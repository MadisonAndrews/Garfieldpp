C  PROGRAM MAGBOLTZ 2   VERSION 8.6 SEP 2009
C --------------------------------------------------------------------
C  COPYRIGHT 2008   STEPHEN FRANCIS BIAGI
C  --------------------------------------------------------------------
C VERSION 8.6  INCLUDED ARGON UPDATE WITH 44 LEVELS
C---------------------------------------------------------------------
C VERSION 8.5  CORRECTION FOR MISSING LINE IN SUBROUTINE MONTEA WHICH
C              CAUSED ERRORS IN VERSIONS 8.4,8.3 AND 8.2 WHEN A MAGNETIC
C              FIELD WAS INCLUDED PARALLEL TO THE E FIELD
C-----------------------------------------------------------------------
C VERSION 8.4  INCLUDED ISOBUTANE UPDATE
C----------------------------------------------------------------
C VERSION 8.3  INCLUDED NITROGEN UPDATE
C ---------------------------------------------------------------------
C VERSION 8.2 INTRODUCED ALTERNATIVE FORMALISM FOR ANGULAR DISTRIBUTION
C             REF: PHYS.REV.65E 037402 OKHRIMOVSKYY ET AL.
C             INTRODUCED CONTROL FOR ANGULAR DISTRIBUTION GIVING
C             CHOICE OF TWO DIFFERENT ANISOTROPIC SCAT. FORMALISMS.
C             INCREASED DECORRELATION TO  200000 COLLISIONS
C             INCLUDED PENNING TRANSFER EFFICIENCY
C             INCREASED ENERGY SEGEMENTATION FROM 2000 TO 4000 STEPS
C----------------------------------------------------------------------
C VERSION 7.1 INCREASED SOME ARRAY SIZES AND REDUCED DIFFUSION ARRAY
C             WITH SHORTER CORRELATIONS (BACK TO VERSION 6.1) THE LONGER
C             CORRELATION INTRODUCED PROBLELMS WITH ROUNDING ERRORS ON
C             DIFFUSION CALCULATIONS ON 32 BIT PCS.
C             INTRODUCED SAMPLING OF MOST SIGNIFICANT BITS IN COLLISION
C             ARRAY IN ORDER TO REDUCE COMPUTATION TIME FOR COMPLEX
C             MIXTURES WITH MANY LEVELS.
C VERSION 7.2 CHANGED RANDOM NUMBER GENERATOR FROM drand48 TO RM48.F
C             ALL INTEGERS MADE INTEGER*8
C  --------------------------------------------------------------------
C VERSION 6.1 NEW CO2 X-SECTION SET INCLUDED
C VESRION 6.2 UPDATES OF N2O AND CD4 X-SECTIONS
C VERSION 6.3 UPDATES CH4 X-SECTIONS (ONLY CHANGES FANO FACTORS AND HAS
C             NO EFFECT ON DRIFT DIFFUSION COMPARED TO 2002 DATA SET)
C VERSION 6.4 INCREASED DIFFUSION ARRAY TO ALLOW LONGER DECORRELATION
C---------------------------------------------------------------------
C  VERSION 6: REMOVED ALL RESTRICTIONS ON ANGULAR SCATTERING , ALL
C   ELASTIC AND INELASTIC SCATTERING PROCESSES CAN NOW HAVE ANGULAR
C   DISTRIBUTIONS ( IF INCLUDED IN DATA BASE)
C   IF THE ELASTIC ANGULAR DISTRIBUTION EXISTS THEN PROGRAM USES THIS AS
C  AN APPROXIMATION TO THE ANGULAR DISTRIBUTION OF THE PRIMARY
C  IONISATION ELECTRON ( SECONDARIES ALWAYS HAVE ISOTROPIC SCATTERING).
C  THE ANGULAR DISTRIBUTION OF THE PRIMARY IS TAKEN TO BE THE SAME AS
C  THE ANGULAR DISTRIBUTION OF AN ELASTIC SCATTERED ELECTRON WITH THE
C  SAME FINAL ENERGY.
C  THIS ALGORITHM FOR THE ANGULAR DISTRIBUTION OF THE PRIMARY IONISATION
C  ELECTRON REPRODUCES EXPERIMENTAL IONISATION ANGULAR DISTRIBUTIONS
C  AND ALSO GIVES THE CORRECT RANGES FOR HIGH ENERGY ELECTRONS
C  IN GASES . RANGES ARE ACCURATE UP TO 100KEV.
C  N.B  IF USING WATER MIXTURES YOU WILL SEE AN INCREASE IN COMPUTING
C       TIME COMPARED TO PREVIOUS VERSIONS SINCE NOW 210 ROTATIONAL
C       TRANSITIONS ARE INCLUDED IN THE DATA BASE.
C---------------------------------------------------------------------
C  CALCULATES DRIFT,DIFFUSION,GAIN AND ATTACHMENT OF ELECTRONS IN
C  GASES WITH APPLIED ELECTRIC AND MAGNETIC FIELDS AT ARBITRARY ANGLES.
C  THE COMMON BLOCK STRUCTURE OF THE RESULTS IS OUTLINED BELOW.
C  PLEASE QUOTE THE DATA BASE REVISION YEAR FOR THE GAS USED IN THE DATA
C  BASE, ( E.G. KRYPTON (2002) ) , IN ANY PUBLICATIONS.
C ---------------------------------------------------------------------
C  LINUX PC VERSION USES DRAND48 DOUBLE PRECISION RANDOM NO GENERATOR
C  (CAN ALSO USE RNDM2 FROM CERNLIB WITH THE SAME PRECISION ).
C  --------------------------------------------------------------------
C  THE PROGRAM ALLOWS ANISOTROPIC ELASTIC AND INELASTIC SCATTERING :
C    REF : NIM A 421 (1999) 234-240
C   THE GAS DATA BASE LIST BELOW SHOWS THOSE X-SECTIONS WHICH CONTAIN
C   ANISOTROPIC SCATTERING DATA.
C   POSTSCRIPT PLOTS OF THE DATABASE X-SECTIONS CAN BE OBTAINED ON:-
C    HTTP://CONSULT.CERN.CH/WRITEUPS/MAGBOLTZ/CROSS/
C----------------------------------------------------------------------
C  THIS VERSION ALLOWS SPATIAL GRADIENTS TO BE INCLUDED IN THE SOLUTION
C  FOR THE TOWNSEND GAIN AND ATTACHMENT COEFICIENTS.
C   THE PROGRAM AUTOMATICALLY GIVES A SOLUTION WITH SPATIAL GRADIENTS
C  FOR BOTH TIME OF FLIGHT (TOF), PULSED TOWNSEND (PT) AND STEADY STATE
C   TOWNSEND (SST) PARAMETERS.
C  THE NOMENCLATURE IS SIMILAR TO SAKAI ET AL. J.PHYS.D10 (1977) 1035.
C  THE SIMULATION OF AVALANCHE GAIN DETECTORS AT HIGH FIELD REQUIRES THE
C  USE OF SST TOWNSEND PARAMETERS.
C  THE PROGRAM AUTOMATICALLY UPDATES THE COMMON BLOCKS /CTOWNS/ AND
C   /CTWNER/ WITH THE SST PARAMETERS IF THE SPATIAL GRADIENTS ARE
C   GREATER THAN :  ABS (ALPHA-ATT)  = 30/CM AT NTP.
C   WHERE ABS= MAGNITUDE , ALPHA=GAIN COEFICIENT AND ATT=ATTACHMENT.
C  ( FOR SMALLER VALUES OF ABS(ALPHA-ATT) < 30/CM , THE CHANGE OF THE
C  GAIN OR ATTACHMENT IS TYPICALLY LESS THAN 3% FOR THE SOLUTION WITHOUT
C   SPATIAL GRADIENTS ).
C-----------------------------------------------------------------------
C --------------------------------------------------------------------
C THE  INPUT CONTROL FLAG IPEN WHEN SET TO 1 ALLOWS SOME PENNING CALCS:
C
C   ESTIMATES OF THE PENNING EFFECT AT HIGH FIELD CAN BE OBTAINED BY
C  EDITING THE ARRAY PENFRA(3,220) IN THE GAS DATA BASE SUBROUTINES.
C THE PROGRAM CAN THEN BE RECOMPILED AND RUN. THE OUTPUT THEN CONTAINS
C INFORMATION ON THE PENNING FRACTION USED IN THE CALCULATION.
C  IN THE GAS MIXTURES. PENNING EFFECTS CAN OCCUR BETWEEN EXCITED STATES
C   IN THE GAS MIXTURE WHICH ARE HIGHER IN ENERGY THAN THE LOWEST
C    IONISATION POTENTIAL IN THE MIXTURE.
C  THE FIRST ENTRY PENFRA(1,N) IS THE FRACTION OF THE EXCITED STATE N
C  THAT WILL TRANSFER TO IONISE THE LOWER IONISATION LEVELS IN THE GAS
C  MIXTURE.
C   THE SECOND ENTRY ,PENFRA(2,N) IS THE DELOCALISATION LENGTH OF THE
C  TRANSFER I.E. THE AVERAGE DISTANCE THAT THE EXCITED GAS WILL TRAVEL
C  BEFORE THE TRANSFER ( OR IN CASE OF PHOTON EMISSION AND CAPTURE)
C  THE AVERAGE DISTANCE TRAVELLED BY THE PHOTON)
C  THE THIRD ENTRY , PENFRA(3,N) IS THE DECAY TIME OF THE EXCITED STATE
C  IN THE MIXTURE.
C  NB DELOCALISATION DISTANCE IS IN MICRONS AND DECAY TIME IN PICOSECS.
C   THERE IS NO AUTOMATIC METHOD FOR CHOOSING THE PENNING FRACTION BUT
C  YOU WILL FIND THAT THE ARRAY PENFRA(1,220) FOR HELIUM HAS BEEN SET TO
C  1.0 (100%) THIS IS THE ONLY CORRECT CHOICE FOR THIS GAS WITH ANY OTHER
C  GAS MIXED IN. SIMILARLY THE NEON PENNING FRACTION SHOULD BE BETWEEN
C  0.3 AND 0.7 (30 TO 70 %) . ARGON WHEN MIXED WITH HYDROCARBONS OTHER
C THAN METHANE GIVES PENNING FRACTIONS OF 0 TO 30%.
C   IF DIFFICULTY OCCURS CONTACT THE AUTHOR.
C
C *********************************************************************
C  THE PROGRAM SHOULD ALWAYS CONVERGE TO A SOLUTION. THE ERROR ON THE
C  INTEGRATION SHOULD SCALE WITH THE SQUARE ROOT OF THE NUMBER OF
C  COLLISIONS (PARAMETER NMAX) . THE OUTPUT SHOULD ALWAYS BE CHECKED TO
C  ENSURE THAT THE NUMBER OF COLLISIONS IN THE LAST ENERGY BIN IS SMALL,
C  ANY VALUE LESS THAN  500 SHOULD GIVE REASONABLE SYSTEMATIC ERRORS
C   IF THE NUMBER OF COLLISIONS IS GREATER THAN 500 THEN THE INTEGRATION
C   ENERGY RANGE SHOULD BE INCREASED.
C***********************************************************************
C  THE PROGRAM IS LIMITED IN PRECISION BY THE STATISTICAL ACCURACY
C  OF THE RESULTS. IT IS POSSIBLE  TO OBTAIN A STATISTICAL ACCURACY
C  OF BETTER THAN 0.1% ON THE DRIFT VELOCITY AND 1% ON THE
C  DIFFUSION COEFICIENTS IN MOST COUNTING GAS MIXTURES IN ABOUT
C  1 MINUTE OF COMPUTING TIME ON A PC , ALPHA OR WORKSTATION.
C  AT HIGH FIELD WHEN THE TOWNSEND COEFICIENT IS INCLUDED IN THE SPATIAL
C  GRADIENT THE COMPUTATION TIME MAY BE REQUIRED TO INCREASE TO A FEW
C   MINUTES.
C  WHEN VELOCITY VECTORS ARE SMALL SUCH AS THE CASE WITH SMALL LORENTZ
C  ANGLES THE PARAMETER NMAX WILL NEED TO BE INCREASED TO 20  OR MORE.
C
C--------------------------------------------------------------------
C  GEOMETRY:
C--------------
C            THE ELECTRIC FIELD IS TAKEN ALONG THE Z-AXIS AND THE
C   MAGNETIC FIELD IS TAKEN IN THE Z-X PLANE AT AN ANGLE, BTHETA ,
C   TO THE ELECTRIC FIELD.
C
C  THE RESULTS OF THE CALCULATION ARE LOADED INTO COMMON BLOCKS:
C  COMMON/VEL/WX,WY,WZ
C  COMMON/VELERR/DWX,DWY,DWZ
C  COMMON/DIFLAB/DIFXX,DIFYY,DIFZZ,DIFYZ,DIFXY,DIFXZ
C  COMMON/DIFERB/DXXER,DYYER,DZZER,DYZER,DXYER,DXZER
C  COMMON/DIFVEL/DIFLN,DIFTR
C  COMMON/DIFERL/DFLER,DFTER
C  COMMON/CTOWNS/ALPHA,ATT
C  COMMON/CTWNER/ALPER,ATTER
C
C    WX,WY,WZ ARE THE DRIFT VELOCITY VECTORS
C    DIFXX,DIFYY,DIFZZ,DIFYZ,DIFXY,DIFXZ ARE THE VALUES OF THE DIFFUSION
C    TENSOR IN THE CARTESIAN COORDINATE SYSTEM.
C    -------------------------------
C    NOTE : OFF-DIAGONAL ELEMENTS ARE DEFINED SO THAT THE COEFFICIENTS
C    ARE EQUAL :  DIFXY=DIFYX   ,   DIFXZ=DIFZX  AND DIFYZ=DIFZY .
C    -----------------------------
C    DIFLN,DIFTR,DIFXX ARE THE DIFFUSION COEFFICIENTS IN THE COORDINATE
C    SYSTEM ALIGNED ALONG THE DRIFT DIRECTION (IT IS ONLY CALCULATED
C    FOR THE CASE WHERE THE MAGNETIC FIELD IS AT 90 DEGREES TO EFIELD).
C    IF THERE IS NO MAGNETIC FIELD THE VALUES DIFLN AND DIFTR
C     REPRESENT THE LONGITUDINAL AND TRANSVERSE DIFFUSION.
C
C    OUTPUT UNITS IN COMMON BLOCKS:
C                                 : VELOCITY : CM/SEC
C                                  DIFFUSION : CM**2/SEC
C                                  ALPHA     : 1/CM.
C                                  ATT       : 1/CM.
C                        CALCULATION  ERRORS :  % OF VALUE.
C
C  NB . OBSERVED ALPHA = ALPHA-ATT
C  FOR MAGNETIC FIELDS ALPHA AND ATT ARE DEFINED PARALLEL TO THE
C  ELECTRIC FIELD......
C----------------------------------------------------------------
C---------------------------------------------------------------
C   INPUT CARDS :
C----------------------------------------------------------
C  FIRST CARD: 3I10,F10.5  :  NGAS,NMAX,IPEN,EFINAL
C  NGAS:  NUMBER OF GASES IN MIXTURE
C  NMAX: NUMBER OF REAL COLLISIONS ( MULTIPLE OF 1*10**7 )
C  USE NMAX = BETWEEN 2 AND 5 FOR INELASTIC GAS TO OBTAIN 1% ACCURACY
C      NMAX = ABOVE 10 FOR BETTER THAN 0.5% ACCURACY.
C      NMAX = AT LEAST 10 FOR PURE ELASTIC GASES LIKE ARGON
C      HIGHER VALUES THAN NMAX=214 CAN ONLY BE USED ON COMPUTERS SUCH
C      AS DEC ALPHAS WITH TRUE 64 BIT INTEGERS. PCS ARE LIMITED TO
C      31 BIT INTEGERS...
C    IPEN   = 0 PENNING EFFECTS NOT INCLUDED
C           = 1 PENNING EFFECTS INCLUDED (SEE INSTRUCTIONS ABOVE)
C    EFINAL = UPPER LIMIT OF THE ELECTRON ENERGY IN ELECTRON VOLTS.
C    EFINAL = 0.0 (PROGRAM AUTOMATICALLY CALCULATES UPPER INTEGRATION
C                 ENERGY LIMIT)
C-------------------------------------------------------------
C  SECOND CARD : 6I5   : NGAS1 , NGAS2, NGAS3 , NGAS4 , NGAS5 , NGAS6
C       NGAS1,ETC :  GAS NUMBER IDENTIFIERS (BETWEEN 1 AND 80)
C                   SEE GAS LIST BELOW FOR IDENTIFYING NUMBERS.
C
C-------------------------------------------------------------
C THIRD CARD: 8F10.4  : FRAC1,FRAC2,FRAC3,FRAC4,FRAC5,FRAC6,TEMP,TORR
C  FRAC1,ETC : PERCENTAGE FRACTION OF GAS1,ETC
C  TEMP : TEMPERATURE OF GAS IN CENTIGRADE
C  TORR :  PRESSURE OF GAS IN TORR
C ------------------------------------------------------------
C FOURTH CARD : 6F10.3  : EFIELD,BMAG,BTHETA
C  EFIELD : ELECTRIC FIELD IN VOLTS/ CM.
C   BMAG  : MAGNITUDE OF THE MAGNETIC FIELD IN KILOGAUSS
C  BTHETA : ANGLE BETWEEN THE ELECTRIC AND MAGNETIC FIELDS IN DEGREES.
C-----------------------------------------------------------------------
C CARD 4*N+1 USES NGAS=0 TO TERMINATE CORRECTLY
C--------------------------------------------------------------------
C DATA BASE:
C
C GAS NUMBER:                                           STAR RATING:
C-----------------------------------------------------------------
C GAS1  :  CF4             (2008)                                  5*
C GAS2  :  ARGON           (2009)                                  5*
C GAS3  :  HELIUM 4        (2007)                                  5*
C GAS4  :  HELIUM 3        (2007)                                  5*
C GAS5  :  NEON            (2007)                                  5*
C GAS6  :  KRYPTON         (2007)                                  4*
C GAS7  :  XENON           (2007)                                  4*
C GAS8  :  METHANE         (2008)                                  5*
C GAS9  :  ETHANE          (1999)                                  5*
C GAS10 :  PROPANE         (1999)                                  4*
C GAS11 :  ISOBUTANE       (2009)                                  4*
C GAS12 :  CO2             (2007)                                  5*
C GAS13 :  NEO-PENTANE     (2003)  C(CH3)4                         4*
C GAS14 :  H20             (2004) 210  ROTATIONAL STATES INCLUDED  4*
C GAS15 :  OXYGEN          (2004)  3-BODY ATTACHMENT INCLUDED      4*
C GAS16 :  NITROGEN        (2008)                                  5*
C GAS17 :  NITRIC OXIDE    (1995)  ATTACHING GAS                   2*
C GAS18 :  NITROUS OXIDE   (2004)  ATTACHING GAS (SEE DATA FILE)   4*
C GAS19 :  ETHENE          (1999)   C2H4                           4*
C GAS20 :  ACETYLENE       (2002)   C2H2                           4*
C GAS21 :  HYDROGEN        (2001)                                  5*
C GAS22 :  DEUTERIUM       (1998)                                  5*
C GAS23 :  CARBON MONOXIDE (2003) ANISOTROPIC ROTATIONAL STATES    5*
C GAS24 :  METHYLAL        (1988)                                  2*
C GAS25 :  DME             (1998)                                  4*
C GAS26 :  REID STEP MODEL         (ANISOTROPIC VERSION)
C GAS27 :  MAXWELL MODEL
C GAS28 :  REID RAMP MODEL
C GAS29 :  C2F6             (1999)   (ANISOTROPIC )                4*
C GAS30 :  SF6   N.B.  DO NOT USE HIGH PERCENTAGE                  3*
C GAS31 :  NH3 AMMONIA        (2004) 120 ROTATIONAL LEVELS         4*
C GAS32 :  C3H6   PROPENE     (1999)                               4*
C GAS33 :  C3H6  CYCLOPROPANE (1999)                               4*
C GAS34 :  CH3OH METHANOL     (1999)                               3*
C GAS35 :  C2H5OH ETHANOL     (1999)                               3*
C GAS36 :  C3H7OH ISO PROPANOL(1999)                               3*
C GAS37 :  CESIUM (2001) (NO DIMERS)                               2*
C GAS38 :  FLOURINE  (MORGAN)                                      2*
C GAS39 :  CS2  (2001)  ( ION DRIFT,DARK MATTER )                  2*
C GAS40 :  COS  (2001)                                             2*
C GAS41 :  CD4 (2004)  TPCS IN NEUTRON BACKGROUND ENVIRONMENT      4*
C GAS42 :  BF3 BORON TRIFLOURIDE (2001)  (ANISOTROPIC)             4*
C GAS43 :  C2HF5 OR C2H2F4 (ESTIMATED NO DATA)  (ANISOTROPIC)      2*
C GAS44 :
C GAS45 :
C GAS46 :
C GAS47 :
C GAS48 :
C GAS49 :
C GAS50 :  CHF3     (2001)                                         3*
C GAS51 :  CF3BR    (2002) MAGIC GAS CONSTITUENT                   3*
C GAS52 :  C3F8     (2002)  (ANISOTROPIC)                          3*
C GAS53 :  OZONE    (2002)  RAD HARD (REMOVES CARBON DEPOSITS)     3*
C GAS54 :  MERCURY  (2003)  INCLUDES DIMER X-SECTION               2*
C GAS55 :  H2S      (2003)  POOR QUALITY DATA                      2*
C GAS56 :  N-BUTANE (2003)  LINEAR CHAIN 	C-C-C-C            4*
C GAS57 :  N-PENTANE(2003) LINEAR CHAIN C-C-C-C-C                  4*
C GAS58 :  NITROGEN (2004) P+PHELPS  MOD ANISOTROPIC ELASTIC SCATT 4*
C GAS59 :  GEH4  (2005)    GERMANE BETTER TRANSPORT DATA NEEDED    3*
C GAS60 :  SIH4  (2005)    SILANE ANISOTROPIC                      4*
C  GAS61-80 :DUMMY ROUTINES
C------------------------------------------------------------------
C
      PROGRAM MAGBOLTZ 2
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/BFLD/EOVB,WB,BTHETA,BMAG
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      COMMON/SETP/TMAX,SMALL,API,ESTART,THETA,PHI,TCFMAX(8),RSTART,
     /EFIELD,NMAX
      COMMON/OUTPT/TIME(300),ICOLL(30),SPEC(4000),TMAX1,
     /AVE,DEN,XID,X,Y,Z,ST,NNULL,ICOLN(512)
      COMMON/CTOWNS/ALPHA,ATT
 1    CALL SETUP(LAST)
      IF(LAST.EQ.1) GO TO 99
      IF(EFINAL.GT.0.0D0) GO TO 3
C CALCULATE EFINAL (START AT 0.5 EV. IF E/P GT 15 START AT 8.0 EV.)
      EFINAL=0.5D0
      EOP=EFIELD*(TEMPC+273.15D0)/(TORR*293.15D0)
      IF(EOP.GT.15.0D0) EFINAL=8.0D0
      ESTART=EFINAL/50.0D0
 2    CALL MIXER
C LOOP TO CALCULATE EFINAL
      IF(BMAG.EQ.0.0D0.OR.BTHETA.EQ.0.0D0.OR.DABS(BTHETA).EQ.180.0D0)
     /THEN
       CALL ELIMIT(IELOW)
       GO TO 10
      ENDIF
      IF(BTHETA.EQ.90.0D0) THEN
       CALL ELIMITB(IELOW)
       GO TO 10
      ELSE
       CALL ELIMITC(IELOW)
      ENDIF
   10 IF(IELOW.EQ.1) THEN
       EFINAL=EFINAL*DSQRT(2.0D0)
       ESTART=EFINAL/50.0D0
       GO TO 2
      ENDIF
      GO TO 4
    3 CALL MIXER
    4 CONTINUE
      CALL PRNTER
      IF(BMAG.EQ.0.0D0) CALL MONTE
      IF(BMAG.NE.0.0D0) THEN
       IF(BTHETA.EQ.0.0D0.OR.BTHETA.EQ.180.0D0) THEN
        CALL MONTEA
        ELSE IF(BTHETA.EQ.90.0D0) THEN
        CALL MONTEB
        ELSE
        CALL MONTEC
       ENDIF
      ENDIF
C     IF(SPEC(4000).GT.500.0D0) THEN
C      WRITE(6,50)
C  50  FORMAT(' WARNING COMPUTATION STOPPED INCREASE ELECTRON ENERGY INT
C    /EGRATION RANGE ')
C      STOP
C     ENDIF
      CALL OUTPUT
C IF ATTACHMENT OR IONISATION RATE IS GREATER THAN SSTMIN THEN INCLUDE
C   SPATIAL GRADIENTS IN THE SOLUTION .
      TGAS=273.15D0+TEMPC
      ALPP=ALPHA*760.0D0*TGAS/(TORR*293.15D0)
      ATTP=ATT*760.0D0*TGAS/(TORR*293.15D0)
C*******************
      SSTMIN=30.0D0
C     SSTMIN=60.0D0
C*****************
      IF(DABS(ALPP-ATTP).GT.SSTMIN) GO TO 5
      IF(ALPP.GT.SSTMIN.OR.ATTP.GT.SSTMIN) GO TO 5
      CALL OUTPUT2
      GO TO 1
   5  IF(BMAG.EQ.0.0D0) THEN
       CALL ALPCALC
      ELSE IF(BTHETA.EQ.0.0D0.OR.BTHETA.EQ.180.0D0) THEN
       CALL ALPCLCA
      ELSE IF(BTHETA.EQ.90.0D0) THEN
       CALL ALPCLCB
      ELSE
       CALL ALPCLCC
      ENDIF
      CALL OUTPUT2
      GO TO 1
  99  STOP
      END
      SUBROUTINE ANGCUT(PSCT1,ANGC,PSCT2)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
C  --------------------------------------------------------------
C  SET ANGLE CUTS ON ANGULAR DISTRIBUTION AND RENORMALISE FORWARD
C  SCATTERING PROBABILITY
C  ---------------------------------------------------------------
      ANGC=1.0D0
      PSCT2=PSCT1
      IF(PSCT1.LE.1.0D0) RETURN
      API=DACOS(-1.0D0)
      RADS=2.0D0/API
      CNS=PSCT1-0.5D0
      THETAC=DASIN(2.0D0*DSQRT(CNS-CNS*CNS))
      FAC=(1.0D0-DCOS(THETAC))/(DSIN(THETAC)*DSIN(THETAC))
      PSCT2=(CNS*FAC)+0.5D0
      ANGC=THETAC*RADS
      RETURN
      END
      SUBROUTINE MIXER
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/RATIO/AN1,AN2,AN3,AN4,AN5,AN6,AN,FRAC(6)
      COMMON/GASN/NGASN(6)
      COMMON/MIX1/QELM(4000),QSUM(4000),QION(6,4000),QIN1(220,4000),
     /QIN2(220,4000),QIN3(220,4000),QIN4(220,4000),QIN5(220,4000),
     /QIN6(220,4000),QSATT(4000)
      COMMON/MIX2/E(4000),EROOT(4000),QTOT(4000),QREL(4000),
     /QINEL(4000),QEL(4000)
      COMMON/MIX3/NIN1,NIN2,NIN3,NIN4,NIN5,NIN6,LION(6),LIN1(220),
     /LIN2(220),LIN3(220),LIN4(220),LIN5(220),LIN6(220),ALION(6),
     /ALIN1(220),ALIN2(220),ALIN3(220),ALIN4(220),ALIN5(220),ALIN6(220)
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      COMMON/CNSTS1/CONST1,CONST2,CONST3,CONST4,CONST5
      COMMON/SETP/TMAX,SMALL,API,ESTART,THETA,PHI,TCFMAX(8),RSTART,
     /EFIELD,NMAX
      COMMON/LARGE/CF(4000,512),EIN(512),TCF(4000),IARRY(512),RGAS(512),
     /IPN(512),WPL(512),IPLAST,ISIZE,PENFRA(3,512)
      COMMON/ANIS/PSCT(4000,512),ANGCT(4000,512),INDEX(512),NISO
      COMMON/FRED/FCION(4000),FCATT(4000)
      COMMON/MRATIO/VAN1,VAN2,VAN3,VAN4,VAN5,VAN6,VAN
      COMMON/NAMES/NAMEG(6)
      COMMON/SCRIP/DSCRPT(512)
      CHARACTER*15 NAMEG,NAME1,NAME2,NAME3,NAME4,NAME5,NAME6
      CHARACTER*30 DSCRPT,SCRP1(226),SCRP2(226),SCRP3(226),SCRP4(226),
     /SCRP5(226),SCRP6(226)
      DIMENSION Q1(6,4000),Q2(6,4000),Q3(6,4000),Q4(6,4000),
     /Q5(6,4000),Q6(6,4000)
      DIMENSION E1(6),E2(6),E3(6),E4(6),E5(6),E6(6),EI1(220),EI2(220),
     /EI3(220),EI4(220),EI5(220),EI6(220)
      DIMENSION QQROT(4000),QDROT(4000),QATT(6,4000),EION(6)
      DIMENSION PEQEL1(6,4000),PEQEL2(6,4000),PEQEL3(6,4000),
     /PEQEL4(6,4000),PEQEL5(6,4000),PEQEL6(6,4000)
      DIMENSION PEQIN1(220,4000),PEQIN2(220,4000),PEQIN3(220,4000),
     /PEQIN4(220,4000),PEQIN5(220,4000),PEQIN6(220,4000)
      DIMENSION PENFRA1(3,220),PENFRA2(3,220),PENFRA3(3,220),
     /PENFRA4(3,220),PENFRA5(3,220),PENFRA6(3,220)
      DIMENSION KIN1(220),KIN2(220),KIN3(220),KIN4(220),KIN5(220),
     /KIN6(220)
      DIMENSION KEL1(6),KEL2(6),KEL3(6),KEL4(6),KEL5(6),KEL6(6)
C
C  ---------------------------------------------------------------------
C
C     SUBROUTINE MIXER FILLS ARRAYS OF COLLISION FREQUENCY
C     CAN HAVE A MIXTURE OF UP TO 6 GASES
C
C
C  ---------------------------------------------------------------------
C
      NISO=0
      NIN1=0
      NIN2=0
      NIN3=0
      NIN4=0
      NIN5=0
      NIN6=0
      N4000=4000
      NONE=1
      DO 2 J=1,6
      NAMEG(J)='---------------'
      KEL1(J)=0
      KEL2(J)=0
      KEL3(J)=0
      KEL4(J)=0
      KEL5(J)=0
      KEL6(J)=0
      DO 1 I=1,4000
      Q1(J,I)=0.0D0
      Q2(J,I)=0.0D0
      Q3(J,I)=0.0D0
      Q4(J,I)=0.0D0
      Q5(J,I)=0.0D0
      Q6(J,I)=0.0D0
    1 CONTINUE
      E1(J)=0.0D0
      E2(J)=0.0D0
      E3(J)=0.0D0
      E4(J)=0.0D0
      E5(J)=0.0D0
    2 E6(J)=0.0D0
      ESTEP=EFINAL/DFLOAT(NSTEP)
      EHALF=ESTEP/2.0D0
      E(1)=EHALF
      DO 3 I=2,4000
      AJ=DFLOAT(I-1)
      E(I)=EHALF+ESTEP*AJ
    3 EROOT(I)=DSQRT(E(I))
      EROOT(1)=DSQRT(EHALF)
      DO 4 I=1,220
      KIN1(I)=0
      KIN2(I)=0
      KIN3(I)=0
      KIN4(I)=0
      KIN5(I)=0
    4 KIN6(I)=0
      DO 6 I=1,512
    6 INDEX(I)=0
C
C   CALL GAS CROSS-SECTIONS
      CALL GASMIX(NGASN(1),Q1,QIN1,NIN1,E1,EI1,NAME1,VIRIAL1,EB1,
     /PEQEL1,PEQIN1,PENFRA1,KEL1,KIN1,SCRP1)
      IF(NGAS.EQ.1) GO TO 10
      CALL GASMIX(NGASN(2),Q2,QIN2,NIN2,E2,EI2,NAME2,VIRIAL2,EB2,
     /PEQEL2,PEQIN2,PENFRA2,KEL2,KIN2,SCRP2)
      IF(NGAS.EQ.2) GO TO 10
      CALL GASMIX(NGASN(3),Q3,QIN3,NIN3,E3,EI3,NAME3,VIRIAL3,EB3,
     /PEQEL3,PEQIN3,PENFRA3,KEL3,KIN3,SCRP3)
      IF(NGAS.EQ.3) GO TO 10
      CALL GASMIX(NGASN(4),Q4,QIN4,NIN4,E4,EI4,NAME4,VIRIAL4,EB4,
     /PEQEL4,PEQIN4,PENFRA4,KEL4,KIN4,SCRP4)
      IF(NGAS.EQ.4) GO TO 10
      CALL GASMIX(NGASN(5),Q5,QIN5,NIN5,E5,EI5,NAME5,VIRIAL5,EB5,
     /PEQEL5,PEQIN5,PENFRA5,KEL5,KIN5,SCRP5)
      IF(NGAS.EQ.5) GO TO 10
      CALL GASMIX(NGASN(6),Q6,QIN6,NIN6,E6,EI6,NAME6,VIRIAL6,EB6,
     /PEQEL6,PEQIN6,PENFRA6,KEL6,KIN6,SCRP6)
   10 CONTINUE
C ---------------------------------------------------------------
C  CORRECTION OF NUMBER DENSITY DUE TO VIRIAL COEFFICIENT
C  CAN BE PROGRAMMED HERE NOT YET IMPLEMENTED.
C-----------------------------------------------------------------
C-----------------------------------------------------------------
C     CALCULATION OF COLLISION FREQUENCIES FOR AN ARRAY OF
C     ELECTRON ENERGIES IN THE RANGE ZERO TO EFINAL
C
C     L=5*N-4    ELASTIC NTH GAS
C     L=5*N-3    IONISATION NTH GAS
C     L=5*N-2    ATTACHMENT NTH GAS
C     L=5*N-1    INELASTIC NTH GAS
C     L=5*N      SUPERELASTIC NTH GAS
C---------------------------------------------------------------
      write(6,*) e1(2), e2(2), e1(3), e2(3)
      write(6,*) eb1, eb2
      DO 700 IE=1,4000
      FCION(IE)=0.0D0
      FCATT(IE)=0.0D0
      NP=1
      CF(IE,NP)=Q1(2,IE)*VAN1
      PSCT(IE,NP)=0.5D0
      ANGCT(IE,NP)=1.0D0
      INDEX(NP)=0
C
      IF(KEL1(2).EQ.1) THEN
       PSCT1=PEQEL1(2,IE)
       CALL ANGCUT(PSCT1,ANGC,PSCT2)
       ANGCT(IE,NP)=ANGC
       PSCT(IE,NP)=PSCT2
       INDEX(NP)=1
      ENDIF
      IF(KEL1(2).EQ.2) THEN
       PSCT(IE,NP)=PEQEL1(2,IE)
       INDEX(NP)=2
      ENDIF
C
      IF(IE.GT.1) GO TO 12
      RGAS1=1.0D0+E1(2)/2.0D0
      RGAS(NP)=RGAS1
      EIN(NP)=0.0D0
      IPN(NP)=0
      L=1
      IARRY(NP)=L
      DSCRPT(NP)=SCRP1(2)
      NAMEG(1)=NAME1
      PENFRA(1,NP)=0.0
      PENFRA(2,NP)=0.0
      PENFRA(3,NP)=0.0
   12 IF(EFINAL.LT.E1(3)) GO TO 30
      NP=NP+1
      CF(IE,NP)=Q1(3,IE)*VAN1
      FCION(IE)=FCION(IE)+CF(IE,NP)
      PSCT(IE,NP)=0.5D0
      ANGCT(IE,NP)=1.0D0
      INDEX(NP)=0
C
      IF(KEL1(3).EQ.1) THEN
       PSCT1=PEQEL1(3,IE)
       CALL ANGCUT(PSCT1,ANGC,PSCT2)
       ANGCT(IE,NP)=ANGC
       PSCT(IE,NP)=PSCT2
       INDEX(NP)=1
      ENDIF
      IF(KEL1(3).EQ.2) THEN
       PSCT(IE,NP)=PEQEL1(3,IE)
       INDEX(NP)=2
      ENDIF
C
      IF(IE.GT.1) GO TO 30
      RGAS(NP)=RGAS1
      EIN(NP)=E1(3)/RGAS1
      WPL(NP)=EB1
      IPN(NP)=1
      L=2
      IARRY(NP)=L
      DSCRPT(NP)=SCRP1(3)
      PENFRA(1,NP)=0.0
      PENFRA(2,NP)=0.0
      PENFRA(3,NP)=0.0
   30 IF(EFINAL.LT.E1(4)) GO TO 40
      NP=NP+1
      CF(IE,NP)=Q1(4,IE)*VAN1
      FCATT(IE)=FCATT(IE)+CF(IE,NP)
      PSCT(IE,NP)=0.5D0
      ANGCT(IE,NP)=1.0D0
      IF(IE.GT.1) GO TO 40
      INDEX(NP)=0
      RGAS(NP)=RGAS1
      EIN(NP)=0.0D0
      IPN(NP)=-1
      L=3
      IARRY(NP)=L
      DSCRPT(NP)=SCRP1(4)
      PENFRA(1,NP)=0.0
      PENFRA(2,NP)=0.0
      PENFRA(3,NP)=0.0
   40 IF(NIN1.EQ.0) GO TO 60
      DO 50 J=1,NIN1
      NP=NP+1
      CF(IE,NP)=QIN1(J,IE)*VAN1
      PSCT(IE,NP)=0.5D0
      ANGCT(IE,NP)=1.0D0
      INDEX(NP)=0
C
      IF(KIN1(J).EQ.1) THEN
       PSCT1=PEQIN1(J,IE)
       CALL ANGCUT(PSCT1,ANGC,PSCT2)
       ANGCT(IE,NP)=ANGC
       PSCT(IE,NP)=PSCT2
       INDEX(NP)=1
      ENDIF
      IF(KIN1(J).EQ.2) THEN
       PSCT(IE,NP)=PEQIN1(J,IE)
       INDEX(NP)=2
      ENDIF
C
      IF(IE.GT.1) GO TO 50
      RGAS(NP)=RGAS1
      EIN(NP)=EI1(J)/RGAS1
      L=4
      IF(EI1(J).LT.0.0D0) L=5
      IPN(NP)=0
      IARRY(NP)=L
      DSCRPT(NP)=SCRP1(6+J)
      PENFRA(1,NP)=PENFRA1(1,J)
      PENFRA(2,NP)=PENFRA1(2,J)*1.D-16/DSQRT(3.0D0)
      PENFRA(3,NP)=PENFRA1(3,J)
   50 CONTINUE
C
   60 IF(NGAS.EQ.1) GO TO 600
      NP=NP+1
      CF(IE,NP)=Q2(2,IE)*VAN2
      PSCT(IE,NP)=0.5D0
      ANGCT(IE,NP)=1.0D0
      INDEX(NP)=0
C
      IF(KEL2(2).EQ.1) THEN
       PSCT1=PEQEL2(2,IE)
       CALL ANGCUT(PSCT1,ANGC,PSCT2)
       ANGCT(IE,NP)=ANGC
       PSCT(IE,NP)=PSCT2
       INDEX(NP)=1
      ENDIF
      IF(KEL2(2).EQ.2) THEN
       PSCT(IE,NP)=PEQEL2(2,IE)
       INDEX(NP)=2
      ENDIF
C
      IF(IE.GT.1) GO TO 62
      RGAS2=1.0D0+E2(2)/2.0D0
      RGAS(NP)=RGAS2
      EIN(NP)=0.0D0
      IPN(NP)=0
      L=6
      IARRY(NP)=L
      DSCRPT(NP)=SCRP2(2)
      NAMEG(2)=NAME2
      PENFRA(1,NP)=0.0
      PENFRA(2,NP)=0.0
      PENFRA(3,NP)=0.0
   62 IF(EFINAL.LT.E2(3)) GO TO 130
      NP=NP+1
      CF(IE,NP)=Q2(3,IE)*VAN2
      FCION(IE)=FCION(IE)+CF(IE,NP)
      PSCT(IE,NP)=0.5D0
      ANGCT(IE,NP)=1.0D0
      INDEX(NP)=0
C
      IF(KEL2(3).EQ.1) THEN
       PSCT1=PEQEL2(3,IE)
       CALL ANGCUT(PSCT1,ANGC,PSCT2)
       ANGCT(IE,NP)=ANGC
       PSCT(IE,NP)=PSCT2
       INDEX(NP)=1
      ENDIF
      IF(KEL2(3).EQ.2) THEN
       PSCT(IE,NP)=PEQEL2(3,IE)
       INDEX(NP)=2
      ENDIF
C
      IF(IE.GT.1) GO TO 130
      RGAS(NP)=RGAS2
      EIN(NP)=E2(3)/RGAS2
      WPL(NP)=EB2
      IPN(NP)=1
      L=7
      IARRY(NP)=L
      DSCRPT(NP)=SCRP2(3)
      PENFRA(1,NP)=0.0
      PENFRA(2,NP)=0.0
      PENFRA(3,NP)=0.0
  130 IF(EFINAL.LT.E2(4)) GO TO 140
      NP=NP+1
      CF(IE,NP)=Q2(4,IE)*VAN2
      FCATT(IE)=FCATT(IE)+CF(IE,NP)
      IF(IE.GT.1) GO TO 140
      PSCT(IE,NP)=0.5D0
      ANGCT(IE,NP)=1.0D0
      INDEX(NP)=0
      RGAS(NP)=RGAS2
      EIN(NP)=0.0D0
      IPN(NP)=-1
      L=8
      IARRY(NP)=L
      DSCRPT(NP)=SCRP2(4)
      PENFRA(1,NP)=0.0
      PENFRA(2,NP)=0.0
      PENFRA(3,NP)=0.0
  140 IF(NIN2.EQ.0) GO TO 160
      DO 150 J=1,NIN2
      NP=NP+1
      CF(IE,NP)=QIN2(J,IE)*VAN2
      PSCT(IE,NP)=0.5D0
      ANGCT(IE,NP)=1.0D0
      INDEX(NP)=0
C
      IF(KIN2(J).EQ.1) THEN
       PSCT1=PEQIN2(J,IE)
       CALL ANGCUT(PSCT1,ANGC,PSCT2)
       ANGCT(IE,NP)=ANGC
       PSCT(IE,NP)=PSCT2
       INDEX(NP)=1
      IF(KIN2(J).EQ.2) THEN
       PSCT(IE,NP)=PEQIN2(J,IE)
       INDEX(NP)=2
      ENDIF
C
      ENDIF
      IF(IE.GT.1) GO TO 150
      RGAS(NP)=RGAS2
      EIN(NP)=EI2(J)/RGAS2
      L=9
      IF(EI2(J).LT.0.0D0) L=10
      IPN(NP)=0
      IARRY(NP)=L
      DSCRPT(NP)=SCRP2(6+J)
      PENFRA(1,NP)=PENFRA2(1,J)
      PENFRA(2,NP)=PENFRA2(2,J)*1.D-6/DSQRT(3.0D0)
      PENFRA(3,NP)=PENFRA2(3,J)
  150 CONTINUE
C
  160 IF(NGAS.EQ.2) GO TO 600
      NP=NP+1
      CF(IE,NP)=Q3(2,IE)*VAN3
      PSCT(IE,NP)=0.5D0
      ANGCT(IE,NP)=1.0D0
      INDEX(NP)=0
C
      IF(KEL3(2).EQ.1) THEN
       PSCT1=PEQEL3(2,IE)
       CALL ANGCUT(PSCT1,ANGC,PSCT2)
       ANGCT(IE,NP)=ANGC
       PSCT(IE,NP)=PSCT2
       INDEX(NP)=1
      ENDIF
      IF(KEL3(2).EQ.2) THEN
       PSCT(IE,NP)=PEQEL3(2,IE)
       INDEX(NP)=2
      ENDIF
C
      IF(IE.GT.1) GO TO 162
      RGAS3=1.0D0+E3(2)/2.0D0
      RGAS(NP)=RGAS3
      EIN(NP)=0.0D0
      IPN(NP)=0
      L=11
      IARRY(NP)=L
      DSCRPT(NP)=SCRP3(2)
      NAMEG(3)=NAME3
      PENFRA(1,NP)=0.0
      PENFRA(2,NP)=0.0
      PENFRA(3,NP)=0.0
  162 IF(EFINAL.LT.E3(3)) GO TO 230
      NP=NP+1
      CF(IE,NP)=Q3(3,IE)*VAN3
      FCION(IE)=FCION(IE)+CF(IE,NP)
      PSCT(IE,NP)=0.5D0
      ANGCT(IE,NP)=1.0D0
      INDEX(NP)=0
C
      IF(KEL3(3).EQ.1) THEN
       PSCT1=PEQEL3(3,IE)
       CALL ANGCUT(PSCT1,ANGC,PSCT2)
       ANGCT(IE,NP)=ANGC
       PSCT(IE,NP)=PSCT2
       INDEX(NP)=1
      ENDIF
      IF(KEL3(3).EQ.2) THEN
       PSCT(IE,NP)=PEQEL3(3,IE)
       INDEX(NP)=2
      ENDIF
C
      IF(IE.GT.1) GO TO 230
      RGAS(NP)=RGAS3
      EIN(NP)=E3(3)/RGAS3
      WPL(NP)=EB3
      IPN(NP)=1
      L=12
      IARRY(NP)=L
      DSCRPT(NP)=SCRP3(3)
      PENFRA(1,NP)=0.0
      PENFRA(2,NP)=0.0
      PENFRA(3,NP)=0.0
  230 IF(EFINAL.LT.E3(4)) GO TO 240
      NP=NP+1
      CF(IE,NP)=Q3(4,IE)*VAN3
      FCATT(IE)=FCATT(IE)+CF(IE,NP)
      PSCT(IE,NP)=0.5D0
      ANGCT(IE,NP)=1.0D0
      IF(IE.GT.1) GO TO 240
      INDEX(NP)=0
      RGAS(NP)=RGAS3
      EIN(NP)=0.0D0
      IPN(NP)=-1
      L=13
      IARRY(NP)=L
      DSCRPT(NP)=SCRP3(4)
      PENFRA(1,NP)=0.0
      PENFRA(2,NP)=0.0
      PENFRA(3,NP)=0.0
  240 IF(NIN3.EQ.0) GO TO 260
      DO 250 J=1,NIN3
      NP=NP+1
      CF(IE,NP)=QIN3(J,IE)*VAN3
      PSCT(IE,NP)=0.5D0
      ANGCT(IE,NP)=1.0D0
      INDEX(NP)=0
C
      IF(KIN3(J).EQ.1) THEN
       PSCT1=PEQIN3(J,IE)
       CALL ANGCUT(PSCT1,ANGC,PSCT2)
       ANGCT(IE,NP)=ANGC
       PSCT(IE,NP)=PSCT2
       INDEX(NP)=1
      ENDIF
      IF(KIN3(J).EQ.2) THEN
       PSCT(IE,NP)=PEQIN3(J,IE)
       INDEX(NP)=2
      ENDIF
C
      IF(IE.GT.1) GO TO 250
      RGAS(NP)=RGAS3
      EIN(NP)=EI3(J)/RGAS3
      L=14
      IF(EI3(J).LT.0.0D0) L=15
      IPN(NP)=0
      IARRY(NP)=L
      DSCRPT(NP)=SCRP3(6+J)
      PENFRA(1,NP)=PENFRA3(1,J)
      PENFRA(2,NP)=PENFRA3(2,J)*1.D-6/DSQRT(3.0D0)
      PENFRA(3,NP)=PENFRA3(3,J)
  250 CONTINUE
C
  260 IF(NGAS.EQ.3) GO TO 600
      NP=NP+1
      CF(IE,NP)=Q4(2,IE)*VAN4
      PSCT(IE,NP)=0.5D0
      ANGCT(IE,NP)=1.0D0
      INDEX(NP)=0
C
      IF(KEL4(2).EQ.1) THEN
       PSCT1=PEQEL4(2,IE)
       CALL ANGCUT(PSCT1,ANGC,PSCT2)
       ANGCT(IE,NP)=ANGC
       PSCT(IE,NP)=PSCT2
       INDEX(NP)=1
      ENDIF
      IF(KEL4(2).EQ.2) THEN
       PSCT(IE,NP)=PEQEL4(2,IE)
       INDEX(NP)=2
      ENDIF
C
      IF(IE.GT.1) GO TO 262
      RGAS4=1.0D0+E4(2)/2.0D0
      RGAS(NP)=RGAS4
      EIN(NP)=0.0D0
      IPN(NP)=0
      L=16
      IARRY(NP)=L
      DSCRPT(NP)=SCRP4(2)
      NAMEG(4)=NAME4
      PENFRA(1,NP)=0.0
      PENFRA(2,NP)=0.0
      PENFRA(3,NP)=0.0
  262 IF(EFINAL.LT.E4(3)) GO TO 330
      NP=NP+1
      CF(IE,NP)=Q4(3,IE)*VAN4
      FCION(IE)=FCION(IE)+CF(IE,NP)
      PSCT(IE,NP)=0.5D0
      ANGCT(IE,NP)=1.0D0
      INDEX(NP)=0
C
      IF(KEL4(3).EQ.1) THEN
       PSCT1=PEQEL4(3,IE)
       CALL ANGCUT(PSCT1,ANGC,PSCT2)
       ANGCT(IE,NP)=ANGC
       PSCT(IE,NP)=PSCT2
       INDEX(NP)=1
      ENDIF
      IF(KEL4(3).EQ.2) THEN
       PSCT(IE,NP)=PEQEL4(3,IE)
       INDEX(NP)=2
      ENDIF
C
      IF(IE.GT.1) GO TO 330
      RGAS(NP)=RGAS4
      EIN(NP)=E4(3)/RGAS4
      WPL(NP)=EB4
      IPN(NP)=1
      L=17
      IARRY(NP)=L
      DSCRPT(NP)=SCRP4(3)
      PENFRA(1,NP)=0.0
      PENFRA(2,NP)=0.0
      PENFRA(3,NP)=0.0
  330 IF(EFINAL.LT.E4(4)) GO TO 340
      NP=NP+1
      CF(IE,NP)=Q4(4,IE)*VAN4
      FCATT(IE)=FCATT(IE)+CF(IE,NP)
      PSCT(IE,NP)=0.5D0
      ANGCT(IE,NP)=1.0D0
      IF(IE.GT.1) GO TO 340
      INDEX(NP)=0
      RGAS(NP)=RGAS4
      EIN(NP)=0.0D0
      IPN(NP)=-1
      L=18
      IARRY(NP)=L
      DSCRPT(NP)=SCRP4(4)
      PENFRA(1,NP)=0.0
      PENFRA(2,NP)=0.0
      PENFRA(3,NP)=0.0
  340 IF(NIN4.EQ.0) GO TO 360
      DO 350 J=1,NIN4
      NP=NP+1
      CF(IE,NP)=QIN4(J,IE)*VAN4
      PSCT(IE,NP)=0.5D0
      ANGCT(IE,NP)=1.0D0
      INDEX(NP)=0
C
      IF(KIN4(J).EQ.1) THEN
       PSCT1=PEQIN4(J,IE)
       CALL ANGCUT(PSCT1,ANGC,PSCT2)
       ANGCT(IE,NP)=ANGC
       PSCT(IE,NP)=PSCT2
       INDEX(NP)=1
      ENDIF
      IF(KIN4(J).EQ.2) THEN
       PSCT(IE,NP)=PEQIN4(J,IE)
       INDEX(NP)=2
      ENDIF
C
      IF(IE.GT.1) GO TO 350
      RGAS(NP)=RGAS4
      EIN(NP)=EI4(J)/RGAS4
      L=19
      IF(EI4(J).LT.0.0D0) L=20
      IPN(NP)=0
      IARRY(NP)=L
      DSCRPT(NP)=SCRP4(6+J)
      PENFRA(1,NP)=PENFRA4(1,J)
      PENFRA(2,NP)=PENFRA4(2,J)*1.D-6/DSQRT(3.0D0)
      PENFRA(3,NP)=PENFRA4(3,J)
  350 CONTINUE
C
  360 IF(NGAS.EQ.4) GO TO 600
      NP=NP+1
      CF(IE,NP)=Q5(2,IE)*VAN5
      PSCT(IE,NP)=0.5D0
      ANGCT(IE,NP)=1.0D0
      INDEX(NP)=0
C
      IF(KEL5(2).EQ.1) THEN
       PSCT1=PEQEL5(2,IE)
       CALL ANGCUT(PSCT1,ANGC,PSCT2)
       ANGCT(IE,NP)=ANGC
       PSCT(IE,NP)=PSCT2
       INDEX(NP)=1
      ENDIF
      IF(KEL5(2).EQ.2) THEN
       PSCT(IE,NP)=PEQEL5(2,IE)
       INDEX(NP)=2
      ENDIF
C
      IF(IE.GT.1) GO TO 362
      RGAS5=1.0D0+E5(2)/2.0D0
      RGAS(NP)=RGAS5
      EIN(NP)=0.0D0
      IPN(NP)=0
      L=21
      IARRY(NP)=L
      DSCRPT(NP)=SCRP5(2)
      NAMEG(5)=NAME5
      PENFRA(1,NP)=0.0
      PENFRA(2,NP)=0.0
      PENFRA(3,NP)=0.0
  362 IF(EFINAL.LT.E5(3)) GO TO 430
      NP=NP+1
      CF(IE,NP)=Q5(3,IE)*VAN5
      FCION(IE)=FCION(IE)+CF(IE,NP)
      PSCT(IE,NP)=0.5D0
      ANGCT(IE,NP)=1.0D0
      INDEX(NP)=0
C
      IF(KEL5(3).EQ.1) THEN
       PSCT1=PEQEL5(3,IE)
       CALL ANGCUT(PSCT1,ANGC,PSCT2)
       ANGCT(IE,NP)=ANGC
       PSCT(IE,NP)=PSCT2
       INDEX(NP)=1
      ENDIF
      IF(KEL5(3).EQ.2) THEN
       PSCT(IE,NP)=PEQEL5(3,IE)
       INDEX(NP)=2
      ENDIF
C
      IF(IE.GT.1) GO TO 430
      RGAS(NP)=RGAS5
      EIN(NP)=E5(3)/RGAS5
      WPL(NP)=EB5
      IPN(NP)=1
      L=22
      IARRY(NP)=L
      DSCRPT(NP)=SCRP5(3)
      PENFRA(1,NP)=0.0
      PENFRA(2,NP)=0.0
      PENFRA(3,NP)=0.0
  430 IF(EFINAL.LT.E5(4)) GO TO 440
      NP=NP+1
      CF(IE,NP)=Q5(4,IE)*VAN5
      FCATT(IE)=FCATT(IE)+CF(IE,NP)
      PSCT(IE,NP)=0.5D0
      ANGCT(IE,NP)=1.0D0
      IF(IE.GT.1) GO TO 440
      INDEX(NP)=0
      RGAS(NP)=RGAS5
      EIN(NP)=0.0D0
      IPN(NP)=-1
      L=23
      IARRY(NP)=L
      DSCRPT(NP)=SCRP5(4)
      PENFRA(1,NP)=0.0
      PENFRA(2,NP)=0.0
      PENFRA(3,NP)=0.0
  440 IF(NIN5.EQ.0) GO TO 460
      DO 450 J=1,NIN5
      NP=NP+1
      CF(IE,NP)=QIN5(J,IE)*VAN5
      PSCT(IE,NP)=0.5D0
      ANGCT(IE,NP)=1.0D0
      INDEX(NP)=0
C
      IF(KIN5(J).EQ.1) THEN
       PSCT1=PEQIN5(J,IE)
       CALL ANGCUT(PSCT1,ANGC,PSCT2)
       ANGCT(IE,NP)=ANGC
       PSCT(IE,NP)=PSCT2
       INDEX(NP)=1
      ENDIF
      IF(KIN5(J).EQ.2) THEN
       PSCT(IE,NP)=PEQIN5(J,IE)
       INDEX(NP)=2
      ENDIF
C
      IF(IE.GT.1) GO TO 450
      RGAS(NP)=RGAS5
      EIN(NP)=EI5(J)/RGAS5
      L=24
      IF(EI5(J).LT.0.0D0) L=25
      IPN(NP)=0
      IARRY(NP)=L
      DSCRPT(NP)=SCRP5(6+J)
      PENFRA(1,NP)=PENFRA5(1,J)
      PENFRA(2,NP)=PENFRA5(2,J)*1.D-6/DSQRT(3.0D0)
      PENFRA(3,NP)=PENFRA5(3,J)
  450 CONTINUE
C
  460 IF(NGAS.EQ.5) GO TO 600
      NP=NP+1
      CF(IE,NP)=Q6(2,IE)*VAN6
      PSCT(IE,NP)=0.5D0
      ANGCT(IE,NP)=1.0D0
      INDEX(NP)=0
C
      IF(KEL6(2).EQ.1) THEN
       PSCT1=PEQEL6(2,IE)
       CALL ANGCUT(PSCT1,ANGC,PSCT2)
       ANGCT(IE,NP)=ANGC
       PSCT(IE,NP)=PSCT2
       INDEX(NP)=1
      ENDIF
      IF(KEL6(2).EQ.2) THEN
       PSCT(IE,NP)=PEQEL6(2,IE)
       INDEX(NP)=2
      ENDIF
C
      IF(IE.GT.1) GO TO 462
      RGAS6=1.0D0+E6(2)/2.0D0
      RGAS(NP)=RGAS6
      EIN(NP)=0.0D0
      IPN(NP)=0
      L=26
      IARRY(NP)=L
      DSCRPT(NP)=SCRP6(2)
      NAMEG(6)=NAME6
      PENFRA(1,NP)=0.0
      PENFRA(2,NP)=0.0
      PENFRA(3,NP)=0.0
  462 IF(EFINAL.LT.E6(3)) GO TO 530
      NP=NP+1
      CF(IE,NP)=Q6(3,IE)*VAN6
      FCION(IE)=FCION(IE)+CF(IE,NP)
      PSCT(IE,NP)=0.5D0
      ANGCT(IE,NP)=1.0D0
      INDEX(NP)=0
C
      IF(KEL6(3).EQ.1) THEN
       PSCT1=PEQEL6(3,IE)
       CALL ANGCUT(PSCT1,ANGC,PSCT2)
       ANGCT(IE,NP)=ANGC
       PSCT(IE,NP)=PSCT2
       INDEX(NP)=1
      ENDIF
      IF(KEL6(3).EQ.2) THEN
       PSCT(IE,NP)=PEQEL6(3,IE)
       INDEX(NP)=2
      ENDIF
C
      IF(IE.GT.1) GO TO 530
      RGAS(NP)=RGAS6
      EIN(NP)=E6(3)/RGAS6
      WPL(NP)=EB6
      IPN(NP)=1
      L=27
      IARRY(NP)=L
      DSCRPT(NP)=SCRP6(3)
      PENFRA(1,NP)=0.0
      PENFRA(2,NP)=0.0
      PENFRA(3,NP)=0.0
  530 IF(EFINAL.LT.E6(4)) GO TO 540
      NP=NP+1
      CF(IE,NP)=Q6(4,IE)*VAN6
      FCATT(IE)=FCATT(IE)+CF(IE,NP)
      PSCT(IE,NP)=0.5D0
      ANGCT(IE,NP)=1.0D0
      IF(IE.GT.1) GO TO 540
      INDEX(NP)=0
      RGAS(NP)=RGAS6
      EIN(NP)=0.0D0
      IPN(NP)=-1
      L=28
      IARRY(NP)=L
      DSCRPT(NP)=SCRP6(4)
      PENFRA(1,NP)=0.0
      PENFRA(2,NP)=0.0
      PENFRA(3,NP)=0.0
  540 IF(NIN6.EQ.0) GO TO 560
      DO 550 J=1,NIN6
      NP=NP+1
      CF(IE,NP)=QIN6(J,IE)*VAN6
      PSCT(IE,NP)=0.5D0
      ANGCT(IE,NP)=1.0D0
      INDEX(NP)=0
C
      IF(KIN6(J).EQ.1) THEN
       PSCT1=PEQIN6(J,IE)
       CALL ANGCUT(PSCT1,ANGC,PSCT2)
       ANGCT(IE,NP)=ANGC
       PSCT(IE,NP)=PSCT2
       INDEX(NP)=1
      ENDIF
      IF(KIN6(J).EQ.2) THEN
       PSCT(IE,NP)=PEQIN6(J,IE)
       INDEX(NP)=2
      ENDIF
C
      IF(IE.GT.1) GO TO 550
      RGAS(NP)=RGAS6
      EIN(NP)=EI6(J)/RGAS6
      L=29
      IF(EI6(J).LT.0.0D0) L=30
      IPN(NP)=0
      IARRY(NP)=L
      DSCRPT(NP)=SCRP6(6+J)
      PENFRA(1,NP)=PENFRA6(1,J)
      PENFRA(2,NP)=PENFRA6(2,J)*1.D-6/DSQRT(3.0D0)
      PENFRA(3,NP)=PENFRA6(3,J)
  550 CONTINUE
  560 CONTINUE
C
  600 CONTINUE
      IPLAST=NP
      ISIZE=1
      IF(IPLAST.GE.2)   ISIZE=2
      IF(IPLAST.GE.4)   ISIZE=4
      IF(IPLAST.GE.8)   ISIZE=8
      IF(IPLAST.GE.16)  ISIZE=16
      IF(IPLAST.GE.32)  ISIZE=32
      IF(IPLAST.GE.64)  ISIZE=64
      IF(IPLAST.GE.128) ISIZE=128
      IF(IPLAST.GE.256) ISIZE=256
      IF(IPLAST.GE.512) ISIZE=512
      IF(IPLAST.GE.1024)ISIZE=1024
C ----------------------------------------------------------------
C   CAN INCREASE ARRAY SIZE UP TO 1356 IF MORE COMPLEX MIXTURES USED.
C   1356 = 6 * 226 ( 6 = MAX NO OF GASES. 226 = MAX NO OF LEVELS )
C ------------------------------------------------------------------
      IF(IPLAST.GT.512) WRITE(6,992)
  992 FORMAT(/,/,6X,'WARNING TOO MANY LEVELS IN CALCULATION. CAN INCREAS
     /E THE ARRAY SIZES FROM 512 UP TO 1356 MAXIMUM',/)
      IF(IPLAST.GT.512) STOP
C --------------------------------------------------------------------
C     CALCULATION OF TOTAL COLLISION FREQUENCY
C ---------------------------------------------------------------------
      TCF(IE)=0.0D0
      DO 610 IF=1,IPLAST
      TCF(IE)=TCF(IE)+CF(IE,IF)
      IF(CF(IE,IF).LT.0.0D0) WRITE(6,776) CF(IE,IF),IE,IF,IARRY(IF),EIN
     /(IF)
  776 FORMAT('  WARNING NEGATIVE COLLISION FEQUENCY =',D12.3,' IE =',I6,
     /' IF =',I3,' IARRY=',I5,' EIN=',F7.4)
 610  CONTINUE
      DO 620 IF=1,IPLAST
      IF(TCF(IE).EQ.0.0D0) GO TO 615
      CF(IE,IF)=CF(IE,IF)/TCF(IE)
      GO TO 620
 615  CF(IE,IF)=0.0D0
 620  CONTINUE
      DO 630 IF=2,IPLAST
      CF(IE,IF)=CF(IE,IF)+CF(IE,IF-1)
 630  CONTINUE
      FCATT(IE)=FCATT(IE)*EROOT(IE)
      FCION(IE)=FCION(IE)*EROOT(IE)
      TCF(IE)=TCF(IE)*EROOT(IE)
 700  CONTINUE
C     WRITE(6,841) (INDEX(J),J, J=1,IPLAST)
C 841 FORMAT(2X,' INDEX=',I3,' J=',I3)
C  SET ANISOTROPIC FLAG IF ANISOTROPIC SCATTERING DATA IS DETECTED
      KELSUM=0
      DO 701 J=1,6
 701  KELSUM=KELSUM+KEL1(J)+KEL2(J)+KEL3(J)+KEL4(J)+KEL5(J)+KEL6(J)
      DO 702 J=1,220
 702  KELSUM=KELSUM+KIN1(J)+KIN2(J)+KIN3(J)+KIN4(J)+KIN5(J)+KIN6(J)
      IF(KELSUM.GT.0) NISO=1
C     IF(NISO.EQ.1) WRITE(6,7765) NISO
C7765 FORMAT(3X,' ANISOTROPIC SCATTERING DETECTED NISO=',I5)
C -------------------------------------------------------------------
C   CALCULATE NULL COLLISION FREQUENCY
C -------------------------------------------------------------------
      BP=EFIELD*EFIELD*CONST1
      F2=EFIELD*CONST3
      ELOW=TMAX*(TMAX*BP-F2*DSQRT(0.5D0*EFINAL))/ESTEP-1.0D0
      ELOW=DMIN1(ELOW,SMALL)
      EHI=TMAX*(TMAX*BP+F2*DSQRT(0.5D0*EFINAL))/ESTEP+1.0D0
      IF(EHI.GT.10000.D0) EHI=10000.D0
      DO 810 I=1,8
      JLOW=4000-500*(9-I)+1+DINT(ELOW)
      JHI=4000-500*(8-I)+DINT(EHI)
      JLOW=DMAX0(JLOW,NONE)
      JHI=DMIN0(JHI,N4000)
      DO 800 J=JLOW,JHI
      IF(TCF(J).GE.TCFMAX(I)) TCFMAX(I)=TCF(J)
  800 CONTINUE
  810 CONTINUE
C -------------------------------------------------------------------
C   CROSS SECTION DATA FOR INTEGRALS IN  OUTPUT
C ---------------------------------------------------------------------
      DO 900 I=1,NSTEP
      QTOT(I)=AN1*Q1(1,I)+AN2*Q2(1,I)+AN3*Q3(1,I)+AN4*Q4(1,I)+
     /AN5*Q5(1,I)+AN6*Q6(1,I)
      QEL(I)=AN1*Q1(2,I)+AN2*Q2(2,I)+AN3*Q3(2,I)+AN4*Q4(2,I)+
     /AN5*Q5(2,I)+AN6*Q6(2,I)
C
      QION(1,I)=Q1(3,I)*AN1
      QION(2,I)=Q2(3,I)*AN2
      QION(3,I)=Q3(3,I)*AN3
      QION(4,I)=Q4(3,I)*AN4
      QION(5,I)=Q5(3,I)*AN5
      QION(6,I)=Q6(3,I)*AN6
      QATT(1,I)=Q1(4,I)*AN1
      QATT(2,I)=Q2(4,I)*AN2
      QATT(3,I)=Q3(4,I)*AN3
      QATT(4,I)=Q4(4,I)*AN4
      QATT(5,I)=Q5(4,I)*AN5
      QATT(6,I)=Q6(4,I)*AN6
C
  850 QREL(I)=0.0D0
      QSATT(I)=0.0D0
      QSUM(I)=0.0D0
      DO 855 J=1,NGAS
      QSUM(I)=QSUM(I)+QION(J,I)+QATT(J,I)
      QSATT(I)=QSATT(I)+QATT(J,I)
  855 QREL(I)=QREL(I)+QION(J,I)-QATT(J,I)
C
      IF(NIN1.EQ.0) GO TO 865
      DO 860 J=1,NIN1
  860 QSUM(I)=QSUM(I)+QIN1(J,I)*AN1
  865 IF(NIN2.EQ.0) GO TO 875
      DO 870 J=1,NIN2
  870 QSUM(I)=QSUM(I)+QIN2(J,I)*AN2
  875 IF(NIN3.EQ.0) GO TO 885
      DO 880 J=1,NIN3
  880 QSUM(I)=QSUM(I)+QIN3(J,I)*AN3
  885 IF(NIN4.EQ.0) GO TO 895
      DO 890 J=1,NIN4
  890 QSUM(I)=QSUM(I)+QIN4(J,I)*AN4
  895 IF(NIN5.EQ.0) GO TO 898
      DO 896 J=1,NIN5
  896 QSUM(I)=QSUM(I)+QIN5(J,I)*AN5
  898 IF(NIN6.EQ.0) GO TO 900
      DO 899 J=1,NIN6
  899 QSUM(I)=QSUM(I)+QIN6(J,I)*AN6
C
 900  CONTINUE
C
      RETURN
      END
      SUBROUTINE GASMIX(NGS,Q,QIN,NIN,E,EI,NAME,VIRL,EB,
     /PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      CHARACTER*15 NAME
      CHARACTER*30 SCRPT(226)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EI(220),KIN(220)
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KEL(6),PENFRA(3,220)
C
      GO TO (1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,
     /21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,
     /41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,
     /61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80) NGS
    1 CALL GAS1(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
    2 CALL GAS2(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
    3 CALL GAS3(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
    4 CALL GAS4(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
    5 CALL GAS5(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
    6 CALL GAS6(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
    7 CALL GAS7(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
    8 CALL GAS8(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
    9 CALL GAS9(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   10 CALL GAS10(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   11 CALL GAS11(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   12 CALL GAS12(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   13 CALL GAS13(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   14 CALL GAS14(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   15 CALL GAS15(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   16 CALL GAS16(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   17 CALL GAS17(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   18 CALL GAS18(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   19 CALL GAS19(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   20 CALL GAS20(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   21 CALL GAS21(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   22 CALL GAS22(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   23 CALL GAS23(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   24 CALL GAS24(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   25 CALL GAS25(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   26 CALL GAS26(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   27 CALL GAS27(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   28 CALL GAS28(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   29 CALL GAS29(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   30 CALL GAS30(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   31 CALL GAS31(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   32 CALL GAS32(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   33 CALL GAS33(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   34 CALL GAS34(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   35 CALL GAS35(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   36 CALL GAS36(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   37 CALL GAS37(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   38 CALL GAS38(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   39 CALL GAS39(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   40 CALL GAS40(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   41 CALL GAS41(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   42 CALL GAS42(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   43 CALL GAS43(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   44 CALL GAS44(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   45 CALL GAS45(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   46 CALL GAS46(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   47 CALL GAS47(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   48 CALL GAS48(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   49 CALL GAS49(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   50 CALL GAS50(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   51 CALL GAS51(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   52 CALL GAS52(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   53 CALL GAS53(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   54 CALL GAS54(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   55 CALL GAS55(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   56 CALL GAS56(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   57 CALL GAS57(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   58 CALL GAS58(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   59 CALL GAS59(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   60 CALL GAS60(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   61 CALL GAS61(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   62 CALL GAS62(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   63 CALL GAS63(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   64 CALL GAS64(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   65 CALL GAS65(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   66 CALL GAS66(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   67 CALL GAS67(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   68 CALL GAS68(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   69 CALL GAS69(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   70 CALL GAS70(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   71 CALL GAS71(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   72 CALL GAS72(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   73 CALL GAS73(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   74 CALL GAS74(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   75 CALL GAS75(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   76 CALL GAS76(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   77 CALL GAS77(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   78 CALL GAS78(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   79 CALL GAS79(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
   80 CALL GAS80(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /SCRPT)
      RETURN
      END
      SUBROUTINE SETUP(LAST)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/CNSTS1/CONST1,CONST2,CONST3,CONST4,CONST5
      COMMON/RATIO/AN1,AN2,AN3,AN4,AN5,AN6,AN,FRAC(6)
      COMMON/GASN/NGASN(6)
      COMMON/SETP/TMAX,SMALL,API,ESTART,THETA,PHI,TCFMAX(8),RSTART,
     /EFIELD,NMAX
      COMMON/VEL/WX,WY,WZ
      COMMON/VELERR/DWX,DWY,DWZ
      COMMON/CTOWNS/ALPHA,ATT
      COMMON/CTWNER/ALPER,ATTER
      COMMON/DIFVEL/DIFLN,DIFTR
      COMMON/DIFERL/DFLER,DFTER
      COMMON/DIFLAB/DIFXX,DIFYY,DIFZZ,DIFYZ,DIFXY,DIFXZ
      COMMON/DIFERB/DXXER,DYYER,DZZER,DYZER,DXYER,DXZER
      COMMON/THRM/ERFINT(25),CON,ITHRM
      COMMON/BFLD/EOVB,WB,BTHETA,BMAG
      COMMON/MRATIO/VAN1,VAN2,VAN3,VAN4,VAN5,VAN6,VAN
      COMMON/TTRM/ZTOT,TTOT,ZTOTS,TTOTS
      COMMON/OUTPT/TIME(300),ICOLL(30),SPEC(4000),TMAX1,
     /AVE,DEN,XID,X,Y,Z,ST,NNULL,ICOLN(512)
C INTEGRALS OF ERROR FUNCTION
C     DATA ERFINT/.112462916,.222702589,.328626759,.428392355,
C    /.520499878,.603856091,.677801194,.742100965,.796908212,.842700793,
C    /.880205070,.910313978,.934007945,.952285120,.966105146,.976348383,
C    /.983790459,.989090502,.992790429,.995322265,.997020533,.998137154,
C    /.998856823,.999311486,.999593048/
C
C   NEW UPDATE OF CONSTANTS 2008
C
      DO 1 K=1,25
    1 ERFINT(K)=0.0D0
      API=DACOS(-1.0D0)
      ARY=13.60569193
      PIR2=8.7973553523D-17
      ECHARG=1.602176487D-19
      EMASS=9.10938215D-31
      AMU=1.660538782D-27
      BOLTZ=8.617343D-5
      BOLTZJ=1.3806504D-23
      AWB=1.758820150D10
      ALOSCH=2.6867774D19
      EOVM=DSQRT(2.0D0*ECHARG/EMASS)*100.0D0
      ABZERO=273.15D0
      ATMOS=760.0D0
      CONST1=AWB/2.0D0*1.0D-19
      CONST2=CONST1*1.0D-02
      CONST3=DSQRT(0.2D0*AWB)*1.0D-09
      CONST4=CONST3*ALOSCH*1.0D-15
      CONST5=CONST3/2.0D0
C%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
C FIX ELASTIC ANGULAR DISTRIBUTIONS TO OKHRIMVOSKKY TYPE
      NANISO=2
C FIX ELASTIC ANGULAR DISTRIBUTIONS TO CAPITELLI LONGO TYPE
C     NANISO=1
C FIX ELASTIC ANGULAR DISTRIBUTIONS TO ISOTROPIC SCATTERING
C     NANISO=0
C%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
C  --------------------------------------------
C
C      READ IN OUTPUT CONTROL AND INTEGRATION DATA
C
      READ(5,2) NGAS,NMAX,IPEN,EFINAL
    2 FORMAT(3I10,F10.5)
      IF(NGAS.EQ.0) GO TO 99
C
C   GAS IDENTIFIERS
C
      READ(5,3) NGASN(1),NGASN(2),NGASN(3),NGASN(4),NGASN(5),NGASN(6)
    3 FORMAT(6I5)
C
C      GAS PARAMETERS
C
      READ(5,4) FRAC(1),FRAC(2),FRAC(3),FRAC(4),FRAC(5),FRAC(6),TEMPC,
     /TORR
    4 FORMAT(8F10.4)
C
C      FIELD VALUES
C
      READ(5,5) EFIELD,BMAG,BTHETA
    5 FORMAT(3F10.3)
C   CHECK INPUT
      IF(NGAS.EQ.1.AND.IPEN.EQ.1) THEN
      WRITE(6,992)
  992 FORMAT(' PROGRAM STOPPED IT IS NOT POSSIBLE TO HAVE PENNING TRANSF
     /ERS IN PURE GASES.',/,' ONLY MIXTURES ALLOWED WITH IPEN=1')
      STOP
      ENDIF
      TOTFRAC=0.0D0
      IF(NGAS.EQ.0.OR.NGAS.GT.6) GO TO 999
      DO 10 J=1,NGAS
      IF(NGASN(J).EQ.0.OR.FRAC(J).EQ.0.0D0) GO TO 999
   10 TOTFRAC=TOTFRAC+FRAC(J)
      IF(DABS(TOTFRAC-100.0D0).GT.1.D-6) GO TO 999
      LAST=0
      TMAX=100.0D0
      NSCALE=10000000
      NMAX=NMAX*NSCALE
      IF(NMAX.LT.0) THEN
       WRITE(6,91)
   91  FORMAT(2(/),' ERROR IN INPUT : NMAX TOO LARGE OVERFLOWED THE ALLO
     /WED INTEGER RANGE OF THE COMPUTER OR COMPILER')
       LAST=1
       RETURN
      ENDIF
      NSTEP=4000
      THETA=0.785D0
      PHI=0.1D0
C ZERO COMMON BLOCKS OF OUTPUT RESULTS
      WX=0.0D0
      WY=0.0D0
      WZ=0.0D0
      DWX=0.0D0
      DWY=0.0D0
      DWZ=0.0D0
      TTOTS=0.0D0
      ALPHA=0.0D0
      ATT=0.0D0
      ALPER=0.0D0
      ATTER=0.0D0
      DIFLN=0.0D0
      DIFTR=0.0D0
      DFLER=0.0D0
      DFTER=0.0D0
      DIFXX=0.0D0
      DIFYY=0.0D0
      DIFZZ=0.0D0
      DIFYZ=0.0D0
      DIFXY=0.0D0
      DIFXZ=0.0D0
      DXXER=0.0D0
      DYYER=0.0D0
      DZZER=0.0D0
      DYZER=0.0D0
      DXYER=0.0D0
      DXZER=0.0D0
      DO 65 J=1,300
   65 TIME(J)=0.0D0
      DO 70 K=1,30
   70 ICOLL(K)=0
      DO 80 K=1,512
   80 ICOLN(K)=0
      DO 100 K=1,4000
  100 SPEC(K)=0.0D0
      DO 101 K=1,8
  101 TCFMAX(K)=0.0D0
C ---------------------------------------------
C CAN SET RANDOM NUMBER SEED TO SEED VALUE HERE
C
      RSTART=0.666D0
C    RANDOM NUMBER SEED FUNCTION (RSTART)
C-----------------------------------------------
      ESTART=EFINAL/50.0D0
      ITHRM=0
      CORR=ABZERO*TORR/(ATMOS*(ABZERO+TEMPC)*100.0D0)
      AKT=(ABZERO+TEMPC)*BOLTZ
      AN1=FRAC(1)*CORR*ALOSCH
      AN2=FRAC(2)*CORR*ALOSCH
      AN3=FRAC(3)*CORR*ALOSCH
      AN4=FRAC(4)*CORR*ALOSCH
      AN5=FRAC(5)*CORR*ALOSCH
      AN6=FRAC(6)*CORR*ALOSCH
      AN=100.0D0*CORR*ALOSCH
      VAN1=FRAC(1)*CORR*CONST4*1.0D15
      VAN2=FRAC(2)*CORR*CONST4*1.0D15
      VAN3=FRAC(3)*CORR*CONST4*1.0D15
      VAN4=FRAC(4)*CORR*CONST4*1.0D15
      VAN5=FRAC(5)*CORR*CONST4*1.0D15
      VAN6=FRAC(6)*CORR*CONST4*1.0D15
      VAN=100.0D0*CORR*CONST4*1.0D15
C CALCULATE THERMAL VELOCITY DISTRIBUTION INTEGRALS
C     CON=1.0D-13/DSQRT(AMU/(2.0D0*BOLTZJ*(TEMPC+ABZERO)))
C N.B.  LOADED ERROR FUNCTION INTEGRALS IN DATA ARRAY .
C
C  RADIANS PER PICOSECOND
      WB=AWB*BMAG*1.0D-12
C   METRES PER PICOSECOND
      IF(BMAG.EQ.0.0D0) RETURN
      EOVB=EFIELD*1.D-9/BMAG
      RETURN
  999 WRITE(6,87) NGAS,(J,NGASN(J),FRAC(J),J=1,6)
   87 FORMAT(3(/),4X,' ERROR IN GAS INPUT : NGAS=',I5,6(/,2X,' N=',I3,'
     /NGAS=',I5,' FRAC=',F8.3))
   99 LAST=1
      RETURN
      END
      SUBROUTINE PRNTER
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      COMMON/RATIO/AN1,AN2,AN3,AN4,AN5,AN6,AN,FRAC(6)
      COMMON/SETP/TMAX,SMALL,API,ESTART,THETA,PHI,TCFMAX(8),RSTART,
     /EFIELD,NMAX
      COMMON/THRM/ERFINT(25),CON,ITHRM
      COMMON/BFLD/EOVB,WB,BTHETA,BMAG
      COMMON/LARGE/CF(4000,512),EIN(512),TCF(4000),IARRY(512),RGAS(512),
     /IPN(512),WPL(512),IPLAST,ISIZE,PENFRA(3,512)
      COMMON/NAMES/NAMEG(6)
      CHARACTER*15 NAMEG
      WRITE(6,1)
    1 FORMAT(2(/),10X,'PROGRAM MAGBOLTZ 2 VERSION 8.6 ',/)
      WRITE(6,10) NGAS
   10 FORMAT(10X,'MONTE CARLO SOLUTION FOR MIXTURE OF ',I2,' GASES.',/,
     /5X,'------------------------------------------------------')
      WRITE(6,30) (NAMEG(J),FRAC(J), J=1,NGAS)
  30  FORMAT(/,5X,'  GASES  USED ',5X,' PERCENTAGE USED ',2(/),6(6X,A15,
     /5X,F9.4,/))
      WRITE(6,50) TEMPC,TORR
   50 FORMAT(/,2X,'GAS TEMPERATURE =',F6.1,' DEGREES CENTIGRADE.',/,2X,'
     /GAS PRESSURE = ',F7.1,' TORR.')
      WRITE(6,51) EFINAL,NSTEP
  51  FORMAT(1(/),2X,'INTEGRATION FROM 0.0 TO ',F8.2,' EV.  IN ',I4,' ST
     /EPS. ')
      IF(IPEN.EQ.0) WRITE(6,52)
      IF(IPEN.EQ.1) WRITE(6,53)
   52 FORMAT(/,' PENNING EFFECTS NOT INCLUDED')
   53 FORMAT(/,' PENNING EFFECTS INCLUDED')
      IF(NANISO.EQ.0) WRITE(6,61)
      IF(NANISO.EQ.1) WRITE(6,62)
      IF(NANISO.EQ.2) WRITE(6,63)
      IF(NANISO.LT.0.OR.NANISO.GT.2) THEN
       WRITE(6,64)
       STOP
      ENDIF
  61  FORMAT(/,' ISOTROPIC SCATTERING X-SECTIONS USED')
  62  FORMAT(/,' ANISOTROPIC SCATTERING TYPE 1 (CAPITELLI/LONGO) USED IF
     / AVAILABLE')
  63  FORMAT(/,' ANISOTROPIC SCATTERING TYPE 2 (OKHRIMOVSKYY) USED IF AV
     /AILABLE')
  64  FORMAT(/,' INPUT ERROR FOR ISOTROPY CONTROL,PROGRAM STOPPED')
C     IF(ITHRM.EQ.0) WRITE(6,65)
C     IF(ITHRM.NE.0) WRITE(6,66)
C 65  FORMAT(2(/),' THERMAL MOTION OF GAS NOT INCLUDED')
C 66  FORMAT(2(/),' THERMAL MOTION OF GAS INCLUDED')
  74  WRITE(6,90) EFIELD,BMAG,BTHETA,WB
  90  FORMAT(1(/),'  ELECTRIC FIELD =',F12.4,' VOLTS/CM.',/'  MAGNETIC F
     /IELD =',F11.4,' KILOGAUSS.',/,'  ANGLE BETWEEN ELECTRIC AND MAGNET
     /IC FIELD =',F10.3,' DEGREES.',/,'  CYCLOTRON FREQ. =',D12.3,' RADI
     /ANS/PICOSECOND')
      WRITE(6,95) ESTART
  95  FORMAT(1(/),'  INITIAL ELECTRON ENERGY =',F8.3,' EV.')
C     WRITE(6,96) RSTART
C 96  FORMAT(/,'  RANDOM NUMBER STARTER (SEED)=',F7.4)
      WRITE(6,100) NMAX
 100  FORMAT(1(/),'  TOTAL NUMBER OF REAL COLLISIONS =',I11)
      WRITE(6,110)  (TCFMAX(L),L=1,8)
  110 FORMAT(1(/),'  NULL COLLISION FREQUENCY AT  8 EQUALLY SPACED ENERG
     /Y INTERVALS (*10**12/SEC)',/,2(4(5X,D10.3)/))
      WRITE(6,111)  (TCF(L),L=250,3750,500)
  111 FORMAT('  REAL COLLISION FREQUENCY AT  8 EQUALLY SPACED ENERGY INT
     /ERVALS (*10**12/SEC)',/,2(4(5X,D10.3)/))
C      do 112 l=1,4000
C      write(6,*) tcf(l), cf(l,1), cf(l,2), cf(l,3)
C  112 continue    
      RETURN
      END
      SUBROUTINE SORT(I,R2,IE)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/LARGE/CF(4000,512),EIN(512),TCF(4000),IARRY(512),RGAS(512),
     /IPN(512),WPL(512),LAST,ISIZE,PENFRA(3,512)
C
C    SELECTS COLLISION TYPE FROM COLLISION ARRAY BY BINARY STEP SAMPLING
C      REDUCES SAMPLING RANGE TO WITHIN 4 POSITIONS IN ARRAY
C      OUTPUT =  I   ( POSITION WITHIN 4 OF CORRECT VALUE)
C
      ISTEP=ISIZE
      INCR=0
      DO 1 K=1,12
      I=INCR
      IF(ISTEP.EQ.2) RETURN
      I=INCR+ISTEP
      IF(I.GT.LAST) GO TO 2
      IF(CF(IE,I).LT.R2) THEN
       INCR=INCR+ISTEP
      ENDIF
    2 ISTEP=ISTEP/2
    1 CONTINUE
      RETURN
      END
      SUBROUTINE MONTE
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/CNSTS1/CONST1,CONST2,CONST3,CONST4,CONST5
      COMMON/SETP/TMAX,SMALL,API,ESTART,THETA,PHI,TCFMAX(8),RSTART,
     /EFIELD,NMAX
      COMMON/LARGE/CF(4000,512),EIN(512),TCF(4000),IARRY(512),RGAS(512),
     /IPN(512),WPL(512),LAST,ISIZE,PENFRA(3,512)
      COMMON/ANIS/PSCT(4000,512),ANGCT(4000,512),INDEX(512),NISO
      COMMON/VEL/WX,WY,WZ
      COMMON/VELERR/DWX,DWY,DWZ
      COMMON/CTOWNS/ALPHA,ATT
      COMMON/CTWNER/ALPER,ATTER
      COMMON/DIFVEL/DIFLN,DIFTR
      COMMON/DIFERL/DFLER,DFTER
      COMMON/DIFLAB/DIFXX,DIFYY,DIFZZ,DIFYZ,DIFXY,DIFXZ
      COMMON/DIFERB/DXXER,DYYER,DZZER,DYZER,DXYER,DXZER
      COMMON/THRM/ERFINT(25),CON,ITHRM
      COMMON/OUTPT/TIME(300),ICOLL(30),SPEC(4000),TMAX1,
     /AVE,DEN,XID,X,Y,Z,ST,NNULL,ICOLN(512)
      DIMENSION XST(200000),YST(200000),ZST(200000),STO(200000)
      DIMENSION WZST(10),AVEST(10)
      DIMENSION DFZZST(10),DFYYST(10),DFXXST(10)
C -------------------------------------------------------------------
C   CALCULATES COLLISION EVENTS AND UPDATES DIFFUSION AND VELOCITY.
C   USED WITH MAGNETIC FIELD B =0.0   ELECTRIC FIELD IN Z DIRECTION.
C -------------------------------------------------------------------
      WX=0.0D0
      WY=0.0D0
      DWX=0.0D0
      DWY=0.0D0
      DIFYZ=0.0D0
      DIFXY=0.0D0
      DIFXZ=0.0D0
      DYZER=0.0D0
      DXYER=0.0D0
      DXZER=0.0D0
      X=0.0D0
      Y=0.0D0
      Z=0.0D0
      ST=0.0D0
      ST1=0.0D0
      ST2=0.0D0
      SUME2=0.0D0
      SUMXX=0.0D0
      SUMYY=0.0D0
      SUMZZ=0.0D0
      SUMVX=0.0D0
      SUMVY=0.0D0
      ZOLD=0.0D0
      STOLD=0.0D0
      ST1OLD=0.0D0
      ST2OLD=0.0D0
      SZZOLD=0.0D0
      SXXOLD=0.0D0
      SYYOLD=0.0D0
      SVXOLD=0.0D0
      SVYOLD=0.0D0
      SME2OLD=0.0D0
      SMALL=1.0D-20
      TMAX1=0.0D0
      RDUM=RSTART
      E1=ESTART
      CONST9=CONST3*0.01D0
      ARAT=EMASS/AMU
      N4000=4000
      N300=300
      INTEM=8
      ITMAX=10
      ID=0
      NCOL=0
      NNULL=0
      IEXTRA=0
C  NUMBER OF COLLISIONS FOR DE-CORRELATION
      NCOLM=200000
      TDASH=0.0D0
C
C     INITIAL DIRECTION COSINES
C
      DCZ1=DCOS(THETA)
      DCX1=DSIN(THETA)*DCOS(PHI)
      DCY1=DSIN(THETA)*DSIN(PHI)
C
      BP=EFIELD*EFIELD*CONST1
      F1=EFIELD*CONST2
      F2=EFIELD*CONST3
      F4=2.0D0*DACOS(-1.0D0)
      DELTAE=EFINAL/DFLOAT(INTEM)
      J2M=NMAX/ITMAX
C MAIN LOOP
      DO 210 J1=1,ITMAX
      DO 133 J2=1,J2M
    1 R1=drand48(RDUM)
      I=DINT(E1/DELTAE)+1
      I=DMIN0(I,INTEM)
      TLIM=TCFMAX(I)
      T=-DLOG(R1)/TLIM+TDASH
      TDASH=T
      AP=DCZ1*F2*DSQRT(E1)
      E=E1+(AP+BP*T)*T
      IE=DINT(E/ESTEP)+1
      IE=DMIN0(IE,N4000)
      IF(TCF(IE).GT.TLIM) THEN
       TDASH=TDASH+DLOG(R1)/TLIM
       TCFMAX(I)=1.05D0*TCFMAX(I)
C      WRITE(6,996)
C996   FORMAT(/,5X,' WARNING NULL COLLISION TIME INCREASED',/)
       GO TO 1
      ENDIF
C
C     TEST FOR REAL OR NULL COLLISION
C
      R5=drand48(RDUM)
      TLIM=TCF(IE)/TLIM
      IF(R5.GT.TLIM) THEN
       NNULL=NNULL+1
       GO TO 1
      ENDIF
C
C  CALCULATE DIRECTION COSINES AND POSITIONS AT INSTANT BEFORE COLLISION
C    ALSO UPDATE DIFFUSION  AND ENERGY CALCULATIONS.
      T2=T*T
      IF(T.GE.TMAX1) TMAX1=T
      TDASH=0.0D0
      CONST6=DSQRT(E1/E)
      DCX2=DCX1*CONST6
      DCY2=DCY1*CONST6
      DCZ2=DCZ1*CONST6+EFIELD*T*CONST5/DSQRT(E)
      A=AP*T
      B=BP*T2
      SUME2=SUME2+T*(E1+A/2.0D0+B/3.0D0)
      CONST7=CONST9*DSQRT(E1)
      A=T*CONST7
      NCOL=NCOL+1
      CX1=DCX1*CONST7
      CY1=DCY1*CONST7
      CZ1=DCZ1*CONST7
      X=X+DCX1*A
      Y=Y+DCY1*A
      Z=Z+DCZ1*A+T2*F1
      ST=ST+T
      IT=DINT(T+1.0D0)
      IT=DMIN0(IT,N300)
      TIME(IT)=TIME(IT)+1.0D0
      SPEC(IE)=SPEC(IE)+1.0D0
      WZ=Z/ST
      SUMVX=SUMVX+CX1*CX1*T2
      SUMVY=SUMVY+CY1*CY1*T2
      IF(ID.EQ.0) GO TO 121
      KDUM=0
      DO 120 JDUM=1,4
      ST2=ST2+T
      NCOLDM=NCOL+KDUM
      IF(NCOLDM.GT.NCOLM) NCOLDM=NCOLDM-NCOLM
      SDIF=ST-STO(NCOLDM)
      SUMXX=SUMXX+((X-XST(NCOLDM))**2)*T/SDIF
      SUMYY=SUMYY+((Y-YST(NCOLDM))**2)*T/SDIF
      IF(J1.LT.3) GO TO 120
      ST1=ST1+T
      SUMZZ=SUMZZ+((Z-ZST(NCOLDM)-WZ*SDIF)**2)*T/SDIF
  120 KDUM=KDUM+25000
  121 XST(NCOL)=X
      YST(NCOL)=Y
      ZST(NCOL)=Z
      STO(NCOL)=ST
      IF(NCOL.GE.NCOLM) THEN
       ID=ID+1
       XID=DFLOAT(ID)
       NCOL=0
      ENDIF
C ---------------------------------------------------------------------
C     DETERMINATION OF REAL COLLISION TYPE
C ---------------------------------------------------------------------
      R2=drand48(RDUM)
C FIND LOCATION WITHIN 4 UNITS IN COLLISION ARRAY
      CALL SORT(I,R2,IE)
  140 I=I+1
      IF(CF(IE,I).LT.R2) GO TO 140
      S1=RGAS(I)
      EI=EIN(I)
      IF(IPN(I).LE.0) GO TO 666
C  USE FLAT DISTRIBUTION OF  ELECTRON ENERGY BETWEEN E-EION AND 0.0 EV
C  SAME AS IN BOLTZMANN
      R9=drand48(RDUM)
      EXTRA=R9*(E-EI)
      EI=EXTRA+EI
C
C  GENERATE SCATTERING ANGLES AND UPDATE  LABORATORY COSINES AFTER
C   COLLISION ALSO UPDATE ENERGY OF ELECTRON.
C
  666 IPT=IARRY(I)
      ICOLL(IPT)=ICOLL(IPT)+1
      ICOLN(I)=ICOLN(I)+1
      IF(E.LT.EI) THEN
C      WRITE(6,994) E,EI,J2
C994  FORMAT(2X,' WARNING ENERGY =',F8.3,' LESS THAN ENERGY LOSS EI=',F8
C    /.3,' AT ITER=',I12,' DUE TO BINNING ERROR')
C  FIX ENERGY LOSS SMALLER THAN INCIDENT ENERGY IF ERROR OCCURS
       EI=E-0.0001D0
      ENDIF
C IF EXCITATION THEN ADD PROBABILITY ,PENFRA(1,I), OF TRANSFER TO
C IONISATION OF THE OTHER GASES IN MIXTURE
      IF(IPEN.EQ.0) GO TO 5
      IF(PENFRA(1,I).NE.0.0) THEN
       RAN=drand48(RDUM)
       IF(RAN.GT.PENFRA(1,I)) GO TO 5
C ADD EXTRA IONISATION COLLISION
       IEXTRA=IEXTRA+1
      ENDIF
    5 S2=(S1*S1)/(S1-1.0D0)
C  ANISOTROPIC SCATTERING
      IF(INDEX(I).EQ.1) THEN
       R31=drand48(RDUM)
       R3=drand48(RDUM)
       F3=1.0D0-R3*ANGCT(IE,I)
       IF(R31.GT.PSCT(IE,I)) F3=-F3
      ELSE IF(INDEX(I).EQ.2) THEN
       R3=drand48(RDUM)
       EPSI=PSCT(IE,I)
       F3=1.0D0-(2.0D0*R3*(1.0D0-EPSI)/(1.0D0+EPSI*(1.0D0-2.0D0*R3)))
      ELSE
C ISOTROPIC  SCATTERING
       R3=drand48(RDUM)
       F3=1.0D0-2.0D0*R3
      ENDIF
      THETA0=DACOS(F3)
      R4=drand48(RDUM)
      PHI0=F4*R4
      F8=DSIN(PHI0)
      F9=DCOS(PHI0)
      ARG1=1.0D0-S1*EI/E
      ARG1=DMAX1(ARG1,SMALL)
      D=1.0D0-F3*DSQRT(ARG1)
      E1=E*(1.0D0-EI/(S1*E)-2.0D0*D/S2)
      E1=DMAX1(E1,SMALL)
      Q=DSQRT((E/E1)*ARG1)/S1
      Q=DMIN1(Q,1.0D0)
      THETA=DASIN(Q*DSIN(THETA0))
      F6=DCOS(THETA)
      U=(S1-1.0D0)*(S1-1.0D0)/ARG1
      CSQD=F3*F3
      IF(F3.LT.0.0D0.AND.CSQD.GT.U) F6=-1.0D0*F6
      F5=DSIN(THETA)
      DCZ2=DMIN1(DCZ2,1.0D0)
      ARGZ=DSQRT(DCX2*DCX2+DCY2*DCY2)
      IF(ARGZ.EQ.0.0D0) THEN
C      WRITE(6,9232) ITER,ID,E1
C9232  FORMAT(3X,'WARNING ARGZ= 0.0 AT ITER =',I10,' ID =',I10,' E1=',E1
C    /2.3)
       DCZ1=F6
       DCX1=F9*F5
       DCY1=F8*F5
       GO TO 130
      ENDIF
      DCZ1=DCZ2*F6+ARGZ*F5*F8
      DCY1=DCY2*F6+(F5/ARGZ)*(DCX2*F9-DCY2*DCZ2*F8)
      DCX1=DCX2*F6-(F5/ARGZ)*(DCY2*F9+DCX2*DCZ2*F8)
  130 CONTINUE
  133 CONTINUE
C   ------------------------------------------
      write(6,*) tmax1
      IF(J1.EQ.1) WRITE(6,201)
  201 FORMAT(/,'    VEL      POS        TIME      ENERGY   COUNT   DIFXX
     /     DIFYY     DIFZZ',/)
      WZ=WZ*1.0D+09
      AVE=SUME2/ST
      DIFLN=0.0D0
      IF(NISO.EQ.0) THEN
       DIFXX=5.0D+15*SUMVX/ST
       DIFYY=5.0D+15*SUMVY/ST
       DFXXST(J1)=5.0D+15*(SUMVX-SVXOLD)/(ST-STOLD)
       DFYYST(J1)=5.0D+15*(SUMVY-SVYOLD)/(ST-STOLD)
      ELSE
       IF(ST2.NE.0.0D0) THEN
        DIFYY=5.0D+15*SUMYY/ST2
        DIFXX=5.0D+15*SUMXX/ST2
        DFXXST(J1)=5.0D+15*(SUMXX-SXXOLD)/(ST2-ST2OLD)
        DFYYST(J1)=5.0D+15*(SUMYY-SYYOLD)/(ST2-ST2OLD)
       ELSE
        DFXXST(J1)=0.0D0
        DFYYST(J1)=0.0D0
       ENDIF
      ENDIF
      IF(ST1.NE.0.0D0) THEN
       DIFZZ=5.0D+15*SUMZZ/ST1
       DFZZST(J1)=5.0D+15*(SUMZZ-SZZOLD)/(ST1-ST1OLD)
      ELSE
       DFZZST(J1)=0.0D0
      ENDIF
      WZST(J1)=(Z-ZOLD)/(ST-STOLD)*1.0D+09
      AVEST(J1)=(SUME2-SME2OLD)/(ST-STOLD)
      ZOLD=Z
      STOLD=ST
      ST1OLD=ST1
      ST2OLD=ST2
      SVXOLD=SUMVX
      SVYOLD=SUMVY
      SZZOLD=SUMZZ
      SXXOLD=SUMXX
      SYYOLD=SUMYY
      SME2OLD=SUME2
      WRITE(6,202) WZ,Z,ST,AVE,ID,DIFXX,DIFYY,DIFZZ
  202 FORMAT(1X,F8.2,2(1X,D10.3),F9.4,1X,I5,1X,3(2X,F8.1))
C IF LAST ENERGY BIN IS HIGH INCREASE INTEGRATION ENERGY RANGE
      IF(SPEC(4000).GT.(150.0D0*DFLOAT(J1))) THEN
       WRITE(6,50)
   50  FORMAT(' WARNING ENERGY OUT OF RANGE,INCREASE ELECTRON ENERGY INT
     /EGRATION RANGE ')
       STOP
      ENDIF
C LOOP
  210 CONTINUE
C CALCULATE ERRORS AND CHECK AVERAGES
      TWZST=0.0D0
      TAVE=0.0D0
      T2WZST=0.0D0
      T2AVE=0.0D0
      TZZST=0.0D0
      TYYST=0.0D0
      TXXST=0.0D0
      T2ZZST=0.0D0
      T2YYST=0.0D0
      T2XXST=0.0D0
      DO 768 K=1,10
      TWZST=TWZST+WZST(K)
      TAVE=TAVE+AVEST(K)
      T2WZST=T2WZST+WZST(K)*WZST(K)
      T2AVE=T2AVE+AVEST(K)*AVEST(K)
      TXXST=TXXST+DFXXST(K)
      TYYST=TYYST+DFYYST(K)
      T2YYST=T2YYST+DFYYST(K)*DFYYST(K)
      T2XXST=T2XXST+DFXXST(K)*DFXXST(K)
      IF(K.LT.3) GO TO 768
      TZZST=TZZST+DFZZST(K)
      T2ZZST=T2ZZST+DFZZST(K)*DFZZST(K)
  768 CONTINUE
      DWZ=100.0D0*DSQRT((T2WZST-TWZST*TWZST/10.0D0)/9.0D0)/WZ
      DEN=100.0D0*DSQRT((T2AVE-TAVE*TAVE/10.0D0)/9.0D0)/AVE
      DXXER=100.0D0*DSQRT((T2XXST-TXXST*TXXST/10.0D0)/9.0D0)/DIFXX
      DYYER=100.0D0*DSQRT((T2YYST-TYYST*TYYST/10.0D0)/9.0D0)/DIFYY
      DZZER=100.0D0*DSQRT((T2ZZST-TZZST*TZZST/8.0D0)/7.0D0)/DIFZZ
      DIFLN=DIFZZ
      DIFTR=(DIFXX+DIFYY)/2.0D0
C  CONVERT CM/SEC
      WZ=WZ*1.0D05
      DFLER=DZZER
      DFTER=(DXXER+DYYER)/2.0D0
C CALCULATE TOWNSEND COEFICIENTS AND ERRORS
      ANCATT=0.0D0
      ANCION=0.0D0
      DO 800 I=1,NGAS
      ANCATT=ANCATT+ICOLL((5*I)-2)
  800 ANCION=ANCION+ICOLL((5*I)-3)
      ANCION=ANCION+IEXTRA
      ATTER=0.0D0
      IF(ANCATT.EQ.0.0D0) GO TO 810
      ATTER=100.0D0*DSQRT(ANCATT)/ANCATT
  810 ATT=ANCATT/(ST*WZ)*1.0D12
      ALPER=0.0D0
      IF(ANCION.EQ.0.0D0) GO TO 820
      ALPER=100.0D0*DSQRT(ANCION)/ANCION
  820 ALPHA=ANCION/(ST*WZ)*1.0D12
      RETURN
      END
      SUBROUTINE OUTPUT
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      COMMON/MIX2/E(4000),EROOT(4000),QTOT(4000),QREL(4000),QINEL(4000),
     /QEL(4000)
      COMMON/MIX1/QELM(4000),QSUM(4000),QION(6,4000),QIN1(220,4000),
     /QIN2(220,4000),QIN3(220,4000),QIN4(220,4000),QIN5(220,4000),
     /QIN6(220,4000),QSATT(4000)
      COMMON/RATIO/AN1,AN2,AN3,AN4,AN5,AN6,AN,FRAC(6)
      COMMON/DIFVEL/DIFLN,DIFTR
      COMMON/DIFERL/DFLER,DFTER
      COMMON/DIFLAB/DIFXX,DIFYY,DIFZZ,DIFYZ,DIFXY,DIFXZ
      COMMON/DIFERB/DXXER,DYYER,DZZER,DYZER,DXYER,DXZER
      COMMON/VEL/WX,WY,WZ
      COMMON/VELERR/DWX,DWY,DWZ
      COMMON/CTOWNS/ALPHA,ATT
      COMMON/CTWNER/ALPER,ATTER
      COMMON/SETP/TMAX,SMALL,API,ESTART,THETA,PHI,TCFMAX(8),RSTART,
     /EFIELD,NMAX
      COMMON/BFLD/EOVB,WB,BTHETA,BMAG
      COMMON/LARGE/CF(4000,512),EIN(512),TCF(4000),IARRY(512),RGAS(512),
     /IPN(512),WPL(512),LAST,ISIZE,PENFRA(3,512)
      COMMON/OUTPT/TIME(300),ICOLL(30),SPEC(4000),TMAX1,
     /AVE,DEN,XID,X,Y,Z,ST,NNULL,ICOLN(512)
      COMMON/SINT/SIMF(4000)
      COMMON/NAMES/NAMEG(6)
      COMMON/SCRIP/DSCRPT(512)
      CHARACTER*30 DSCRPT
      CHARACTER*15 NAMEG
      WRITE(6,15)
      WRITE(6,15)
   15 FORMAT('----------------------------------------------------------
     /-------------------')
      NREAL=NMAX
      WRITE(6,109) TMAX1,NNULL,NREAL
  109 FORMAT(/,2X,'CALCULATED MAX. COLLISION TIME =',F7.2,' PICOSECONDS.
     /',2(/),2X,'NUMBER OF NULL COLLISIONS =',I11,/,2X,'NUMBER OF REAL C
     /OLLISIONS =',I11)
      WMNZ=WZ*1.0D-05
      WMNY=WY*1.0D-05
      WMNX=WX*1.0D-05
      WRITE(6,940) WMNZ,DWZ,WMNY,DWY,WMNX,DWX
  940 FORMAT(/,2X,'Z DRIFT VELOCITY =',E11.4,' MICRONS/NANOSECOND  +-',F
     /8.2,'% ',/,2X,'Y DRIFT VELOCITY =',E11.4,' MICRONS/NANOSECOND  +-'
     /,F8.2,'%',/,2X,'X DRIFT VELOCITY =',E11.4,' MICRONS/NANOSECOND  +-
     /',F8.2,'%',/)
      IF(BMAG.GT.0.0D0.AND.(BTHETA.GT.0.0D0.AND.BTHETA.LT.180.0D0))
     /GO TO 800
      DTOVMB=DIFTR*EFIELD/WZ
      DTMN=DSQRT(2.0D0*DIFTR/WZ)*10000.0D0
      DFTER1=DSQRT(DFTER**2+DWZ**2)
      DFTER2=DFTER1/2.0
      WRITE(6,954)
      WRITE(6,950) DIFTR,DFTER,DTOVMB,DFTER1,DTMN,DFTER2
  950 FORMAT(/,2X,'TRANSVERSE DIFFUSION   =',D11.4,' +-',F8.2,'%',/,10X,
     /'=',F9.4,' EV. +-',F8.2,'%',/,10X,'=',F9.3,' MICRONS/CENTIMETER**0
     /.5  +-',F8.2,'%',/)
      DLOVMB=DIFLN*EFIELD/WZ
      DLMN=DSQRT(2.0D0*DIFLN/WZ)*10000.0D0
      DFLER1=DSQRT(DFLER**2+DWZ**2)
      DFLER2=DFLER1/2.0
      WRITE(6,992) DIFLN,DFLER,DLOVMB,DFLER1,DLMN,DFLER2
  992 FORMAT(/,2X,'LONGITUDINAL DIFFUSION =',D11.4,' +-',F8.1,'%',/,10X,
     /'=',F9.4,' EV. +-',F8.2,'%',/,10X,'=',F9.3,' MICRONS/CENTIMETER**0
     /.5  +-',F8.2,'%',/)
      GO TO 900
  800 WRITE(6,954)
  954 FORMAT(/,10X,' DIFFUSION IN CM**2/SEC.',/)
      WRITE(6,955) DIFXX,DIFYY,DIFZZ,DIFYZ,DIFXY,DIFXZ
  955 FORMAT(/,2X,'DIFFUSION TENSOR :',/,6X,' DIFXX =',D11.4,' DIFYY =',
     /D11.4,' DIFZZ =',D11.4,/,6X,' DIFYZ =',D11.4,' DIFXY =',D11.4,' DI
     /FXZ =',D11.4,/)
      WRITE(6,956) DXXER,DYYER,DZZER,DYZER,DXYER,DXZER
  956 FORMAT(/,2X,'ERROR ON DIFFUSION TENSOR :',/,6X,' DIFXX =',F8.2,'%
     / DIFYY =',F8.2,'%  DIFZZ =',F8.2,'%',/,6X,' DIFYZ =',F8.2,'%  DIFX
     /Y =',F8.2,'%  DIFXZ =',F8.2,'%',/)
      IF(BTHETA.EQ.90.) WRITE(6,957) DIFLN,DFLER,DIFTR,DFTER,DIFXX,DXXER
  957 FORMAT(/,8X,' LONGITUDINAL DIFFUSION =',D11.4,' +-',F8.2,'%',/,10X
     /,' TRANSVERSE DIFFUSION =',D11.4,' +-',F8.2,'%',/,2X,'TRANSVERSE D
     /IFFUSION (PARALLEL TO B-FIELD) DIFXX=',D11.4,' +-',F8.2,'%',/)
  900 WRITE(6,333) ALPHA,ALPER,ATT,ATTER
  333 FORMAT(2(/),'  IONISATION RATE /CM.=',E11.4,' +/-',F6.2,' PERCENT.
     /',/,'  ATTACHMENT RATE /CM.=',E11.4,' +/-',F6.2,' PERCENT.',2(/))
      WRITE(6,960) AVE,DEN
  960 FORMAT(/,2X,'MEAN ELECTRON ENERGY =',F9.4,' EV. ERROR =  +-',F8.2,
     /'%',/)
      RETURN
      END
      SUBROUTINE MONTEA
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      COMMON/CNSTS1/CONST1,CONST2,CONST3,CONST4,CONST5
      COMMON/SETP/TMAX,SMALL,API,ESTART,THETA,PHI,TCFMAX(8),RSTART,
     /EFIELD,NMAX
      COMMON/BFLD/EOVB,WB,BTHETA,BMAG
      COMMON/LARGE/CF(4000,512),EIN(512),TCF(4000),IARRY(512),RGAS(512),
     /IPN(512),WPL(512),LAST,ISIZE,PENFRA(3,512)
      COMMON/ANIS/PSCT(4000,512),ANGCT(4000,512),INDEX(512),NISO
      COMMON/DIFVEL/DIFLN,DIFTR
      COMMON/DIFERL/DFLER,DFTER
      COMMON/DIFLAB/DIFXX,DIFYY,DIFZZ,DIFYZ,DIFXY,DIFXZ
      COMMON/DIFERB/DXXER,DYYER,DZZER,DYZER,DXYER,DXZER
      COMMON/VEL/WX,WY,WZ
      COMMON/VELERR/DWX,DWY,DWZ
      COMMON/CTOWNS/ALPHA,ATT
      COMMON/CTWNER/ALPER,ATTER
      COMMON/OUTPT/TIME(300),ICOLL(30),SPEC(4000),TMAX1,
     /AVE,DEN,XID,X,Y,Z,ST,NNULL,ICOLN(512)
      DIMENSION XST(200000),YST(200000),ZST(200000),STO(200000)
      DIMENSION WZST(10),AVEST(10)
      DIMENSION DFZZST(10),DFYYST(10),DFXXST(10)
C -------------------------------------------------------------------
C   CALCULATES COLLISION EVENTS AND UPDATES DIFFUSION AND VELOCITY.
C   USED WITH MAGNETIC FIELD , B , PARALLEL TO ELECTRIC FIELD IN THE
C   Z DIRECTION.
C -------------------------------------------------------------------
      WX=0.0D0
      WY=0.0D0
      DWX=0.0D0
      DWY=0.0D0
      DIFYZ=0.0D0
      DIFXY=0.0D0
      DIFXZ=0.0D0
      DYZER=0.0D0
      DXYER=0.0D0
      DXZER=0.0D0
      X=0.0D0
      Y=0.0D0
      Z=0.0D0
      ST=0.0D0
      ST1=0.0D0
      ST2=0.0D0
      SUME2=0.0D0
      SUMXX=0.0D0
      SUMYY=0.0D0
      SUMZZ=0.0D0
      SUMVX=0.0D0
      SUMVY=0.0D0
      ZOLD=0.0D0
      STOLD=0.0D0
      ST1OLD=0.0D0
      ST2OLD=0.0D0
      SZZOLD=0.0D0
      SXXOLD=0.0D0
      SYYOLD=0.0D0
      SVXOLD=0.0D0
      SVYOLD=0.0D0
      SME2OLD=0.0D0
      SMALL=1.0D-20
      TMAX1=0.0D0
      RDUM=RSTART
      E1=ESTART
      CONST9=CONST3*0.01D0
      N4000=4000
      N300=300
      INTEM=8
      ITMAX=10
      ID=0
      NCOL=0
      NNULL=0
      IEXTRA=0
C  NUMBER OF COLLISIONS FOR DE-CORRELATION
      NCOLM=200000
      TDASH=0.0D0
C
C     INITIAL DIRECTION COSINES
C
      DCZ1=DCOS(THETA)
      DCX1=DSIN(THETA)*DCOS(PHI)
      DCY1=DSIN(THETA)*DSIN(PHI)
C INITIAL VELOCITY
      VTOT=CONST9*DSQRT(E1)
      CX1=DCX1*VTOT
      CY1=DCY1*VTOT
      CZ1=DCZ1*VTOT
      BP=EFIELD*EFIELD*CONST1
      F1=EFIELD*CONST2
      F2=EFIELD*CONST3
      F4=2.0D0*DACOS(-1.0D0)
      DELTAE=EFINAL/DFLOAT(INTEM)
      J2M=NMAX/ITMAX
C MAIN LOOP
      DO 210 J1=1,ITMAX
      DO 133 J2=1,J2M
    1 R1=drand48(RDUM)
      I=DINT(E1/DELTAE)+1
      I=DMIN0(I,INTEM)
      TLIM=TCFMAX(I)
      T=-DLOG(R1)/TLIM+TDASH
      TDASH=T
      AP=DCZ1*F2*DSQRT(E1)
      E=E1+(AP+BP*T)*T
      IE=DINT(E/ESTEP)+1
      IE=DMIN0(IE,N4000)
      IF(TCF(IE).GT.TLIM) THEN
       TDASH=TDASH+DLOG(R1)/TLIM
       TCFMAX(I)=1.05D0*TCFMAX(I)
C      WRITE(6,996)
C996   FORMAT(/,5X,' WARNING NULL COLLISION TIME INCREASED',/)
       GO TO 1
      ENDIF
C
C     TEST FOR REAL OR NULL COLLISION
C
      R5=drand48(RDUM)
      TLIM=TCF(IE)/TLIM
      IF(R5.GT.TLIM) THEN
       NNULL=NNULL+1
       GO TO 1
      ENDIF
C
C  CALCULATE DIRECTION COSINES AND POSITIONS AT INSTANT BEFORE COLLISION
C    ALSO UPDATE DIFFUSION  AND ENERGY CALCULATIONS.
      T2=T*T
      IF(T.GE.TMAX1) TMAX1=T
      TDASH=0.0D0
      WBT=WB*T
      COSWT=DCOS(WBT)
      SINWT=DSIN(WBT)
      CONST6=DSQRT(E1/E)
      CX2=CX1*COSWT-CY1*SINWT
      CY2=CY1*COSWT+CX1*SINWT
      VTOT=CONST9*DSQRT(E)
      DCX2=CX2/VTOT
      DCY2=CY2/VTOT
      DCZ2=DCZ1*CONST6+EFIELD*T*CONST5/DSQRT(E)
      A=AP*T
      B=BP*T2
      SUME2=SUME2+T*(E1+A/2.0D0+B/3.0D0)
      CONST7=CONST9*DSQRT(E1)
      A=T*CONST7
      NCOL=NCOL+1
      DX=(CX1*SINWT-CY1*(1.0D0-COSWT))/WB
      X=X+DX
      DY=(CY1*SINWT+CX1*(1.0D0-COSWT))/WB
      Y=Y+DY
      Z=Z+DCZ1*A+T2*F1
      ST=ST+T
      IT=DINT(T+1.0D0)
      IT=DMIN0(IT,N300)
      TIME(IT)=TIME(IT)+1.0D0
      SPEC(IE)=SPEC(IE)+1.0D0
      WZ=Z/ST
      SUMVX=SUMVX+DX*DX
      SUMVY=SUMVY+DY*DY
      IF(ID.EQ.0) GO TO 121
      KDUM=0
      DO 120 JDUM=1,4
      ST2=ST2+T
      NCOLDM=NCOL+KDUM
      IF(NCOLDM.GT.NCOLM) NCOLDM=NCOLDM-NCOLM
      SDIF=ST-STO(NCOLDM)
      SUMXX=SUMXX+((X-XST(NCOLDM))**2)*T/SDIF
      SUMYY=SUMYY+((Y-YST(NCOLDM))**2)*T/SDIF
      IF(J1.LT.3) GO TO 120
      ST1=ST1+T
      SUMZZ=SUMZZ+((Z-ZST(NCOLDM)-WZ*SDIF)**2)*T/SDIF
  120 KDUM=KDUM+25000
  121 XST(NCOL)=X
      YST(NCOL)=Y
      ZST(NCOL)=Z
      STO(NCOL)=ST
      IF(NCOL.GE.NCOLM) THEN
       ID=ID+1
       XID=DFLOAT(ID)
       NCOL=0
      ENDIF
C ---------------------------------------------------------------------
C     DETERMINATION OF REAL COLLISION TYPE
C ---------------------------------------------------------------------
      R2=drand48(RDUM)
C FIND LOCATION WITHIN 4 UNITS IN COLLISION ARRAY
      CALL SORT(I,R2,IE)
  140 I=I+1
      IF(CF(IE,I).LT.R2) GO TO 140
      S1=RGAS(I)
      EI=EIN(I)
      IF(IPN(I).LE.0) GO TO 666
C  USE FLAT DISTRIBUTION OF  ELECTRON ENERGY BETWEEN E-EION AND 0.0 EV
C  SAME AS IN BOLTZMANN
      R9=drand48(RDUM)
      EXTRA=R9*(E-EI)
      EI=EXTRA+EI
C
C  GENERATE SCATTERING ANGLES AND UPDATE  LABORATORY COSINES AFTER
C   COLLISION ALSO UPDATE ENERGY OF ELECTRON.
C
  666 IPT=IARRY(I)
      ICOLL(IPT)=ICOLL(IPT)+1
      ICOLN(I)=ICOLN(I)+1
      IF(E.LT.EI) THEN
C      WRITE(6,994) E,EI,J2
C994  FORMAT(2X,' WARNING ENERGY =',F8.3,' LESS THAN ENERGY LOSS EI=',F8
C    /.3,' AT ITER=',I12,' DUE TO BINNING ERROR')
C  FIX ENERGY LOSS SMALLER THAN INCIDENT ENERGY IF ERROR OCCURS
       EI=E-0.0001D0
      ENDIF
C IF EXCITATION THEN ADD PROBABLITY,PENFRAC(1,I),OF TRANSFER TO GIVE
C IONISATION OF THE OTHER GASES IN THE MIXTURE.
      IF(IPEN.EQ.0) GO TO 5
      IF(PENFRA(1,I).NE.0.0) THEN
       RAN=drand48(RDUM)
       IF(RAN.GT.PENFRA(1,I)) GO TO 5
C ADD EXTRA IONISATION COLLISION
       IEXTRA=IEXTRA+1
      ENDIF
    5 S2=(S1*S1)/(S1-1.0D0)
C ANISOTROPIC SCATTERING
      R3=drand48(RDUM)
      IF(INDEX(I).EQ.1) THEN
       R31=drand48(RDUM)
       F3=1.0D0-R3*ANGCT(IE,I)
       IF(R31.GT.PSCT(IE,I)) F3=-F3
      ELSE IF(INDEX(I).EQ.2) THEN
       EPSI=PSCT(IE,I)
       F3=1.0D0-(2.0D0*R3*(1.0D0-EPSI)/(1.0D0+EPSI*(1.0D0-2.0D0*R3)))
      ELSE
C ISOTROPIC SCATTERING
       F3=1.0D0-2.0D0*R3
      ENDIF
      THETA0=DACOS(F3)
      R4=drand48(RDUM)
      PHI0=F4*R4
      F8=DSIN(PHI0)
      F9=DCOS(PHI0)
      ARG1=1.0D0-S1*EI/E
      ARG1=DMAX1(ARG1,SMALL)
      D=1.0D0-F3*DSQRT(ARG1)
      E1=E*(1.0D0-EI/(S1*E)-2.0D0*D/S2)
      E1=DMAX1(E1,SMALL)
      Q=DSQRT((E/E1)*ARG1)/S1
      Q=DMIN1(Q,1.0D0)
      THETA=DASIN(Q*DSIN(THETA0))
      F6=DCOS(THETA)
      U=(S1-1.0D0)*(S1-1.0D0)/ARG1
      CSQD=F3*F3
      IF(F3.LT.0.0D0.AND.CSQD.GT.U) F6=-1.0D0*F6
      F5=DSIN(THETA)
      DCZ2=DMIN1(DCZ2,1.0D0)
      VTOT=CONST9*DSQRT(E1)
      ARGZ=DSQRT(DCX2*DCX2+DCY2*DCY2)
      IF(ARGZ.EQ.0.0D0) THEN
C      WRITE(6,9232) ITER,ID,E1
C9232  FORMAT(3X,'WARNING ARGZ= 0.0 AT ITER =',I10,' ID =',I10,' E1=',E1
C    /2.3)
       DCZ1=F6
       DCX1=F9*F5
       DCY1=F8*F5
       GO TO 130
      ENDIF
      DCZ1=DCZ2*F6+ARGZ*F5*F8
      DCY1=DCY2*F6+(F5/ARGZ)*(DCX2*F9-DCY2*DCZ2*F8)
      DCX1=DCX2*F6-(F5/ARGZ)*(DCY2*F9+DCX2*DCZ2*F8)
C CALCULATE VELOCITY VECTORS AFTER COLLISION
  130 CX1=DCX1*VTOT
      CY1=DCY1*VTOT
      CZ1=DCZ1*VTOT
  133 CONTINUE
C   ------------------------------------------
      IF(J1.EQ.1) WRITE(6,201)
  201 FORMAT(/,'    VEL      POS        TIME      ENERGY   COUNT   DIFXX
     /     DIFYY     DIFZZ  ',/)
      WZ=WZ*1.0D+09
      AVE=SUME2/ST
      IF(NISO.EQ.0) THEN
       DIFXX=5.0D+15*SUMVX/ST
       DIFYY=5.0D+15*SUMVY/ST
       DFXXST(J1)=5.0D+15*(SUMVX-SVXOLD)/(ST-STOLD)
       DFYYST(J1)=5.0D+15*(SUMVY-SVYOLD)/(ST-STOLD)
      ELSE
       IF(ST2.NE.0.0D0) THEN
        DIFYY=5.0D+15*SUMYY/ST2
        DIFXX=5.0D+15*SUMXX/ST2
        DFXXST(J1)=5.0D+15*(SUMXX-SXXOLD)/(ST2-ST2OLD)
        DFYYST(J1)=5.0D+15*(SUMYY-SYYOLD)/(ST2-ST2OLD)
       ELSE
        DFXXST(J1)=0.0D0
        DFYYST(J1)=0.0D0
       ENDIF
      ENDIF
      IF(ST1.NE.0.0D0) THEN
       DIFZZ=5.0D+15*SUMZZ/ST1
       DFZZST(J1)=5.0D+15*(SUMZZ-SZZOLD)/(ST1-ST1OLD)
      ELSE
       DFZZST(J1)=0.0D0
      ENDIF
      WZST(J1)=(Z-ZOLD)/(ST-STOLD)*1.0D+09
      AVEST(J1)=(SUME2-SME2OLD)/(ST-STOLD)
      ZOLD=Z
      STOLD=ST
      ST1OLD=ST1
      ST2OLD=ST2
      SVXOLD=SUMVX
      SVYOLD=SUMVY
      SZZOLD=SUMZZ
      SXXOLD=SUMXX
      SYYOLD=SUMYY
      SME2OLD=SUME2
      WRITE(6,202) WZ,Z,ST,AVE,ID,DIFXX,DIFYY,DIFZZ
  202 FORMAT(1X,F8.2,2(1X,D10.3),F9.4,1X,I5,1X,3(2X,F8.1))
C LOOP
  210 CONTINUE
C CALCULATE ERRORS AND CHECK AVERAGES
      TWZST=0.0D0
      TAVE=0.0D0
      T2WZST=0.0D0
      T2AVE=0.0D0
      TZZST=0.0D0
      TYYST=0.0D0
      TXXST=0.0D0
      T2ZZST=0.0D0
      T2YYST=0.0D0
      T2XXST=0.0D0
      DO 768 K=1,10
      TWZST=TWZST+WZST(K)
      TAVE=TAVE+AVEST(K)
      T2WZST=T2WZST+WZST(K)*WZST(K)
      T2AVE=T2AVE+AVEST(K)*AVEST(K)
      TXXST=TXXST+DFXXST(K)
      TYYST=TYYST+DFYYST(K)
      T2XXST=T2XXST+DFXXST(K)*DFXXST(K)
      T2YYST=T2YYST+DFYYST(K)*DFYYST(K)
      IF(K.LT.3) GO TO 768
      TZZST=TZZST+DFZZST(K)
      T2ZZST=T2ZZST+DFZZST(K)*DFZZST(K)
  768 CONTINUE
      DWZ=100.0D0*DSQRT((T2WZST-TWZST*TWZST/10.0D0)/9.0D0)/WZ
      DEN=100.0D0*DSQRT((T2AVE-TAVE*TAVE/10.0D0)/9.0D0)/AVE
      DXXER=100.0D0*DSQRT((T2XXST-TXXST*TXXST/10.0D0)/9.0D0)/DIFXX
      DYYER=100.0D0*DSQRT((T2YYST-TYYST*TYYST/10.0D0)/9.0D0)/DIFYY
      DZZER=100.0D0*DSQRT((T2ZZST-TZZST*TZZST/8.0D0)/7.0D0)/DIFZZ
      DIFLN=DIFZZ
      DIFTR=(DIFXX+DIFYY)/2.0D0
C CONVERT TO CM/SEC
      WZ=WZ*1.0D05
      DFLER=DZZER
      DFTER=(DXXER+DYYER)/2.0D0
C CALCULATE TOWNSEND COEFICIENTS AND ERRORS
      ANCATT=0.0D0
      ANCION=0.0D0
      DO 800 I=1,NGAS
      ANCATT=ANCATT+ICOLL((5*I)-2)
  800 ANCION=ANCION+ICOLL((5*I)-3)
      ANCION=ANCION+IEXTRA
      ATTER=0.0
      IF(ANCATT.EQ.0.0D0) GO TO 810
      ATTER=100.0*DSQRT(ANCATT)/ANCATT
  810 ATT=ANCATT/(ST*WZ)*1.0D12
      ALPER=0.0
      IF(ANCION.EQ.0.0D0) GO TO 820
      ALPER=100.0*DSQRT(ANCION)/ANCION
  820 ALPHA=ANCION/(ST*WZ)*1.0D12
      RETURN
      END
      SUBROUTINE MONTEB
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      COMMON/CNSTS1/CONST1,CONST2,CONST3,CONST4,CONST5
      COMMON/SETP/TMAX,SMALL,API,ESTART,THETA,PHI,TCFMAX(8),RSTART,
     /EFIELD,NMAX
      COMMON/BFLD/EOVB,WB,BTHETA,BMAG
      COMMON/LARGE/CF(4000,512),EIN(512),TCF(4000),IARRY(512),RGAS(512),
     /IPN(512),WPL(512),LAST,ISIZE,PENFRA(3,512)
      COMMON/ANIS/PSCT(4000,512),ANGCT(4000,512),INDEX(512),NISO
      COMMON/MIX2/ES(4000),EROOT(4000),QTOT(4000),QREL(4000),QINEL(4000)
     /,QEL(4000)
      COMMON/DIFLAB/DIFXX,DIFYY,DIFZZ,DIFYZ,DIFXY,DIFXZ
      COMMON/DIFERB/DXXER,DYYER,DZZER,DYZER,DXYER,DXZER
      COMMON/DIFVEL/DIFLN,DIFTR
      COMMON/DIFERL/DFLER,DFTER
      COMMON/VEL/WX,WY,WZ
      COMMON/VELERR/DWX,DWY,DWZ
      COMMON/CTOWNS/ALPHA,ATT
      COMMON/CTWNER/ALPER,ATTER
      COMMON/OUTPT/TIME(300),ICOLL(30),SPEC(4000),TMAX1,
     /AVE,DEN,XID,X,Y,Z,ST,NNULL,ICOLN(512)
      DIMENSION XST(200000),YST(200000),ZST(200000),STO(200000)
      DIMENSION WZST(10),WYST(10),AVEST(10)
      DIMENSION DFZZST(10),DFYYST(10),DFXXST(10)
      DIMENSION DFYZST(10),DFLNST(10),DFTRST(10)
C -------------------------------------------------------------------
C   CALCULATES COLLISION EVENTS AND UPDATES DIFFUSION AND VELOCITY.
C   SUBROUTINE HANDLES MAGNETIC FIELD AND ELECTRIC FIELD
C   BFIELD ALONG X-AXIS EFIELD ALONG Z-AXIS (90 DEGREES).
C -------------------------------------------------------------------
      WX=0.0D0
      DWX=0.0D0
      DIFXZ=0.0D0
      DIFXY=0.0D0
      DXZER=0.0D0
      DXYER=0.0D0
      X=0.0D0
      Y=0.0D0
      Z=0.0D0
      ST=0.0D0
      ST1=0.0D0
      ST2=0.0D0
      SUMXX=0.0D0
      SUMYY=0.0D0
      SUMZZ=0.0D0
      SUMYZ=0.0D0
      SUMLS=0.0D0
      SUMTS=0.0D0
      SUMVX=0.0D0
      ZOLD=0.0D0
      YOLD=0.0D0
      STOLD=0.0D0
      ST1OLD=0.0D0
      ST2OLD=0.0D0
      SZZOLD=0.0D0
      SXXOLD=0.0D0
      SYYOLD=0.0D0
      SYZOLD=0.0D0
      SVXOLD=0.0D0
      SLNOLD=0.0D0
      STROLD=0.0D0
      EBAROLD=0.0D0
      SMALL=1.0D-20
      TMAX1=0.0D0
      EF100=EFIELD*100.0D0
      RDUM=RSTART
      E1=ESTART
      N4000=4000
      N300=300
      INTEM=8
      ITMAX=10
      ID=0
      NCOL=0
      NNULL=0
      IEXTRA=0
C  NUMBER OF COLLISIONS FOR DE-CORRELATION
      NCOLM=200000
      TDASH=0.0D0
      CONST9=CONST3*0.01D0
C
C     INITIAL DIRECTION COSINES
C
      DCZ1=DCOS(THETA)
      DCX1=DSIN(THETA)*DCOS(PHI)
      DCY1=DSIN(THETA)*DSIN(PHI)
C     INITIAL VELOCITY
      VTOT=CONST9*DSQRT(E1)
      CX1=DCX1*VTOT
      CY1=DCY1*VTOT
      CZ1=DCZ1*VTOT
      F4=2.0D0*DACOS(-1.0D0)
      DELTAE=EFINAL/DFLOAT(INTEM)
      J2M=NMAX/ITMAX
C MAIN LOOP
      DO 210 J1=1,ITMAX
      DO 133 J2=1,J2M
    1 R1=drand48(RDUM)
      I=DINT(E1/DELTAE)+1
      I=DMIN0(I,INTEM)
      TLIM=TCFMAX(I)
      T=-DLOG(R1)/TLIM+TDASH
      TDASH=T
      WBT=WB*T
      COSWT=DCOS(WBT)
      SINWT=DSIN(WBT)
      DZ=(CZ1*SINWT+(EOVB-CY1)*(1.0D0-COSWT))/WB
      E=E1+DZ*EF100
C     IF(E.LT.0.0) WRITE(6,983) J2,DZ,E1,COSWT,SINWT,WBT,CY1
C983  FORMAT(2X,' J2=',I12,' DZ=',D12.3,' E1=',D12.3,' COSWT=',D12.3
C    /,' SINWT=',D12.3,' WBT=',D12.3,' CY1=',D12.3)
      IE=DINT(E/ESTEP)+1
      IE=DMIN0(IE,N4000)
      IF(TCF(IE).GT.TLIM) THEN
       TDASH=TDASH+DLOG(R1)/TLIM
       TCFMAX(I)=1.05D0*TCFMAX(I)
C
C      WRITE(6,996)
C996   FORMAT(/,5X,' WARNING NULL COLLISION TIME INCREASED',/)
       GO TO 1
      ENDIF
C
C     TEST FOR REAL OR NULL COLLISION
C
      R5=drand48(RDUM)
      TLIM=TCF(IE)/TLIM
      IF(R5.GT.TLIM) THEN
       NNULL=NNULL+1
       GO TO 1
      ENDIF
C
C  CALCULATE DIRECTION COSINES AND POSITIONS AT INSTANT BEFORE COLLISION
C    ALSO UPDATE DIFFUSION  AND ENERGY CALCULATIONS.
      T2=T*T
      IF(T.GE.TMAX1) TMAX1=T
      TDASH=0.0D0
C  CALC VELOCITY
      CX2=CX1
      CY2=(CY1-EOVB)*COSWT+CZ1*SINWT+EOVB
      CZ2=CZ1*COSWT-(CY1-EOVB)*SINWT
C CALC DIRECTION COSINE
      VTOT=DSQRT(CX2*CX2+CY2*CY2+CZ2*CZ2)
      DCX2=CX2/VTOT
      DCY2=CY2/VTOT
      DCZ2=CZ2/VTOT
      NCOL=NCOL+1
C CALC NEW POSITION
      X=X+CX1*T
      Y=Y+EOVB*T+((CY1-EOVB)*SINWT+CZ1*(1.0D0-COSWT))/WB
      Z=Z+DZ
      ST=ST+T
      IT=DINT(T+1.0D0)
      IT=DMIN0(IT,N300)
      TIME(IT)=TIME(IT)+1.0D0
      SPEC(IE)=SPEC(IE)+1.0D0
      WZ=Z/ST
      WY=Y/ST
      SUMVX=SUMVX+CX1*CX1*T2
      IF(ID.EQ.0) GO TO 121
      KDUM=0
      DO 120 J=1,4
      ST2=ST2+T
      NCOLDM=NCOL+KDUM
      IF(NCOLDM.GT.NCOLM) NCOLDM=NCOLDM-NCOLM
      SDIF=ST-STO(NCOLDM)
      SUMXX=SUMXX+((X-XST(NCOLDM))**2)*T/SDIF
      IF(J1.LT.3) GO TO 120
      ST1=ST1+T
      SUMZZ=SUMZZ+((Z-ZST(NCOLDM)-WZ*SDIF)**2)*T/SDIF
      SUMYY=SUMYY+((Y-YST(NCOLDM)-WY*SDIF)**2)*T/SDIF
      SUMYZ=SUMYZ+(Z-ZST(NCOLDM)-WZ*SDIF)*(Y-YST(NCOLDM)-WY*SDIF)*T/SDIF
      A2=(WZ*SDIF)**2+(WY*SDIF)**2
      B2=(Z-WZ*SDIF-ZST(NCOLDM))**2+(Y-WY*SDIF-YST(NCOLDM))**2
      C2=(Z-ZST(NCOLDM))**2+(Y-YST(NCOLDM))**2
      DL2=(A2+B2-C2)**2/(4.0D0*A2)
      DT2=B2-DL2
      SUMLS=SUMLS+DL2*T/SDIF
      SUMTS=SUMTS+DT2*T/SDIF
 120  KDUM=KDUM+25000
 121  XST(NCOL)=X
      YST(NCOL)=Y
      ZST(NCOL)=Z
      STO(NCOL)=ST
      IF(NCOL.GE.NCOLM) THEN
       ID=ID+1
       XID=DFLOAT(ID)
       NCOL=0
      ENDIF
C ---------------------------------------------------------------------
C     DETERMINATION OF REAL COLLISION TYPE
C ---------------------------------------------------------------------
      R2=drand48(RDUM)
C FIND LOCATION WITHIN 4 UNITS IN COLLISION ARRAY
      CALL SORT(I,R2,IE)
  140 I=I+1
      IF(CF(IE,I).LT.R2) GO TO 140
      S1=RGAS(I)
      EI=EIN(I)
      IF(IPN(I).LE.0) GO TO 666
C  USE FLAT DISTRIBUTION OF  ELECTRON ENERGY BETWEEN E-EION AND 0.0 EV
C  SAME AS IN BOLTZMANN
      R9=drand48(RDUM)
      EXTRA=R9*(E-EI)
      EI=EXTRA+EI
C
C  GENERATE SCATTERING ANGLES AND UPDATE  LABORATORY COSINES AFTER
C   COLLISION ALSO UPDATE ENERGY OF ELECTRON.
C
  666 IPT=IARRY(I)
      ICOLL(IPT)=ICOLL(IPT)+1
      ICOLN(I)=ICOLN(I)+1
      IF(E.LT.EI) THEN
C      WRITE(6,994) E,EI,J2
C994  FORMAT(2X,' WARNING ENERGY =',F8.3,' LESS THAN ENERGY LOSS EI=',F8
C    /.3,' AT ITER=',I12,' DUE TO BINNING ERROR')
C  FIX ENERGY LOSS SMALLER THAN INCIDENT ENERGY IF ERROR OCCURS
       EI=E-0.0001D0
      ENDIF
C IF EXCITATION THEN ADD PROBABILITY,PENFRAC(1,I), OF TRANSFER TO GIVE
C IONISATION OF THE OTHER GASES IN THE MIXTURE
      IF(IPEN.EQ.0) GO TO 5
      IF(PENFRA(1,I).NE.0.0) THEN
       RAN=drand48(RDUM)
       IF(RAN.GT.PENFRA(1,I)) GO TO 5
C ADD EXTRA IONISATION COLLISION
       IEXTRA=IEXTRA+1
      ENDIF
    5 S2=(S1*S1)/(S1-1.0D0)
C  ANISOTROPIC SCATTERING
      R3=drand48(RDUM)
      IF(INDEX(I).EQ.1) THEN
        R31=drand48(RDUM)
        F3=1.0D0-R3*ANGCT(IE,I)
        IF(R31.GT.PSCT(IE,I)) F3=-F3
      ELSE IF(INDEX(I).EQ.2) THEN
       EPSI=PSCT(IE,I)
       F3=1.0D0-(2.0D0*R3*(1.0D0-EPSI)/(1.0D0+EPSI*(1.0D0-2.0D0*R3)))
      ELSE
C ISOTROPIC SCATTERING
        F3=1.0D0-2.0D0*R3
      ENDIF
      THETA0=DACOS(F3)
      R4=drand48(RDUM)
      PHI0=F4*R4
      F8=DSIN(PHI0)
      F9=DCOS(PHI0)
      ARG1=1.0D0-S1*EI/E
      ARG1=DMAX1(ARG1,SMALL)
      D=1.0D0-F3*DSQRT(ARG1)
      E1=E*(1.0D0-EI/(S1*E)-2.0D0*D/S2)
      E1=DMAX1(E1,SMALL)
      Q=DSQRT((E/E1)*ARG1)/S1
      Q=DMIN1(Q,1.0D0)
      THETA=DASIN(Q*DSIN(THETA0))
      F6=DCOS(THETA)
      U=(S1-1.0D0)*(S1-1.0D0)/ARG1
      CSQD=F3*F3
      IF(F3.LT.0.0D0.AND.CSQD.GT.U) F6=-1.0D0*F6
      F5=DSIN(THETA)
      DCZ2=DMIN1(DCZ2,1.0D0)
      VTOT=CONST9*DSQRT(E1)
      ARGZ=DSQRT(DCX2*DCX2+DCY2*DCY2)
      IF(ARGZ.EQ.0.0D0) THEN
C      WRITE(6,9232) ITER,ID,E1
C9232  FORMAT(3X,'WARNING ARGZ= 0.0 AT ITER =',I10,' ID =',I10,' E1=',E1
C    /2.3)
       DCZ1=F6
       DCX1=F9*F5
       DCY1=F8*F5
       GO TO 130
      ENDIF
      DCZ1=DCZ2*F6+ARGZ*F5*F8
      DCY1=DCY2*F6+(F5/ARGZ)*(DCX2*F9-DCY2*DCZ2*F8)
      DCX1=DCX2*F6-(F5/ARGZ)*(DCY2*F9+DCX2*DCZ2*F8)
C CALCULATE VELOCITY VECTORS AFTER COLLISION
  130 CX1=DCX1*VTOT
      CY1=DCY1*VTOT
      CZ1=DCZ1*VTOT
  133 CONTINUE
C   ------------------------------------------
      IF(J1.EQ.1) WRITE(6,201)
  201 FORMAT(/,'   VELZ    VELY  ENERGY   ID  DIFXX   DIFYY   DIFZZ   DI
     /FYZ  DIFLNG  DIFTRN',/)
      WZ=WZ*1.0D+09
      WY=WY*1.0D+09
      IF(ST2.NE.0.0D0) DIFXX=5.0D+15*SUMXX/ST2
      IF(ST1.NE.0.0D0) DIFYY=5.0D+15*SUMYY/ST1
      IF(ST1.NE.0.0D0) DIFZZ=5.0D+15*SUMZZ/ST1
      IF(ST1.NE.0.0D0) DIFYZ=-5.0D+15*SUMYZ/ST1
      IF(ST1.NE.0.0D0) DIFLN=5.0D+15*SUMLS/ST1
      IF(ST1.NE.0.0D0) DIFTR=5.0D+15*SUMTS/ST1
      IF(NISO.EQ.0) DIFXX=5.0D+15*SUMVX/ST
      EBAR=0.0D0
      DO 300 IK=1,4000
  300 EBAR=EBAR+ES(IK)*SPEC(IK)/TCF(IK)
      AVE=EBAR/ST
      WZST(J1)=(Z-ZOLD)/(ST-STOLD)*1.0D+09
      WYST(J1)=(Y-YOLD)/(ST-STOLD)*1.0D+09
      AVEST(J1)=(EBAR-EBAROLD)/(ST-STOLD)
      EBAROLD=EBAR
      DFZZST(J1)=0.0D0
      DFYYST(J1)=0.0D0
      DFYZST(J1)=0.0D0
      DFLNST(J1)=0.0D0
      DFTRST(J1)=0.0D0
      IF(J1.GT.2) THEN
       DFZZST(J1)=5.0D+15*(SUMZZ-SZZOLD)/(ST1-ST1OLD)
       DFYYST(J1)=5.0D+15*(SUMYY-SYYOLD)/(ST1-ST1OLD)
       DFYZST(J1)=5.0D+15*(SUMYZ-SYZOLD)/(ST1-ST1OLD)
       DFLNST(J1)=5.0D+15*(SUMLS-SLNOLD)/(ST1-ST1OLD)
       DFTRST(J1)=5.0D+15*(SUMTS-STROLD)/(ST1-ST1OLD)
      ENDIF
      DFXXST(J1)=5.0D+15*(SUMXX-SXXOLD)/(ST2-ST2OLD)
      IF(NISO.EQ.0) DFXXST(J1)=5.0D+15*(SUMVX-SVXOLD)/(ST-STOLD)
      ZOLD=Z
      YOLD=Y
      STOLD=ST
      ST1OLD=ST1
      ST2OLD=ST2
      SVXOLD=SUMVX
      SZZOLD=SUMZZ
      SXXOLD=SUMXX
      SYYOLD=SUMYY
      SYZOLD=SUMYZ
      SLNOLD=SUMLS
      STROLD=SUMTS
      WRITE(6,202) WZ,WY,AVE,ID,DIFXX,DIFYY,DIFZZ,
     /DIFYZ,DIFLN,DIFTR
  202 FORMAT(2(F7.2,1X),F7.4,1X,I4,6(F7.1,1X))
C  LOOP
  210 CONTINUE
C CALCULATE ERRORS AND CHECK AVERAGES
      TWZST=0.0D0
      TWYST=0.0D0
      TAVE=0.0D0
      T2WZST=0.0D0
      T2WYST=0.0D0
      T2AVE=0.0D0
      TZZST=0.0D0
      TYYST=0.0D0
      TXXST=0.0D0
      TYZST=0.0D0
      TLNST=0.0D0
      TTRST=0.0D0
      T2ZZST=0.0D0
      T2YYST=0.0D0
      T2XXST=0.0D0
      T2YZST=0.0D0
      T2LNST=0.0D0
      T2TRST=0.0D0
      DO 768 K=1,10
      TWZST=TWZST+WZST(K)
      TWYST=TWYST+WYST(K)
      TAVE=TAVE+AVEST(K)
      T2WZST=T2WZST+WZST(K)*WZST(K)
      T2WYST=T2WYST+WYST(K)*WYST(K)
      T2AVE=T2AVE+AVEST(K)*AVEST(K)
      TXXST=TXXST+DFXXST(K)
      T2XXST=T2XXST+DFXXST(K)*DFXXST(K)
      IF(K.LT.3) GO TO 768
      TZZST=TZZST+DFZZST(K)
      TYYST=TYYST+DFYYST(K)
      TYZST=TYZST+DFYZST(K)
      TLNST=TLNST+DFLNST(K)
      TTRST=TTRST+DFTRST(K)
      T2ZZST=T2ZZST+DFZZST(K)*DFZZST(K)
      T2YYST=T2YYST+DFYYST(K)*DFYYST(K)
      T2YZST=T2YZST+DFYZST(K)*DFYZST(K)
      T2LNST=T2LNST+DFLNST(K)*DFLNST(K)
      T2TRST=T2TRST+DFTRST(K)*DFTRST(K)
  768 CONTINUE
      DWZ=100.0D0*DSQRT((T2WZST-TWZST*TWZST/10.0D0)/9.0D0)/WZ
      DWY=100.0D0*DSQRT((T2WYST-TWYST*TWYST/10.0D0)/9.0D0)/DABS(WY)
      DEN=100.0D0*DSQRT((T2AVE-TAVE*TAVE/10.0D0)/9.0D0)/AVE
      DXXER=100.0D0*DSQRT((T2XXST-TXXST*TXXST/10.0D0)/9.0D0)/DIFXX
      DYYER=100.0D0*DSQRT((T2YYST-TYYST*TYYST/8.0D0)/7.0D0)/DIFYY
      DZZER=100.0D0*DSQRT((T2ZZST-TZZST*TZZST/8.0D0)/7.0D0)/DIFZZ
      DYZER=100.0D0*DSQRT((T2YZST-TYZST*TYZST/8.0D0)/7.0D0)/DABS(DIFYZ)
      DFLER=100.0D0*DSQRT((T2LNST-TLNST*TLNST/8.0D0)/7.0D0)/DIFLN
      DFTER=100.0D0*DSQRT((T2TRST-TTRST*TTRST/8.0D0)/7.0D0)/DIFTR
C CONVERT TO CM/SEC
      WZ=WZ*1.0D05
      WY=WY*1.0D05
C CALCULATE TOWNSEND COEFICIENTS AND ERRORS
      ANCATT=0.0D0
      ANCION=0.0D0
      DO 800 I=1,NGAS
      ANCATT=ANCATT+ICOLL((5*I)-2)
  800 ANCION=ANCION+ICOLL((5*I)-3)
      ANCION=ANCION+IEXTRA
      ATTER=0.0D0
      IF(ANCATT.EQ.0.0D0) GO TO 810
      ATTER=100.0D0*DSQRT(ANCATT)/ANCATT
  810 ATT=ANCATT/(ST*WZ)*1.0D12
      ALPER=0.0D0
      IF(ANCION.EQ.0.0D0) GO TO 820
      ALPER=100.0D0*DSQRT(ANCION)/ANCION
  820 ALPHA=ANCION/(ST*WZ)*1.0D12
      RETURN
      END
      SUBROUTINE MONTEC
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      COMMON/CNSTS1/CONST1,CONST2,CONST3,CONST4,CONST5
      COMMON/SETP/TMAX,SMALL,API,ESTART,THETA,PHI,TCFMAX(8),RSTART,
     /EFIELD,NMAX
      COMMON/BFLD/EOVB,WB,BTHETA,BMAG
      COMMON/LARGE/CF(4000,512),EIN(512),TCF(4000),IARRY(512),RGAS(512),
     /IPN(512),WPL(512),LAST,ISIZE,PENFRA(3,512)
      COMMON/ANIS/PSCT(4000,512),ANGCT(4000,512),INDEX(512),NISO
      COMMON/MIX2/ES(4000),EROOT(4000),QTOT(4000),QREL(4000),QINEL(4000)
     /,QEL(4000)
      COMMON/DIFLAB/DIFXX,DIFYY,DIFZZ,DIFYZ,DIFXY,DIFXZ
      COMMON/DIFERB/DXXER,DYYER,DZZER,DYZER,DXYER,DXZER
      COMMON/DIFVEL/DIFLN,DIFTR
      COMMON/DIFERL/DFLER,DFTER
      COMMON/VEL/WX,WY,WZ
      COMMON/VELERR/DWX,DWY,DWZ
      COMMON/CTOWNS/ALPHA,ATT
      COMMON/CTWNER/ALPER,ATTER
      COMMON/OUTPT/TIME(300),ICOLL(30),SPEC(4000),TMAX1,
     /AVE,DEN,XID,X,Y,Z,ST,NNULL,ICOLN(512)
      DIMENSION XST(200000),YST(200000),ZST(200000),STO(200000)
      DIMENSION WZST(10),WYST(10),WXST(10),AVEST(10)
      DIMENSION DFZZST(10),DFYYST(10),DFXXST(10)
      DIMENSION DFYZST(10),DFXYST(10),DFXZST(10)
C -------------------------------------------------------------------
C   CALCULATES COLLISION EVENTS AND UPDATES DIFFUSION AND VELOCITY.
C   SUBROUTINE SOLVES MOTION IN COORDINATE SYSTEM WITH BFIELD
C   ALIGNED ALONG X AXIS AND ELECTRIC FIELD AT AN ANGLE BTHETA IN
C   THE X-Z PLANE.  THE VELOCITY VECTORS AND DIFFUSION ARE THEN
C   ROTATED INTO THE STANDARD COORDINATE FRAME WITH THE ELECTRIC-
C   FIELD ALONG Z-AXIS AND THE  BFIELD AT AN ANGLE BTHETA TO THE
C   ELECTRIC FIELD IN THE X-Z PLANE.
C -------------------------------------------------------------------
      X=0.0D0
      Y=0.0D0
      Z=0.0D0
C CALC LONG AND TRANS ONLY FOR 90 DEGREES BETWEEN E AND B
      DIFLN=0.0D0
      DIFTR=0.0D0
      DFLER=0.0D0
      DFTER=0.0D0
      DIFXXR=0.0D0
      DIFYYR=0.0D0
      DIFZZR=0.0D0
      DIFYZR=0.0D0
      DIFXZR=0.0D0
      DIFXYR=0.0D0
      ST=0.0D0
      ST1=0.0D0
      SUMXX=0.0D0
      SUMYY=0.0D0
      SUMZZ=0.0D0
      SUMYZ=0.0D0
      SUMXY=0.0D0
      SUMXZ=0.0D0
      ZROLD=0.0D0
      YROLD=0.0D0
      XROLD=0.0D0
      SZZR=0.0D0
      SYYR=0.0D0
      SXXR=0.0D0
      SXYR=0.0D0
      SYZR=0.0D0
      SXZR=0.0D0
      STOLD=0.0D0
      ST1OLD=0.0D0
      ST2OLD=0.0D0
      SZZOLD=0.0D0
      SYYOLD=0.0D0
      SXXOLD=0.0D0
      SYZOLD=0.0D0
      SXYOLD=0.0D0
      SXZOLD=0.0D0
      EBAROLD=0.0D0
      SMALL=1.0D-20
      TMAX1=0.0D0
      API=DACOS(-1.0D0)
C CALC ROTATION MATRIX ANGLES
      RCS=DCOS((BTHETA-90.0D0)*API/180.0D0)
      RSN=DSIN((BTHETA-90.0D0)*API/180.0D0)
C
      RTHETA=BTHETA*API/180.0D0
      EFZ100=EFIELD*100.0D0*DSIN(RTHETA)
      EFX100=EFIELD*100.0D0*DCOS(RTHETA)
      F1=EFIELD*CONST2*DCOS(RTHETA)
      EOVBR=EOVB*DSIN(RTHETA)
      RDUM=RSTART
      E1=ESTART
      N4000=4000
      N300=300
      INTEM=8
      ITMAX=10
      ID=0
      NCOL=0
      NNULL=0
      IEXTRA=0
      NCOLM=200000
      TDASH=0.0D0
      CONST9=CONST3*0.01D0
C
C     INITIAL DIRECTION COSINES
C
      DCZ1=DCOS(THETA)
      DCX1=DSIN(THETA)*DCOS(PHI)
      DCY1=DSIN(THETA)*DSIN(PHI)
C     INITIAL VELOCITY
      VTOT=CONST9*DSQRT(E1)
      CX1=DCX1*VTOT
      CY1=DCY1*VTOT
      CZ1=DCZ1*VTOT
      F4=2.0D0*API
      DELTAE=EFINAL/DFLOAT(INTEM)
      J2M=NMAX/ITMAX
C MAIN LOOP
      DO 210 J1=1,ITMAX
      DO 133 J2=1,J2M
    1 R1=drand48(RDUM)
      I=DINT(E1/DELTAE)+1
      I=DMIN0(I,INTEM)
      TLIM=TCFMAX(I)
      T=-DLOG(R1)/TLIM+TDASH
      TDASH=T
      WBT=WB*T
      COSWT=DCOS(WBT)
      SINWT=DSIN(WBT)
      DZ=(CZ1*SINWT+(EOVBR-CY1)*(1.0D0-COSWT))/WB
      DX=CX1*T+F1*T*T
      E=E1+DZ*EFZ100+DX*EFX100
C     IF(E.LT.0.0) WRITE(6,983) J2,DZ,E1,COSWT,SINWT,WBT,CY1
C983  FORMAT(2X,' J2=',I12,' DZ=',D12.3,' E1=',D12.3,' COSWT=',D12.3
C    /,' SINWT=',D12.3,' WBT=',D12.3,' CY1=',D12.3)
      IE=DINT(E/ESTEP)+1
      IE=DMIN0(IE,N4000)
      IF(TCF(IE).GT.TLIM) THEN
       TDASH=TDASH+DLOG(R1)/TLIM
       TCFMAX(I)=1.05D0*TCFMAX(I)
C      WRITE(6,996)
C996   FORMAT(/,5X,' WARNING NULL COLLISION TIME INCREASED',/)
       GO TO 1
      ENDIF
C
C     TEST FOR REAL OR NULL COLLISION
C
      R5=drand48(RDUM)
      TLIM=TCF(IE)/TLIM
      IF(R5.GT.TLIM) THEN
       NNULL=NNULL+1
       GO TO 1
      ENDIF
C
C  CALCULATE DIRECTION COSINES AND POSITIONS AT INSTANT BEFORE COLLISION
C    ALSO UPDATE DIFFUSION  AND ENERGY CALCULATIONS.
      T2=T*T
      IF(T.GE.TMAX1) TMAX1=T
      TDASH=0.0D0
C  CALC VELOCITY
      CX2=CX1+2.0D0*F1*T
      CY2=(CY1-EOVBR)*COSWT+CZ1*SINWT+EOVBR
      CZ2=CZ1*COSWT-(CY1-EOVBR)*SINWT
C CALC DIRECTION COSINE
      VTOT=DSQRT(CX2*CX2+CY2*CY2+CZ2*CZ2)
      DCX2=CX2/VTOT
      DCY2=CY2/VTOT
      DCZ2=CZ2/VTOT
      NCOL=NCOL+1
C CALC NEW POSITION
      X=X+DX
      Y=Y+EOVBR*T+((CY1-EOVBR)*SINWT+CZ1*(1.0D0-COSWT))/WB
      Z=Z+DZ
      ST=ST+T
      IT=DINT(T+1.0D0)
      IT=DMIN0(IT,N300)
      TIME(IT)=TIME(IT)+1.0D0
      SPEC(IE)=SPEC(IE)+1.0D0
      WZ=Z/ST
      WY=Y/ST
      WX=X/ST
      IF(J1.LT.3) GO TO 121
      KDUM=0
      DO 120 J=1,4
      NCOLDM=NCOL+KDUM
      IF(NCOLDM.GT.NCOLM) NCOLDM=NCOLDM-NCOLM
      ST1=ST1+T
      SDIF=ST-STO(NCOLDM)
      SUMZZ=SUMZZ+((Z-ZST(NCOLDM)-WZ*SDIF)**2)*T/SDIF
      SUMYY=SUMYY+((Y-YST(NCOLDM)-WY*SDIF)**2)*T/SDIF
      SUMXX=SUMXX+((X-XST(NCOLDM)-WX*SDIF)**2)*T/SDIF
      SUMYZ=SUMYZ+(Z-ZST(NCOLDM)-WZ*SDIF)*(Y-YST(NCOLDM)-WY*SDIF)*T/SDIF
      SUMXY=SUMXY+(X-XST(NCOLDM)-WX*SDIF)*(Y-YST(NCOLDM)-WY*SDIF)*T/SDIF
      SUMXZ=SUMXZ+(X-XST(NCOLDM)-WX*SDIF)*(Z-ZST(NCOLDM)-WZ*SDIF)*T/SDIF
 120  KDUM=KDUM+25000
 121  XST(NCOL)=X
      YST(NCOL)=Y
      ZST(NCOL)=Z
      STO(NCOL)=ST
      IF(NCOL.GE.NCOLM) THEN
       ID=ID+1
       XID=DFLOAT(ID)
       NCOL=0
      ENDIF
C ---------------------------------------------------------------------
C     DETERMINATION OF REAL COLLISION TYPE
C ---------------------------------------------------------------------
      R2=drand48(RDUM)
C FIND LOCATION WITHIN 4 UNITS IN COLLISION ARRAY
      CALL SORT(I,R2,IE)
  140 I=I+1
      IF(CF(IE,I).LT.R2) GO TO 140
      S1=RGAS(I)
      EI=EIN(I)
      IF(IPN(I).LE.0) GO TO 666
C  USE FLAT DISTRIBUTION OF  ELECTRON ENERGY BETWEEN E-EION AND 0.0 EV
C  SAME AS IN BOLTZMANN
      R9=drand48(RDUM)
      EXTRA=R9*(E-EI)
      EI=EXTRA+EI
C
C  GENERATE SCATTERING ANGLES AND UPDATE  LABORATORY COSINES AFTER
C   COLLISION ALSO UPDATE ENERGY OF ELECTRON.
C
  666 IPT=IARRY(I)
      ICOLL(IPT)=ICOLL(IPT)+1
      ICOLN(I)=ICOLN(I)+1
      IF(E.LT.EI) THEN
C      WRITE(6,994) E,EI,J2
C994  FORMAT(2X,' WARNING ENERGY =',F8.3,' LESS THAN ENERGY LOSS EI=',F8
C    /.3,' AT ITER=',I12,' DUE TO BINNING ERROR')
C  FIX ENERGY LOSS SMALLER THAN INCIDENT ENERGY IF ERROR OCCURS
       EI=E-0.0001D0
      ENDIF
C IF EXCITATION THEN ADD PROBABILITY, PENFRA(1,I), OF TRANSFER TO GIVE
C IONISATION OF THE OTHER GASES IN THE MIXTURE
      IF(IPEN.EQ.0) GO TO 5
      IF(PENFRA(1,I).NE.0.0) THEN
       RAN=drand48(RDUM)
       IF(RAN.GT.PENFRA(1,I)) GO TO 5
C ADD EXTRA IONISATION COLLISION
       IEXTRA=IEXTRA+1
      ENDIF
    5 S2=(S1*S1)/(S1-1.0D0)
C ANISOTROPIC SCATTERING
      R3=drand48(RDUM)
      IF(INDEX(I).EQ.1) THEN
        R31=drand48(RDUM)
        F3=1.0D0-R3*ANGCT(IE,I)
        IF(R31.GT.PSCT(IE,I)) F3=-F3
      ELSE IF(INDEX(I).EQ.2) THEN
       EPSI=PSCT(IE,I)
       F3=1.0D0-(2.0D0*R3*(1.0D0-EPSI)/(1.0D0+EPSI*(1.0D0-2.0D0*R3)))
      ELSE
C ISOTROPIC SCATTERING
        F3=1.0D0-2.0D0*R3
      ENDIF
      THETA0=DACOS(F3)
      R4=drand48(RDUM)
      PHI0=F4*R4
      F8=DSIN(PHI0)
      F9=DCOS(PHI0)
      ARG1=1.0D0-S1*EI/E
      ARG1=DMAX1(ARG1,SMALL)
      D=1.0D0-F3*DSQRT(ARG1)
      E1=E*(1.0D0-EI/(S1*E)-2.0D0*D/S2)
      E1=DMAX1(E1,SMALL)
      Q=DSQRT((E/E1)*ARG1)/S1
      Q=DMIN1(Q,1.0D0)
      THETA=DASIN(Q*DSIN(THETA0))
      F6=DCOS(THETA)
      U=(S1-1.0D0)*(S1-1.0D0)/ARG1
      CSQD=F3*F3
      IF(F3.LT.0.0D0.AND.CSQD.GT.U) F6=-1.0D0*F6
      F5=DSIN(THETA)
      DCZ2=DMIN1(DCZ2,1.0D0)
      VTOT=CONST9*DSQRT(E1)
      ARGZ=DSQRT(DCX2*DCX2+DCY2*DCY2)
      IF(ARGZ.EQ.0.0D0) THEN
C      WRITE(6,9232) ITER,ID,E1
C9232  FORMAT(3X,'WARNING ARGZ= 0.0 AT ITER =',I10,' ID =',I10,' E1=',E1
C    /2.3)
       DCZ1=F6
       DCX1=F9*F5
       DCY1=F8*F5
       GO TO 130
      ENDIF
      DCZ1=DCZ2*F6+ARGZ*F5*F8
      DCY1=DCY2*F6+(F5/ARGZ)*(DCX2*F9-DCY2*DCZ2*F8)
      DCX1=DCX2*F6-(F5/ARGZ)*(DCY2*F9+DCX2*DCZ2*F8)
C CALCULATE VELOCITY VECTORS AFTER COLLISION
  130 CX1=DCX1*VTOT
      CY1=DCY1*VTOT
      CZ1=DCZ1*VTOT
  133 CONTINUE
C   ------------------------------------------
      IF(J1.EQ.1) WRITE(6,201)
  201 FORMAT(/,'   VELZ    VELY    VELX   ENERGY  ID  DIFXX  DIFYY  DIFZ
     /Z  DIFYZ  DIFXZ  DIFXY',/)
      WZ=WZ*1.0D+09
      WY=WY*1.0D+09
      WX=WX*1.0D+09
C CALCULATE ROTATED VECTORS AND POSITIONS
      WZR=WZ*RCS-WX*RSN
      WYR=WY
      WXR=WZ*RSN+WX*RCS
      ZR=Z*RCS-X*RSN
      YR=Y
      XR=Z*RSN+X*RCS
      EBAR=0.0D0
      DO 300 IK=1,4000
 300  EBAR=EBAR+ES(IK)*SPEC(IK)/TCF(IK)
      AVE=EBAR/ST
      WZST(J1)=(ZR-ZROLD)/(ST-STOLD)*1.0D+09
      WYST(J1)=(YR-YROLD)/(ST-STOLD)*1.0D+09
      WXST(J1)=(XR-XROLD)/(ST-STOLD)*1.0D+09
      AVEST(J1)=(EBAR-EBAROLD)/(ST-STOLD)
      EBAROLD=EBAR
      IF(J1.LT.3) GO TO 100
      DIFXX=5.0D+15*SUMXX/ST1
      DIFYY=5.0D+15*SUMYY/ST1
      DIFZZ=5.0D+15*SUMZZ/ST1
      DIFYZ=5.0D+15*SUMYZ/ST1
      DIFXZ=5.0D+15*SUMXZ/ST1
      DIFXY=5.0D+15*SUMXY/ST1
C CALCULATE  ROTATED TENSOR .
      DIFXXR=DIFXX*RCS*RCS+DIFZZ*RSN*RSN+2.0D0*RCS*RSN*DIFXZ
      DIFYYR=DIFYY
      DIFZZR=DIFXX*RSN*RSN+DIFZZ*RCS*RCS-2.0D0*RCS*RSN*DIFXZ
      DIFXYR=RCS*DIFXY+RSN*DIFYZ
      DIFYZR=RSN*DIFXY-RCS*DIFYZ
      DIFXZR=(RCS*RCS-RSN*RSN)*DIFXZ-RSN*RCS*(DIFXX-DIFZZ)
      SXXR=SUMXX*RCS*RCS+SUMZZ*RSN*RSN+2.0D0*RCS*RSN*SUMXZ
      SYYR=SUMYY
      SZZR=SUMXX*RSN*RSN+SUMZZ*RCS*RCS-2.0D0*RCS*RSN*SUMXZ
      SXYR=RCS*SUMXY+RSN*SUMYZ
      SYZR=RSN*SUMXY-RCS*SUMYZ
      SXZR=(RCS*RCS-RSN*RSN)*SUMXZ-RSN*RCS*(SUMXX-SUMZZ)
C
  100 DFZZST(J1)=0.0D0
      DFYYST(J1)=0.0D0
      DFXXST(J1)=0.0D0
      DFXYST(J1)=0.0D0
      DFYZST(J1)=0.0D0
      DFXZST(J1)=0.0D0
      IF(J1.GT.2) THEN
       DFZZST(J1)=5.0D+15*(SZZR-SZZOLD)/(ST1-ST1OLD)
       DFYYST(J1)=5.0D+15*(SYYR-SYYOLD)/(ST1-ST1OLD)
       DFXXST(J1)=5.0D+15*(SXXR-SXXOLD)/(ST1-ST1OLD)
       DFXYST(J1)=5.0D+15*(SXYR-SXYOLD)/(ST1-ST1OLD)
       DFYZST(J1)=5.0D+15*(SYZR-SYZOLD)/(ST1-ST1OLD)
       DFXZST(J1)=5.0D+15*(SXZR-SXZOLD)/(ST1-ST1OLD)
      ENDIF
      ZROLD=ZR
      YROLD=YR
      XROLD=XR
      STOLD=ST
      ST1OLD=ST1
      SZZOLD=SZZR
      SYYOLD=SYYR
      SXXOLD=SXXR
      SXYOLD=SXYR
      SYZOLD=SYZR
      SXZOLD=SXZR
C OUTPUT ROTATED VECTORS AND TENSOR
      WRITE(6,202) WZR,WYR,WXR,AVE,ID,DIFXXR,DIFYYR,DIFZZR,
     /DIFYZR,DIFXZR,DIFXYR
  202 FORMAT(3(F7.2,1X),1X,F7.4,I4,6(F7.1))
C LOOP
  210 CONTINUE
C CALCULATE ERRORS AND CHECK AVERAGES
      TWZST=0.0D0
      TWYST=0.0D0
      TWXST=0.0D0
      TAVE=0.0D0
      T2WZST=0.0D0
      T2WYST=0.0D0
      T2WXST=0.0D0
      T2AVE=0.0D0
      TZZST=0.0D0
      TYYST=0.0D0
      TXXST=0.0D0
      TXYST=0.0D0
      TYZST=0.0D0
      TXZST=0.0D0
      T2ZZST=0.0D0
      T2YYST=0.0D0
      T2XXST=0.0D0
      T2XYST=0.0D0
      T2YZST=0.0D0
      T2XZST=0.0D0
      DO 768 K=1,10
      TWZST=TWZST+WZST(K)
      TWYST=TWYST+WYST(K)
      TWXST=TWXST+WXST(K)
      TAVE=TAVE+AVEST(K)
      T2WZST=T2WZST+WZST(K)*WZST(K)
      T2WYST=T2WYST+WYST(K)*WYST(K)
      T2WXST=T2WXST+WXST(K)*WXST(K)
      T2AVE=T2AVE+AVEST(K)*AVEST(K)
      IF(K.LT.3) GO TO 768
      TZZST=TZZST+DFZZST(K)
      TYYST=TYYST+DFYYST(K)
      TXXST=TXXST+DFXXST(K)
      TXYST=TXYST+DFXYST(K)
      TYZST=TYZST+DFYZST(K)
      TXZST=TXZST+DFXZST(K)
      T2ZZST=T2ZZST+DFZZST(K)*DFZZST(K)
      T2YYST=T2YYST+DFYYST(K)*DFYYST(K)
      T2XXST=T2XXST+DFXXST(K)*DFXXST(K)
      T2XYST=T2XYST+DFXYST(K)*DFXYST(K)
      T2YZST=T2YZST+DFYZST(K)*DFYZST(K)
      T2XZST=T2XZST+DFXZST(K)*DFXZST(K)
  768 CONTINUE
      DWZ=100.0D0*DSQRT((T2WZST-TWZST*TWZST/10.0D0)/9.0D0)/WZR
      DWY=100.0D0*DSQRT((T2WYST-TWYST*TWYST/10.0D0)/9.0D0)/DABS(WYR)
      DWX=100.0D0*DSQRT((T2WXST-TWXST*TWXST/10.0D0)/9.0D0)/DABS(WXR)
      DEN=100.0D0*DSQRT((T2AVE-TAVE*TAVE/10.0D0)/9.0D0)/AVE
      DZZER=100.0D0*DSQRT((T2ZZST-TZZST*TZZST/8.0D0)/7.0D0)/DIFZZR
      DYYER=100.0D0*DSQRT((T2YYST-TYYST*TYYST/8.0D0)/7.0D0)/DIFYYR
      DXXER=100.0D0*DSQRT((T2XXST-TXXST*TXXST/8.0D0)/7.0D0)/DIFXXR
      DXYER=100.0D0*DSQRT((T2XYST-TXYST*TXYST/8.0D0)/7.0D0)/DABS(DIFXYR)
      DYZER=100.0D0*DSQRT((T2YZST-TYZST*TYZST/8.0D0)/7.0D0)/DABS(DIFYZR)
      DXZER=100.0D0*DSQRT((T2XZST-TXZST*TXZST/8.0D0)/7.0D0)/DABS(DIFXZR)
C LOAD ROTATED VALUES INTO ARRAYS
      WZ=WZR
      WX=WXR
      WY=WYR
      DIFXX=DIFXXR
      DIFYY=DIFYYR
      DIFZZ=DIFZZR
      DIFYZ=DIFYZR
      DIFXZ=DIFXZR
      DIFXY=DIFXYR
C CONVERT TO CM/SEC.
      WZ=WZ*1.0D05
      WY=WY*1.0D05
      WX=WX*1.0D05
C CALCULATE TOWNSEND COEFICIENTS AND ERRORS
      ANCATT=0.0D0
      ANCION=0.0D0
      DO 800 I=1,NGAS
      ANCATT=ANCATT+ICOLL((5*I)-2)
  800 ANCION=ANCION+ICOLL((5*I)-3)
      ANCION=ANCION+IEXTRA
      ATTER=0.0D0
      IF(ANCATT.EQ.0.0D0) GO TO 810
      ATTER=100.0D0*DSQRT(ANCATT)/ANCATT
  810 ATT=ANCATT/(ST*WZ)*1.0D12
      ALPER=0.0D0
      IF(ANCION.EQ.0.0D0) GO TO 820
      ALPER=100.0D0*DSQRT(ANCION)/ANCION
  820 ALPHA=ANCION/(ST*WZ)*1.0D12
      RETURN
      END
      SUBROUTINE ELIMIT(IELOW)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/CNSTS1/CONST1,CONST2,CONST3,CONST4,CONST5
      COMMON/SETP/TMAX,SMALL,API,ESTART,THETA,PHI,TCFMAX(8),RSTART,
     /EFIELD,NMAX
      COMMON/LARGE/CF(4000,512),EIN(512),TCF(4000),IARRY(512),RGAS(512),
     /IPN(512),WPL(512),LAST,ISIZE,PENFRA(3,512)
      COMMON/ANIS/PSCT(4000,512),ANGCT(4000,512),INDEX(512),NISO
C -------------------------------------------------------------------
C   CALCULATES COLLISION EVENTS AND TESTS TO FIND IF THE UPPER ENERGY
C   LIMIT FOR THE ELECTRON ENERGY IS EXCEEDED.
C    IF ENERGY LIMIT IS OK       IELOW = 0
C    IF ENERGY LIMIT IS EXCEEDED IELOW = 1
C   THE TEST IS CARRIED OUT FOR A SAMPLE OF COLLISIONS THAT ARE
C   SMALLER THAN THE FULL SAMPLE BY A FACTOR OF 1/ISAMP
C
C   USED WITH MAGNETIC FIELD B =0.0   ELECTRIC FIELD IN Z DIRECTION.
C -------------------------------------------------------------------
      ISAMP=10
      SMALL=1.0D-20
      RDUM=RSTART
      E1=ESTART
      N4000=4000
      INTEM=8
      TDASH=0.0D0
C
C     INITIAL DIRECTION COSINES
C
      DCZ1=DCOS(THETA)
      DCX1=DSIN(THETA)*DCOS(PHI)
      DCY1=DSIN(THETA)*DSIN(PHI)
C
      BP=EFIELD*EFIELD*CONST1
      F1=EFIELD*CONST2
      F2=EFIELD*CONST3
      F4=2.0D0*DACOS(-1.0D0)
      DELTAE=EFINAL/DFLOAT(INTEM)
      J2M=NMAX/ISAMP
C MAIN LOOP
      DO 210 J1=1,J2M
    1 R1=drand48(RDUM)
      I=DINT(E1/DELTAE)+1
      I=DMIN0(I,INTEM)
      TLIM=TCFMAX(I)
      T=-DLOG(R1)/TLIM+TDASH
      TDASH=T
      AP=DCZ1*F2*DSQRT(E1)
      E=E1+(AP+BP*T)*T
      IE=DINT(E/ESTEP)+1
      IE=DMIN0(IE,N4000)
      IF(TCF(IE).GT.TLIM) THEN
       TDASH=TDASH+DLOG(R1)/TLIM
       TCFMAX(I)=1.05D0*TCFMAX(I)
       GO TO 1
      ENDIF
C
C     TEST FOR REAL OR NULL COLLISION
C
      R5=drand48(RDUM)
      TLIM=TCF(IE)/TLIM
      IF(R5.GT.TLIM) GO TO 1
C
C  CALCULATE DIRECTION COSINES AT INSTANT BEFORE COLLISION
C
      IF(IE.EQ.4000) THEN
C ELECTRON ENERGY OUT OF RANGE
       IELOW=1
       RETURN
      ENDIF
      TDASH=0.0D0
      CONST6=DSQRT(E1/E)
      DCX2=DCX1*CONST6
      DCY2=DCY1*CONST6
      DCZ2=DCZ1*CONST6+EFIELD*T*CONST5/DSQRT(E)
C ---------------------------------------------------------------------
C     DETERMINATION OF REAL COLLISION TYPE
C ---------------------------------------------------------------------
      R2=drand48(RDUM)
C FIND LOCATION WITHIN 4 UNITS IN COLLISION ARRAY
      CALL SORT(I,R2,IE)
  140 I=I+1
      IF(CF(IE,I).LT.R2) GO TO 140
      S1=RGAS(I)
      EI=EIN(I)
      IF(IPN(I).LE.0) GO TO 666
      R9=drand48(RDUM)
      EXTRA=R9*(E-EI)
      EI=EXTRA+EI
C
C  GENERATE SCATTERING ANGLES AND UPDATE  LABORATORY COSINES AFTER
C   COLLISION ALSO UPDATE ENERGY OF ELECTRON.
C
  666 IPT=IARRY(I)
      IF(E.LT.EI) THEN
       EI=E-0.0001D0
      ENDIF
      S2=(S1*S1)/(S1-1.0D0)
      R3=drand48(RDUM)
      IF(INDEX(I).EQ.1) THEN
       R31=drand48(RDUM)
       F3=1.0D0-R3*ANGCT(IE,I)
       IF(R31.GT.PSCT(IE,I))  F3=-F3
      ELSE IF(INDEX(I).EQ.2) THEN
       EPSI=PSCT(IE,I)
       F3=1.0D0-(2.0D0*R3*(1.0D0-EPSI)/(1.0D0+EPSI*(1.0D0-2.0D0*R3)))
      ELSE
       F3=1.0D0-2.0D0*R3
      ENDIF
      THETA0=DACOS(F3)
      R4=drand48(RDUM)
      PHI0=F4*R4
      F8=DSIN(PHI0)
      F9=DCOS(PHI0)
      ARG1=1.0D0-S1*EI/E
      ARG1=DMAX1(ARG1,SMALL)
      D=1.0D0-F3*DSQRT(ARG1)
      E1=E*(1.0D0-EI/(S1*E)-2.0D0*D/S2)
      E1=DMAX1(E1,SMALL)
      Q=DSQRT((E/E1)*ARG1)/S1
      Q=DMIN1(Q,1.0D0)
      THETA=DASIN(Q*DSIN(THETA0))
      F6=DCOS(THETA)
      U=(S1-1.0D0)*(S1-1.0D0)/ARG1
      CSQD=F3*F3
      IF(F3.LT.0.0D0.AND.CSQD.GT.U) F6=-1.0D0*F6
      F5=DSIN(THETA)
      DCZ2=DMIN1(DCZ2,1.0D0)
      ARGZ=DSQRT(DCX2*DCX2+DCY2*DCY2)
      IF(ARGZ.EQ.0.0D0) THEN
       DCZ1=F6
       DCX1=F9*F5
       DCY1=F8*F5
       GO TO 210
      ENDIF
      DCZ1=DCZ2*F6+ARGZ*F5*F8
      DCY1=DCY2*F6+(F5/ARGZ)*(DCX2*F9-DCY2*DCZ2*F8)
      DCX1=DCX2*F6-(F5/ARGZ)*(DCY2*F9+DCX2*DCZ2*F8)
C LOOP
  210 CONTINUE
      IELOW=0
      RETURN
      END
      SUBROUTINE ELIMITB(IELOW)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/CNSTS1/CONST1,CONST2,CONST3,CONST4,CONST5
      COMMON/SETP/TMAX,SMALL,API,ESTART,THETA,PHI,TCFMAX(8),RSTART,
     /EFIELD,NMAX
      COMMON/BFLD/EOVB,WB,BTHETA,BMAG
      COMMON/LARGE/CF(4000,512),EIN(512),TCF(4000),IARRY(512),RGAS(512),
     /IPN(512),WPL(512),LAST,ISIZE,PENFRA(3,512)
      COMMON/ANIS/PSCT(4000,512),ANGCT(4000,512),INDEX(512),NISO
C -------------------------------------------------------------------
C   CALCULATES COLLISION EVENTS AND TESTS TO FIND IF THE UPPER ENERGY
C   LIMIT FOR THE ELECTRON ENERGY IS EXCEEDED.
C    IF ENERGY LIMIT IS OK       IELOW = 0
C    IF ENERGY LIMIT IS EXCEEDED IELOW = 1
C   THE TEST IS CARRIED OUT FOR A SAMPLE OF COLLISIONS THAT ARE
C   SMALLER THAN THE FULL SAMPLE BY A FACTOR OF 1/ISAMP
C
C   USED WITH MAGNETIC FIELD B AT 90 DEGREES TO ELECTRIC FIELD
C -------------------------------------------------------------------
      ISAMP=20
      SMALL=1.0D-20
      EF100=EFIELD*100.0D0
      RDUM=RSTART
      E1=ESTART
      N4000=4000
      INTEM=8
      TDASH=0.0D0
      CONST9=CONST3*0.01D0
C
C     INITIAL DIRECTION COSINES
C
      DCZ1=DCOS(THETA)
      DCX1=DSIN(THETA)*DCOS(PHI)
      DCY1=DSIN(THETA)*DSIN(PHI)
C
      VTOT=CONST9*DSQRT(E1)
      CX1=DCX1*VTOT
      CY1=DCY1*VTOT
      CZ1=DCZ1*VTOT
      F4=2.0D0*DACOS(-1.0D0)
      DELTAE=EFINAL/DFLOAT(INTEM)
      J2M=NMAX/ISAMP
C MAIN LOOP
      DO 210 J1=1,J2M
    1 R1=drand48(RDUM)
      I=DINT(E1/DELTAE)+1
      I=DMIN0(I,INTEM)
      TLIM=TCFMAX(I)
      T=-DLOG(R1)/TLIM+TDASH
      TDASH=T
      WBT=WB*T
      COSWT=DCOS(WBT)
      SINWT=DSIN(WBT)
      DZ=(CZ1*SINWT+(EOVB-CY1)*(1.0D0-COSWT))/WB
      E=E1+DZ*EF100
      IE=DINT(E/ESTEP)+1
      IE=DMIN0(IE,N4000)
      IF(TCF(IE).GT.TLIM) THEN
       TDASH=TDASH+DLOG(R1)/TLIM
       TCFMAX(I)=1.05D0*TCFMAX(I)
       GO TO 1
      ENDIF
C
C     TEST FOR REAL OR NULL COLLISION
C
      R5=drand48(RDUM)
      TLIM=TCF(IE)/TLIM
      IF(R5.GT.TLIM) GO TO 1
C
C  CALCULATE DIRECTION COSINES AT INSTANT BEFORE COLLISION
C
      IF(IE.EQ.4000) THEN
C ELECTRON ENERGY OUT OF RANGE
       IELOW=1
       RETURN
      ENDIF
      TDASH=0.0D0
      CX2=CX1
      CY2=(CY1-EOVB)*COSWT+CZ1*SINWT+EOVB
      CZ2=CZ1*COSWT-(CY1-EOVB)*SINWT
      VTOT=DSQRT(CX2*CX2+CY2*CY2+CZ2*CZ2)
      DCX2=CX2/VTOT
      DCY2=CY2/VTOT
      DCZ2=CZ2/VTOT
C ---------------------------------------------------------------------
C     DETERMINATION OF REAL COLLISION TYPE
C ---------------------------------------------------------------------
      R2=drand48(RDUM)
C FIND LOCATION WITHIN 4 UNITS IN COLLISION ARRAY
      CALL SORT(I,R2,IE)
  140 I=I+1
      IF(CF(IE,I).LT.R2) GO TO 140
      S1=RGAS(I)
      EI=EIN(I)
      IF(IPN(I).LE.0) GO TO 666
      R9=drand48(RDUM)
      EXTRA=R9*(E-EI)
      EI=EXTRA+EI
C
C  GENERATE SCATTERING ANGLES AND UPDATE  LABORATORY COSINES AFTER
C   COLLISION ALSO UPDATE ENERGY OF ELECTRON.
C
  666 IPT=IARRY(I)
      IF(E.LT.EI) THEN
       EI=E-0.0001D0
      ENDIF
      S2=(S1*S1)/(S1-1.0D0)
      R3=drand48(RDUM)
      IF(INDEX(I).EQ.1) THEN
       R31=drand48(RDUM)
       F3=1.0D0-R3*ANGCT(IE,I)
       IF(R31.GT.PSCT(IE,I)) F3=-F3
      ELSE IF(INDEX(I).EQ.2) THEN
       EPSI=PSCT(IE,I)
       F3=1.0D0-(2.0D0*R3*(1.0D0-EPSI)/(1.0D0+EPSI*(1.0D0-2.0D0*R3)))
      ELSE
       F3=1.0D0-2.0D0*R3
      ENDIF
      THETA0=DACOS(F3)
      R4=drand48(RDUM)
      PHI0=F4*R4
      F8=DSIN(PHI0)
      F9=DCOS(PHI0)
      ARG1=1.0D0-S1*EI/E
      ARG1=DMAX1(ARG1,SMALL)
      D=1.0D0-F3*DSQRT(ARG1)
      E1=E*(1.0D0-EI/(S1*E)-2.0D0*D/S2)
      E1=DMAX1(E1,SMALL)
      Q=DSQRT((E/E1)*ARG1)/S1
      Q=DMIN1(Q,1.0D0)
      THETA=DASIN(Q*DSIN(THETA0))
      F6=DCOS(THETA)
      U=(S1-1.0D0)*(S1-1.0D0)/ARG1
      CSQD=F3*F3
      IF(F3.LT.0.0D0.AND.CSQD.GT.U) F6=-1.0D0*F6
      F5=DSIN(THETA)
      DCZ2=DMIN1(DCZ2,1.0D0)
      VTOT=CONST9*DSQRT(E1)
      ARGZ=DSQRT(DCX2*DCX2+DCY2*DCY2)
      IF(ARGZ.EQ.0.0D0) THEN
       DCZ1=F6
       DCX1=F9*F5
       DCY1=F8*F5
       GO TO 130
      ENDIF
      DCZ1=DCZ2*F6+ARGZ*F5*F8
      DCY1=DCY2*F6+(F5/ARGZ)*(DCX2*F9-DCY2*DCZ2*F8)
      DCX1=DCX2*F6-(F5/ARGZ)*(DCY2*F9+DCX2*DCZ2*F8)
  130 CX1=DCX1*VTOT
      CY1=DCY1*VTOT
      CZ1=DCZ1*VTOT
C LOOP
  210 CONTINUE
      IELOW=0
      RETURN
      END
      SUBROUTINE ELIMITC(IELOW)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/CNSTS1/CONST1,CONST2,CONST3,CONST4,CONST5
      COMMON/SETP/TMAX,SMALL,API,ESTART,THETA,PHI,TCFMAX(8),RSTART,
     /EFIELD,NMAX
      COMMON/BFLD/EOVB,WB,BTHETA,BMAG
      COMMON/LARGE/CF(4000,512),EIN(512),TCF(4000),IARRY(512),RGAS(512),
     /IPN(512),WPL(512),LAST,ISIZE,PENFRA(3,512)
      COMMON/ANIS/PSCT(4000,512),ANGCT(4000,512),INDEX(512),NISO
C -------------------------------------------------------------------
C   CALCULATES COLLISION EVENTS AND TESTS TO FIND IF THE UPPER ENERGY
C   LIMIT FOR THE ELECTRON ENERGY IS EXCEEDED.
C    IF ENERGY LIMIT IS OK       IELOW = 0
C    IF ENERGY LIMIT IS EXCEEDED IELOW = 1
C   THE TEST IS CARRIED OUT FOR A SAMPLE OF COLLISIONS THAT ARE
C   SMALLER THAN THE FULL SAMPLE BY A FACTOR OF 1/ISAMP
C
C   USED WITH MAGNETIC FIELD B AT ANGLES BETWEEN 0 AND 90 DEGREES TO
C   THE ELECTRIC FIELD.
C -------------------------------------------------------------------
      ISAMP=20
      SMALL=1.0D-20
      RTHETA=BTHETA*DACOS(-1.0D0)/180.0D0
      EFZ100=EFIELD*100.0D0*DSIN(RTHETA)
      EFX100=EFIELD*100.0D0*DCOS(RTHETA)
      F1=EFIELD*CONST2*DCOS(RTHETA)
      EOVBR=EOVB*DSIN(RTHETA)
      RDUM=RSTART
      E1=ESTART
      N4000=4000
      INTEM=8
      TDASH=0.0D0
      CONST9=CONST3*0.01D0
C
C     INITIAL DIRECTION COSINES
C
      DCZ1=DCOS(THETA)
      DCX1=DSIN(THETA)*DCOS(PHI)
      DCY1=DSIN(THETA)*DSIN(PHI)
C
      VTOT=CONST9*DSQRT(E1)
      CX1=DCX1*VTOT
      CY1=DCY1*VTOT
      CZ1=DCZ1*VTOT
      F4=2.0D0*DACOS(-1.0D0)
      DELTAE=EFINAL/DFLOAT(INTEM)
      J2M=NMAX/ISAMP
C MAIN LOOP
      DO 210 J1=1,J2M
    1 R1=drand48(RDUM)
      I=DINT(E1/DELTAE)+1
      I=DMIN0(I,INTEM)
      TLIM=TCFMAX(I)
      T=-DLOG(R1)/TLIM+TDASH
      TDASH=T
      WBT=WB*T
      COSWT=DCOS(WBT)
      SINWT=DSIN(WBT)
      DZ=(CZ1*SINWT+(EOVBR-CY1)*(1.0D0-COSWT))/WB
      DX=CX1*T+F1*T*T
      E=E1+DZ*EFZ100+DX*EFX100
      IE=DINT(E/ESTEP)+1
      IE=DMIN0(IE,N4000)
      IF(TCF(IE).GT.TLIM) THEN
       TDASH=TDASH+DLOG(R1)/TLIM
       TCFMAX(I)=1.05D0*TCFMAX(I)
       GO TO 1
      ENDIF
C
C     TEST FOR REAL OR NULL COLLISION
C
      R5=drand48(RDUM)
      TLIM=TCF(IE)/TLIM
      IF(R5.GT.TLIM) GO TO 1
C
C  CALCULATE DIRECTION COSINES AT INSTANT BEFORE COLLISION
C
      IF(IE.EQ.4000) THEN
C ELECTRON ENERGY OUT OF RANGE
       IELOW=1
       RETURN
      ENDIF
      TDASH=0.0D0
      CX2=CX1+2.0D0*F1*T
      CY2=(CY1-EOVBR)*COSWT+CZ1*SINWT+EOVBR
      CZ2=CZ1*COSWT-(CY1-EOVBR)*SINWT
      VTOT=DSQRT(CX2*CX2+CY2*CY2+CZ2*CZ2)
      DCX2=CX2/VTOT
      DCY2=CY2/VTOT
      DCZ2=CZ2/VTOT
C ---------------------------------------------------------------------
C     DETERMINATION OF REAL COLLISION TYPE
C ---------------------------------------------------------------------
      R2=drand48(RDUM)
C FIND LOCATION WITHIN 4 UNITS IN COLLISION ARRAY
      CALL SORT(I,R2,IE)
  140 I=I+1
      IF(CF(IE,I).LT.R2) GO TO 140
      S1=RGAS(I)
      EI=EIN(I)
      IF(IPN(I).LE.0) GO TO 666
      R9=drand48(RDUM)
      EXTRA=R9*(E-EI)
      EI=EXTRA+EI
C
C  GENERATE SCATTERING ANGLES AND UPDATE  LABORATORY COSINES AFTER
C   COLLISION ALSO UPDATE ENERGY OF ELECTRON.
C
  666 IPT=IARRY(I)
      IF(E.LT.EI) THEN
       EI=E-0.0001D0
      ENDIF
      S2=(S1*S1)/(S1-1.0D0)
      R3=drand48(RDUM)
      IF(INDEX(I).EQ.1) THEN
       R31=drand48(RDUM)
       F3=1.0D0-R3*ANGCT(IE,I)
       IF(R31.GT.PSCT(IE,I)) F3=-F3
      ELSE IF(INDEX(I).EQ.2) THEN
       EPSI=PSCT(IE,I)
       F3=1.0D0-(2.0D0*R3*(1.0D0-EPSI)/(1.0D0+EPSI*(1.0D0-2.0D0*R3)))
      ELSE
       F3=1.0D0-2.0D0*R3
      ENDIF
      THETA0=DACOS(F3)
      R4=drand48(RDUM)
      PHI0=F4*R4
      F8=DSIN(PHI0)
      F9=DCOS(PHI0)
      ARG1=1.0D0-S1*EI/E
      ARG1=DMAX1(ARG1,SMALL)
      D=1.0D0-F3*DSQRT(ARG1)
      E1=E*(1.0D0-EI/(S1*E)-2.0D0*D/S2)
      E1=DMAX1(E1,SMALL)
      Q=DSQRT((E/E1)*ARG1)/S1
      Q=DMIN1(Q,1.0D0)
      THETA=DASIN(Q*DSIN(THETA0))
      F6=DCOS(THETA)
      U=(S1-1.0D0)*(S1-1.0D0)/ARG1
      CSQD=F3*F3
      IF(F3.LT.0.0D0.AND.CSQD.GT.U) F6=-1.0D0*F6
      F5=DSIN(THETA)
      DCZ2=DMIN1(DCZ2,1.0D0)
      VTOT=CONST9*DSQRT(E1)
      ARGZ=DSQRT(DCX2*DCX2+DCY2*DCY2)
      IF(ARGZ.EQ.0.0D0) THEN
       DCZ1=F6
       DCX1=F9*F5
       DCY1=F8*F5
       GO TO 130
      ENDIF
      DCZ1=DCZ2*F6+ARGZ*F5*F8
      DCY1=DCY2*F6+(F5/ARGZ)*(DCX2*F9-DCY2*DCZ2*F8)
      DCX1=DCX2*F6-(F5/ARGZ)*(DCY2*F9+DCX2*DCZ2*F8)
  130 CX1=DCX1*VTOT
      CY1=DCY1*VTOT
      CZ1=DCZ1*VTOT
C LOOP
  210 CONTINUE
      IELOW=0
      RETURN
      END
      SUBROUTINE ALPCALC
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/SETP/TMAX,SMALL,API,ESTART,THETA,PHI,TCFMAX(8),RSTART,
     /EFIELD,NMAX
      COMMON/SSTOUT/VDOUT,VDERR,WSOUT,WSERR,DLOUT,DLERR,DTOUT,DTERR,
     /ALPHSST,ALPHERR,ATTSST,ATTERR
      COMMON/TOFOUT/RALPHA,RALPER,TOFENE,TOFENER,TOFWV,TOFWVER,
     /TOFDL,TOFDLER,TOFDT,TOFDTER,TOFWR,TOFWRER,RATTOF,RATOFER
      COMMON/VEL/WX,WY,WZ
      COMMON/CTOWNS/ALPHA,ATT
      COMMON/CTWNER/ALPER,ATTER
      COMMON/CTCALC/ZPLANE1,ZPLANE2,ZPLANE3,ZPLANE4,ZPLANE5,ZPLANE6,
     /ZPLANE7,ZPLANE8,IZFINAL
      COMMON/CION/ALPHAST,VDST,TSTEP,ZSTEP,TFINAL,ZFINAL,ITFINAL,IPRIM
C ---------------------------------------------------------------------
C  ESTIMATE TIME STEP AND SPACE STEPS FOR AVALANCHE SIMULATION IN
C  TIME OF FLIGHT AND STEADY STATE TOWNSEND SIMULATIONS.
C  USES ESTIMATED GAIN OF 3.0 BETWEEN PLANES.
C  CALLS SST AND TOF SUBROUTINES AND UPDATES ALPHA AND ATT
C ------------------------------------------------------------------
      IMAX=NMAX/10000000
      IF(IMAX.LT.5) IMAX=5
      NMAX=IMAX*10000000
      ALPHAST=0.85D0*DABS(ALPHA-ATT)
      VDST=WZ*1.D-5
      TSTEP=DLOG(3.0D0)/(ALPHAST*VDST*1.0D5)
      ZSTEP=DLOG(3.0D0)/ALPHAST
C  CONVERT TO METRES AND PICOSECONDS
      TSTEP=TSTEP*1.0D12
      ZSTEP=ZSTEP*0.01D0
      TFINAL=7.0D0*TSTEP
      ITFINAL=7
      ZFINAL=8.0D0*ZSTEP
      IZFINAL=8
      ZPLANE1=ZSTEP
      ZPLANE2=2.0D0*ZSTEP
      ZPLANE3=3.0D0*ZSTEP
      ZPLANE4=4.0D0*ZSTEP
      ZPLANE5=5.0D0*ZSTEP
      ZPLANE6=6.0D0*ZSTEP
      ZPLANE7=7.0D0*ZSTEP
      ZPLANE8=8.0D0*ZSTEP
C CALC SST
      WRITE(6,11)
   11 FORMAT(/,2X,'SOLUTION FOR STEADY STATE TOWNSEND PARAMETERS',/,'  -
     /------------------------------------------------')
      ZSTEPM=ZSTEP*1.0D6
      WRITE(6,12) ZSTEPM
   12 FORMAT(1(/),' SPACE STEP BETWEEN SAMPLING PLANES =',D12.5,' MICRON
     /S.',/)
      CALL MONTEFD
      CALL SST
C--------------------------------------------------------
C LOAD NEW ALPHA AND ATTACHMENT INTO COMMON BLOCKS
C-----------------------------------------------
      ALPHA=ALPHSST
      ALPER=ALPHERR
      ATT=ATTSST
      ATTER=ATTERR
C-----------------------------------------------
      WRITE(6,18)
   18 FORMAT(/,' SST DRIFT VELOCITIES')
      WRITE(6,19) VDOUT,VDERR,WSOUT,WSERR
   19 FORMAT(/,' VD=',F9.1,' +- ',F6.2,' %   WS=',F9.1,' +- ',F6.2,' %')
      WRITE(6,20)
   20 FORMAT(/,' SST DIFFUSION')
      WRITE(6,21) DLOUT,DLERR,DTOUT,DTERR
   21 FORMAT(/,' DL=',F9.1,' +- ',F6.1,' %   DT=',F9.1,' +- ',F6.2,' %')
      WRITE(6,22)
   22 FORMAT(/,' SST TOWNSEND COEFICIENTS')
      WRITE(6,23) ALPHSST,ALPHERR,ATTSST,ATTERR
   23 FORMAT(/,' ALPHA=',F9.1,' +- ',F6.2,' %    ATT=',F9.1,' +- ',F6.2,
     /' %')
C CALC TIME OF FLIGHT AND PT
      WRITE(6,25)
   25 FORMAT(/,2X,'SOLUTION FOR PULSED TOWNSEND AND TIME OF FLIGHT PARAM
     /ETERS',/,'  ------------------------------------------------------
     /--------')
      WRITE(6,26) TSTEP
   26 FORMAT(1(/),'  TIME STEP BETWEEN SAMPLING PLANES =',D12.5,' PICOSE
     /CS.',/)
      CALL MONTEFT
      CALL FRIEDLAND
      CALL PT
      CALL TOF
      WRITE(6,27) RALPHA,RALPER,RATTOF,RATOFER
   27 FORMAT(/,' PT IONISATION AND ATTACHMENT RATES *10**12/SEC',/,' ALP
     /HA=',D10.3,' +- ',F6.2,' %      ATT=',D10.3,' +- ',F6.2,' %')
      WRITE(6,28)
   28 FORMAT(/,' TOF DIFFUSION')
      WRITE(6,29) TOFDL,TOFDLER,TOFDT,TOFDTER
   29 FORMAT(/,'  DL=',F8.1,' +- ',F6.1,' %       DT=',F8.1,' +- ',F6.1,
     /' %')
      WRITE(6,30)
   30 FORMAT(/,' TOF DRIFT VELOCITY')
      WRITE(6,31) TOFWR,TOFWRER
   31 FORMAT(/,'    WR=',F8.2,' +-',F6.1,' %')
      WRZN=TOFWR*1.0D05
      FC1=WRZN/(2.0D0*TOFDL)
      FC2=((RALPHA-RATTOF)*1.0D12)/TOFDL
      ALPTEST=FC1-DSQRT(FC1**2-FC2)
      WRITE(6,888) ALPTEST
  888 FORMAT(/,'TOWNSEND COEFICIENT (ALPHA-ATT) CALCULATED FROM TOF RESU
     /LTS:',/,' ALPHA-ATT /CM.=',D11.4)
      RETURN
      END
      SUBROUTINE MONTEFT
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      COMMON/CNSTS1/CONST1,CONST2,CONST3,CONST4,CONST5
      COMMON/SETP/TMAX,SMALL,API,ESTART,THETA,PHI,TCFMAX(8),RSTART,
     /EFIELD,NMAX
      COMMON/LARGE/CF(4000,512),EIN(512),TCF(4000),IARRY(512),RGAS(512),
     /IPN(512),WPL(512),IPLAST,ISIZE,PENFRA(3,512)
      COMMON/CION/ALPHAST,VDST,TSTEP,ZSTEP,TFINAL,ZFINAL,ITFINAL,IPRIM
      COMMON/OUTPT/TIME(300),ICOLL(30),SPEC(4000),TMAX1,
     /AVE,DEN,XID,X,Y,Z,ST,NNULL,ICOLN(512)
      COMMON/TTRM/ZTOT,TTOT,ZTOTS,TTOTS
      COMMON/IPT/XS(200),YS(200),ZS(200),TS(200),ES(200),
     /DCX(200),DCY(200),DCZ(200),IPL(200)
      COMMON/TPLOUT/ETPL(8),XTPL(8),YTPL(8),ZTPL(8),TTPL(8),XXTPL(8),
     /YYTPL(8),ZZTPL(8),VZTPL(8),NETPL(8),ATTOINT,ATTERT,AIOERT
      COMMON/ANIS/PSCT(4000,512),ANGCT(4000,512),INDEX(512),NISO
      DIMENSION EPRM(4000000),IESPECP(100)
C -------------------------------------------------------------------
C   CALCULATES COLLISION EVENTS AND UPDATES DIFFUSION AND VELOCITY.
C   THIS ROUTINE HANDLES TERMINATIONS AT FIXED DRIFT TIMES.
C -------------------------------------------------------------------
      S=0.0D0
      ST=0.0D0
      X=0.0D0
      Y=0.0D0
      Z=0.0D0
      ZTOT=0.0D0
      ZTOTS=0.0D0
      TTOT=0.0D0
      TTOTS=0.0D0
      SMALL=1.0D-20
      TMAX1=0.0D0
      RDUM=RSTART
      E1=ESTART
      CONST9=CONST3*0.01D0
      API=DACOS(-1.0D0)
      DO 25 I=1,300
   25 TIME(I)=0.0D0
      DO 26 I=1,30
   26 ICOLL(I)=0
      DO 27 I=1,512
   27 ICOLN(I)=0
      DO 28 I=1,4000
   28 SPEC(I)=0.0D0
      DO 33 I=1,100
   33 IESPECP(I)=0
      DO 34 I=1,8
      ETPL(I)=0.0D0
      XTPL(I)=0.0D0
      YTPL(I)=0.0D0
      ZTPL(I)=0.0D0
      TTPL(I)=0.0D0
      XXTPL(I)=0.0D0
      YYTPL(I)=0.0D0
      ZZTPL(I)=0.0D0
      VZTPL(I)=0.0D0
   34 NETPL(I)=0
      ID=0
      N4000=4000
      N300=300
      N100=100
      INTEM=8
      I100=0
      NCOL=0
      NNULL=0
      NELEC=0
      NEION=0
      NMXADD=0
      NPONT=0
      NCLUS=0
      J1=1
      ZSTRT=0.0D0
      TSSTRT=0.0D0
C     INITIAL DIRECTION COSINES
      DCZ1=DCOS(THETA)
      DCX1=DSIN(THETA)*DCOS(PHI)
      DCY1=DSIN(THETA)*DSIN(PHI)
      E100=E1
      DCZ100=DCZ1
      DCX100=DCX1
      DCY100=DCY1
      BP=EFIELD*EFIELD*CONST1
      F1=EFIELD*CONST2
      F2=EFIELD*CONST3
      F4=2.0D0*API
C SET TO MAXIMUM POSSIBLE COLLISION FREQ.
      TLIM=TCFMAX(1)
      DO 35 I=2,INTEM
   35 IF(TLIM.LT.TCFMAX(I)) TLIM=TCFMAX(I)
      JPRINT=NMAX/10
      IPRINT=0
      ITER=0
      IPLANE=0
      IPRIM=0
C  LOOP FOR NEW STARTING ELECTRONS
  544 IPRIM=IPRIM+1
      IF(IPRIM.GT.1) THEN
C CHECK IF PROGRAM WILL EXCEED MAXIMUM NUMBER OF ITERATIONS
C IN THIS CYCLE IF SO OUTPUT CURRENT RESULTS.
       IF(ITER.GT.NMAX) THEN
        IPRIM=IPRIM-1
        GO TO 700
       ENDIF
       X=0.0D0
       Y=0.0D0
       Z=0.0D0
       DCZ1=DCZ100
       DCX1=DCX100
       DCY1=DCY100
       E1=E100
       NCLUS=NCLUS+1
       ST=0.0D0
       TSSTRT=0.0D0
       ZSTRT=0.0D0
       IPLANE=0
      ENDIF
      IF(IPRIM.GT.4000000) THEN
      WRITE(6,944) IPRIM
 944  FORMAT(/,2X,'PROGRAM STOPPED TOO MANY PRIMARIES IPRIM =',I7)
      GO TO 700
      ENDIF
      EPRM(IPRIM)=E1
      IDUM=DINT(E1)+1
      IDUM=DMIN0(IDUM,N100)
      IESPECP(IDUM)=IESPECP(IDUM)+1
C START OF LOOP FOR NEWLY CREATED ELECTRONS
  555 TDASH=0.0D0
      NELEC=NELEC+1
      TSTOP=TSTEP+IPLANE*TSTEP
C MAIN LOOP
    1 CONTINUE
C     IF(ITER.GT.NMAX)  GO TO 315
      R1=drand48(RDUM)
      T=-DLOG(R1)/TLIM+TDASH
      TDASH=T
      AP=DCZ1*F2*DSQRT(E1)
  15  IF((T+ST).GE.TSTOP) THEN
       IPLANE=IPLANE+1
       TSTOP=TSTOP+TSTEP
C STORE POSITION AND ENERGY AT TIME PLANE =IPLANE.
       CALL TPLANE(T,E1,DCX1,DCY1,DCZ1,AP,BP,EFIELD,IPLANE)
C CHECK IF PASSED THROUGH MORE THAN ONE PLANE IN THIS STEP
       IF((T+ST).GE.TSTOP.AND.TSTOP.LE.TFINAL) GO TO 15
       IF((T+ST).GE.TFINAL) THEN
        ZTOT=ZTOT+Z
        TTOT=TTOT+ST
        ZTOTS=ZTOTS+Z-ZSTRT
        TTOTS=TTOTS+ST-TSSTRT
        TSTOP=TSTEP
C NO MORE ELECTRONS IN CASCADE TRY NEW PRIMARY ELECTRON
        IF(NELEC.EQ.(NCLUS+1)) GO TO 544
C TAKE ELECTRONS FROM STORE
   20   X=XS(NPONT)
        Y=YS(NPONT)
        Z=ZS(NPONT)
        ST=TS(NPONT)
        E1=ES(NPONT)
        DCX1=DCX(NPONT)
        DCY1=DCY(NPONT)
        DCZ1=DCZ(NPONT)
        IPLANE=IPL(NPONT)
        NPONT=NPONT-1
        ZSTRT=Z
        TSSTRT=ST
        GO TO 555
       ENDIF
      ENDIF
 913  FORMAT(3X,' AFTER STORE ITER=',I10,' E1=',D12.3,' T=',D12.3,' AP='
     /,D12.3,' BP=',D12.3,' DCZ1=',D12.3)
      E=E1+(AP+BP*T)*T
      IF(E.LT.0.0D0) THEN
       WRITE(6,913)ITER,E,E1,AP,BP,DCZ1
       E=0.001D0
      ENDIF
      IE=DINT(E/ESTEP)+1
      IE=DMIN0(IE,N4000)
C
C     TEST FOR REAL OR NULL COLLISION
C
      R5=drand48(RDUM)
      TTEM=TCF(IE)/TLIM
      IF(R5.LE.TTEM)GO TO 137
      NNULL=NNULL+1
      GO TO 1
C
C  CALCULATE DIRECTION COSINES AND POSITIONS AT INSTANT BEFORE COLLISION
C    ALSO UPDATE DIFFUSION  AND ENERGY CALCULATIONS.
  137 T2=T*T
      IF(T.GE.TMAX1) TMAX1=T
      TDASH=0.0D0
      CONST6=DSQRT(E1/E)
      DCX2=DCX1*CONST6
      DCY2=DCY1*CONST6
      DCZ2=DCZ1*CONST6+EFIELD*T*CONST5/DSQRT(E)
      CONST7=CONST9*DSQRT(E1)
      A=T*CONST7
      NCOL=NCOL+1
      X=X+DCX1*A
      Y=Y+DCY1*A
      Z=Z+DCZ1*A+T2*F1
      ST=ST+T
      IT=DINT(T+1.0D0)
      IT=DMIN0(IT,N300)
      TIME(IT)=TIME(IT)+1.0D0
      SPEC(IE)=SPEC(IE)+1.0D0
C ---------------------------------------------------------------------
C     DETERMINATION OF REAL COLLISION TYPE
C ---------------------------------------------------------------------
C     R2=RNDM2(RDUM)
      R2=drand48(RDUM)
C FIND LOCATION WITHIN 4 UNITS IN COLLISION ARRAY
      CALL SORT(I,R2,IE)
  140 I=I+1
      IF(CF(IE,I).LT.R2) GO TO 140
      S1=RGAS(I)
      EI=EIN(I)
      IF(E.LT.EI) THEN
C     WRITE(6,994) E,EI,ITER
C994  FORMAT(2X,' WARNING ENERGY =',F8.3,' LESS THAN ENERGY LOSS EI=',F8
C    /.3,' AT ITER=',I12,' DUE TO BINNING ERROR')
C FIX ENERGY LOSS SMALLER THAN INCIDENT ENERGY IF A BINING ERROR OCCURS.
      EI=E-0.0001D0
      ENDIF
      IF(IPN(I).EQ.0) GO TO 666
C ATTACHMENT
      IF(IPN(I).EQ.-1) THEN
       NEION=NEION+1
       IPT=IARRY(I)
       ID=ID+1
       ITER=ITER+1
       IPRINT=IPRINT+1
       ICOLL(IPT)=ICOLL(IPT)+1
       ICOLN(I)=ICOLN(I)+1
       IT=DINT(T+1.0D0)
       IT=DMIN0(IT,N300)
       TIME(IT)=TIME(IT)+1.0D0
       ZTOT=ZTOT+Z
       TTOT=TTOT+ST
       ZTOTS=ZTOTS+Z-ZSTRT
       TTOTS=TTOTS+ST-TSSTRT
C  ELECTRON CAPTURED START NEW PRIMARY
       IF(NELEC.EQ.(NCLUS+1)) GO TO 544
C ELECTRON CAPTURED TAKE NEXT ELECTRON FROM STORE
       GO TO 20
      ENDIF
      R9=drand48(RDUM)
C     ESEC=R9*(E-EI)
C    USE OPAL PETERSON AND BEATY SPLITTING FACTOR.
      ESEC=WPL(I)*TAN(R9*ATAN((E-EI)/(2.0D0*WPL(I))))
      EI=ESEC+EI
C STORE POSITION ,ENERGY, DIRECTION COSINES AND TIME OF GENERATION
C OF IONISATION ELECTRON
      NCLUS=NCLUS+1
      NPONT=NPONT+1
      NMXADD=MAX(NPONT,NMXADD)
      IF(NPONT.GT.200) THEN
      WRITE(6,546) NPONT,ITER
 546  FORMAT(2X,' PROGRAM STOPPED . NPONT=',I4,' ITER=',I10)
      STOP
      ENDIF
      XS(NPONT)=X
      YS(NPONT)=Y
      ZS(NPONT)=Z
      TS(NPONT)=ST
      ES(NPONT)=ESEC
C RANDOMISE SECONDARY ELECTRON DIRECTION
      R3=drand48(RDUM)
      F3=1.0D0-2.0D0*R3
      THETA0=DACOS(F3)
      F6=DCOS(THETA0)
      F5=DSIN(THETA0)
      R4=drand48(rdum)
      PHI0=F4*R4
      F8=DSIN(PHI0)
      F9=DCOS(PHI0)
      DCX(NPONT)=F9*F5
      DCY(NPONT)=F8*F5
      DCZ(NPONT)=F6
      IPL(NPONT)=IPLANE
C
C  GENERATE SCATTERING ANGLES AND UPDATE  LABORATORY COSINES AFTER
C   COLLISION ALSO UPDATE ENERGY OF ELECTRON.
C
  666 IPT=IARRY(I)
      ID=ID+1
      ITER=ITER+1
      IPRINT=IPRINT+1
      ICOLL(IPT)=ICOLL(IPT)+1
      ICOLN(I)=ICOLN(I)+1
C IF EXCITATION THEN ADD PROBABILITY ,PENFRA(1,I), OF TRANSFER TO GIVE
C IONISATION OF THE OTHER GASES IN THE MIXTURE.
      IF(IPEN.EQ.0) GO TO 5
      IF(PENFRA(1,I).NE.0.0) THEN
       RAN=drand48(RDUM)
       IF(RAN.GT.PENFRA(1,I)) GO TO 5
       NCLUS=NCLUS+1
       NPONT=NPONT+1
       IF(NPONT.GT.200) THEN
        WRITE(6,546) NPONT,ITER
        STOP
       ENDIF
C ENTER HERE POSSIBLE DELOCALISATION LENGTH FOR PENNING TRANSFER
       IF(PENFRA(2,I).EQ.0.0) THEN
        XS(NPONT)=X
        YS(NPONT)=Y
        ZS(NPONT)=Z
        GO TO 667
       ENDIF
       ASIGN=1.0
       RAN=drand48(RDUM)
       RAN1=drand48(RDUM)
       IF(RAN1.LT.0.5) ASIGN=-ASIGN
       XS(NPONT)=X-DLOG(RAN)*PENFRA(2,I)*ASIGN
       RAN=drand48(RDUM)
       RAN1=drand48(RDUM)
       IF(RAN1.LT.0.5) ASIGN=-ASIGN
       YS(NPONT)=Y-DLOG(RAN)*PENFRA(2,I)*ASIGN
       RAN=drand48(RDUM)
       RAN1=drand48(RDUM)
       IF(RAN1.LT.0.5) ASIGN=-ASIGN
       ZS(NPONT)=Z-DLOG(RAN)*PENFRA(2,I)*ASIGN
C POSSIBLE PENNING TRANSFER TIME
  667  TPEN=ST
       IF(PENFRA(3,I).EQ.0.0) GO TO 668
       RAN=drand48(RDUM)
       TPEN=ST-DLOG(RAN)*PENFRA(3,I)
  668  TS(NPONT)=TPEN
       ES(NPONT)=1.0
       DCX(NPONT)=DCX1
       DCY(NPONT)=DCY1
       DCZ(NPONT)=DCZ1
C FIND LAST TIME PLANE BEFORE TPEN
       TSTOP1=0.0
       IPLANE1=0
       DO 669 KDUM=1,ITFINAL
       TSTOP1=TSTEP+TSTOP1
       IF(TPEN.LT.TSTOP1) GO TO 670
       IPLANE1=IPLANE1+1
  669  CONTINUE
C PENNING TRANSFER OCCURS AFTER FINAL TIME PLANE CLEAR ENTRY
       NPONT=NPONT-1
       NCLUS=NCLUS-1
       GO TO 5
  670  IPL(NPONT)=IPLANE1
      ENDIF
    5 S2=(S1*S1)/(S1-1.0D0)
C ANISOTROPIC SCATTERING
      R3=drand48(RDUM)
      IF(INDEX(I).EQ.1) THEN
       R31=drand48(RDUM)
       F3=1.0D0-R3*ANGCT(IE,I)
       IF(R31.GT.PSCT(IE,I)) F3=-F3
      ELSE IF(INDEX(I).EQ.2) THEN
       EPSI=PSCT(IE,I)
       F3=1.0D0-(2.0D0*R3*(1.0D0-EPSI)/(1.0D0+EPSI*(1.0D0-2.0D0*R3)))
      ELSE
C ISOTROPIC SCATTERING
       F3=1.0D0-2.0D0*R3
      ENDIF
      THETA0=DACOS(F3)
      R4=drand48(RDUM)
      PHI0=F4*R4
      F8=DSIN(PHI0)
      F9=DCOS(PHI0)
      IF(E.LT.EI) EI=0.0D0
      ARG1=1.0D0-S1*EI/E
      ARG1=DMAX1(ARG1,SMALL)
      D=1.0D0-F3*DSQRT(ARG1)
      E1=E*(1.0D0-EI/(S1*E)-2.0D0*D/S2)
      E1=DMAX1(E1,SMALL)
      Q=DSQRT((E/E1)*ARG1)/S1
      Q=DMIN1(Q,1.0D0)
      THETA=DASIN(Q*DSIN(THETA0))
      F6=DCOS(THETA)
      U=(S1-1.0D0)*(S1-1.0D0)/ARG1
      CSQD=F3*F3
      IF(F3.LT.0.0D0.AND.CSQD.GT.U) F6=-1.0D0*F6
      F5=DSIN(THETA)
      DCZ2=DMIN1(DCZ2,1.0D0)
      ARGZ=DSQRT(DCX2*DCX2+DCY2*DCY2)
      IF(ARGZ.EQ.0.0D0) THEN
C      WRITE(6,9232) ITER,ID,E1
C9232  FORMAT(3X,'WARNING ARGZ= 0.0 AT ITER =',I10,' ID =',I10,' E1=',E1
C    /2.3)
       DCZ1=F6
       DCX1=F9*F5
       DCY1=F8*F5
       GO TO 190
      ENDIF
      DCZ1=DCZ2*F6+ARGZ*F5*F8
      DCY1=DCY2*F6+(F5/ARGZ)*(DCX2*F9-DCY2*DCZ2*F8)
      DCX1=DCX2*F6-(F5/ARGZ)*(DCY2*F9+DCX2*DCZ2*F8)
  190 CONTINUE
C STORE DIRECTION COSINES AND ENERGY AFTER N COLLISIONS
C FOR LATER REUSE IN PRIMARY GENERATION
      I100=I100+1
      IF(I100.EQ.200) THEN
       DCZ100=DCZ1
       DCX100=DCX1
       DCY100=DCY1
       E100=E1
       I100=0
      ENDIF
      IF(IPRINT.GT.JPRINT) GO TO 200
      GO TO 1
C    INTERMEDIATE PRINTOUT
 200  IPRINT=0
      W=ZTOTS/TTOTS
      W=W*1.0D+09
      JCT=ID/100000
C     IF(J1.EQ.1) WRITE(6,201)
C 201 FORMAT(/,7X,'INTERMEDIATE OUTPUT',/,'    VEL      POS        TIME
C    /       COUNT    ')
C     WRITE(6,202) W,ZTOTS,TTOTS,JCT
C 202 FORMAT(1X,F8.3,2(1X,D10.3),4X,I6)
      J1=J1+1
      GO TO 1
C  MAIN LOOP END
  700 XID=DFLOAT(ID)
      IF(NELEC.GT.IPRIM) THEN
       ANEION=DFLOAT(NEION)
       ANBT=DFLOAT(NELEC-IPRIM)
       ATTOINT=ANEION/ANBT
       ATTERT=DSQRT(ANEION)/ANEION
       AIOERT=DSQRT(ANBT)/ANBT
      ELSE
       ANEION=DFLOAT(NEION)
       ATTOINT=-1.0
       ATTERT=DSQRT(ANEION)/ANEION
      ENDIF
      JCT=ID/100000
      IF(J1.EQ.1) THEN
      WRITE(6,940) NCLUS,ITER
  940 FORMAT(2(/),' PROGRAM STOPPED  (TOO FEW COLLISIONS), DECREASE THE
     /ESTIMATED ALPHA.  NCLUS = ',I7,'  ITER =',I9)
      STOP
      ENDIF
      WRITE(6,878) NELEC,NEION,IPRIM
 878  FORMAT(/,' TOTAL NO OF ELECTRONS=',I10,/,' TOTAL NO OF NEG. IONS='
     /,I10,/,' TOTAL NO OF PRIMARIES=',I10)
      EPRMBAR=0.0D0
      E2PRM=0.0D0
      IF(IPRIM.EQ.1) RETURN
      DO 310 I=1,IPRIM
      E2PRM=E2PRM+EPRM(I)*EPRM(I)
 310  EPRMBAR=EPRMBAR+EPRM(I)
      EBAR=EPRMBAR/IPRIM
      EERR=DSQRT(E2PRM/IPRIM-EBAR**2)
      WRITE(6,836) EBAR,EERR
 836  FORMAT(/,2X,'AVERAGE ENERGY OF PRIMARY ELECTRON =',F10.3,' EV.',/,
     /'   ENERGY SPREAD OF PRIMARY ELECTRON =',F10.3,' EV.')
C     WRITE(6,835) (IESPECP(J),J=1,100)
C835  FORMAT(/,2X,'ENERGY SPECTRUM OF PRIMARY ELECTRONS IN 1 EV. BINS',/
C    /,10(2X,10I5,/))
      RETURN
  315 IF(ITER.GT.NMAX) THEN
       WRITE(6,991) ITER,NMAX,NPONT,NELEC,IPRIM,NMXADD
 991   FORMAT(2(/),' PROGRAM STOPPED.  ITER =',I10,'    NMAX =',I10,/,
     /' NPONT=',I4,' NELEC=',I8,' IPRIM=',I4,' NMXADD=',I3)
       STOP
      ENDIF
      RETURN
      END
      SUBROUTINE TPLANE(T,E1,DCX1,DCY1,DCZ1,AP,BP,EFLD,IPLANE)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS1/CONST1,CONST2,CONST3,CONST4,CONST5
      COMMON/CION/ALPHAST,VDST,TSTEP,ZSTEP,TFINAL,ZFINAL,ITFINAL,IPRIM
      COMMON/OUTPT/TIME(300),ICOLL(30),SPEC(4000),TMAX1,
     /AVE,DEN,XID,X,Y,Z,ST,NNULL,ICOLN(512)
      COMMON/TPLOUT/ETPL(8),XTPL(8),YTPL(8),ZTPL(8),TTPL(8),XXTPL(8),
     /YYTPL(8),ZZTPL(8),VZTPL(8),NETPL(8),ATTOINT,ATTERT,AIOERT
C-----------------------------------------------------------------------
C STORES POSITION, TIME AND ENERGY AND SUMS REQUIRED
C TO CALCULATE DEVIATIONS AND MEANS AT PLANE =IPLANE
C-----------------------------------------------------------------------
      TIMESP=IPLANE*TSTEP
C CALC TIME LEFT TO ARRIVE AT PLANE
      TIMLFT=TIMESP-ST
      T2LFT=TIMLFT*TIMLFT
      A=AP*TIMLFT
      B=BP*T2LFT
      EPLANE=E1+A+B
      CONST6=DSQRT(E1/EPLANE)
C     DCX2=DCX1*CONST6
C     DCY2=DCY1*CONST6
      DCZ2=DCZ1*CONST6+EFLD*TIMLFT*CONST5/DSQRT(EPLANE)
      XPLANE=X+DCX1*TIMLFT*DSQRT(E1)*CONST3*0.01D0
      YPLANE=Y+DCY1*TIMLFT*DSQRT(E1)*CONST3*0.01D0
      ZPLANE=Z+DCZ1*TIMLFT*DSQRT(E1)*CONST3*0.01D0+T2LFT*EFLD*CONST2
      VZPLANE=DCZ2*DSQRT(EPLANE)*CONST3*0.01D0
      XTPL(IPLANE)=XTPL(IPLANE)+XPLANE
      YTPL(IPLANE)=YTPL(IPLANE)+YPLANE
      ZTPL(IPLANE)=ZTPL(IPLANE)+ZPLANE
      XXTPL(IPLANE)=XXTPL(IPLANE)+XPLANE*XPLANE
      YYTPL(IPLANE)=YYTPL(IPLANE)+YPLANE*YPLANE
      ZZTPL(IPLANE)=ZZTPL(IPLANE)+ZPLANE*ZPLANE
      ETPL(IPLANE)=ETPL(IPLANE)+EPLANE
      TTPL(IPLANE)=TTPL(IPLANE)+ST+TIMLFT
      VZTPL(IPLANE)=VZTPL(IPLANE)+VZPLANE
      NETPL(IPLANE)=NETPL(IPLANE)+1
      RETURN
      END
      SUBROUTINE FRIEDLAND
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/FRED/FCION(4000),FCATT(4000)
      COMMON/OUTPT/TIME(300),ICOLL(30),SPEC(4000),TMAX1,
     /AVE,DEN,XID,X,Y,Z,ST,NNULL,ICOLN(512)
      COMMON/CNSTS1/CONST1,CONST2,CONST3,CONST4,CONST5
      COMMON/TTRM/ZTOT,TTOT,ZTOTS,TTOTS
      COMMON/LARGE/CF(4000,512),EIN(512),TCF(4000),IARRY(512),RGAS(512),
     /IPN(512),WPL(512),LAST,ISIZE,PENFRA(3,512)
      COMMON/MIX2/E(4000),EROOT(4000),QTOT(4000),QREL(4000),QINEL(4000),
     /QEL(4000)
      DIMENSION FR(4000)
C -------------------------------------------------------
C CALCULATE DISTRIBUTION FUNCTION USING FRIEDLAND TECHNIQUE
C CF: J.FRIEDLAND  PHYSICS OF FLUIDS 20(1461)1977
C  USE DITRIBUTION FUNCTION TO CALCULATE AVERAGE ENERGY
C  IONISATION RATE AND ATTACHMENT RATE.
C-----------------------------------------------------
      ALFBAR=0.0D0
      ATTBAR=0.0D0
      EBAR=0.0D0
      FSUM=0.0D0
      DO 100 I=1,4000
      FR(I)=SPEC(I)/TCF(I)
      EBAR=EBAR+E(I)*SPEC(I)/TCF(I)
      ALFBAR=ALFBAR+FCION(I)*SPEC(I)/TCF(I)
      ATTBAR=ATTBAR+FCATT(I)*SPEC(I)/TCF(I)
 100  FSUM=FSUM+FR(I)
      DO 200 I=1,4000
 200  FR(I)=FR(I)/FSUM
      EBAR=EBAR/TTOTS
      ALFBAR=ALFBAR/TTOTS
      ATTBAR=ATTBAR/TTOTS
      WRITE(6,900) EBAR,ALFBAR,ATTBAR
 900  FORMAT(2(/),' ESTIMATE USING FRIEDLAND :',/,' AVERAGE ENERGY =',F8
     /.3,'EV.',/,' AVERAGE IONISATION =',E11.4,' *10**12/SEC',/,' AVERAG
     /E ATTACHMENT =',E11.4,' *10**12/SEC')
      RETURN
      END
      SUBROUTINE PT
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CION/ALPHAST,VDST,TSTEP,ZSTEP,TFINAL,ZFINAL,ITFINAL,IPRIM
      COMMON/TPLOUT/ETPL(8),XTPL(8),YTPL(8),ZTPL(8),TTPL(8),XXTPL(8),
     /YYTPL(8),ZZTPL(8),VZTPL(8),NETPL(8),ATTOINT,ATTERT,AIOERT
      COMMON/PTTOF/RI(8),EPT(8),VZPT(8),TTEST(8)
      DIMENSION ANTPL(8)
C ------------------------------------------------
C CALCULATES PULSED TOWNSEND COEFFICIENTS
C-------------------------------------------------
      ANTPL(1)=DFLOAT(NETPL(1))
      RI(1)=(DLOG(ANTPL(1))-DLOG(DFLOAT(IPRIM)))/TSTEP
      EPT(1)=ETPL(1)/ANTPL(1)
      TTEST(1)=TTPL(1)/ANTPL(1)
      VZPT(1)=1.0D+09*VZTPL(1)/ANTPL(1)
      DO 10 I=2,ITFINAL
      IF(NETPL(I).EQ.0) THEN
       ITFINAL=I-1
       GO TO 11
      ENDIF
      ANTPL(I)=DFLOAT(NETPL(I))
      RI(I)=(DLOG(ANTPL(I))-DLOG(ANTPL(I-1)))/TSTEP
      EPT(I)=ETPL(I)/ANTPL(I)
      TTEST(I)=TTPL(I)/ANTPL(I)
      VZPT(I)=1.0D+09*VZTPL(I)/ANTPL(I)
  10  CONTINUE
  11  WRITE(6,900) ITFINAL
 900  FORMAT(2(/),' PULSED TOWNSEND RESULTS AT',I2,' SEQUENTIAL TIME PLA
     /NES',/,' PLANE NO.   (ION-ATT) FREQ.   ENERGY      WV      NO.OF E
     /LECTRONS',/)
      DO 20 IPL=1,ITFINAL
      WRITE(6,910) IPL,RI(IPL),EPT(IPL),VZPT(IPL),NETPL(IPL)
 910  FORMAT(2X,I2,4X,E15.4,7X,F7.2,4X,F7.2,3X,I8)
  20  CONTINUE
      RETURN
      END
      SUBROUTINE TOF
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CION/ALPHAST,VDST,TSTEP,ZSTEP,TFINAL,ZFINAL,ITFINAL,IPRIM
      COMMON/TPLOUT/ETPL(8),XTPL(8),YTPL(8),ZTPL(8),TTPL(8),XXTPL(8),
     /YYTPL(8),ZZTPL(8),VZTPL(8),NETPL(8),ATTOINT,ATTERT,AIOERT
      COMMON/TOFOUT/RALPHA,RALPER,TOFENE,TOFENER,TOFWV,TOFWVER,
     /TOFDL,TOFDLER,TOFDT,TOFDTER,TOFWR,TOFWRER,RATTOF,RATOFER
      COMMON/PTTOF/RI(8),EPT(8),VZPT(8),TTEST(8)
      DIMENSION DLTF(8),DXTF(8),DYTF(8),WR(8),ANTPL(8)
C----------------------------------------------------------
C CALCULATES TIME OF FLIGHT COEFFICIENTS
C---------------------------------------------
      ANTPL(1)=DFLOAT(NETPL(1))
      WR(1)=ZTPL(1)/(ANTPL(1)*TSTEP)
      DLTF(1)=((ZZTPL(1)/ANTPL(1))-(ZTPL(1)/ANTPL(1))**2)/(2.0D0*TSTEP)
      DXTF(1)=((XXTPL(1)/ANTPL(1))-(XTPL(1)/ANTPL(1))**2)/(2.0D0*TSTEP)
      DYTF(1)=((YYTPL(1)/ANTPL(1))-(YTPL(1)/ANTPL(1))**2)/(2.0D0*TSTEP)
      DO 10 I=2,ITFINAL
      ANTPL(I)=DFLOAT(NETPL(I))
      WR(I)=((ZTPL(I)/ANTPL(I))-(ZTPL(I-1)/ANTPL(I-1)))/TSTEP
      DLTF(I)=((ZZTPL(I)/ANTPL(I))-(ZTPL(I)/ANTPL(I))**2-(ZZTPL(I-1)/ANT
     /PL(I-1))+(ZTPL(I-1)/ANTPL(I-1))**2)/(2.0D0*TSTEP)
      DXTF(I)=((XXTPL(I)/ANTPL(I))-(XTPL(I)/ANTPL(I))**2-(XXTPL(I-1)/ANT
     /PL(I-1))+(XTPL(I-1)/ANTPL(I-1))**2)/(2.0D0*TSTEP)
      DYTF(I)=((YYTPL(I)/ANTPL(I))-(YTPL(I)/ANTPL(I))**2-(YYTPL(I-1)/ANT
     /PL(I-1))+(YTPL(I-1)/ANTPL(I-1))**2)/(2.0D0*TSTEP)
  10  CONTINUE
      DO 15 I=1,ITFINAL
      WR(I)=WR(I)*1.0D+09
      DLTF(I)=DLTF(I)*1.0D+16
      DXTF(I)=DXTF(I)*1.0D+16
      DYTF(I)=DYTF(I)*1.0D+16
  15  CONTINUE
      WRITE(6,900) ITFINAL
 900  FORMAT(2(/),' TIME OF FLIGHT RESULTS AT',I2,' SEQUENTIAL TIME PLAN
     /ES',/,' PLANE NO.        DL         DX          DY            WR',
     //)
      DO 20 IPL=1,ITFINAL
      WRITE(6,910) IPL,DLTF(IPL),DXTF(IPL),DYTF(IPL),WR(IPL)
 910  FORMAT(3X,I3,4X,3F12.1,4X,F8.2)
  20  CONTINUE
      IF(NETPL(1).GT.NETPL(ITFINAL)) THEN
C        NET ATTACHMENT TAKE RESULTS FROM PLANE 2
       TOFENE=EPT(2)
       TOFENER=100.0D0*DABS((EPT(2)-EPT(3))/(2.0D0*EPT(2)))
       TOFWV=VZPT(2)
       TOFWVER=100.0D0*DABS((VZPT(2)-VZPT(3))/(2.0D0*VZPT(2)))
       TOFDL=DLTF(2)
       TOFDLER=100.0D0*DABS((DLTF(2)-DLTF(3))/(2.0D0*DLTF(2)))
       TDT2=(DXTF(2)+DYTF(2))/2.0D0
       TDT3=(DXTF(3)+DYTF(3))/2.0D0
       TOFDT=TDT2
       TOFDTER=100.0D0*DABS((TDT2-TDT3)/(2.0D0*TDT2))
       TOFWR=WR(2)
       TOFWRER=100.0D0*DABS((WR(2)-WR(3))/(2.0D0*WR(2)))
        ANST2=DFLOAT(NETPL(2))
        ANST3=DFLOAT(NETPL(3))
        ANST4=ANST3-DSQRT(ANST3)
        ANST5=DLOG(ANST2/ANST3)
        ANST6=DLOG(ANST2/ANST4)
        ANST7=ANST6/ANST5
        ANST8=ANST7-1.0D0
       IF(ATTOINT.EQ.-1.0) THEN
C        NO IONISATION
        RALPHA=0.0D0
        RALPER=0.0D0
        RATTOF=-RI(2)
        RATOFER=100.0D0*DSQRT(ANST8**2+ATTERT**2)
       ELSE
        RALPHA=RI(2)/(1.0D0-ATTOINT)
        RALPER=100.0D0*DSQRT(ANST8**2+AIOERT**2)
        RATTOF=ATTOINT*RI(2)/(1.0D0-ATTOINT)
        RATOFER=100.0D0*DSQRT(ANST8**2+ATTERT**2)
       ENDIF
      ELSE
C NET IONISATION TAKE RESULTS FROM PLANE ITFINAL
       I1=ITFINAL
       I2=ITFINAL-1
       TOFENE=EPT(I1)
       TOFENER=100.0D0*DABS((EPT(I1)-EPT(I2))/(2.0D0*EPT(I1)))
       TOFWV=VZPT(I1)
       TOFWVER=100.0D0*DABS((VZPT(I1)-VZPT(I2))/(2.0D0*VZPT(I1)))
       TOFDL=DLTF(I1)
       TOFDLER=100.0D0*DABS((DLTF(I1)-DLTF(I2))/(2.0D0*DLTF(I1)))
       TDT1=(DXTF(I1)+DYTF(I1))/2.0D0
       TDT2=(DXTF(I2)+DYTF(I2))/2.0D0
       TOFDT=TDT1
       TOFDTER=100.0D0*DABS((TDT1-TDT2)/(2.0D0*TDT1))
       TOFWR=WR(I1)
       TOFWRER=100.0D0*DABS((WR(I1)-WR(I2))/(2.0D0*WR(I1)))
       ATER=DABS((RI(I1)-RI(I2))/(2.0D0*RI(I1)))
       RALPHA=RI(I1)/(1.0D0-ATTOINT)
       RALPER=100.0D0*DSQRT(ATER**2+AIOERT**2)
       RATTOF=ATTOINT*RI(I1)/(1.0D0-ATTOINT)
       IF(ATTOINT.NE.0.0D0) THEN
        RATOFER=100.0D0*DSQRT(ATER**2+ATTERT**2)
       ELSE
        RATOFER=0.0D0
       ENDIF
      ENDIF
      RETURN
      END
      SUBROUTINE MONTEFD
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      COMMON/CNSTS1/CONST1,CONST2,CONST3,CONST4,CONST5
      COMMON/SETP/TMAX,SMALL,API,ESTART,THETA,PHI,TCFMAX(8),RSTART,
     /EFIELD,NMAX
      COMMON/LARGE/CF(4000,512),EIN(512),TCF(4000),IARRY(512),RGAS(512),
     /IPN(512),WPL(512),LAST,ISIZE,PENFRA(3,512)
      COMMON/CION/ALPHAST,VDST,TSTEP,ZSTEP,TFINAL,ZFINAL,ITFINAL,IPRIM
      COMMON/OUTPT/TIME(300),ICOLL(30),SPEC(4000),TMAX1,
     /AVE,DEN,XID,X,Y,Z,ST,NNULL,ICOLN(512)
      COMMON/TTRM/ZTOT,TTOT,ZTOTS,TTOTS
      COMMON/IPS/XSS(200),YSS(200),ZSS(200),TSS(200),ESS(200),
     /DCXS(200),DCYS(200),DCZS(200),IPLS(200)
      COMMON/SPLOUT/ESPL(8),XSPL(8),YSPL(8),ZSPL(8),TSPL(8),XXSPL(8),
     /YYSPL(8),ZZSPL(8),VZSPL(8),TSSUM(8),TSSUM2(8),ATTOION,ATTIOER,
     /ATTATER,NESST(9)
      COMMON/SPL1/TMSPL(8),TTMSPL(8),RSPL(8),RRSPL(8),RRSPM(8)
      COMMON/CTCALC/ZPLANE1,ZPLANE2,ZPLANE3,ZPLANE4,ZPLANE5,ZPLANE6,
     /ZPLANE7,ZPLANE8,IZFINAL
      COMMON/ANIS/PSCT(4000,512),ANGCT(4000,512),INDEX(512),NISO
      DIMENSION EPRM(4000000),IESPECP(100)
C----------------------------------------------------------------------
C   CALCULATES COLLISION EVENTS AND UPDATES DIFFUSION AND VELOCITY.
C   THIS ROUTINE HANDLES TERMINATIONS AT FIXED DRIFT DISTANCES.
C -------------------------------------------------------------------
      S=0.0D0
      ST=0.0D0
      X=0.0D0
      Y=0.0D0
      Z=0.0D0
      ZTOT=0.0D0
      ZTOTS=0.0D0
      TTOT=0.0D0
      TTOTS=0.0D0
      SMALL=1.0D-20
      TMAX1=0.0D0
      RDUM=RSTART
      E1=ESTART
      CONST9=CONST3*0.01D0
      API=DACOS(-1.0D0)
      DO 25 I=1,300
   25 TIME(I)=0.0D0
      DO 26 I=1,30
   26 ICOLL(I)=0
      DO 27 I=1,512
   27 ICOLN(I)=0
      DO 28 I=1,4000
   28 SPEC(I)=0.0D0
      DO 33 I=1,100
   33 IESPECP(I)=0
      DO 34 I=1,8
      ESPL(I)=0.0D0
      XSPL(I)=0.0D0
      YSPL(I)=0.0D0
      ZSPL(I)=0.0D0
      TSPL(I)=0.0D0
      XXSPL(I)=0.0D0
      YYSPL(I)=0.0D0
      ZZSPL(I)=0.0D0
      VZSPL(I)=0.0D0
      TSSUM(I)=0.0D0
      TSSUM2(I)=0.0D0
      TMSPL(I)=0.0D0
      TTMSPL(I)=0.0D0
      RSPL(I)=0.0D0
      RRSPL(I)=0.0D0
      RRSPM(I)=0.0D0
   34 NESST(I)=0
      NESST(9)=0
      ID=0
      N4000=4000
      N300=300
      N100=100
      INTEM=8
      I100=0
      NCOL=0
      NNULL=0
      NELEC=0
      NEION=0
      NMXADD=0
      NPONT=0
      NCLUS=0
      J1=1
      ZSTRT=0.0D0
      TSSTRT=0.0D0
C     INITIAL DIRECTION COSINES
      DCZ1=DCOS(THETA)
      DCX1=DSIN(THETA)*DCOS(PHI)
      DCY1=DSIN(THETA)*DSIN(PHI)
      DCX100=DCX1
      DCY100=DCY1
      DCZ100=DCZ1
      E100=E1
      BP=EFIELD*EFIELD*CONST1
      F1=EFIELD*CONST2
      F2=EFIELD*CONST3
      F4=2.0D0*API
C SET TO MAXIMUM POSSIBLE COLLISION FREQ.
      TLIM=TCFMAX(1)
      DO 35 I=2,INTEM
   35 IF(TLIM.LT.TCFMAX(I)) TLIM=TCFMAX(I)
      JPRINT=NMAX/10
      IPRINT=0
      ITER=0
      IPRIM=0
C LOOP FOR NEW STARTING ELECTRONS
 544  IPRIM=IPRIM+1
      IZPLANE=0
      TZSTOP=1000.0D0
      IF(IPRIM.GT.1) THEN
C CHECK IF PROGRAM WILL EXCEED MAXIMUM NUMBER OF ITERATIONS IN THIS
C CYCLE , IF SO OUTPUT CURRENT RESULTS.
       IF(ITER.GT.NMAX) THEN
        IPRIM=IPRIM-1
        GO TO 700
       ENDIF
       X=0.0D0
       Y=0.0D0
       Z=0.0D0
       DCZ1=DCZ100
       DCX1=DCX100
       DCY1=DCY100
       NCLUS=NCLUS+1
       E1=E100
       ST=0.0D0
       ZSTRT=0.0D0
       TSSTRT=0.0D0
      ENDIF
      IF(IPRIM.GT.4000000) THEN
      WRITE(6,944) IPRIM
  944 FORMAT(2X,' PROGRAM STOPPED TOO MANY PRIMARIES IPRIM=',I7)
      STOP
      ENDIF
      EPRM(IPRIM)=E1
      IDUM=DINT(E1)+1
      IDUM=DMIN0(IDUM,N100)
      IESPECP(IDUM)=IESPECP(IDUM)+1
C START OF LOOP FOR NEWLY CREATED ELECTRONS .
 555  TDASH=0.0D0
      NELEC=NELEC+1
C MAIN LOOP
    1 CONTINUE
C     IF(ITER.GT.NMAX)  GO TO 315
      R1=drand48(RDUM)
      T=-DLOG(R1)/TLIM+TDASH
      TOLD=TDASH
      TDASH=T
      AP=DCZ1*F2*DSQRT(E1)
   15 IF(T.GE.TZSTOP.AND.TOLD.LT.TZSTOP) THEN
      TLFT=TZSTOP
C STORE POSITION AND ENERGY AT Z PLANE = IZPLANE.
C      IF(IZPLANE.EQ.0) WRITE(6,8876) IZPLANE
C8876  FORMAT(' IZPLANE=',I5)
       CALL SPLANE(T,E1,DCX1,DCY1,DCZ1,AP,BP,EFIELD,TLFT,IZPLANE)
C********************************************************************
C
C CHANGE  IF STATEMENT FROM (IZFINAL+1) TO (IZFINAL-1)
C FOR ANODE TERMINATION .
C*********************************************************************
       IF(IZPLANE.GE.(IZFINAL+1)) THEN
  18    ZTOT=ZTOT+Z
        TTOT=TTOT+ST
        ZTOTS=ZTOTS+Z-ZSTRT
        TTOTS=TTOTS+ST-TSSTRT
C NO MORE ELECTRONS IN CASCADE RETURN TO MAIN.
        IF(NELEC.EQ.(NCLUS+1)) GO TO 544
C TAKE ELECTRONS FROM STORE
   20   X=XSS(NPONT)
        Y=YSS(NPONT)
        Z=ZSS(NPONT)
        ST=TSS(NPONT)
        E1=ESS(NPONT)
        DCX1=DCXS(NPONT)
        DCY1=DCYS(NPONT)
        DCZ1=DCZS(NPONT)
        IZPLANE=IPLS(NPONT)
        NPONT=NPONT-1
        ZSTRT=Z
        TSSTRT=ST
        IF(Z.GT.ZFINAL) THEN
C CHECK IF ELECTRON HAS ENOUGH ENERGY TO GO BACK TO FINAL PLANE
         EPOT=EFIELD*(Z-ZFINAL)*100.0D0
         IF(E1.LT.EPOT) THEN
          NELEC=NELEC+1
          ISOL=1
          GO TO 18
         ENDIF
        ENDIF
        CALL TCALC(Z,DCZ1,E1,EFIELD,TZSTOP,TZSTOP1,ISOL,IZPLANE)
        IF(TZSTOP.EQ.-99.0D0) THEN
C CATCH RUNAWAY ELECTRONS AT HIGH FIELD
          NELEC=NELEC+1
          ISOL=1
          GO TO 18
        ENDIF
        GO TO 555
       ENDIF
C IF TWO SOLUTIONS REPEAT ENTRY FOR SECOND SOLUTION.
      IF(ISOL.EQ.2) THEN
       TZSTOP=TZSTOP1
       ISOL=1
       GO TO 15
      ENDIF
      ENDIF
      E=E1+(AP+BP*T)*T
      IF(E.LT.0.0D0) THEN
       WRITE(6,999) E,E1,AP,BP,T,DCZ1,ITER
 999   FORMAT(2X,' WARNING ENERGY LT.0. E=',D12.3,' E1=',D12.3,' AP=',D1
     /2.3,' BP=',D12.3,' T=',D12.3,/,' DCZ1=',D12.3,' ITER=',I10)
       E=0.001D0
      ENDIF
      IE=DINT(E/ESTEP)+1
      IE=DMIN0(IE,N4000)
C
C     TEST FOR REAL OR NULL COLLISION
C
      R5=drand48(RDUM)
      TTEM=TCF(IE)/TLIM
      IF(R5.LE.TTEM)GO TO 137
      NNULL=NNULL+1
      GO TO 1
C
C  CALCULATE DIRECTION COSINES AND POSITIONS AT INSTANT BEFORE COLLISION
C    ALSO UPDATE DIFFUSION  AND ENERGY CALCULATIONS.
  137 T2=T*T
      IF(T.GE.TMAX1) TMAX1=T
      TDASH=0.0D0
      CONST6=DSQRT(E1/E)
      DCX2=DCX1*CONST6
      DCY2=DCY1*CONST6
      DCZ2=DCZ1*CONST6+EFIELD*T*CONST5/DSQRT(E)
      A=AP*T
      B=BP*T2
      CONST7=CONST9*DSQRT(E1)
      A=T*CONST7
      NCOL=NCOL+1
      CZ1=DCZ1*CONST7
      X=X+DCX1*A
      Y=Y+DCY1*A
      Z=Z+DCZ1*A+T2*F1
      ST=ST+T
      IT=DINT(T+1.0D0)
      IT=DMIN0(IT,N300)
      TIME(IT)=TIME(IT)+1.0D0
      CX1=DCX1*CONST7
      CY1=DCY1*CONST7
      SPEC(IE)=SPEC(IE)+1.0D0
C ---------------------------------------------------------------------
C     DETERMINATION OF REAL COLLISION TYPE
C ---------------------------------------------------------------------
      R2=drand48(RDUM)
C FIND LOCATION WITHIN 4 UNITS IN COLLISION ARRAY
      CALL SORT(I,R2,IE)
  140 I=I+1
      IF(CF(IE,I).LT.R2) GO TO 140
      S1=RGAS(I)
      EI=EIN(I)
      IF(E.LT.EI) THEN
C FIX ENERGY LOSS SMALLER THAN INCIDENT ENERGY IF A BINING ERROR OCCURS.
C     WRITE(6,994) E,EI,ITER
C994  FORMAT(3X,' WARNING BINNING ERROR ENERGY =',F8.3,' EI=',F8.3,' ITE
C    /R =',I12)
      EI=E-0.0001D0
      ENDIF
      IF(IPN(I).EQ.0) GO TO 666
C ATTACHMENT
      IF(IPN(I).EQ.-1) THEN
       NEION=NEION+1
       IPT=IARRY(I)
       ID=ID+1
       ITER=ITER+1
       IPRINT=IPRINT+1
       ICOLL(IPT)=ICOLL(IPT)+1
       ICOLN(I)=ICOLN(I)+1
       IT=DINT(T+1.0D0)
       IT=DMIN0(IT,N300)
       TIME(IT)=TIME(IT)+1.0D0
       ZTOT=ZTOT+Z
       TTOT=TTOT+ST
       ZTOTS=ZTOTS+Z-ZSTRT
       TTOTS=TTOTS+ST-TSSTRT
       IDM1=1+DINT(Z/ZSTEP)
       IF(IDM1.LT.1) IDM1=1
       IF(IDM1.GT.9) IDM1=9
       NESST(IDM1)=NESST(IDM1)-1
C ELECTRON CAPTURED START NEW PRIMARY
       IF(NELEC.EQ.(NCLUS+1)) GO TO 544
C ELECTRON CAPTURED TAKE NEXT ELECTRON FROM STORE
       GO TO 20
      ENDIF
      R9=drand48(RDUM)
C     ESEC=R9*(E-EI)
C  USE OPAL PETERSON AND BEATY SPLITTING FACTOR.
      ESEC=WPL(I)*TAN(R9*ATAN((E-EI)/(2.0D0*WPL(I))))
C RESCALE ESEC BY WPL(I)*(ESEC/(WPL(I))**0.9524
      ESEC=WPL(I)*(ESEC/WPL(I))**0.9524
      EI=ESEC+EI
C STORE POSITION ,ENERGY, DIRECTION COSINES AND TIME OF GENERATION
C OF IONISATION ELECTRON
      NCLUS=NCLUS+1
      NPONT=NPONT+1
      NMXADD=MAX(NPONT,NMXADD)
      IF(NPONT.GT.200) THEN
      WRITE(6,546) NPONT,ITER
 546  FORMAT(2X,' PROGRAM STOPPED NPONT=',I3,' ITER=',I10)
      STOP
      ENDIF
      XSS(NPONT)=X
      YSS(NPONT)=Y
      ZSS(NPONT)=Z
      TSS(NPONT)=ST
      ESS(NPONT)=ESEC
C RANDOMISE SECONDARY ELECTRON DIRECTION
      R3=drand48(RDUM)
      F3=1.0D0-2.0D0*R3
      THETA0=DACOS(F3)
      F6=DCOS(THETA0)
      F5=DSIN(THETA0)
      R4=drand48(RDUM)
      PHI0=F4*R4
      F8=DSIN(PHI0)
      F9=DCOS(PHI0)
      DCXS(NPONT)=F9*F5
      DCYS(NPONT)=F8*F5
      DCZS(NPONT)=F6
      IDM1=1+DINT(Z/ZSTEP)
      IF(IDM1.LT.1) IDM1=1
      IF(IDM1.GT.9) IDM1=9
      IPLS(NPONT)=IDM1
      NESST(IPLS(NPONT))=NESST(IPLS(NPONT))+1
C
C  GENERATE SCATTERING ANGLES AND UPDATE  LABORATORY COSINES AFTER
C   COLLISION ALSO UPDATE ENERGY OF ELECTRON.
C
  666 IPT=IARRY(I)
      ID=ID+1
      ITER=ITER+1
      IPRINT=IPRINT+1
      ICOLL(IPT)=ICOLL(IPT)+1
      ICOLN(I)=ICOLN(I)+1
C IF EXCITATION THEN ADD PROBABILITY,PENFRA(1,I), OF TRANSFER TO GIVE
C IONISATION OF THE OTHER GASES IN THE MIXTURE.
      IF(IPEN.EQ.0) GO TO 5
      IF(PENFRA(1,I).NE.0.0) THEN
       RAN=drand48(RDUM)
       IF(RAN.GT.PENFRA(1,I)) GO TO 5
       NCLUS=NCLUS+1
       NPONT=NPONT+1
       IF(NPONT.GT.200) THEN
        WRITE(6,546) NPONT,ITER
        STOP
       ENDIF
C ENTER HERE POSSIBLE DELOCALISATION LENGTH FOR PENNING TRANSFER
       IF(PENFRA(2,I).EQ.0.0) THEN
        XSS(NPONT)=X
        YSS(NPONT)=Y
        ZSS(NPONT)=Z
        IF(ZSS(NPONT).GT.ZFINAL.OR.ZSS(NPONT).LT.0.0) GO TO 669
        GO TO 667
       ENDIF
       ASIGN=1.0
       RAN=drand48(RDUM)
       RAN1=drand48(RDUM)
       IF(RAN1.LT.0.5) ASIGN=-ASIGN
       XSS(NPONT)=X-DLOG(RAN)*PENFRA(2,I)*ASIGN
       RAN=drand48(RDUM)
       RAN1=drand48(RDUM)
       IF(RAN1.LT.0.5) ASIGN=-ASIGN
       YSS(NPONT)=Y-DLOG(RAN)*PENFRA(2,I)*ASIGN
       RAN=drand48(RDUM)
       RAN1=drand48(RDUM)
       IF(RAN1.LT.0.5) ASIGN=-ASIGN
       ZSS(NPONT)=Z-DLOG(RAN)*PENFRA(2,I)*ASIGN
       IF(ZSS(NPONT).LT.0.0) GO TO 669
       IF(ZSS(NPONT).GT.ZFINAL.OR.ZSS(NPONT).LT.0.0) GO TO 669
  667  TPEN=ST
       IF(PENFRA(3,I).EQ.0.) GO TO 668
       RAN=drand48(RDUM)
       TPEN=ST-DLOG(RAN)*PENFRA(3,I)
  668  TSS(NPONT)=TPEN
       ESS(NPONT)=1.0
       DCXS(NPONT)=DCX1
       DCYS(NPONT)=DCY1
       DCZS(NPONT)=DCZ1
C FIND LAST PLANE BEFORE ZSS(NPONT)
       IDM1=1+DINT(ZSS(NPONT)/ZSTEP)
       IF(IDM1.LT.1) IDM1=1
       IF(IDM1.GT.9) IDM1=9
       IPLS(NPONT)=IDM1
       NESST(IPLS(NPONT))=NESST(IPLS(NPONT))+1
       GO TO 5
C     PENNING TRANSFER OCCURS BEFORE FIRST SPACE PLANE CLEAR ENTRY
  669  NPONT=NPONT-1
       NCLUS=NCLUS-1
      ENDIF
    5 S2=(S1*S1)/(S1-1.0D0)
C ANISOTROPIC SCATTERING
      R3=drand48(RDUM)
      IF(INDEX(I).EQ.1) THEN
       R31=drand48(RDUM)
       F3=1.0D0-R3*ANGCT(IE,I)
       IF(R31.GT.PSCT(IE,I)) F3=-F3
      ELSE IF(INDEX(I).EQ.2) THEN
       EPSI=PSCT(IE,I)
       F3=1.0D0-(2.0D0*R3*(1.0D0-EPSI)/(1.0D0+EPSI*(1.0D0-2.0D0*R3)))
      ELSE
C ISOTROPIC SCATTERING
       F3=1.0D0-2.0D0*R3
      ENDIF
      THETA0=DACOS(F3)
      R4=drand48(RDUM)
      PHI0=F4*R4
      F8=DSIN(PHI0)
      F9=DCOS(PHI0)
      IF(E.LT.EI) EI=0.0D0
      ARG1=1.0D0-S1*EI/E
      ARG1=DMAX1(ARG1,SMALL)
      D=1.0D0-F3*DSQRT(ARG1)
      E1=E*(1.0D0-EI/(S1*E)-2.0D0*D/S2)
      E1=DMAX1(E1,SMALL)
      Q=DSQRT((E/E1)*ARG1)/S1
      Q=DMIN1(Q,1.0D0)
      THETA=DASIN(Q*DSIN(THETA0))
      F6=DCOS(THETA)
      U=(S1-1.0D0)*(S1-1.0D0)/ARG1
      CSQD=F3*F3
      IF(F3.LT.0.0D0.AND.CSQD.GT.U) F6=-1.0D0*F6
      F5=DSIN(THETA)
      DCZ2=DMIN1(DCZ2,1.0D0)
      ARGZ=DSQRT(DCX2*DCX2+DCY2*DCY2)
      IF(ARGZ.EQ.0.0D0) THEN
C      WRITE(6,9232) ITER,ID,E1
C9232  FORMAT(3X,' WARNING ARGZ= 0.0  AT ITER =',I10,' ID=',I10,' E1=',E
C    /12.3)
       DCZ1=F6
       DCX1=F9*F5
       DCY1=F8*F5
       GO TO 190
      ENDIF
      DCZ1=DCZ2*F6+ARGZ*F5*F8
      DCY1=DCY2*F6+(F5/ARGZ)*(DCX2*F9-DCY2*DCZ2*F8)
      DCX1=DCX2*F6-(F5/ARGZ)*(DCY2*F9+DCX2*DCZ2*F8)
 190  CONTINUE
C STORE DIRECTION COSINES AND ENERGY AFTER N COLLISIONS
C FOR LATER REUSE IN PRIMARY GENERATION.
      I100=I100+1
      IF(I100.EQ.200) THEN
       DCZ100=DCZ1
       DCX100=DCX1
       DCY100=DCY1
       E100=E1
       I100=0
      ENDIF
      IF(Z.GT.ZFINAL) THEN
C CHECK IF ELECTRON HAS ENOUGH ENERGY TO GO BACK TO FINAL PLANE.
       EPOT=EFIELD*(Z-ZFINAL)*100.0D0
       IF(E1.LT.EPOT) GO TO 18
      ENDIF
C CALCULATE TIME TZSTOP TO ARRIVE AT NEXT Z PLANE IZPLANE.
      CALL TCALC(Z,DCZ1,E1,EFIELD,TZSTOP,TZSTOP1,ISOL,IZPLANE)
C CATCH RUNAWAY ELECTRONS AT HIGH FIELD
      IF(TZSTOP.EQ.-99.0D0) GO TO 18
      IF(IPRINT.GT.JPRINT) GO TO 200
      GO TO 1
C    INTERMEDIATE PRINTOUT
 200  IPRINT=0
      W=ZTOTS/TTOTS
      W=W*1.0D+09
      XID=DFLOAT(ID)
      JCT=ID/100000
C     IF(J1.EQ.1) WRITE(6,201)
C 201 FORMAT(/,7X,'INTERMEDIATE OUTPUT',/,'    VEL       POS       TIME
C    /     COUNT')
C     WRITE(6,202) W,ZTOTS,TTOTS,JCT
C 202 FORMAT(1X,F8.3,2(1X,D10.3),1X,I6)
      J1=J1+1
      GO TO 1
C  MAIN LOOP END
  700 XID=DFLOAT(ID)
      IF(NELEC.GT.IPRIM) THEN
       ANEION=DFLOAT(NEION)
       ANBT=DFLOAT(NELEC-IPRIM)
       ATTOION=ANEION/ANBT
       ATTATER=DSQRT(ANEION)/ANEION
       ATTIOER=DSQRT(ANBT)/ANBT
      ELSE
       ATTOION=-1.0D0
       ANEION=DFLOAT(NEION)
       ATTATER=DSQRT(ANEION)/ANEION
      ENDIF
      JCT=ID/10000
      IF(J1.EQ.1) THEN
      WRITE(6,940) NCLUS,ITER,NELEC,NEION
  940 FORMAT(2(/),' PROGRAM STOPPED (TOO FEW COLLISIONS), DECREASE THE
     /ESTIMATED ALPHA.  NCLUS=',I7,'  ITER =',I9,' NELEC=',I9,' NEION ='
     /,I6)
      ENDIF
      WRITE(6,878) NELEC,NEION,IPRIM
 878  FORMAT(/,' TOTAL NO OF ELECTRONS=',I10,/,' TOTAL NO OF NEG. IONS='
     /,I10,/,' TOTAL NO OF PRIMARIES=',I10)
      EPRMBAR=0.0D0
      E2PRM=0.0D0
      IF(IPRIM.EQ.1) RETURN
      DO 310 I=1,IPRIM
      E2PRM=E2PRM+EPRM(I)*EPRM(I)
  310 EPRMBAR=EPRMBAR+EPRM(I)
      EBAR=EPRMBAR/IPRIM
      EERR=DSQRT(E2PRM/IPRIM-EBAR**2)
      WRITE(6,836) EBAR,EERR
  836 FORMAT(/,2X,'AVERAGE ENERGY OF PRIMARY ELECTRON =',F10.3,' EV.',/,
     /'   ENERGY SPREAD OF PRIMARY ELECTRON =',F10.3,' EV.')
C     WRITE(6,837) (IESPECP(J),J=1,100)
C 837 FORMAT(/,2X,'ENERGY SPECTRUM OF PRIMARIES IN 1EV BINS',/,10(2X,10I
C    /5,/))
      RETURN
  315 IF(ITER.GT.NMAX) THEN
       WRITE(6,991) ITER,NMAX,NPONT,NELEC,IPRIM,NMXADD
 991   FORMAT(2(/),' PROGRAM STOPPED.  ITER =',I10,'    NMAX =',I10,/,
     /' NPONT=',I4,' NELEC=',I8,' IPRIM=',I6,' NMXADD=',I3)
       STOP
      ENDIF
      RETURN
      END
      SUBROUTINE SPLANE(T,E1,DCX1,DCY1,DCZ1,AP,BP,EFLD,TIMLFT,IZPLANE)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS1/CONST1,CONST2,CONST3,CONST4,CONST5
      COMMON/OUTPT/TIME(300),ICOLL(30),SPEC(4000),TMAX1,
     /AVE,DEN,XID,X,Y,Z,ST,NNULL,ICOLN(512)
      COMMON/CION/ALPHAST,VDST,TSTEP,ZSTEP,TFINAL,ZFINAL,ITFINAL,IPRIM
      COMMON/SPLOUT/ESPL(8),XSPL(8),YSPL(8),ZSPL(8),TSPL(8),XXSPL(8),
     /YYSPL(8),ZZSPL(8),VZSPL(8),TSSUM(8),TSSUM2(8),ATTOION,ATTIOER,
     /ATTATER,NESST(9)
      COMMON/SPL1/TMSPL(8),TTMSPL(8),RSPL(8),RRSPL(8),RRSPM(8)
C--------------------------------------------------------
C STORES POSITION, TIME AND ENERGY AND SUMS REQUIRED
C TO CALCULATE DEVIATIONS AND MEANS AT PLANE =IZPLANE
C----------------------------------------------------
      IF(IZPLANE.GT.8) RETURN
      T2LFT=TIMLFT*TIMLFT
      A=AP*TIMLFT
      B=BP*T2LFT
      EPLANE=E1+A+B
      CONST6=DSQRT(E1/EPLANE)
C     DCX2=DCX1*CONST6
C     DCY2=DCY1*CONST6
      DCZ2=DCZ1*CONST6+EFLD*TIMLFT*CONST5/DSQRT(EPLANE)
      XPLANE=X+DCX1*TIMLFT*DSQRT(E1)*CONST3*0.01D0
      YPLANE=Y+DCY1*TIMLFT*DSQRT(E1)*CONST3*0.01D0
      ZPLANE=Z+DCZ1*TIMLFT*DSQRT(E1)*CONST3*0.01D0+T2LFT*EFLD*CONST2
      VZPLANE=DCZ2*DSQRT(EPLANE)*CONST3*0.01D0
      WGHT=DABS(1.0D0/VZPLANE)
      RPLANE=DSQRT(XPLANE**2+YPLANE**2)
      XSPL(IZPLANE)=XSPL(IZPLANE)+XPLANE*WGHT
      YSPL(IZPLANE)=YSPL(IZPLANE)+YPLANE*WGHT
      RSPL(IZPLANE)=RSPL(IZPLANE)+RPLANE*WGHT
      ZSPL(IZPLANE)=ZSPL(IZPLANE)+ZPLANE*WGHT
      TMSPL(IZPLANE)=TMSPL(IZPLANE)+(ST+TIMLFT)*WGHT
      TTMSPL(IZPLANE)=TTMSPL(IZPLANE)+(ST+TIMLFT)*(ST+TIMLFT)*WGHT
      XXSPL(IZPLANE)=XXSPL(IZPLANE)+XPLANE*XPLANE*WGHT
      YYSPL(IZPLANE)=YYSPL(IZPLANE)+YPLANE*YPLANE*WGHT
      RRSPM(IZPLANE)=RRSPM(IZPLANE)+RPLANE*RPLANE*WGHT
      ZZSPL(IZPLANE)=ZZSPL(IZPLANE)+ZPLANE*ZPLANE*WGHT
      ESPL(IZPLANE)=ESPL(IZPLANE)+EPLANE*WGHT
      TSPL(IZPLANE)=TSPL(IZPLANE)+WGHT/(ST+TIMLFT)
      VZSPL(IZPLANE)=VZSPL(IZPLANE)+VZPLANE*WGHT
      TSSUM(IZPLANE)=TSSUM(IZPLANE)+WGHT
      TSSUM2(IZPLANE)=TSSUM2(IZPLANE)+WGHT*WGHT
      RETURN
      END
      SUBROUTINE TCALC(Z,DCZ1,E1,EFIELD,TZSTOP1,TZSTOP2,ISOL,IZPLANE)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS1/CONST1,CONST2,CONST3,CONST4,CONST5
      COMMON/CION/ALPHAST,VDST,TSTEP,ZSTEP,TFINAL,ZFINAL,ITFINAL,IPRIM
      COMMON/CTCALC/ZPLANE1,ZPLANE2,ZPLANE3,ZPLANE4,ZPLANE5,ZPLANE6,
     /ZPLANE7,ZPLANE8,IZFINAL
C----------------------------------------------------------------------
C CALCULATE ELAPSED TIME ,TZSTOP1, UNTIL ARRIVAL AT NEXT PLANE ,IZPLANE.
C IF TWO POSITIVE SOLUTIONS SET ISOL=2 AND CALCULATE SECOND SOLUTION
C  TZSTOP2.
C-----------------------------------------------------------------------
      ISOL=1
      A=EFIELD*CONST2
      B=DSQRT(E1)*CONST3*0.01D0*DCZ1
      B2=B*B
      IF(Z.LT.ZPLANE1) THEN
       IZPLANE=1
       C1=Z-ZPLANE1
       ELSE IF(Z.LT.ZPLANE2) THEN
       IZPLANE=2
       C1=Z-ZPLANE2
       C2=Z-ZPLANE1
       ELSE IF(Z.LT.ZPLANE3) THEN
       IZPLANE=3
       C1=Z-ZPLANE3
       C2=Z-ZPLANE2
       ELSE IF(Z.LT.ZPLANE4) THEN
       IZPLANE=4
       C1=Z-ZPLANE4
       C2=Z-ZPLANE3
       ELSE IF(Z.LT.ZPLANE5) THEN
       IZPLANE=5
       C1=Z-ZPLANE5
       C2=Z-ZPLANE4
       ELSE IF(Z.LT.ZPLANE6) THEN
       IZPLANE=6
       C1=Z-ZPLANE6
       C2=Z-ZPLANE5
       ELSE IF(Z.LT.ZPLANE7) THEN
       IZPLANE=7
       C1=Z-ZPLANE7
       C2=Z-ZPLANE6
       ELSE IF(Z.LT.ZPLANE8) THEN
       IZPLANE=8
       C1=Z-ZPLANE8
       C2=Z-ZPLANE7
       ELSE
       IZPLANE=9
       C1=Z-ZPLANE8-10.0D0*ZSTEP
       C2=Z-ZPLANE8
       ENDIF
C CHECK PLANE IN DRIFT DIRECTION ( ONLY ONE TIME SOLUTION POSITIVE)
      FAC=B2-4.0D0*A*C1
      IF(FAC.LT.0.0D0) THEN
C PASSED FINAL PLANE  (RUNAWAY ELECTRONS)
       TZSTOP1=-99.0D0
       RETURN
      ENDIF
      TSTOP1=(-B+DSQRT(B2-4.0D0*A*C1))/(2.0D0*A)
      TSTOP2=(-B-DSQRT(B2-4.0D0*A*C1))/(2.0D0*A)
      IF(TSTOP1.LT.TSTOP2) THEN
       IF(TSTOP1.GE.0.0D0)THEN
        TZSTOP1=TSTOP1
       ELSE
        TZSTOP1=TSTOP2
       ENDIF
       IF(IZPLANE.EQ.1) RETURN
      ELSE
       IF(TSTOP2.GE.0.0D0) THEN
        TZSTOP1=TSTOP2
       ELSE
        TZSTOP1=TSTOP1
       ENDIF
       IF(IZPLANE.EQ.1) RETURN
      ENDIF
C CHECK PLANE IN BACKWARD DIRECTION (ONLY IF REAL SOLUTION)
      FAC=B2-4.0D0*A*C2
      IF(FAC.LT.0.0D0) RETURN
      TSTOP1=(-B+DSQRT(FAC))/(2.0D0*A)
      TSTOP2=(-B-DSQRT(FAC))/(2.0D0*A)
C SOLUTIONS CAN BE EITHER BOTH POSITIVE OR BOTH NEGATIVE
C PICK POSITIVE SOLUTIONS AND ORDER IN TIME SEQUENCE OR
C  RETURN IF NEGATIVE
      IF(TSTOP1.LT.0.0D0) RETURN
C  FOUND BACKWARD SOLUTIONS
      ISOL=2
      IZPLANE=IZPLANE-1
      IF(TSTOP1.LT.TSTOP2) THEN
       TZSTOP1=TSTOP1
       TZSTOP2=TSTOP2
      ELSE
       TZSTOP1=TSTOP2
       TZSTOP2=TSTOP1
      ENDIF
      RETURN
      END
      SUBROUTINE SST
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CION/ALPHAST,VDST,TSTEP,ZSTEP,TFINAL,ZFINAL,ITFINAL,IPRIM
      COMMON/SPLOUT/ESPL(8),XSPL(8),YSPL(8),ZSPL(8),TSPL(8),XXSPL(8),
     /YYSPL(8),ZZSPL(8),VZSPL(8),TSSUM(8),TSSUM2(8),ATTOION,ATTIOER,
     /ATTATER,NESST(9)
      COMMON/SPL1/TMSPL(8),TTMSPL(8),RSPL(8),RRSPL(8),RRSPM(8)
      COMMON/CTCALC/ZPLANE1,ZPLANE2,ZPLANE3,ZPLANE4,ZPLANE5,ZPLANE6,
     /ZPLANE7,ZPLANE8,IZFINAL
      COMMON/SSTOUT/VDOUT,VDERR,WSOUT,WSERR,DLOUT,DLERR,DTOUT,DTERR,
     /ALPHSST,ALPHERR,ATTSST,ATTERR
      DIMENSION ESST(8),VDSST(8),WSSST(8),DXSST(8),DYSST(8),WTEMP(8)
      DIMENSION DRSST(8)
      DIMENSION ALFNE(8),ALFNJ(8),ALFN(8),ZSST(8),DLSST(8)
      DIMENSION DRSS1(8),DRSS2(8),DRSS3(8),ALFEX1(8),NEPL(8)
C----------------------------------------------------------------------
C CALCULATES STEADY STATE TOWNSEND COEFFICIENTS.
C LOADS REULTS AND ERRORS INTO COMMON BLOCKS /SSTOUT/
C -------------------------------------------------------------------
      VDOUT=0.0D0
      VDERR=0.0D0
      WSOUT=0.0D0
      WSERR=0.0D0
      DLOUT=0.0D0
      DLERR=0.0D0
      DTOUT=0.0D0
      DTERR=0.0D0
      ALPHSST=0.0D0
      ALPHERR=0.0D0
      ATTSST=0.0D0
      ATTERR=0.0D0
      JPRINT=IZFINAL
C CALCULATE NUMBER OF ELECTRONS AT EACH PLANE
      NEPL(1)=IPRIM+NESST(1)
      DO 21 K=2,JPRINT
      NEPL(K)=NEPL(K-1)+NESST(K)
  21  CONTINUE
C  SUBSTITUTE NEPL FOR NEEST
      DO 22 K=1,JPRINT
  22  NESST(K)=NEPL(K)
      DO 23 I=1,JPRINT
      IF(NESST(I).EQ.0) THEN
       JPRINT=I-1
       GO TO 24
      ENDIF
  23  CONTINUE
  24  ESST(1)=ESPL(1)/TSSUM(1)
      ZSST(1)=ZSPL(1)/TSSUM(1)
      VDSST(1)=VZSPL(1)/TSSUM(1)
      WTEMP(1)=ZSTEP*TSSUM(1)/TMSPL(1)
      WSSST(1)=WTEMP(1)
      DXSST(1)=((XXSPL(1)/TSSUM(1))-(XSPL(1)/TSSUM(1))**2)*WSSST(1)/
     /(2.0D0*ZSTEP)
      DYSST(1)=((YYSPL(1)/TSSUM(1))-(YSPL(1)/TSSUM(1))**2)*WSSST(1)/
     /(2.0D0*ZSTEP)
      DLSST(1)=((TTMSPL(1)/TSSUM(1))-(TMSPL(1)/TSSUM(1))**2)*WSSST(1)**3
     //(2.0D0*ZSTEP)
      IF(NESST(1).EQ.0) GO TO 1
      ALFNE(1)=(DLOG(DFLOAT(NESST(1)))-DLOG(DFLOAT(IPRIM)))/ZSTEP
    1 ALFNJ(1)=0.0D0
      ALFN(1)=0.0D0
      DO 10 I=2,JPRINT
      ESST(I)=ESPL(I)/TSSUM(I)
      ZSST(I)=ZSPL(I)/TSSUM(I)
      VDSST(I)=VZSPL(I)/TSSUM(I)
      WTEMP(I)=ZSTEP*DFLOAT(I)*TSSUM(I)/TMSPL(I)
      WSSST(I)=(WTEMP(I)*WTEMP(I-1))/(I*WTEMP(I-1)-(I-1)*WTEMP(I))
      DXSST(I)=((XXSPL(I)/TSSUM(I))-(XSPL(I)/TSSUM(I))**2-(XXSPL(I-1)/
     /TSSUM(I-1))+(XSPL(I-1)/TSSUM(I-1))**2)*WSSST(I)/(2.0D0*ZSTEP)
      DYSST(I)=((YYSPL(I)/TSSUM(I))-(YSPL(I)/TSSUM(I))**2-(YYSPL(I-1)/
     /TSSUM(I-1))+(YSPL(I-1)/TSSUM(I-1))**2)*WSSST(I)/(2.0D0*ZSTEP)
      DLSST(I)=((TTMSPL(I)/TSSUM(I))-(TMSPL(I)/TSSUM(I))**2-(TTMSPL(I-1)
     //TSSUM(I-1))+(TMSPL(I-1)/TSSUM(I-1))**2)*WSSST(I)**3/(2.0D0*ZSTEP)
      ALFN(I)=(DLOG(TSSUM(I))-DLOG(TSSUM(I-1)))/ZSTEP
      ALFNJ(I)=(DLOG(TSSUM(I)*VDSST(I))-DLOG(TSSUM(I-1)*VDSST(I-1)))/ZST
     /EP
      IF(NESST(I).EQ.0.OR.NESST(I-1).EQ.0) GO TO 10
   10 ALFNE(I)=(DLOG(DFLOAT(NESST(I)))-DLOG(DFLOAT(NESST(I-1))))/ZSTEP
      DXFIN=((XXSPL(JPRINT)/TSSUM(JPRINT))-(XSPL(JPRINT)/TSSUM(JPRINT))
     /**2)*WSSST(JPRINT)/(JPRINT*2.0D0*ZSTEP)
      DXFIN=DXFIN*1.0D+16
      DYFIN=((YYSPL(JPRINT)/TSSUM(JPRINT))-(YSPL(JPRINT)/TSSUM(JPRINT))
     /**2)*WSSST(JPRINT)/(JPRINT*2.0D0*ZSTEP)
      DYFIN=DYFIN*1.0D+16
      DLFIN=((TTMSPL(JPRINT)/TSSUM(JPRINT))-(TMSPL(JPRINT)/TSSUM(JPRINT)
     /)**2)*WSSST(JPRINT)**3/(JPRINT*2.0D0*ZSTEP)
      DLFIN=DLFIN*1.0D+16
      ALNGTH=ZSTEP*DFLOAT(JPRINT)
      ALFIN=DLOG(DFLOAT(NESST(JPRINT))/DFLOAT(IPRIM))/ALNGTH
      ALFIN=ALFIN*0.01D0
      DO 15 J=1,JPRINT
      VDSST(J)=VDSST(J)*1.0D+09
      WSSST(J)=WSSST(J)*1.0D+09
      DXSST(J)=DXSST(J)*1.0D+16
      DYSST(J)=DYSST(J)*1.0D+16
      DLSST(J)=DLSST(J)*1.0D+16
      ALFN(J)=ALFN(J)*0.01D0
      ALFNJ(J)=ALFNJ(J)*0.01D0
      ALFNE(J)=ALFNE(J)*0.01D0
  15  CONTINUE
      WRITE(6,800) JPRINT
 800  FORMAT(2(/),' STEADY STATE TOWNSEND RESULTS FOR',I2,' SEQUENTIAL S
     /PACE PLANES',2(/),'PLANE   NEL     VD      WS     DL       DT
     /EBAR   ALFN    ALFNJ   ALFNE',/)
      DO 20 IPL=1,JPRINT
      DRSST(IPL)=(DXSST(IPL)+DYSST(IPL))/2.0
  20  WRITE(6,810)IPL,NESST(IPL),VDSST(IPL),WSSST(IPL),DLSST(IPL),DRSST(
     /IPL),ESST(IPL),ALFN(IPL),ALFNJ(IPL),ALFNE(IPL)
 810  FORMAT(1X,I2,2X,I7,2(1X,F6.1),2F9.1,F6.1,3F8.1)
      IF(NESST(1).GT.NESST(5)) THEN
C NET ATTACHMENT THEREFORE TAKE RESULTS FROM PLANE 2
       VDOUT=VDSST(2)
       VDERR=100.0D0*DABS((VDSST(2)-VDSST(3))/(2.0D0*VDSST(2)))
       WSOUT=WSSST(2)
       WSERR=100.0D0*DABS((WSSST(2)-WSSST(3))/(2.0D0*WSSST(2)))
       DLOUT=DLSST(2)
       DLERR=100.0D0*DABS((DLSST(2)-DLSST(3))/(2.0D0*DLSST(2)))
       DTOUT=DRSST(2)
       DTERR=100.0D0*DABS((DRSST(2)-DRSST(3))/(2.0D0*DRSST(2)))
       IF(ATTOION.EQ.-1.0D0) THEN
C NO IONISATION
        ALPHSST=0.0
        ALPHERR=0.0
        ANST2=DFLOAT(NESST(2))
        ANST3=DFLOAT(NESST(3))
        ANST4=ANST3-DSQRT(ANST3)
        ANST5=DLOG(ANST2/ANST3)
        ANST6=DLOG(ANST2/ANST4)
        ANST7=ANST6/ANST5
        ANST8=ANST7-1.0D0
        ATTSST=-(ALFN(2)+ALFNJ(2)+ALFNE(2))/3.0D0
        ATTERR=100.0D0*DSQRT(ANST8**2+ATTATER**2)
       ELSE
        ANST2=DFLOAT(NESST(2))
        ANST3=DFLOAT(NESST(3))
        ANST4=ANST3-DSQRT(ANST3)
        ANST5=DLOG(ANST2/ANST3)
        ANST6=DLOG(ANST2/ANST4)
        ANST7=ANST6/ANST5
        ANST8=ANST7-1.0D0
        ATMP=(ALFN(2)+ALFNJ(2)+ALFNE(2))/3.0D0
        ALPHSST=ATMP/(1.0D0-ATTOION)
        ALPHERR=100.0D0*DSQRT(ANST8**2+ATTIOER**2)
        ATTSST=ATTOION*ATMP/(1.0D0-ATTOION)
        ATTERR=100.0D0*DSQRT(ANST8**2+ATTATER**2)
       ENDIF
      ELSE
C NET IONISATION THEREFORE TAKE RESULTS FROM PLANE 8
       VDOUT=VDSST(8)
       VDERR=100.0D0*DABS((VDSST(8)-VDSST(7))/(2.0D0*VDSST(8)))
       WSOUT=WSSST(8)
       WSERR=100.0D0*DABS((WSSST(8)-WSSST(7))/(2.0D0*WSSST(8)))
       DLOUT=DLFIN
       DLERR=100.0D0*DABS((DLOUT-DLSST(8))/(2.0D0*DLOUT))
       DTOUT=(DXFIN+DYFIN)/2.0D0
       DTERR=100.0D0*DABS((DTOUT-DRSST(8))/(2.0D0*DTOUT))
       ATMP=(ALFN(8)+ALFNJ(8)+ALFNE(8))/3.0D0
       ATMP2=(ALFN(7)+ALFNJ(7)+ALFNE(7))/3.0D0
       ATER=DABS((ATMP-ATMP2)/(2.0D0*ATMP))
       ALPHSST=ATMP/(1.0D0-ATTOION)
       ALPHERR=100.0D0*DSQRT(ATER**2+ATTIOER**2)
       ATTSST=ATTOION*ATMP/(1.0D0-ATTOION)
       IF(ATTOION.NE.0.0D0) THEN
        ATTERR=100.0D0*DSQRT(ATER**2+ATTATER**2)
       ELSE
        ATTERR=0.0D0
       ENDIF
      ENDIF
      RETURN
      END
      SUBROUTINE OUTPUT2
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      COMMON/MIX2/E(4000),EROOT(4000),QTOT(4000),QREL(4000),QINEL(4000),
     /QEL(4000)
      COMMON/MIX1/QELM(4000),QSUM(4000),QION(6,4000),QIN1(220,4000),
     /QIN2(220,4000),QIN3(220,4000),QIN4(220,4000),QIN5(220,4000),
     /QIN6(220,4000),QSATT(4000)
      COMMON/RATIO/AN1,AN2,AN3,AN4,AN5,AN6,AN,FRAC(6)
      COMMON/SETP/TMAX,SMALL,API,ESTART,THETA,PHI,TCFMAX(8),RSTART,
     /EFIELD,NMAX
      COMMON/LARGE/CF(4000,512),EIN(512),TCF(4000),IARRY(512),RGAS(512),
     /IPN(512),WPL(512),LAST,ISIZE,PENFRA(3,512)
      COMMON/OUTPT/TIME(300),ICOLL(30),SPEC(4000),TMAX1,
     /AVE,DEN,XID,X,Y,Z,ST,NNULL,ICOLN(512)
      COMMON/TTRM/ZTOT,TTOT,ZTOTS,TTOTS
      COMMON/SINT/SIMF(4000)
      COMMON/NAMES/NAMEG(6)
      COMMON/SCRIP/DSCRPT(512)
      CHARACTER*30 DSCRPT
      CHARACTER*15 NAMEG
      DIMENSION FREQEL(6),FREQSP(6),FREINE(6),FREATT(6),FREION(6)
      DIMENSION SPECS(40)
      WRITE(6,15)
      WRITE(6,15)
   15 FORMAT('----------------------------------------------------------
     /-------------------')
      WRITE(6,110) SPEC(4000)
 110  FORMAT(2(/),' NUMBER OF COLLISIONS IN FINAL ENERGY BIN =',F8.1)
      NINEL=ICOLL(2)+ICOLL(3)+ICOLL(4)+ICOLL(5)+ICOLL(7)+ICOLL(8)+ICOLL(
     /9)+ICOLL(10)+ICOLL(12)+ICOLL(13)+ICOLL(14)+ICOLL(15)+ICOLL(17)+ICO
     /LL(18)+ICOLL(19)+ICOLL(20)+ICOLL(22)+ICOLL(23)+ICOLL(24)+ICOLL(25)
     /+ICOLL(27)+ICOLL(28)+ICOLL(29)+ICOLL(30)
      NELA=ICOLL(1)+ICOLL(6)+ICOLL(11)+ICOLL(16)+ICOLL(21)+ICOLL(26)
      NTOTAL=NELA+NINEL
      IF(TTOTS.EQ.0.0D0) THEN
       NREAL=NTOTAL
       TTOTS=ST
      ELSE
       NREAL=NTOTAL
      ENDIF
      FREQ=NREAL/TTOTS
      FREIN=NINEL/TTOTS
      FREEL=NELA/TTOTS
      WRITE(6,220) FREQ,FREIN,FREEL
  220 FORMAT(/,6X,'TOTAL COLL. FREQ. =',D11.4,' (*10**12)/SEC.',/,2X,'IN
     /ELASTIC COLL. FREQ. =',D11.4,' (*10**12)/SEC.',/,4X,'ELASTIC COLL.
     / FREQ. =',D11.4,' (*10**12)/SEC.',/)
      WRITE(6,15)
C     ILAST=DINT(TMAX1)+1
C     IF(ILAST.GT.120) ILAST=120
C     WRITE(6,1010) (TIME(I),I=1,ILAST)
C1010 FORMAT(/,6X,'DISTRIBUTION OF COLLISION TIMES IN 1 PECOSECOND BINS'
C    /,2(/),20(1X,6(F10.1,2X)/))
C     WRITE(6,15)
      DO 1020 I=1,NGAS
      FREQEL(I)=ICOLL((5*I)-4)/TTOTS
      FREQSP(I)=ICOLL(5*I)/TTOTS
      FREINE(I)=ICOLL((5*I)-1)/TTOTS
      FREATT(I)=ICOLL((5*I)-2)/TTOTS
      FREION(I)=ICOLL((5*I)-3)/TTOTS
 1020 CONTINUE
C     WRITE(6,1050) (NAMEG(I),FREQEL(I),FREQSP(I),FREINE(I),FREATT(I),
C    /FREION(I),I=1,NGAS)
C1050 FORMAT(/,5X,'COLLISION FREQUENCIES SORTED ACCORDING TO GAS AND TYP
C    /E OF COLLISION',/,5X,' IN UNITS OF 10**12/SEC.',2(/),'  GASES USED
C    /     ELASTIC     SUPERELAS   INELASTIC  ATTACHMENT  IONISATION ',2
C    /(/),6(A15,1X,5(D10.3,2X),/))
C     WRITE(6,15)
      WRITE(6,1060)
 1060 FORMAT(/,2X,'DETAILED COLLISION FREQUENCIES FOR EACH GAS IN UNITS
     /OF 10**12/SEC. :',2(/))
      DO 1100 J=1,NGAS
      WRITE(6,1065) NAMEG(J)
 1065 FORMAT(3X,A15,/,'------------------',2(/))
      DO 1090 K=1,LAST
      IF(IARRY(K).LE.(5*J).AND.IARRY(K).GT.(5*(J-1))) THEN
       FRELV=FREQ*ICOLN(K)/DFLOAT(NREAL)
       IF(ICOLN(K).EQ.0) THEN
        ERRFRE=0.0
       ELSE
        ERRFRE=100.0D0*DSQRT(DFLOAT(ICOLN(K)))/DFLOAT(ICOLN(K))
       ENDIF
       WRITE(6,1070) DSCRPT(K),FRELV,ERRFRE
 1070 FORMAT(3X,A30,3X,D11.4,' +-',F8.4,' %')
      ENDIF
 1090 CONTINUE
 1100 CONTINUE
      WRITE(6,15)
      WRITE(6,301)
  301 FORMAT(2(/),10X,' NORMALISED ENERGY DISTRIBUTION')
      J1=0
      J2=0
      SPECN=DFLOAT(NREAL)
      SMSPEC=0.0D0
      DO 350 K=1,4000
      SPEC(K)=SPEC(K)/SPECN
      J1=J1+1
      SMSPEC=SMSPEC+SPEC(K)
      IF(J1.LT.100) GO TO 350
      J2=J2+1
      SPECS(J2)=SMSPEC
      SMSPEC=0.0D0
      J1=0
  350 CONTINUE
      EPLT=EFINAL/40.0D0
      DO 420 I=1,40
      ENER=EPLT*(DFLOAT(I)-0.5D0)
      WRITE(6,302) ENER,SPECS(I)
  302 FORMAT(6X,'E=',F7.3,6X,'SPEC=',D10.3)
  420 CONTINUE
      RETURN
      END
      SUBROUTINE ALPCLCB
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/SETP/TMAX,SMALL,API,ESTART,THETA,PHI,TCFMAX(8),RSTART,
     /EFIELD,NMAX
      COMMON/TOFGOUT/RALPHA,RALPER,TOFENE,TOFENER,TOFWVZ,TOFWVZER,
     /TOFWVY,TOFWVYER,TOFDZZ,TOFDZZER,TOFDXX,TOFDXXER,TOFDYY,TOFDYYER,
     /TOFDYZ,TOFDYZER,TOFWRZ,TOFWRZER,TOFWRY,TOFWRYER,RATTOF,RATOFER
      COMMON/VEL/WX,WY,WZ
      COMMON/CTOWNS/ALPHA,ATT
      COMMON/CTWNER/ALPER,ATTER
      COMMON/CION/ALPHAST,VDST,TSTEP,ZSTEP,TFINAL,ZFINAL,ITFINAL,IPRIM
C ----------------------------------------------------------------------
C  ESTIMATE TIME STEP  FOR AVALANCHE SIMULATION IN TIME OF FLIGHT SIM.
C  USES ESTIMATED GAIN OF 3.0 BETWEEN PLANES.
C  CALLS TOF AND PT SUBROUTINES AND UPDATES ALPHA AND ATT
C  VERSION WITH BFIELD ALONG X-AXIS AND EFIELD ALONG Z-AXIS (90 DEGREES)
C ----------------------------------------------------------------------
      IMAX=NMAX/10000000
      IF(IMAX.LT.5) IMAX=5
      NMAX=IMAX*10000000
      ALPHAST=0.85D0*DABS(ALPHA-ATT)
      VDST=WZ*1.D-5
      TSTEP=DLOG(3.0D0)/(ALPHAST*VDST*1.0D5)
      TSTEP=TSTEP*1.0D12
      TFINAL=7.0D0*TSTEP
      ITFINAL=7
C CALC TIME OF FLIGHT AND PT
      WRITE(6,25)
   25 FORMAT(/,2X,'SOLUTION FOR PULSED TOWNSEND AND TIME OF FLIGHT PARAM
     /ETERS',/,'  ------------------------------------------------------
     /--------')
      WRITE(6,26) TSTEP
   26 FORMAT(1(/),'  TIME STEP BETWEEN SAMPLING PLANES =',D12.5,' PICOSE
     /CS.',/)
      CALL MONTEFTG
      CALL FRIEDLAND
      CALL PTG
      CALL TOFG
      WRITE(6,27) RALPHA,RALPER,RATTOF,RATOFER
   27 FORMAT(/,'PT IONISATION AND ATTACHMENT RATES *10**12/SEC',/,'ALPHA
     /=',D10.3,' +- ',F6.2,' %      ATT=',D10.3,' +- ',F6.2,' %')
      WRITE(6,28)
   28 FORMAT(/,'TOF DIFFUSION')
      WRITE(6,29) TOFDZZ,TOFDZZER,TOFDXX,TOFDXXER,TOFDYY,TOFDYYER,
     /TOFDYZ,TOFDYZER
   29 FORMAT(/,'DZZ=',F8.1,' +- ',F5.1,' %',/,'DXX=',F8.1,' +- ',F5.1,'
     /%',/,'DYY=',F8.1,' +- ',F5.1,' %',/,'DYZ=',F8.1,' +- ',F5.1,' %')
      WRITE(6,30)
   30 FORMAT(/,'TOF DRIFT VELOCITY')
      WRITE(6,31) TOFWRZ,TOFWRZER,TOFWRY,TOFWRYER
   31 FORMAT(/,'WRZ=',F8.2,' +-',F6.1,' %    WRY=',F8.2,' +-',F6.1,' %')
C CALCULATE TOWNSEND SST COEFICIENTS FROM TOF RESULTS
      WRZN=TOFWRZ*1.0D05
      FC1=WRZN/(2.0D0*TOFDZZ)
      FC2=((RALPHA-RATTOF)*1.0D12)/TOFDZZ
      ALPZZ=FC1-DSQRT(FC1**2-FC2)
C---- -------------------------------------------------
C      LOAD NEW ALPHA AND ATTACHMENT INTO COMMON BLOCKS
C---- -------------------------------------------
      ALPATT=ALPHA-ATT
      RATIO=ALPZZ/ALPATT
      ALPHA=ALPHA*RATIO
      ATT=ATT*RATIO
      WRITE(6,32) ALPHA,ALPER,ATT,ATTER
   32 FORMAT(/,'TOWNSEND COEFICIENTS CALCULATED FROM TOF RESULTS:',2(/),
     /'IONISATION RATE /CM.=',D11.4,' +-',F6.2,' %',/,'ATTACHMENT RATE /
     /CM.=',D11.4,' +-',F6.2,' %',/)
C --- -------------------------------------------
      RETURN
      END
      SUBROUTINE MONTEFTG
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      COMMON/CNSTS1/CONST1,CONST2,CONST3,CONST4,CONST5
      COMMON/SETP/TMAX,SMALL,API,ESTART,THETA,PHI,TCFMAX(8),RSTART,
     /EFIELD,NMAX
      COMMON/BFLD/EOVB,WB,BTHETA,BMAG
      COMMON/LARGE/CF(4000,512),EIN(512),TCF(4000),IARRY(512),RGAS(512),
     /IPN(512),WPL(512),IPLAST,ISIZE,PENFRA(3,512)
      COMMON/CION/ALPHAST,VDST,TSTEP,ZSTEP,TFINAL,ZFINAL,ITFINAL,IPRIM
      COMMON/OUTPT/TIME(300),ICOLL(30),SPEC(4000),TMAX1,
     /AVE,DEN,XID,X,Y,Z,ST,NNULL,ICOLN(512)
      COMMON/TTRM/ZTOT,TTOT,ZTOTS,TTOTS
      COMMON/IPT/XS(200),YS(200),ZS(200),TS(200),ES(200),
     /DCX(200),DCY(200),DCZ(200),IPL(200)
      COMMON/TPLOUTG/ETPL(8),XTPL(8),YTPL(8),ZTPL(8),TTPL(8),XXTPL(8),
     /YYTPL(8),ZZTPL(8),YZTPL(8),VZTPL(8),VYTPL(8),NETPL(8),ATTOINT,
     /ATTERT,AIOERT
      COMMON/ANIS/PSCT(4000,512),ANGCT(4000,512),INDEX(512),NISO
      DIMENSION EPRM(4000000),IESPECP(100)
C -------------------------------------------------------------------
C   CALCULATES COLLISION EVENTS AND UPDATES DIFFUSION AND VELOCITY.
C   THIS ROUTINE HANDLES TERMINATIONS AT FIXED DRIFT TIMES.
C   B FIELD AT 90 DEGREES TO EFIELD
C -------------------------------------------------------------------
      S=0.0D0
      ST=0.0D0
      X=0.0D0
      Y=0.0D0
      Z=0.0D0
      ZTOT=0.0D0
      ZTOTS=0.0D0
      YTOT=0.0D0
      YTOTS=0.0D0
      TTOT=0.0D0
      TTOTS=0.0D0
      SMALL=1.0D-20
      TMAX1=0.0D0
      RDUM=RSTART
      E1=ESTART
      CONST9=CONST3*0.01D0
      API=DACOS(-1.0D0)
      DO 25 I=1,300
   25 TIME(I)=0.0D0
      DO 26 I=1,30
   26 ICOLL(I)=0
      DO 27 I=1,512
   27 ICOLN(I)=0
      DO 28 I=1,4000
   28 SPEC(I)=0.0D0
      DO 33 I=1,100
   33 IESPECP(I)=0
      DO 34 I=1,8
      ETPL(I)=0.0D0
      XTPL(I)=0.0D0
      YTPL(I)=0.0D0
      ZTPL(I)=0.0D0
      TTPL(I)=0.0D0
      XXTPL(I)=0.0D0
      YYTPL(I)=0.0D0
      ZZTPL(I)=0.0D0
      YZTPL(I)=0.0D0
      VZTPL(I)=0.0D0
      VYTPL(I)=0.0D0
   34 NETPL(I)=0
      ID=0
      N4000=4000
      N300=300
      N100=100
      INTEM=8
      I100=0
      NCOL=0
      NNULL=0
      NELEC=0
      NEION=0
      NMXADD=0
      NPONT=0
      NCLUS=0
      J1=1
      ZSTRT=0.0D0
      YSTRT=0.0D0
      TSSTRT=0.0D0
C     INITIAL DIRECTION COSINES
      DCZ1=DCOS(THETA)
      DCX1=DSIN(THETA)*DCOS(PHI)
      DCY1=DSIN(THETA)*DSIN(PHI)
C INITIAL VELOCITY
      VTOT=CONST9*DSQRT(E1)
      CX1=DCX1*VTOT
      CY1=DCY1*VTOT
      CZ1=DCZ1*VTOT
      E100=E1
      DCZ100=DCZ1
      DCX100=DCX1
      DCY100=DCY1
      F4=2.0D0*API
C SET TO MAXIMUM POSSIBLE COLLISION FREQ.
      TLIM=TCFMAX(1)
      DO 35 I=2,INTEM
   35 IF(TLIM.LT.TCFMAX(I)) TLIM=TCFMAX(I)
      JPRINT=NMAX/10
      IPRINT=0
      ITER=0
      IPLANE=0
      IPRIM=0
C  LOOP FOR NEW STARTING ELECTRONS
  544 IPRIM=IPRIM+1
      IF(IPRIM.GT.1) THEN
C CHECK IF PROGRAM WILL EXCEED MAXIMUM NUMBER OF ITERATIONS
C IN THIS CYCLE IF SO OUTPUT CURRENT RESULTS.
       IF(ITER.GT.NMAX) THEN
        IPRIM=IPRIM-1
        GO TO 700
       ENDIF
       X=0.0D0
       Y=0.0D0
       Z=0.0D0
       DCZ1=DCZ100
       DCX1=DCX100
       DCY1=DCY100
       E1=E100
       VTOT=CONST9*DSQRT(E1)
       CX1=DCX1*VTOT
       CY1=DCY1*VTOT
       CZ1=DCZ1*VTOT
       NCLUS=NCLUS+1
       ST=0.0D0
       TSSTRT=0.0D0
       ZSTRT=0.0D0
       YSTRT=0.0D0
       IPLANE=0
      ENDIF
      IF(IPRIM.GT.4000000) THEN
      WRITE(6,944) IPRIM
 944  FORMAT(/,2X,'PROGRAM STOPPED TOO MANY PRIMARIES IPRIM =',I7)
      GO TO 700
      ENDIF
      EPRM(IPRIM)=E1
      IDUM=DINT(E1)+1
      IDUM=DMIN0(IDUM,N100)
      IESPECP(IDUM)=IESPECP(IDUM)+1
C START OF LOOP FOR NEWLY CREATED ELECTRONS
  555 TDASH=0.0D0
      NELEC=NELEC+1
      TSTOP=TSTEP+IPLANE*TSTEP
C MAIN LOOP
    1 CONTINUE
C     IF(ITER.GT.NMAX)  GO TO 315
      R1=drand48(RDUM)
      T=-DLOG(R1)/TLIM+TDASH
      TDASH=T
      WBT=WB*T
      COSWT=DCOS(WBT)
      SINWT=DSIN(WBT)
  15  IF((T+ST).GE.TSTOP) THEN
       IPLANE=IPLANE+1
       TSTOP=TSTOP+TSTEP
C STORE POSITION AND ENERGY AT TIME PLANE =IPLANE.
       CALL TPLANEG(T,E1,CX1,CY1,CZ1,EFIELD,IPLANE)
C CHECK IF PASSED THROUGH MORE THAN ONE PLANE IN THIS STEP
       IF((T+ST).GE.TSTOP.AND.TSTOP.LE.TFINAL) GO TO 15
       IF((T+ST).GE.TFINAL) THEN
        ZTOT=ZTOT+Z
        YTOT=YTOT+Y
        TTOT=TTOT+ST
        ZTOTS=ZTOTS+Z-ZSTRT
        YTOTS=YTOTS+Y-YSTRT
        TTOTS=TTOTS+ST-TSSTRT
        TSTOP=TSTEP
C NO MORE ELECTRONS IN CASCADE TRY NEW PRIMARY ELECTRON
        IF(NELEC.EQ.(NCLUS+1)) GO TO 544
C TAKE ELECTRONS FROM STORE
   20   X=XS(NPONT)
        Y=YS(NPONT)
        Z=ZS(NPONT)
        ST=TS(NPONT)
        E1=ES(NPONT)
        DCX1=DCX(NPONT)
        DCY1=DCY(NPONT)
        DCZ1=DCZ(NPONT)
        VTOT=CONST9*DSQRT(E1)
        CX1=DCX1*VTOT
        CY1=DCY1*VTOT
        CZ1=DCZ1*VTOT
        IPLANE=IPL(NPONT)
        NPONT=NPONT-1
        ZSTRT=Z
        YSTRT=Y
        TSSTRT=ST
        GO TO 555
       ENDIF
      ENDIF
      DZ=(CZ1*SINWT+(EOVB-CY1)*(1.0D0-COSWT))/WB
      E=E1+DZ*EFIELD*100.0D0
 913  FORMAT(3X,' AFTER STORE ITER=',I10,' DZ=',D12.3,'E1=',D12.3,' COSW
     /T=',D12.3,' SINWT=',D12.3,' WBT=',D12.3,' CY1=',D12.3)
      IF(E.LT.0.0D0) THEN
       WRITE(6,913)ITER,DZ,E,COSWT,SINWT,WBT,CY1
       E=0.001D0
      ENDIF
      IE=DINT(E/ESTEP)+1
      IE=DMIN0(IE,N4000)
C
C     TEST FOR REAL OR NULL COLLISION
C
      R5=drand48(RDUM)
      TTEM=TCF(IE)/TLIM
      IF(R5.LE.TTEM)GO TO 137
      NNULL=NNULL+1
      GO TO 1
C
C  CALCULATE DIRECTION COSINES AND POSITIONS AT INSTANT BEFORE COLLISION
C    ALSO UPDATE DIFFUSION  AND ENERGY CALCULATIONS.
  137 T2=T*T
      IF(T.GE.TMAX1) TMAX1=T
      TDASH=0.0D0
C CALC VELOCITY
      CX2=CX1
      CY2=(CY1-EOVB)*COSWT+CZ1*SINWT+EOVB
      CZ2=CZ1*COSWT-(CY1-EOVB)*SINWT
C CALC DIRECTION COSINES
      VTOT=DSQRT(CX2*CX2+CY2*CY2+CZ2*CZ2)
      DCX2=CX2/VTOT
      DCY2=CY2/VTOT
      DCZ2=CZ2/VTOT
      NCOL=NCOL+1
C CALC NEW POSITION
      X=X+CX1*T
      Y=Y+EOVB*T+((CY1-EOVB)*SINWT+CZ1*(1.0D0-COSWT))/WB
      Z=Z+DZ
      ST=ST+T
      IT=DINT(T+1.0D0)
      IT=DMIN0(IT,N300)
      TIME(IT)=TIME(IT)+1.0D0
      SPEC(IE)=SPEC(IE)+1.0D0
C ---------------------------------------------------------------------
C     DETERMINATION OF REAL COLLISION TYPE
C ---------------------------------------------------------------------
      R2=drand48(RDUM)
C FIND LOCATION WITHIN 4 UNITS IN COLLISION ARRAY
      CALL SORT(I,R2,IE)
  140 I=I+1
      IF(CF(IE,I).LT.R2) GO TO 140
      S1=RGAS(I)
      EI=EIN(I)
      IF(E.LT.EI) THEN
C     WRITE(6,994) E,EI,ITER
C994  FORMAT(2X,' WARNING ENERGY =',F8.3,' LESS THAN ENERGY LOSS EI=',F8
C    /.3,' AT ITER=',I12,' DUE TO BINNING ERROR')
C FIX ENERGY LOSS SMALLER THAN INCIDENT ENERGY IF A BINING ERROR OCCURS.
      EI=E-0.0001D0
      ENDIF
      IF(IPN(I).EQ.0) GO TO 666
C ATTACHMENT
      IF(IPN(I).EQ.-1) THEN
       NEION=NEION+1
       IPT=IARRY(I)
       ID=ID+1
       ITER=ITER+1
       IPRINT=IPRINT+1
       ICOLL(IPT)=ICOLL(IPT)+1
       ICOLN(I)=ICOLN(I)+1
       IT=DINT(T+1.0D0)
       IT=DMIN0(IT,N300)
       TIME(IT)=TIME(IT)+1.0D0
       ZTOT=ZTOT+Z
       YTOT=YTOT+Y
       TTOT=TTOT+ST
       ZTOTS=ZTOTS+Z-ZSTRT
       YTOTS=YTOTS+Y-YSTRT
       TTOTS=TTOTS+ST-TSSTRT
C  ELECTRON CAPTURED START NEW PRIMARY
       IF(NELEC.EQ.(NCLUS+1)) GO TO 544
C ELECTRON CAPTURED TAKE NEXT ELECTRON FROM STORE
       GO TO 20
      ENDIF
      R9=drand48(RDUM)
C     ESEC=R9*(E-EI)
C    USE OPAL PETERSON AND BEATY SPLITTING FACTOR.
      ESEC=WPL(I)*TAN(R9*ATAN((E-EI)/(2.0D0*WPL(I))))
      EI=ESEC+EI
C STORE POSITION ,ENERGY, DIRECTION COSINES AND TIME OF GENERATION
C OF IONISATION ELECTRON
      NCLUS=NCLUS+1
      NPONT=NPONT+1
      NMXADD=MAX(NPONT,NMXADD)
      IF(NPONT.GT.200) THEN
      WRITE(6,546) NPONT,ITER
 546  FORMAT(2X,' PROGRAM STOPPED . NPONT=',I4,' ITER=',I10)
      STOP
      ENDIF
      XS(NPONT)=X
      YS(NPONT)=Y
      ZS(NPONT)=Z
      TS(NPONT)=ST
      ES(NPONT)=ESEC
C RANDOMISE SECONDARY ELECTRON DIRECTION
      R3=drand48(RDUM)
      F3=1.0D0-2.0D0*R3
      THETA0=DACOS(F3)
      F6=DCOS(THETA0)
      F5=DSIN(THETA0)
      R4=drand48(rdum)
      PHI0=F4*R4
      F8=DSIN(PHI0)
      F9=DCOS(PHI0)
      DCX(NPONT)=F9*F5
      DCY(NPONT)=F8*F5
      DCZ(NPONT)=F6
      IPL(NPONT)=IPLANE
C
C  GENERATE SCATTERING ANGLES AND UPDATE  LABORATORY COSINES AFTER
C   COLLISION ALSO UPDATE ENERGY OF ELECTRON.
C
  666 IPT=IARRY(I)
      ID=ID+1
      ITER=ITER+1
      IPRINT=IPRINT+1
      ICOLL(IPT)=ICOLL(IPT)+1
      ICOLN(I)=ICOLN(I)+1
C IF EXCITATION THEN ADD PROBABILITY ,PENFRA(1,I),OF TRANSFER TO GIVE
C IONISATION OF THE OTHER GASES IN THE MIXTURE
      IF(IPEN.EQ.0) GO TO 5
      IF(PENFRA(1,I).EQ.0.0) THEN
       RAN=drand48(RDUM)
       IF(RAN.GT.PENFRA(1,I)) GO TO 5
       NCLUS=NCLUS+1
       NPONT=NPONT+1
       IF(NPONT.GT.200) THEN
        WRITE(6,546) NPONT,ITER
        STOP
       ENDIF
C ENTER HERE POSSIBLE DELOCALISATION LENGTH FOR PENNING TRANSFER
       IF(PENFRA(2,I).EQ.0.0) THEN
        XS(NPONT)=X
        YS(NPONT)=Y
        ZS(NPONT)=Z
        GO TO 667
       ENDIF
       ASIGN=1.0
       RAN=drand48(RDUM)
       RAN1=drand48(RDUM)
       IF(RAN1.LT.0.5) ASIGN=-ASIGN
       XS(NPONT)=X-DLOG(RAN)*PENFRA(2,I)*ASIGN
       RAN=drand48(RDUM)
       RAN1=drand48(RDUM)
       IF(RAN1.LT.0.5) ASIGN=-ASIGN
       YS(NPONT)=Y-DLOG(RAN)*PENFRA(2,I)*ASIGN
       RAN=drand48(RDUM)
       RAN1=drand48(RDUM)
       IF(RAN1.LT.0.5) ASIGN=-ASIGN
       ZS(NPONT)=Z-DLOG(RAN)*PENFRA(2,I)*ASIGN
C POSSIBLE PENNING TRANSFER TIME
  667  TPEN=ST
       IF(PENFRA(3,I).EQ.0.0) GO TO 668
       RAN=drand48(RDUM)
       TPEN=ST-DLOG(RAN)*PENFRA(3,I)
  668  TS(NPONT)=TPEN
       ES(NPONT)=1.0
       DCX(NPONT)=DCX1
       DCY(NPONT)=DCY1
       DCZ(NPONT)=DCZ1
C FIND LAST TIME PLANE BEFORE TPEN
       TSTOP1=0.0
       IPLANE1=0
       DO 669 KDUM=1,ITFINAL
       TSTOP1=TSTEP+TSTOP1
       IF(TPEN.LT.TSTOP1) GO TO 670
       IPLANE1=IPLANE1+1
  669  CONTINUE
C PENNING TRANSFER OCCURS AFTER FINAL TIME PLANE CLEAR ENTRY
       NPONT=NPONT-1
       NCLUS=NCLUS-1
       GO TO 5
  670  IPL(NPONT)=IPLANE1
      ENDIF
    5 S2=(S1*S1)/(S1-1.0D0)
C ANISOTROPIC SCATTERING
      R3=drand48(RDUM)
      IF(INDEX(I).EQ.1) THEN
       R31=drand48(RDUM)
       F3=1.0D0-R3*ANGCT(IE,I)
       IF(R31.GT.PSCT(IE,I)) F3=-F3
      ELSE IF(INDEX(I).EQ.2) THEN
       EPSI=PSCT(IE,I)
       F3=1.0D0-(2.0D0*R3*(1.0D0-EPSI)/(1.0D0+EPSI*(1.0D0-2.0D0*R3)))
      ELSE
C ISOTROPIC SCATTERING
       F3=1.0D0-2.0D0*R3
      ENDIF
      THETA0=DACOS(F3)
      R4=drand48(RDUM)
      PHI0=F4*R4
      F8=DSIN(PHI0)
      F9=DCOS(PHI0)
      IF(E.LT.EI) EI=0.0D0
      ARG1=1.0D0-S1*EI/E
      ARG1=DMAX1(ARG1,SMALL)
      D=1.0D0-F3*DSQRT(ARG1)
      E1=E*(1.0D0-EI/(S1*E)-2.0D0*D/S2)
      E1=DMAX1(E1,SMALL)
      Q=DSQRT((E/E1)*ARG1)/S1
      Q=DMIN1(Q,1.0D0)
      THETA=DASIN(Q*DSIN(THETA0))
      F6=DCOS(THETA)
      U=(S1-1.0D0)*(S1-1.0D0)/ARG1
      CSQD=F3*F3
      IF(F3.LT.0.0D0.AND.CSQD.GT.U) F6=-1.0D0*F6
      F5=DSIN(THETA)
      DCZ2=DMIN1(DCZ2,1.0D0)
      ARGZ=DSQRT(DCX2*DCX2+DCY2*DCY2)
      IF(ARGZ.EQ.0.0D0) THEN
C      WRITE(6,9232) ITER,ID,E1
C9232  FORMAT(3X,'WARNING ARGZ= 0.0 AT ITER =',I10,' ID =',I10,' E1=',E1
C    /2.3)
       DCZ1=F6
       DCX1=F9*F5
       DCY1=F8*F5
       GO TO 190
      ENDIF
      DCZ1=DCZ2*F6+ARGZ*F5*F8
      DCY1=DCY2*F6+(F5/ARGZ)*(DCX2*F9-DCY2*DCZ2*F8)
      DCX1=DCX2*F6-(F5/ARGZ)*(DCY2*F9+DCX2*DCZ2*F8)
  190 CONTINUE
      VTOT=CONST9*DSQRT(E1)
      CX1=DCX1*VTOT
      CY1=DCY1*VTOT
      CZ1=DCZ1*VTOT
C STORE DIRECTION COSINES AND ENERGY AFTER N COLLISIONS
C FOR LATER REUSE IN PRIMARY GENERATION
      I100=I100+1
      IF(I100.EQ.200) THEN
       DCZ100=DCZ1
       DCX100=DCX1
       DCY100=DCY1
       E100=E1
       I100=0
      ENDIF
      IF(IPRINT.GT.JPRINT) GO TO 200
      GO TO 1
C    INTERMEDIATE PRINTOUT
 200  IPRINT=0
      W=ZTOTS/TTOTS
      W=W*1.0D+09
      WY=YTOTS/TTOTS
      WY=WY*1.0D+09
      JCT=ID/100000
C     IF(J1.EQ.1) WRITE(6,201)
C 201 FORMAT(/,7X,'INTERMEDIATE OUTPUT',/,'    VELZ     POSZ       TIME
C    /      VELY        COUNT    ')
C     WRITE(6,202) W,ZTOTS,TTOTS,WY,JCT
C 202 FORMAT(1X,F8.3,3(1X,D10.3),4X,I6)
      J1=J1+1
      GO TO 1
C  MAIN LOOP END
  700 XID=DFLOAT(ID)
      IF(NELEC.GT.IPRIM) THEN
       ANEION=DFLOAT(NEION)
       ANBT=DFLOAT(NELEC-IPRIM)
       ATTOINT=ANEION/ANBT
       ATTERT=DSQRT(ANEION)/ANEION
       AIOERT=DSQRT(ANBT)/ANBT
      ELSE
       ANEION=DFLOAT(NEION)
       ATTOINT=-1.0D0
       ATTERT=DSQRT(ANEION)/ANEION
      ENDIF
      JCT=ID/100000
      IF(J1.EQ.1) THEN
      WRITE(6,940) NCLUS,ITER
  940 FORMAT(2(/),' PROGRAM STOPPED  (TOO FEW COLLISIONS), DECREASE THE
     /ESTIMATED ALPHA.  NCLUS = ',I7,'  ITER =',I9)
      STOP
      ENDIF
      WRITE(6,878) NELEC,NEION,IPRIM
 878  FORMAT(/,' TOTAL NO OF ELECTRONS=',I8,/,' TOTAL NO OF NEG. IONS=',
     /I8,/,' TOTAL NO OF PRIMARIES=',I8)
      EPRMBAR=0.0D0
      E2PRM=0.0D0
      IF(IPRIM.EQ.1) RETURN
      DO 310 I=1,IPRIM
      E2PRM=E2PRM+EPRM(I)*EPRM(I)
 310  EPRMBAR=EPRMBAR+EPRM(I)
      EBAR=EPRMBAR/IPRIM
      EERR=DSQRT(E2PRM/IPRIM-EBAR**2)
      WRITE(6,836) EBAR,EERR
 836  FORMAT(/,2X,'AVERAGE ENERGY OF PRIMARY ELECTRON =',F10.3,' EV.',/,
     /'   ENERGY SPREAD OF PRIMARY ELECTRON =',F10.3,' EV.')
C     WRITE(6,835) (IESPECP(J),J=1,100)
C835  FORMAT(/,2X,'ENERGY SPECTRUM OF PRIMARY ELECTRONS IN 1 EV. BINS',/
C    /,10(2X,10I5,/))
      RETURN
  315 IF(ITER.GT.NMAX) THEN
       WRITE(6,991) ITER,NMAX,NPONT,NELEC,IPRIM,NMXADD
 991   FORMAT(2(/),' PROGRAM STOPPED.  ITER =',I10,'    NMAX =',I10,/,
     /' NPONT=',I4,' NELEC=',I8,' IPRIM=',I4,' NMXADD=',I3)
       STOP
      ENDIF
      RETURN
      END
      SUBROUTINE TPLANEG(T,E1,CX1,CY1,CZ1,EFLD,IPLANE)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS1/CONST1,CONST2,CONST3,CONST4,CONST5
      COMMON/BFLD/EOVB,WB,BTHETA,BMAG
      COMMON/CION/ALPHAST,VDST,TSTEP,ZSTEP,TFINAL,ZFINAL,ITFINAL,IPRIM
      COMMON/OUTPT/TIME(300),ICOLL(30),SPEC(4000),TMAX1,
     /AVE,DEN,XID,X,Y,Z,ST,NNULL,ICOLN(512)
      COMMON/TPLOUTG/ETPL(8),XTPL(8),YTPL(8),ZTPL(8),TTPL(8),XXTPL(8),
     /YYTPL(8),ZZTPL(8),YZTPL(8),VZTPL(8),VYTPL(8),NETPL(8),ATTOINT,
     /ATTERT,AIOERT
C-----------------------------------------------------------------------
C STORES POSITION, TIME AND ENERGY AND SUMS REQUIRED
C TO CALCULATE DEVIATIONS AND MEANS AT PLANE =IPLANE
C BFIELD AT 90 DEGREES TO EFIELD
C-----------------------------------------------------------------------
      TIMESP=IPLANE*TSTEP
C CALC TIME LEFT TO ARRIVE AT PLANE
      TIMLFT=TIMESP-ST
      T2LFT=TIMLFT*TIMLFT
      WBT=WB*TIMLFT
      COSWT=DCOS(WBT)
      SINWT=DSIN(WBT)
      DZ=(CZ1*SINWT+(EOVB-CY1)*(1.0D0-COSWT))/WB
      CX2=CX1
      CY2=(CY1-EOVB)*COSWT+CZ1*SINWT+EOVB
      CZ2=CZ1*COSWT-(CY1-EOVB)*SINWT
      VTOT=DSQRT(CX2*CX2+CY2*CY2+CZ2*CZ2)
      DCZ2=CZ2/VTOT
      DCY2=CY2/VTOT
      XPLANE=X+CX1*TIMLFT
      YPLANE=Y+EOVB*TIMLFT+((CY1-EOVB)*SINWT+CZ1*(1.0D0-COSWT))/WB
      DZ=(CZ1*SINWT+(EOVB-CY1)*(1.0D0-COSWT))/WB
      ZPLANE=Z+DZ
      EPLANE=E1+DZ*EFLD*100.0D0
      VZPLANE=DCZ2*DSQRT(EPLANE)*CONST3*0.01D0
      VYPLANE=DCY2*DSQRT(EPLANE)*CONST3*0.01D0
      XTPL(IPLANE)=XTPL(IPLANE)+XPLANE
      YTPL(IPLANE)=YTPL(IPLANE)+YPLANE
      ZTPL(IPLANE)=ZTPL(IPLANE)+ZPLANE
      XXTPL(IPLANE)=XXTPL(IPLANE)+XPLANE*XPLANE
      YYTPL(IPLANE)=YYTPL(IPLANE)+YPLANE*YPLANE
      ZZTPL(IPLANE)=ZZTPL(IPLANE)+ZPLANE*ZPLANE
      YZTPL(IPLANE)=YZTPL(IPLANE)+YPLANE*ZPLANE
      ETPL(IPLANE)=ETPL(IPLANE)+EPLANE
      TTPL(IPLANE)=TTPL(IPLANE)+ST+TIMLFT
      VZTPL(IPLANE)=VZTPL(IPLANE)+VZPLANE
      VYTPL(IPLANE)=VYTPL(IPLANE)+VYPLANE
      NETPL(IPLANE)=NETPL(IPLANE)+1
      RETURN
      END
      SUBROUTINE PTG
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CION/ALPHAST,VDST,TSTEP,ZSTEP,TFINAL,ZFINAL,ITFINAL,IPRIM
      COMMON/TPLOUTG/ETPL(8),XTPL(8),YTPL(8),ZTPL(8),TTPL(8),XXTPL(8),
     /YYTPL(8),ZZTPL(8),YZTPL(8),VZTPL(8),VYTPL(8),NETPL(8),ATTOINT,
     /ATTERT,AIOERT
      COMMON/PTTOFG/RI(8),EPT(8),VZPT(8),VYPT(8),TTEST(8)
      DIMENSION ANTPL(8)
C ------------------------------------------------
C CALCULATES PULSED TOWNSEND COEFFICIENTS
C-------------------------------------------------
      ANTPL(1)=DFLOAT(NETPL(1))
      RI(1)=(DLOG(ANTPL(1))-DLOG(DFLOAT(IPRIM)))/TSTEP
      EPT(1)=ETPL(1)/ANTPL(1)
      TTEST(1)=TTPL(1)/ANTPL(1)
      VZPT(1)=1.0D+09*VZTPL(1)/ANTPL(1)
      VYPT(1)=1.0D+09*VYTPL(1)/ANTPL(1)
      DO 10 I=2,ITFINAL
      IF(NETPL(I).EQ.0) THEN
       ITFINAL=I-1
       GO TO 11
      ENDIF
      ANTPL(I)=DFLOAT(NETPL(I))
      RI(I)=(DLOG(ANTPL(I))-DLOG(ANTPL(I-1)))/TSTEP
      EPT(I)=ETPL(I)/ANTPL(I)
      TTEST(I)=TTPL(I)/ANTPL(I)
      VZPT(I)=1.0D+09*VZTPL(I)/ANTPL(I)
      VYPT(I)=1.0D+09*VYTPL(I)/ANTPL(I)
  10  CONTINUE
  11  WRITE(6,900) ITFINAL
 900  FORMAT(2(/),' PULSED TOWNSEND RESULTS AT',I2,' SEQUENTIAL TIME PLA
     /NES',/,'PLANE   (ION-ATT)FRQ.    ENERGY      WVZ       WVY   NO.OF
     / ELECTRONS',/)
      DO 20 IPL=1,ITFINAL
      WRITE(6,910) IPL,RI(IPL),EPT(IPL),VZPT(IPL),VYPT(IPL),NETPL(IPL)
 910  FORMAT(1X,I2,4X,D12.4,4X,F7.2,4X,F6.1,4X,F6.1,4X,I8)
  20  CONTINUE
      RETURN
      END
      SUBROUTINE TOFG
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CION/ALPHAST,VDST,TSTEP,ZSTEP,TFINAL,ZFINAL,ITFINAL,IPRIM
      COMMON/TPLOUTG/ETPL(8),XTPL(8),YTPL(8),ZTPL(8),TTPL(8),XXTPL(8),
     /YYTPL(8),ZZTPL(8),YZTPL(8),VZTPL(8),VYTPL(8),NETPL(8),ATTOINT,
     /ATTERT,AIOERT
      COMMON/TOFGOUT/RALPHA,RALPER,TOFENE,TOFENER,TOFWVZ,TOFWVZER,
     /TOFWVY,TOFWVYER,TOFDZZ,TOFDZZER,TOFDXX,TOFDXXER,TOFDYY,TOFDYYER,
     /TOFDYZ,TOFDYZER,TOFWRZ,TOFWRZER,TOFWRY,TOFWRYER,RATTOF,RATOFER
      COMMON/PTTOFG/RI(8),EPT(8),VZPT(8),VYPT(8),TTEST(8)
      DIMENSION DZTF(8),DXTF(8),DYTF(8),DYZTF(8),WRZ(8),WRY(8),ANTPL(8)
C----------------------------------------------------------
C CALCULATES TIME OF FLIGHT COEFFICIENTS
C---------------------------------------------
      ANTPL(1)=DFLOAT(NETPL(1))
      WRZ(1)=ZTPL(1)/(ANTPL(1)*TSTEP)
      WRY(1)=YTPL(1)/(ANTPL(1)*TSTEP)
      DZTF(1)=((ZZTPL(1)/ANTPL(1))-(ZTPL(1)/ANTPL(1))**2)/(2.0D0*TSTEP)
      DXTF(1)=((XXTPL(1)/ANTPL(1))-(XTPL(1)/ANTPL(1))**2)/(2.0D0*TSTEP)
      DYTF(1)=((YYTPL(1)/ANTPL(1))-(YTPL(1)/ANTPL(1))**2)/(2.0D0*TSTEP)
      DYZTF(1)=((YZTPL(1)/ANTPL(1))-(YTPL(1)*ZTPL(1)/(ANTPL(1)**2)))/(2
     /.0D0*TSTEP)
      DO 10 I=2,ITFINAL
      ANTPL(I)=DFLOAT(NETPL(I))
      WRZ(I)=((ZTPL(I)/ANTPL(I))-(ZTPL(I-1)/ANTPL(I-1)))/TSTEP
      WRY(I)=((YTPL(I)/ANTPL(I))-(YTPL(I-1)/ANTPL(I-1)))/TSTEP
      DZTF(I)=((ZZTPL(I)/ANTPL(I))-(ZTPL(I)/ANTPL(I))**2-(ZZTPL(I-1)/ANT
     /PL(I-1))+(ZTPL(I-1)/ANTPL(I-1))**2)/(2.0D0*TSTEP)
      DXTF(I)=((XXTPL(I)/ANTPL(I))-(XTPL(I)/ANTPL(I))**2-(XXTPL(I-1)/ANT
     /PL(I-1))+(XTPL(I-1)/ANTPL(I-1))**2)/(2.0D0*TSTEP)
      DYTF(I)=((YYTPL(I)/ANTPL(I))-(YTPL(I)/ANTPL(I))**2-(YYTPL(I-1)/ANT
     /PL(I-1))+(YTPL(I-1)/ANTPL(I-1))**2)/(2.0D0*TSTEP)
      DYZTF(I)=((YZTPL(I)/ANTPL(I))-(YTPL(I)*ZTPL(I)/(ANTPL(I)**2))-(YZT
     /PL(I-1)/ANTPL(I-1))+(YTPL(I-1)*ZTPL(I-1)/(ANTPL(I-1)**2)))/(2.0D0*
     /TSTEP)
  10  CONTINUE
      DO 15 I=1,ITFINAL
      WRZ(I)=WRZ(I)*1.0D+09
      WRY(I)=WRY(I)*1.0D+09
      DZTF(I)=DZTF(I)*1.0D+16
      DXTF(I)=DXTF(I)*1.0D+16
      DYTF(I)=DYTF(I)*1.0D+16
      DYZTF(I)=DYZTF(I)*1.0D+16
  15  CONTINUE
      WRITE(6,900) ITFINAL
 900  FORMAT(2(/),' TIME OF FLIGHT RESULTS AT',I2,' SEQUENTIAL TIME PLAN
     /ES',/,'PLANE    DZZ      DXX      DYY      DYZ        WRZ
     /WRY',/)
      DO 20 IPL=1,ITFINAL
      WRITE(6,910) IPL,DZTF(IPL),DXTF(IPL),DYTF(IPL),DYZTF(IPL),WRZ(IPL)
     /,WRY(IPL)
 910  FORMAT(1X,I2,2X,4F9.1,4X,F8.2,4X,F8.2)
  20  CONTINUE
      IF(NETPL(1).GT.NETPL(ITFINAL)) THEN
C        NET ATTACHMENT TAKE RESULTS FROM PLANE 2
       TOFENE=EPT(2)
       TOFENER=100.0D0*DABS((EPT(2)-EPT(3))/(2.0D0*EPT(2)))
       TOFWVZ=VZPT(2)
       TOFWVZER=100.0D0*DABS((VZPT(2)-VZPT(3))/(2.0D0*VZPT(2)))
       TOFWVY=VYPT(2)
       TOFWVYER=100.0D0*DABS((VYPT(2)-VYPT(3))/(2.0D0*VYPT(2)))
       TOFDZZ=DZTF(2)
       TOFDZZER=100.0D0*DABS((DZTF(2)-DZTF(3))/(2.0D0*DZTF(2)))
       TOFDXX=DXTF(2)
       TOFDXXER=100.0D0*DABS((DXTF(2)-DXTF(3))/(2.0D0*DXTF(2)))
       TOFDYY=DYTF(2)
       TOFDYYER=100.0D0*DABS((DYTF(2)-DYTF(3))/(2.0D0*DYTF(2)))
       TOFDYZ=DYZTF(2)
       TOFDYZER=100.0D0*DABS((DYZTF(2)-DYZTF(3))/(2.0D0*DYZTF(2)))
       TOFWRZ=WRZ(2)
       TOFWRY=WRY(2)
       TOFWRZER=100.0D0*DABS((WRZ(2)-WRZ(3))/(2.0D0*WRZ(2)))
       TOFWRYER=100.0D0*DABS((WRY(2)-WRY(3))/(2.0D0*WRY(2)))
        ANST2=DFLOAT(NETPL(2))
        ANST3=DFLOAT(NETPL(3))
        ANST4=ANST3-DSQRT(ANST3)
        ANST5=DLOG(ANST2/ANST3)
        ANST6=DLOG(ANST2/ANST4)
        ANST7=ANST6/ANST5
        ANST8=ANST7-1.0D0
       IF(ATTOINT.EQ.-1.0D0) THEN
C        NO IONISATION
        RALPHA=0.0D0
        RALPER=0.0D0
        RATTOF=-RI(2)
        RATOFER=100.0D0*DSQRT(ANST8**2+ATTERT**2)
       ELSE
        RALPHA=RI(2)/(1.0D0-ATTOINT)
        RALPER=100.0D0*DSQRT(ANST8**2+AIOERT**2)
        RATTOF=ATTOINT*RI(2)/(1.0D0-ATTOINT)
        RATOFER=100.0D0*DSQRT(ANST8**2+ATTERT**2)
       ENDIF
      ELSE
C NET IONISATION TAKE RESULTS FROM PLANE ITFINAL
       I1=ITFINAL
       I2=ITFINAL-1
       TOFENE=EPT(I1)
       TOFENER=100.0D0*DABS((EPT(I1)-EPT(I2))/(2.0D0*EPT(I1)))
       TOFWVZ=VZPT(I1)
       TOFWVZER=100.0D0*DABS((VZPT(I1)-VZPT(I2))/(2.0D0*VZPT(I1)))
       TOFWVY=VYPT(I1)
       TOFWVYER=100.0D0*DABS((VYPT(I1)-VYPT(I2))/(2.0D0*VYPT(I1)))
       TOFDZZ=DZTF(I1)
       TOFDZZER=100.0D0*DABS((DZTF(I1)-DZTF(I2))/(2.0D0*DZTF(I1)))
       TOFDXX=DXTF(I1)
       TOFDXXER=100.0D0*DABS((DXTF(I1)-DXTF(I2))/(2.0D0*DXTF(I1)))
       TOFDYY=DYTF(I1)
       TOFDYYER=100.0D0*DABS((DYTF(I1)-DYTF(I2))/(2.0D0*DYTF(I1)))
       TOFDYZ=DYZTF(I1)
       TOFDYZER=100.0D0*DABS((DYZTF(I1)-DYZTF(I2))/(2.0D0*DYZTF(I1)))
       TOFWRZ=WRZ(I1)
       TOFWRY=WRY(I1)
       TOFWRZER=100.0D0*DABS((WRZ(I1)-WRZ(I2))/(2.0D0*WRZ(I1)))
       TOFWRYER=100.0D0*DABS((WRY(I1)-WRY(I2))/(2.0D0*WRY(I1)))
       ATER=DABS((RI(I1)-RI(I2))/(2.0D0*RI(I1)))
       RALPHA=RI(I1)/(1.0D0-ATTOINT)
       RALPER=100.0D0*DSQRT(ATER**2+AIOERT**2)
       RATTOF=ATTOINT*RI(I1)/(1.0D0-ATTOINT)
       IF(ATTOINT.NE.0.0D0) THEN
        RATOFER=100.0D0*DSQRT(ATER**2+ATTERT**2)
       ELSE
        RATOFER=0.0D0
       ENDIF
      ENDIF
      RETURN
      END
      SUBROUTINE ALPCLCC
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/SETP/TMAX,SMALL,API,ESTART,THETA,PHI,TCFMAX(8),RSTART,
     /EFIELD,NMAX
      COMMON/TOFHOUT/RALPHA,RALPER,TOFENE,TOFENER,TOFWVZ,TOFWVZER,
     /TOFWVY,TOFWVYER,TOFWVX,TOFWVXER,TOFDZZ,TOFDZZER,TOFDXX,TOFDXXER,
     /TOFDYY,TOFDYYER,TOFDYZ,TOFDYZER,TOFDXY,TOFDXYER,TOFDXZ,TOFDXZER,
     /TOFWRZ,TOFWRZER,TOFWRY,TOFWRYER,TOFWRX,TOFWRXER,RATTOF,RATOFER
      COMMON/VEL/WX,WY,WZ
      COMMON/CTOWNS/ALPHA,ATT
      COMMON/CTWNER/ALPER,ATTER
      COMMON/CION/ALPHAST,VDST,TSTEP,ZSTEP,TFINAL,ZFINAL,ITFINAL,IPRIM
C ----------------------------------------------------------------------
C  ESTIMATE TIME STEP  FOR AVALANCHE SIMULATION IN TIME OF FLIGHT SIM.
C  USES ESTIMATED GAIN OF 3.0 BETWEEN PLANES.
C  CALLS TOF AND PT SUBROUTINES AND UPDATES ALPHA AND ATT
C  BFIELD AT ANY ANGLE BTHETA TO EFIELD
C ----------------------------------------------------------------------
      IMAX=NMAX/10000000
      IF(IMAX.LT.5) IMAX=5
      NMAX=IMAX*10000000
      ALPHAST=0.85D0*DABS(ALPHA-ATT)
      VDST=WZ*1.D-5
      TSTEP=DLOG(3.0D0)/(ALPHAST*VDST*1.0D5)
      TSTEP=TSTEP*1.0D12
      TFINAL=7.0D0*TSTEP
      ITFINAL=7
C CALC TIME OF FLIGHT AND PT
      WRITE(6,25)
   25 FORMAT(/,2X,'SOLUTION FOR PULSED TOWNSEND AND TIME OF FLIGHT PARAM
     /ETERS',/,'  ------------------------------------------------------
     /--------')
      WRITE(6,26) TSTEP
   26 FORMAT(1(/),'  TIME STEP BETWEEN SAMPLING PLANES =',D12.5,' PICOSE
     /CS.',/)
      CALL MONTEFTH
      CALL FRIEDLAND
      CALL PTH
      CALL TOFH
      WRITE(6,27) RALPHA,RALPER,RATTOF,RATOFER
   27 FORMAT(/,'PT IONISATION AND ATTACHMENT RATES *10**12/SEC',/,'ALPHA
     /=',D10.3,' +- ',F6.2,' %      ATT=',D10.3,' +- ',F6.2,' %')
      WRITE(6,28)
   28 FORMAT(/,'TOF DIFFUSION')
      WRITE(6,29) TOFDZZ,TOFDZZER,TOFDXX,TOFDXXER,TOFDYY,TOFDYYER,
     /TOFDYZ,TOFDYZER,TOFDXZ,TOFDXZER,TOFDXY,TOFDXYER
   29 FORMAT(/,'DZZ=',F8.1,' +- ',F5.1,' %',/,'DXX=',F8.1,' +- ',F5.1,'
     /%',/,'DYY=',F8.1,' +- ',F5.1,' %',/,'DYZ=',F8.1,' +- ',F5.1,' %',/
     /,'DXZ=',F8.1,' +- ',F5.1,' %',/,'DXY=',F8.1,' +- ',F5.1,' %')
      WRITE(6,30)
   30 FORMAT(/,'TOF DRIFT VELOCITY')
      WRITE(6,31) TOFWRZ,TOFWRZER,TOFWRY,TOFWRYER,TOFWRX,TOFWRXER
   31 FORMAT(/,'WRZ=',F8.2,' +-',F6.1,' %    WRY=',F8.2,' +-',F6.1,' %
     / WRX=',F8.2,' +-',F6.1,' %')
C CALCULATE TOWNSEND SST COEFICIENTS FROM TOF RESULTS
      WRZN=TOFWRZ*1.0D05
      FC1=WRZN/(2.0D0*TOFDZZ)
      FC2=((RALPHA-RATTOF)*1.0D12)/TOFDZZ
      ALPZZ=FC1-DSQRT(FC1**2-FC2)
C-----------------------------------------------------
C LOAD NEW ALPHA AND ATTACHMENT INTO COMMON BLOCKS
C-----------------------------------------------
      ALPATT=ALPHA-ATT
      RATIO=ALPZZ/ALPATT
      ALPHA=ALPHA*RATIO
      ATT=ATT*RATIO
      WRITE(6,32) ALPHA,ALPER,ATT,ATTER
   32 FORMAT(/,'TOWNSEND COEFICIENTS CALCULATED FROM TOF RESULTS:',2(/),
     /'IONISATION RATE /CM.=',D11.4,' +-',F6.2,' %',/,'ATTACHMENT RATE /
     /CM.=',D11.4,' +-',F6.2,' %',/)
C-----------------------------------------------
      RETURN
      END
      SUBROUTINE MONTEFTH
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      COMMON/CNSTS1/CONST1,CONST2,CONST3,CONST4,CONST5
      COMMON/SETP/TMAX,SMALL,API,ESTART,THETA,PHI,TCFMAX(8),RSTART,
     /EFIELD,NMAX
      COMMON/BFLD/EOVB,WB,BTHETA,BMAG
      COMMON/ROTS/RCS,RSN,EFZ100,EFX100,F1,EOVBR
      COMMON/LARGE/CF(4000,512),EIN(512),TCF(4000),IARRY(512),RGAS(512),
     /IPN(512),WPL(512),IPLAST,ISIZE,PENFRA(3,512)
      COMMON/CION/ALPHAST,VDST,TSTEP,ZSTEP,TFINAL,ZFINAL,ITFINAL,IPRIM
      COMMON/OUTPT/TIME(300),ICOLL(30),SPEC(4000),TMAX1,
     /AVE,DEN,XID,X,Y,Z,ST,NNULL,ICOLN(512)
      COMMON/TTRM/ZTOT,TTOT,ZTOTS,TTOTS
      COMMON/IPT/XS(200),YS(200),ZS(200),TS(200),ES(200),
     /DCX(200),DCY(200),DCZ(200),IPL(200)
      COMMON/TPLOUTH/ETPL(8),XTPL(8),YTPL(8),ZTPL(8),TTPL(8),XXTPL(8),
     /YYTPL(8),ZZTPL(8),YZTPL(8),XZTPL(8),XYTPL(8),VZTPL(8),VYTPL(8),
     /VXTPL(8),NETPL(8),ATTOINT,ATTERT,AIOERT
      COMMON/ANIS/PSCT(4000,512),ANGCT(4000,512),INDEX(512),NISO
      DIMENSION EPRM(4000000),IESPECP(100)
C -------------------------------------------------------------------
C   CALCULATES COLLISION EVENTS AND UPDATES DIFFUSION AND VELOCITY.
C   THIS ROUTINE HANDLES TERMINATIONS AT FIXED DRIFT TIMES.
C   SOLVES MOTION IN COORDINATE SYSTEM WITH BFIELD ALIGNED TO X-AXIS
C   ELECTRIC FIELD AT AN ANGLE BTHETA IN THE X-Z PLANE.
C   THE RESULTS FOR THE VELOCITY VECTORS  ARE THEN
C   ROTATED INTO THE STANDARD COORDINATE FRAME WITH THE ELECTRIC FIELD
C   ALONG THE Z-AXIS AND THE BFIELD AT AN ANGLE BTHETA TO THE ELECTRIC
C   FIELD IN THE X-Z PLANE
C -------------------------------------------------------------------
      S=0.0D0
      ST=0.0D0
      X=0.0D0
      Y=0.0D0
      Z=0.0D0
      ZTOT=0.0D0
      ZTOTS=0.0D0
      YTOT=0.0D0
      YTOTS=0.0D0
      XTOT=0.0D0
      XTOTS=0.0D0
      TTOT=0.0D0
      TTOTS=0.0D0
      SMALL=1.0D-20
      TMAX1=0.0D0
      RDUM=RSTART
      E1=ESTART
      CONST9=CONST3*0.01D0
      DO 25 I=1,300
   25 TIME(I)=0.0D0
      DO 26 I=1,30
   26 ICOLL(I)=0
      DO 27 I=1,512
   27 ICOLN(I)=0
      DO 28 I=1,4000
   28 SPEC(I)=0.0D0
      DO 33 I=1,100
   33 IESPECP(I)=0
      DO 34 I=1,8
      ETPL(I)=0.0D0
      XTPL(I)=0.0D0
      YTPL(I)=0.0D0
      ZTPL(I)=0.0D0
      TTPL(I)=0.0D0
      XXTPL(I)=0.0D0
      YYTPL(I)=0.0D0
      ZZTPL(I)=0.0D0
      YZTPL(I)=0.0D0
      XZTPL(I)=0.0D0
      XYTPL(I)=0.0D0
      VZTPL(I)=0.0D0
      VYTPL(I)=0.0D0
      VXTPL(I)=0.0D0
   34 NETPL(I)=0
      ID=0
      N4000=4000
      N300=300
      N100=100
      INTEM=8
      I100=0
      NCOL=0
      NNULL=0
      NELEC=0
      NEION=0
      NMXADD=0
      NPONT=0
      NCLUS=0
      J1=1
      ZSTRT=0.0D0
      YSTRT=0.0D0
      XSTRT=0.0D0
      TSSTRT=0.0D0
      API=DACOS(-1.0D0)
C CALC ROTATION MATRIX ANGLES
      RCS=DCOS((BTHETA-90.0D0)*API/180.0D0)
      RSN=DSIN((BTHETA-90.0D0)*API/180.0D0)
C
      RTHETA=BTHETA*API/180.0D0
      EFZ100=EFIELD*100.0D0*DSIN(RTHETA)
      EFX100=EFIELD*100.0D0*DCOS(RTHETA)
      F1=EFIELD*CONST2*DCOS(RTHETA)
      EOVBR=EOVB*DSIN(RTHETA)
C     INITIAL DIRECTION COSINES
      DCZ1=DCOS(THETA)
      DCX1=DSIN(THETA)*DCOS(PHI)
      DCY1=DSIN(THETA)*DSIN(PHI)
C INITIAL VELOCITY
      VTOT=CONST9*DSQRT(E1)
      CX1=DCX1*VTOT
      CY1=DCY1*VTOT
      CZ1=DCZ1*VTOT
      E100=E1
      DCZ100=DCZ1
      DCX100=DCX1
      DCY100=DCY1
      F4=2.0D0*API
C SET TO MAXIMUM POSSIBLE COLLISION FREQ.
      TLIM=TCFMAX(1)
      DO 35 I=2,INTEM
   35 IF(TLIM.LT.TCFMAX(I)) TLIM=TCFMAX(I)
      JPRINT=NMAX/10
      IPRINT=0
      ITER=0
      IPLANE=0
      IPRIM=0
C  LOOP FOR NEW STARTING ELECTRONS
  544 IPRIM=IPRIM+1
      IF(IPRIM.GT.1) THEN
C CHECK IF PROGRAM WILL EXCEED MAXIMUM NUMBER OF ITERATIONS
C IN THIS CYCLE IF SO OUTPUT CURRENT RESULTS.
       IF(ITER.GT.NMAX) THEN
        IPRIM=IPRIM-1
        GO TO 700
       ENDIF
       X=0.0D0
       Y=0.0D0
       Z=0.0D0
       DCZ1=DCZ100
       DCX1=DCX100
       DCY1=DCY100
       E1=E100
       VTOT=CONST9*DSQRT(E1)
       CX1=DCX1*VTOT
       CY1=DCY1*VTOT
       CZ1=DCZ1*VTOT
       NCLUS=NCLUS+1
       ST=0.0D0
       TSSTRT=0.0D0
       ZSTRT=0.0D0
       YSTRT=0.0D0
       XSTRT=0.0D0
       IPLANE=0
      ENDIF
      IF(IPRIM.GT.4000000) THEN
      WRITE(6,944) IPRIM
 944  FORMAT(/,2X,'PROGRAM STOPPED TOO MANY PRIMARIES IPRIM =',I7)
      GO TO 700
      ENDIF
      EPRM(IPRIM)=E1
      IDUM=DINT(E1)+1
      IDUM=DMIN0(IDUM,N100)
      IESPECP(IDUM)=IESPECP(IDUM)+1
C START OF LOOP FOR NEWLY CREATED ELECTRONS
  555 TDASH=0.0D0
      NELEC=NELEC+1
      TSTOP=TSTEP+IPLANE*TSTEP
C MAIN LOOP
    1 CONTINUE
C     IF(ITER.GT.NMAX)  GO TO 315
      R1=drand48(RDUM)
      T=-DLOG(R1)/TLIM+TDASH
      TDASH=T
      WBT=WB*T
      COSWT=DCOS(WBT)
      SINWT=DSIN(WBT)
  15  IF((T+ST).GE.TSTOP) THEN
       IPLANE=IPLANE+1
       TSTOP=TSTOP+TSTEP
C STORE POSITION AND ENERGY AT TIME PLANE =IPLANE.
       CALL TPLANEH(T,E1,CX1,CY1,CZ1,EFIELD,IPLANE)
C CHECK IF PASSED THROUGH MORE THAN ONE PLANE IN THIS STEP
       IF((T+ST).GE.TSTOP.AND.TSTOP.LE.TFINAL) GO TO 15
       IF((T+ST).GE.TFINAL) THEN
        ZTOT=ZTOT+Z
        YTOT=YTOT+Y
        XTOT=XTOT+X
        TTOT=TTOT+ST
        ZTOTS=ZTOTS+Z-ZSTRT
        YTOTS=YTOTS+Y-YSTRT
        XTOTS=XTOTS+X-XSTRT
        TTOTS=TTOTS+ST-TSSTRT
        TSTOP=TSTEP
C NO MORE ELECTRONS IN CASCADE TRY NEW PRIMARY ELECTRON
        IF(NELEC.EQ.(NCLUS+1)) GO TO 544
C TAKE ELECTRONS FROM STORE
   20   X=XS(NPONT)
        Y=YS(NPONT)
        Z=ZS(NPONT)
        ST=TS(NPONT)
        E1=ES(NPONT)
        DCX1=DCX(NPONT)
        DCY1=DCY(NPONT)
        DCZ1=DCZ(NPONT)
        VTOT=CONST9*DSQRT(E1)
        CX1=DCX1*VTOT
        CY1=DCY1*VTOT
        CZ1=DCZ1*VTOT
        IPLANE=IPL(NPONT)
        NPONT=NPONT-1
        ZSTRT=Z
        YSTRT=Y
        XSTRT=X
        TSSTRT=ST
        GO TO 555
       ENDIF
      ENDIF
      DZ=(CZ1*SINWT+(EOVBR-CY1)*(1.0D0-COSWT))/WB
      DX=CX1*T+F1*T*T
      E=E1+DZ*EFZ100+DX*EFX100
 913  FORMAT(3X,' AFTER STORE ITER=',I10,' DZ=',D12.3,'E1=',D12.3,' COSW
     /T=',D12.3,' SINWT=',D12.3,' WBT=',D12.3,' CY1=',D12.3)
      IF(E.LT.0.0D0) THEN
       WRITE(6,913)ITER,DZ,E,COSWT,SINWT,WBT,CY1
       E=0.001D0
      ENDIF
      IE=DINT(E/ESTEP)+1
      IE=DMIN0(IE,N4000)
C
C     TEST FOR REAL OR NULL COLLISION
C
      R5=drand48(RDUM)
      TTEM=TCF(IE)/TLIM
      IF(R5.LE.TTEM)GO TO 137
      NNULL=NNULL+1
      GO TO 1
C
C  CALCULATE DIRECTION COSINES AND POSITIONS AT INSTANT BEFORE COLLISION
C    ALSO UPDATE DIFFUSION  AND ENERGY CALCULATIONS.
  137 T2=T*T
      IF(T.GE.TMAX1) TMAX1=T
      TDASH=0.0D0
C CALC VELOCITY
      CX2=CX1+2.0D0*F1*T
      CY2=(CY1-EOVBR)*COSWT+CZ1*SINWT+EOVBR
      CZ2=CZ1*COSWT-(CY1-EOVBR)*SINWT
C CALC DIRECTION COSINES
      VTOT=DSQRT(CX2*CX2+CY2*CY2+CZ2*CZ2)
      DCX2=CX2/VTOT
      DCY2=CY2/VTOT
      DCZ2=CZ2/VTOT
      NCOL=NCOL+1
C CALC NEW POSITION
      X=X+DX
      Y=Y+EOVBR*T+((CY1-EOVBR)*SINWT+CZ1*(1.0D0-COSWT))/WB
      Z=Z+DZ
      ST=ST+T
      IT=DINT(T+1.0D0)
      IT=DMIN0(IT,N300)
      TIME(IT)=TIME(IT)+1.0D0
      SPEC(IE)=SPEC(IE)+1.0D0
C ---------------------------------------------------------------------
C     DETERMINATION OF REAL COLLISION TYPE
C ---------------------------------------------------------------------
      R2=drand48(RDUM)
C FIND LOCATION WITHIN 4 UNITS IN COLLISION ARRAY
      CALL SORT(I,R2,IE)
  140 I=I+1
      IF(CF(IE,I).LT.R2) GO TO 140
      S1=RGAS(I)
      EI=EIN(I)
      IF(E.LT.EI) THEN
C     WRITE(6,994) E,EI,ITER
C994  FORMAT(2X,' WARNING ENERGY =',F8.3,' LESS THAN ENERGY LOSS EI=',F8
C    /.3,' AT ITER=',I12,' DUE TO BINNING ERROR')
C FIX ENERGY LOSS SMALLER THAN INCIDENT ENERGY IF A BINING ERROR OCCURS.
      EI=E-0.0001D0
      ENDIF
      IF(IPN(I).EQ.0) GO TO 666
C ATTACHMENT
      IF(IPN(I).EQ.-1) THEN
       NEION=NEION+1
       IPT=IARRY(I)
       ID=ID+1
       ITER=ITER+1
       IPRINT=IPRINT+1
       ICOLL(IPT)=ICOLL(IPT)+1
       ICOLN(I)=ICOLN(I)+1
       IT=DINT(T+1.0D0)
       IT=DMIN0(IT,N300)
       TIME(IT)=TIME(IT)+1.0D0
       ZTOT=ZTOT+Z
       YTOT=YTOT+Y
       XTOT=XTOT+X
       TTOT=TTOT+ST
       ZTOTS=ZTOTS+Z-ZSTRT
       YTOTS=YTOTS+Y-YSTRT
       XTOTS=XTOTS+X-XSTRT
       TTOTS=TTOTS+ST-TSSTRT
C  ELECTRON CAPTURED START NEW PRIMARY
       IF(NELEC.EQ.(NCLUS+1)) GO TO 544
C ELECTRON CAPTURED TAKE NEXT ELECTRON FROM STORE
       GO TO 20
      ENDIF
      R9=drand48(RDUM)
C     ESEC=R9*(E-EI)
C    USE OPAL PETERSON AND BEATY SPLITTING FACTOR.
      ESEC=WPL(I)*TAN(R9*ATAN((E-EI)/(2.0D0*WPL(I))))
      EI=ESEC+EI
C STORE POSITION ,ENERGY, DIRECTION COSINES AND TIME OF GENERATION
C OF IONISATION ELECTRON
      NCLUS=NCLUS+1
      NPONT=NPONT+1
      NMXADD=MAX(NPONT,NMXADD)
      IF(NPONT.GT.200) THEN
      WRITE(6,546) NPONT,ITER
 546  FORMAT(2X,' PROGRAM STOPPED . NPONT=',I4,' ITER=',I10)
      STOP
      ENDIF
      XS(NPONT)=X
      YS(NPONT)=Y
      ZS(NPONT)=Z
      TS(NPONT)=ST
      ES(NPONT)=ESEC
C RANDOMISE SECONDARY ELECTRON DIRECTION
      R3=drand48(RDUM)
      F3=1.0D0-2.0D0*R3
      THETA0=DACOS(F3)
      F6=DCOS(THETA0)
      F5=DSIN(THETA0)
      R4=drand48(rdum)
      PHI0=F4*R4
      F8=DSIN(PHI0)
      F9=DCOS(PHI0)
      DCX(NPONT)=F9*F5
      DCY(NPONT)=F8*F5
      DCZ(NPONT)=F6
      IPL(NPONT)=IPLANE
C
C  GENERATE SCATTERING ANGLES AND UPDATE  LABORATORY COSINES AFTER
C   COLLISION ALSO UPDATE ENERGY OF ELECTRON.
C
  666 IPT=IARRY(I)
      ID=ID+1
      ITER=ITER+1
      IPRINT=IPRINT+1
      ICOLL(IPT)=ICOLL(IPT)+1
      ICOLN(I)=ICOLN(I)+1
C IF EXCITATION THEN ADD PROBABILITY ,PENFRA(1,I),OF TRANSFER TO GIVE
C IONISATION OF THE OTHER GASES IN THE MIXTURE
      IF(IPEN.EQ.0) GO TO 5
      IF(PENFRA(1,I).NE.0.0) THEN
       RAN=drand48(RDUM)
       IF(RAN.GT.PENFRA(1,I)) GO TO 5
       NCLUS=NCLUS+1
       NPONT=NPONT+1
       IF(NPONT.GT.200) THEN
        WRITE(6,546) NPONT,ITER
        STOP
       ENDIF
C ENTER HERE POSSIBLE DELOCALISATION LENGTH FOR PENNING TRANSFER
       IF(PENFRA(2,I).EQ.0.0) THEN
        XS(NPONT)=X
        YS(NPONT)=Y
        ZS(NPONT)=Z
        GO TO 667
       ENDIF
       ASIGN=1.0
       RAN=drand48(RDUM)
       RAN1=drand48(RDUM)
       IF(RAN1.LT.0.5) ASIGN=-ASIGN
       XS(NPONT)=X-DLOG(RAN)*PENFRA(2,I)*ASIGN
       RAN=drand48(RDUM)
       RAN1=drand48(RDUM)
       IF(RAN1.LT.0.5) ASIGN=-ASIGN
       YS(NPONT)=Y-DLOG(RAN)*PENFRA(2,I)*ASIGN
       RAN=drand48(RDUM)
       RAN1=drand48(RDUM)
       IF(RAN1.LT.0.5) ASIGN=-ASIGN
       ZS(NPONT)=Z-DLOG(RAN)*PENFRA(2,I)*ASIGN
C ENTER POSSIBLE PENNING TRANSFER TIME
  667  TPEN=ST
       IF(PENFRA(3,I).EQ.0.0) GO TO 668
       RAN=drand48(RDUM)
       TPEN=ST-DLOG(RAN)*PENFRA(3,I)
  668  TS(NPONT)=TPEN
       ES(NPONT)=1.0
       DCX(NPONT)=DCX1
       DCY(NPONT)=DCY1
       DCZ(NPONT)=DCZ1
C FIND LAST TIME PLANE BEFORE TPEN
       TSTOP1=0.0
       IPLANE1=0
       DO 669 KDUM=1,ITFINAL
       TSTOP1=TSTEP+TSTOP1
       IF(TPEN.LT.TSTOP1) GO TO 670
       IPLANE1=IPLANE1+1
  669  CONTINUE
C PENNING TRANSFER OCCURS AFTER FINAL TIME PLANE. CLEAR ENTRY
       NPONT=NPONT-1
       NCLUS=NCLUS-1
       GO TO 5
  670  IPL(NPONT)=IPLANE1
      ENDIF
    5 S2=(S1*S1)/(S1-1.0D0)
C ANISOTROPIC SCATTERING
      R3=drand48(RDUM)
      IF(INDEX(I).EQ.1) THEN
       R31=drand48(RDUM)
       F3=1.0D0-R3*ANGCT(IE,I)
       IF(R31.GT.PSCT(IE,I)) F3=-F3
      ELSE IF(INDEX(I).EQ.2) THEN
       EPSI=PSCT(IE,I)
       F3=1.0D0-(2.0D0*R3*(1.0D0-EPSI)/(1.0D0+EPSI*(1.0D0-2.0D0*R3)))
      ELSE
C ISOTROPIC SCATTERING
       F3=1.0D0-2.0D0*R3
      ENDIF
      THETA0=DACOS(F3)
      R4=drand48(RDUM)
      PHI0=F4*R4
      F8=DSIN(PHI0)
      F9=DCOS(PHI0)
      IF(E.LT.EI) EI=0.0D0
      ARG1=1.0D0-S1*EI/E
      ARG1=DMAX1(ARG1,SMALL)
      D=1.0D0-F3*DSQRT(ARG1)
      E1=E*(1.0D0-EI/(S1*E)-2.0D0*D/S2)
      E1=DMAX1(E1,SMALL)
      Q=DSQRT((E/E1)*ARG1)/S1
      Q=DMIN1(Q,1.0D0)
      THETA=DASIN(Q*DSIN(THETA0))
      F6=DCOS(THETA)
      U=(S1-1.0D0)*(S1-1.0D0)/ARG1
      CSQD=F3*F3
      IF(F3.LT.0.0D0.AND.CSQD.GT.U) F6=-1.0D0*F6
      F5=DSIN(THETA)
      DCZ2=DMIN1(DCZ2,1.0D0)
      ARGZ=DSQRT(DCX2*DCX2+DCY2*DCY2)
      IF(ARGZ.EQ.0.0D0) THEN
C      WRITE(6,9232) ITER,ID,E1
C9232  FORMAT(3X,'WARNING ARGZ= 0.0 AT ITER =',I10,' ID =',I10,' E1=',E1
C    /2.3)
       DCZ1=F6
       DCX1=F9*F5
       DCY1=F8*F5
       GO TO 190
      ENDIF
      DCZ1=DCZ2*F6+ARGZ*F5*F8
      DCY1=DCY2*F6+(F5/ARGZ)*(DCX2*F9-DCY2*DCZ2*F8)
      DCX1=DCX2*F6-(F5/ARGZ)*(DCY2*F9+DCX2*DCZ2*F8)
  190 CONTINUE
      VTOT=CONST9*DSQRT(E1)
      CX1=DCX1*VTOT
      CY1=DCY1*VTOT
      CZ1=DCZ1*VTOT
C STORE DIRECTION COSINES AND ENERGY AFTER N COLLISIONS
C FOR LATER REUSE IN PRIMARY GENERATION
      I100=I100+1
      IF(I100.EQ.200) THEN
       DCZ100=DCZ1
       DCX100=DCX1
       DCY100=DCY1
       E100=E1
       I100=0
      ENDIF
      IF(IPRINT.GT.JPRINT) GO TO 200
      GO TO 1
C    INTERMEDIATE PRINTOUT
 200  IPRINT=0
      WZ=ZTOTS/TTOTS
      WZ=WZ*1.0D+09
      WY=YTOTS/TTOTS
      WY=WY*1.0D+09
      WX=XTOTS/TTOTS
      WX=WX*1.0D+09
      JCT=ID/100000
C      IF(J1.EQ.1) WRITE(6,201)
C 201 FORMAT(/,7X,'INTERMEDIATE OUTPUT',/,'    VELZ     VELY     VELX
C    /   TIME       COUNT    ')
C ROTATE INTERMEDIATE OUTPUT INTO LAB FRAME
      WZR=WZ*RCS-WX*RSN
      WYR=WY
      WXR=WZ*RSN+WX*RCS
C     WRITE(6,202) WZR,WYR,WXR,TTOTS,JCT
C 202 FORMAT(3(1X,F8.3),1X,D10.3,4X,I6)
      J1=J1+1
      GO TO 1
C  MAIN LOOP END
  700 XID=DFLOAT(ID)
      IF(NELEC.GT.IPRIM) THEN
       ANEION=DFLOAT(NEION)
       ANBT=DFLOAT(NELEC-IPRIM)
       ATTOINT=ANEION/ANBT
       ATTERT=DSQRT(ANEION)/ANEION
       AIOERT=DSQRT(ANBT)/ANBT
      ELSE
       ANEION=DFLOAT(NEION)
       ATTOINT=-1.0D0
       ATTERT=DSQRT(ANEION)/ANEION
      ENDIF
      JCT=ID/100000
      IF(J1.EQ.1) THEN
      WRITE(6,940) NCLUS,ITER
  940 FORMAT(2(/),' PROGRAM STOPPED  (TOO FEW COLLISIONS), DECREASE THE
     /ESTIMATED ALPHA.  NCLUS = ',I7,'  ITER =',I9)
      STOP
      ENDIF
      WRITE(6,878) NELEC,NEION,IPRIM
 878  FORMAT(/,' TOTAL NO OF ELECTRONS=',I8,/,' TOTAL NO OF NEG. IONS=',
     /I8,/,' TOTAL NO OF PRIMARIES=',I8)
      EPRMBAR=0.0D0
      E2PRM=0.0D0
      IF(IPRIM.EQ.1) RETURN
      DO 310 I=1,IPRIM
      E2PRM=E2PRM+EPRM(I)*EPRM(I)
 310  EPRMBAR=EPRMBAR+EPRM(I)
      EBAR=EPRMBAR/IPRIM
      EERR=DSQRT(E2PRM/IPRIM-EBAR**2)
      WRITE(6,836) EBAR,EERR
 836  FORMAT(/,2X,'AVERAGE ENERGY OF PRIMARY ELECTRON =',F10.3,' EV.',/,
     /'   ENERGY SPREAD OF PRIMARY ELECTRON =',F10.3,' EV.')
C     WRITE(6,835) (IESPECP(J),J=1,100)
C835  FORMAT(/,2X,'ENERGY SPECTRUM OF PRIMARY ELECTRONS IN 1 EV. BINS',/
C    /,10(2X,10I5,/))
      RETURN
  315 IF(ITER.GT.NMAX) THEN
       WRITE(6,991) ITER,NMAX,NPONT,NELEC,IPRIM,NMXADD
 991   FORMAT(2(/),' PROGRAM STOPPED.  ITER =',I10,'    NMAX =',I10,/,
     /' NPONT=',I4,' NELEC=',I8,' IPRIM=',I4,' NMXADD=',I3)
       STOP
      ENDIF
      RETURN
      END
      SUBROUTINE TPLANEH(T,E1,CX1,CY1,CZ1,EFLD,IPLANE)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS1/CONST1,CONST2,CONST3,CONST4,CONST5
      COMMON/BFLD/EOVB,WB,BTHETA,BMAG
      COMMON/ROTS/RCS,RSN,EFZ100,EFX100,F1,EOVBR
      COMMON/CION/ALPHAST,VDST,TSTEP,ZSTEP,TFINAL,ZFINAL,ITFINAL,IPRIM
      COMMON/OUTPT/TIME(300),ICOLL(30),SPEC(4000),TMAX1,
     /AVE,DEN,XID,X,Y,Z,ST,NNULL,ICOLN(512)
      COMMON/TPLOUTH/ETPL(8),XTPL(8),YTPL(8),ZTPL(8),TTPL(8),XXTPL(8),
     /YYTPL(8),ZZTPL(8),YZTPL(8),XZTPL(8),XYTPL(8),VZTPL(8),VYTPL(8),
     /VXTPL(8),NETPL(8),ATTOINT,ATTERT,AIOERT
C-----------------------------------------------------------------------
C STORES POSITION, TIME AND ENERGY AND SUMS REQUIRED
C TO CALCULATE DEVIATIONS AND MEANS AT PLANE =IPLANE
C USED WITH BFIELD AT ANGLE BTHETA TO EFIELD
C ROTATES STORED POSITIONS INTO LAB FRAME.
C-----------------------------------------------------------------------
      TIMESP=IPLANE*TSTEP
C CALC TIME LEFT TO ARRIVE AT PLANE
      TIMLFT=TIMESP-ST
      T2LFT=TIMLFT*TIMLFT
      WBT=WB*TIMLFT
      COSWT=DCOS(WBT)
      SINWT=DSIN(WBT)
      CX2=CX1+2.0D0*F1*TIMLFT
      CY2=(CY1-EOVBR)*COSWT+CZ1*SINWT+EOVBR
      CZ2=CZ1*COSWT-(CY1-EOVBR)*SINWT
      VTOT=DSQRT(CX2*CX2+CY2*CY2+CZ2*CZ2)
      DCZ2=CZ2/VTOT
      DCY2=CY2/VTOT
      DCX2=CX2/VTOT
      DX=CX1*TIMLFT+F1*TIMLFT*TIMLFT
      XPLANE=X+DX
      YPLANE=Y+EOVBR*TIMLFT+((CY1-EOVBR)*SINWT+CZ1*(1.0D0-COSWT))/WB
      DZ=(CZ1*SINWT+(EOVBR-CY1)*(1.0D0-COSWT))/WB
      ZPLANE=Z+DZ
C ROTATE POSITIONS
      ZPLANER=ZPLANE*RCS-XPLANE*RSN
      YPLANER=YPLANE
      XPLANER=ZPLANE*RSN+XPLANE*RCS
      EPLANE=E1+DZ*EFZ100+DX*EFX100
      VZPLANE=DCZ2*DSQRT(EPLANE)*CONST3*0.01D0
      VYPLANE=DCY2*DSQRT(EPLANE)*CONST3*0.01D0
      VXPLANE=DCX2*DSQRT(EPLANE)*CONST3*0.01D0
      XTPL(IPLANE)=XTPL(IPLANE)+XPLANER
      YTPL(IPLANE)=YTPL(IPLANE)+YPLANER
      ZTPL(IPLANE)=ZTPL(IPLANE)+ZPLANER
      XXTPL(IPLANE)=XXTPL(IPLANE)+XPLANER*XPLANER
      YYTPL(IPLANE)=YYTPL(IPLANE)+YPLANER*YPLANER
      ZZTPL(IPLANE)=ZZTPL(IPLANE)+ZPLANER*ZPLANER
      YZTPL(IPLANE)=YZTPL(IPLANE)+YPLANER*ZPLANER
      XZTPL(IPLANE)=XZTPL(IPLANE)+XPLANER*ZPLANER
      XYTPL(IPLANE)=XYTPL(IPLANE)+XPLANER*YPLANER
      ETPL(IPLANE)=ETPL(IPLANE)+EPLANE
      TTPL(IPLANE)=TTPL(IPLANE)+ST+TIMLFT
C ROTATE VELOCITIES
      VZPLNER=VZPLANE*RCS-VXPLANE*RSN
      VYPLNER=VYPLANE
      VXPLNER=VZPLANE*RSN+VXPLANE*RCS
      VZTPL(IPLANE)=VZTPL(IPLANE)+VZPLNER
      VYTPL(IPLANE)=VYTPL(IPLANE)+VYPLNER
      VXTPL(IPLANE)=VXTPL(IPLANE)+VXPLNER
      NETPL(IPLANE)=NETPL(IPLANE)+1
      RETURN
      END
      SUBROUTINE PTH
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/ROTS/RCS,RSN,EFZ100,EFX100,F1,EOVBR
      COMMON/CION/ALPHAST,VDST,TSTEP,ZSTEP,TFINAL,ZFINAL,ITFINAL,IPRIM
      COMMON/TPLOUTH/ETPL(8),XTPL(8),YTPL(8),ZTPL(8),TTPL(8),XXTPL(8),
     /YYTPL(8),ZZTPL(8),YZTPL(8),XZTPL(8),XYTPL(8),VZTPL(8),VYTPL(8),
     /VXTPL(8),NETPL(8),ATTOINT,ATTERT,AIOERT
      COMMON/PTTOFH/RI(8),EPT(8),VZPT(8),VYPT(8),VXPT(8),TTEST(8)
      DIMENSION ANTPL(8)
C ------------------------------------------------
C CALCULATES PULSED TOWNSEND COEFFICIENTS
C-------------------------------------------------
      ANTPL(1)=DFLOAT(NETPL(1))
      RI(1)=(DLOG(ANTPL(1))-DLOG(DFLOAT(IPRIM)))/TSTEP
      EPT(1)=ETPL(1)/ANTPL(1)
      TTEST(1)=TTPL(1)/ANTPL(1)
      VZPT(1)=1.0D+09*VZTPL(1)/ANTPL(1)
      VYPT(1)=1.0D+09*VYTPL(1)/ANTPL(1)
      VXPT(1)=1.0D+09*VXTPL(1)/ANTPL(1)
      DO 10 I=2,ITFINAL
      IF(NETPL(I).EQ.0) THEN
       ITFINAL=I-1
       GO TO 11
      ENDIF
      ANTPL(I)=DFLOAT(NETPL(I))
      RI(I)=(DLOG(ANTPL(I))-DLOG(ANTPL(I-1)))/TSTEP
      EPT(I)=ETPL(I)/ANTPL(I)
      TTEST(I)=TTPL(I)/ANTPL(I)
      VZPT(I)=1.0D+09*VZTPL(I)/ANTPL(I)
      VYPT(I)=1.0D+09*VYTPL(I)/ANTPL(I)
      VXPT(I)=1.0D+09*VXTPL(I)/ANTPL(I)
  10  CONTINUE
  11  WRITE(6,900) ITFINAL
 900  FORMAT(2(/),' PULSED TOWNSEND RESULTS AT',I2,' SEQUENTIAL TIME PLA
     /NES',/,'PLANE   (ION-ATT)FRQ.    ENERGY      WVZ       WVY       W
     /VX  NO.OF ELECTRNS',/)
      DO 20 IPL=1,ITFINAL
      WRITE(6,910) IPL,RI(IPL),EPT(IPL),VZPT(IPL),VYPT(IPL),VXPT(IPL),
     /NETPL(IPL)
 910  FORMAT(1X,I2,4X,D12.4,4X,F7.2,4X,F6.1,4X,F6.1,4X,F6.1,4X,I8)
  20  CONTINUE
      RETURN
      END
      SUBROUTINE TOFH
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CION/ALPHAST,VDST,TSTEP,ZSTEP,TFINAL,ZFINAL,ITFINAL,IPRIM
      COMMON/TPLOUTH/ETPL(8),XTPL(8),YTPL(8),ZTPL(8),TTPL(8),XXTPL(8),
     /YYTPL(8),ZZTPL(8),YZTPL(8),XZTPL(8),XYTPL(8),VZTPL(8),VYTPL(8),
     /VXTPL(8),NETPL(8),ATTOINT,ATTERT,AIOERT
      COMMON/TOFHOUT/RALPHA,RALPER,TOFENE,TOFENER,TOFWVZ,TOFWVZER,
     /TOFWVY,TOFWVYER,TOFWVX,TOFWVXER,TOFDZZ,TOFDZZER,TOFDXX,TOFDXXER,
     /TOFDYY,TOFDYYER,TOFDYZ,TOFDYZER,TOFDXY,TOFDXYER,TOFDXZ,TOFDXZER,
     /TOFWRZ,TOFWRZER,TOFWRY,TOFWRYER,TOFWRX,TOFWRXER,RATTOF,RATOFER
      COMMON/PTTOFH/RI(8),EPT(8),VZPT(8),VYPT(8),VXPT(8),TTEST(8)
      DIMENSION DZTF(8),DXTF(8),DYTF(8),DYZTF(8),DXYTF(8),DXZTF(8)
      DIMENSION WRZ(8),WRY(8),WRX(8),ANTPL(8)
C----------------------------------------------------------
C CALCULATES TIME OF FLIGHT COEFFICIENTS
C---------------------------------------------
      ANTPL(1)=DFLOAT(NETPL(1))
      WRZ(1)=ZTPL(1)/(ANTPL(1)*TSTEP)
      WRY(1)=YTPL(1)/(ANTPL(1)*TSTEP)
      WRX(1)=XTPL(1)/(ANTPL(1)*TSTEP)
      DZTF(1)=((ZZTPL(1)/ANTPL(1))-(ZTPL(1)/ANTPL(1))**2)/(2.0D0*TSTEP)
      DXTF(1)=((XXTPL(1)/ANTPL(1))-(XTPL(1)/ANTPL(1))**2)/(2.0D0*TSTEP)
      DYTF(1)=((YYTPL(1)/ANTPL(1))-(YTPL(1)/ANTPL(1))**2)/(2.0D0*TSTEP)
      DYZTF(1)=((YZTPL(1)/ANTPL(1))-(YTPL(1)*ZTPL(1)/(ANTPL(1)**2)))/(2
     /.0D0*TSTEP)
      DXZTF(1)=((XZTPL(1)/ANTPL(1))-(XTPL(1)*ZTPL(1)/(ANTPL(1)**2)))/(2
     /.0D0*TSTEP)
      DXYTF(1)=((XYTPL(1)/ANTPL(1))-(XTPL(1)*YTPL(1)/(ANTPL(1)**2)))/(2
     /.0D0*TSTEP)
      DO 10 I=2,ITFINAL
      ANTPL(I)=DFLOAT(NETPL(I))
      WRZ(I)=((ZTPL(I)/ANTPL(I))-(ZTPL(I-1)/ANTPL(I-1)))/TSTEP
      WRY(I)=((YTPL(I)/ANTPL(I))-(YTPL(I-1)/ANTPL(I-1)))/TSTEP
      WRX(I)=((XTPL(I)/ANTPL(I))-(XTPL(I-1)/ANTPL(I-1)))/TSTEP
      DZTF(I)=((ZZTPL(I)/ANTPL(I))-(ZTPL(I)/ANTPL(I))**2-(ZZTPL(I-1)/ANT
     /PL(I-1))+(ZTPL(I-1)/ANTPL(I-1))**2)/(2.0D0*TSTEP)
      DXTF(I)=((XXTPL(I)/ANTPL(I))-(XTPL(I)/ANTPL(I))**2-(XXTPL(I-1)/ANT
     /PL(I-1))+(XTPL(I-1)/ANTPL(I-1))**2)/(2.0D0*TSTEP)
      DYTF(I)=((YYTPL(I)/ANTPL(I))-(YTPL(I)/ANTPL(I))**2-(YYTPL(I-1)/ANT
     /PL(I-1))+(YTPL(I-1)/ANTPL(I-1))**2)/(2.0D0*TSTEP)
      DYZTF(I)=((YZTPL(I)/ANTPL(I))-(YTPL(I)*ZTPL(I)/(ANTPL(I)**2))-(YZT
     /PL(I-1)/ANTPL(I-1))+(YTPL(I-1)*ZTPL(I-1)/(ANTPL(I-1)**2)))/(2.0D0*
     /TSTEP)
      DXZTF(I)=((XZTPL(I)/ANTPL(I))-(XTPL(I)*ZTPL(I)/(ANTPL(I)**2))-(XZT
     /PL(I-1)/ANTPL(I-1))+(XTPL(I-1)*ZTPL(I-1)/(ANTPL(I-1)**2)))/(2.0D0*
     /TSTEP)
      DXYTF(I)=((XYTPL(I)/ANTPL(I))-(XTPL(I)*YTPL(I)/(ANTPL(I)**2))-(XYT
     /PL(I-1)/ANTPL(I-1))+(XTPL(I-1)*YTPL(I-1)/(ANTPL(I-1)**2)))/(2.0D0*
     /TSTEP)
  10  CONTINUE
      DO 15 I=1,ITFINAL
      WRZ(I)=WRZ(I)*1.0D+09
      WRY(I)=WRY(I)*1.0D+09
      WRX(I)=WRX(I)*1.0D+09
      DZTF(I)=DZTF(I)*1.0D+16
      DXTF(I)=DXTF(I)*1.0D+16
      DYTF(I)=DYTF(I)*1.0D+16
      DYZTF(I)=DYZTF(I)*1.0D+16
      DXZTF(I)=DXZTF(I)*1.0D+16
      DXYTF(I)=DXYTF(I)*1.0D+16
  15  CONTINUE
      WRITE(6,900) ITFINAL
 900  FORMAT(2(/),' TIME OF FLIGHT RESULTS AT',I2,' SEQUENTIAL TIME PLAN
     /ES',/,'PLANE    DZZ     DXX     DYY     DYZ     DXZ     DXY      W
     /RZ     WRY     WRX',/)
      DO 20 IPL=1,ITFINAL
      WRITE(6,910) IPL,DZTF(IPL),DXTF(IPL),DYTF(IPL),DYZTF(IPL),
     /DXZTF(IPL),DXYTF(IPL),WRZ(IPL),WRY(IPL),WRX(IPL)
 910  FORMAT(1X,I2,2X,6F8.1,3F8.2)
  20  CONTINUE
      IF(NETPL(1).GT.NETPL(ITFINAL)) THEN
C        NET ATTACHMENT TAKE RESULTS FROM PLANE 2
       TOFENE=EPT(2)
       TOFENER=100.0D0*DABS((EPT(2)-EPT(3))/(2.0D0*EPT(2)))
       TOFWVZ=VZPT(2)
       TOFWVZER=100.0D0*DABS((VZPT(2)-VZPT(3))/(2.0D0*VZPT(2)))
       TOFWVY=VYPT(2)
       TOFWVYER=100.0D0*DABS((VYPT(2)-VYPT(3))/(2.0D0*VYPT(2)))
       TOFWVX=VXPT(2)
       TOFWVXER=100.0D0*DABS((VXPT(2)-VXPT(3))/(2.0D0*VXPT(2)))
       TOFDZZ=DZTF(2)
       TOFDZZER=100.0D0*DABS((DZTF(2)-DZTF(3))/(2.0D0*DZTF(2)))
       TOFDXX=DXTF(2)
       TOFDXXER=100.0D0*DABS((DXTF(2)-DXTF(3))/(2.0D0*DXTF(2)))
       TOFDYY=DYTF(2)
       TOFDYYER=100.0D0*DABS((DYTF(2)-DYTF(3))/(2.0D0*DYTF(2)))
       TOFDYZ=DYZTF(2)
       TOFDYZER=100.0D0*DABS((DYZTF(2)-DYZTF(3))/(2.0D0*DYZTF(2)))
       TOFDXZ=DXZTF(2)
       TOFDXZER=100.0D0*DABS((DXZTF(2)-DXZTF(3))/(2.0D0*DXZTF(2)))
       TOFDXY=DXYTF(2)
       TOFDXYER=100.0D0*DABS((DXYTF(2)-DXYTF(3))/(2.0D0*DXYTF(2)))
       TOFWRZ=WRZ(2)
       TOFWRY=WRY(2)
       TOFWRX=WRX(2)
       TOFWRZER=100.0D0*DABS((WRZ(2)-WRZ(3))/(2.0D0*WRZ(2)))
       TOFWRYER=100.0D0*DABS((WRY(2)-WRY(3))/(2.0D0*WRY(2)))
       TOFWRXER=100.0D0*DABS((WRX(2)-WRX(3))/(2.0D0*WRX(2)))
        ANST2=DFLOAT(NETPL(2))
        ANST3=DFLOAT(NETPL(3))
        ANST4=ANST3-DSQRT(ANST3)
        ANST5=DLOG(ANST2/ANST3)
        ANST6=DLOG(ANST2/ANST4)
        ANST7=ANST6/ANST5
        ANST8=ANST7-1.0D0
       IF(ATTOINT.EQ.-1.0D0) THEN
C        NO IONISATION
        RALPHA=0.0D0
        RALPER=0.0D0
        RATTOF=-RI(2)
        RATOFER=100.0D0*DSQRT(ANST8**2+ATTERT**2)
       ELSE
        RALPHA=RI(2)/(1.0D0-ATTOINT)
        RALPER=100.0D0*DSQRT(ANST8**2+AIOERT**2)
        RATTOF=ATTOINT*RI(2)/(1.0D0-ATTOINT)
        RATOFER=100.0D0*DSQRT(ANST8**2+ATTERT**2)
       ENDIF
      ELSE
C NET IONISATION TAKE RESULTS FROM PLANE ITFINAL
       I1=ITFINAL
       I2=ITFINAL-1
       TOFENE=EPT(I1)
       TOFENER=100.0D0*DABS((EPT(I1)-EPT(I2))/(2.0D0*EPT(I1)))
       TOFWVZ=VZPT(I1)
       TOFWVZER=100.0D0*DABS((VZPT(I1)-VZPT(I2))/(2.0D0*VZPT(I1)))
       TOFWVY=VYPT(I1)
       TOFWVYER=100.0D0*DABS((VYPT(I1)-VYPT(I2))/(2.0D0*VYPT(I1)))
       TOFWVX=VXPT(I1)
       TOFWVXER=100.0D0*DABS((VXPT(I1)-VXPT(I2))/(2.0D0*VXPT(I1)))
       TOFDZZ=DZTF(I1)
       TOFDZZER=100.0D0*DABS((DZTF(I1)-DZTF(I2))/(2.0D0*DZTF(I1)))
       TOFDXX=DXTF(I1)
       TOFDXXER=100.0D0*DABS((DXTF(I1)-DXTF(I2))/(2.0D0*DXTF(I1)))
       TOFDYY=DYTF(I1)
       TOFDYYER=100.0D0*DABS((DYTF(I1)-DYTF(I2))/(2.0D0*DYTF(I1)))
       TOFDYZ=DYZTF(I1)
       TOFDYZER=100.0D0*DABS((DYZTF(I1)-DYZTF(I2))/(2.0D0*DYZTF(I1)))
       TOFDXZ=DXZTF(I1)
       TOFDXZER=100.0D0*DABS((DXZTF(I1)-DXZTF(I2))/(2.0D0*DXZTF(I1)))
       TOFDXY=DXYTF(I1)
       TOFDXYER=100.0D0*DABS((DXYTF(I1)-DXYTF(I2))/(2.0D0*DXYTF(I1)))
       TOFWRZ=WRZ(I1)
       TOFWRY=WRY(I1)
       TOFWRX=WRX(I1)
       TOFWRZER=100.0D0*DABS((WRZ(I1)-WRZ(I2))/(2.0D0*WRZ(I1)))
       TOFWRYER=100.0D0*DABS((WRY(I1)-WRY(I2))/(2.0D0*WRY(I1)))
       TOFWRXER=100.0D0*DABS((WRX(I1)-WRX(I2))/(2.0D0*WRX(I1)))
       ATER=DABS((RI(I1)-RI(I2))/(2.0D0*RI(I1)))
       RALPHA=RI(I1)/(1.0D0-ATTOINT)
       RALPER=100.0D0*DSQRT(ATER**2+AIOERT**2)
       RATTOF=ATTOINT*RI(I1)/(1.0D0-ATTOINT)
       IF(ATTOINT.NE.0.0D0) THEN
        RATOFER=100.0D0*DSQRT(ATER**2+ATTERT**2)
       ELSE
        RATOFER=0.0D0
       ENDIF
      ENDIF
      RETURN
      END
      SUBROUTINE ALPCLCA
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/SETP/TMAX,SMALL,API,ESTART,THETA,PHI,TCFMAX(8),RSTART,
     /EFIELD,NMAX
      COMMON/TOFOUT/RALPHA,RALPER,TOFENE,TOFENER,TOFWV,TOFWVER,
     /TOFDL,TOFDLER,TOFDT,TOFDTER,TOFWR,TOFWRER,RATTOF,RATOFER
      COMMON/VEL/WX,WY,WZ
      COMMON/CTOWNS/ALPHA,ATT
      COMMON/CTWNER/ALPER,ATTER
      COMMON/CION/ALPHAST,VDST,TSTEP,ZSTEP,TFINAL,ZFINAL,ITFINAL,IPRIM
C ---------------------------------------------------------------------
C  ESTIMATE TIME STEP FOR AVALANCHE SIMULATION IN TIME OF FLIGHT SIM.
C  USES ESTIMATED GAIN OF 3.0 BETWEEN PLANES.
C  CALLS TOF AND PT SUBROUTINES AND UPDATES ALPHA AND ATT
C  VERSION WITH BFIELD PARALLEL TO EFIELD
C ------------------------------------------------------------------
      IMAX=NMAX/10000000
      IF(IMAX.LT.5) IMAX=5
      NMAX=IMAX*10000000
      ALPHAST=0.85D0*DABS(ALPHA-ATT)
      VDST=WZ*1.D-5
      TSTEP=DLOG(3.0D0)/(ALPHAST*VDST*1.0D5)
      TSTEP=TSTEP*1.0D12
      TFINAL=7.0D0*TSTEP
      ITFINAL=7
C CALC TIME OF FLIGHT AND PT
      WRITE(6,25)
   25 FORMAT(/,2X,'SOLUTION FOR PULSED TOWNSEND AND TIME OF FLIGHT PARAM
     /ETERS',/,'  ------------------------------------------------------
     /--------')
      WRITE(6,26) TSTEP
   26 FORMAT(1(/),'  TIME STEP BETWEEN SAMPLING PLANES =',D12.5,' PICOSE
     /CS.',/)
      CALL MONTEFTA
      CALL FRIEDLAND
      CALL PT
      CALL TOF
      WRITE(6,27) RALPHA,RALPER,RATTOF,RATOFER
   27 FORMAT(/,'PT IONISATION AND ATTACHMENT RATES *10**12/SEC',/,'ALPHA
     /=',D10.3,' +- ',F6.2,' %      ATT=',D10.3,' +- ',F6.2,' %')
      WRITE(6,28)
   28 FORMAT(/,' TOF DIFFUSION')
      WRITE(6,29) TOFDL,TOFDLER,TOFDT,TOFDTER
   29 FORMAT(/,'  DL=',F8.1,' +- ',F6.1,' %       DT=',F8.1,' +- ',F6.1,
     /' %')
      WRITE(6,30)
   30 FORMAT(/,' TOF DRIFT VELOCITY')
      WRITE(6,31) TOFWR,TOFWRER
   31 FORMAT(/,'    WR=',F8.2,' +- ',F6.2,' %')
C CALCULATE TOWNSEND SST COEFICIENTS FROM TOF RESULTS
      WRN=TOFWR*1.0D05
      FC1=WRN/(2.0D0*TOFDL)
      FC2=((RALPHA-RATTOF)*1.0D12)/TOFDL
      ALPZZ=FC1-DSQRT(FC1**2-FC2)
C---------------------------------------------------
C LOAD NEW ALPHA AND ATTACHMENT INTO COMMON BLOCKS
C-----------------------------------------------
      ALPATT=ALPHA-ATT
      RATIO=ALPZZ/ALPATT
      ALPHA=ALPHA*RATIO
      ATT=ATT*RATIO
      WRITE(6,32) ALPHA,ALPER,ATT,ATTER
  32  FORMAT(/,'TOWNSEND COEFICIENTS CALCULATED FROM TOF RESULTS:',2(/),
     /'IONISATION RATE /CM.=',D11.4,' +-',F6.2,' %',/,'ATTACHMENT RATE /
     /CM.=',D11.4,' +-',F6.2,' %',/)
C-----------------------------------------------
      RETURN
      END
      SUBROUTINE MONTEFTA
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      COMMON/CNSTS1/CONST1,CONST2,CONST3,CONST4,CONST5
      COMMON/SETP/TMAX,SMALL,API,ESTART,THETA,PHI,TCFMAX(8),RSTART,
     /EFIELD,NMAX
      COMMON/BFLD/EOVB,WB,BTHETA,BMAG
      COMMON/LARGE/CF(4000,512),EIN(512),TCF(4000),IARRY(512),RGAS(512),
     /IPN(512),WPL(512),IPLAST,ISIZE,PENFRA(3,512)
      COMMON/CION/ALPHAST,VDST,TSTEP,ZSTEP,TFINAL,ZFINAL,ITFINAL,IPRIM
      COMMON/OUTPT/TIME(300),ICOLL(30),SPEC(4000),TMAX1,
     /AVE,DEN,XID,X,Y,Z,ST,NNULL,ICOLN(512)
      COMMON/TTRM/ZTOT,TTOT,ZTOTS,TTOTS
      COMMON/IPT/XS(200),YS(200),ZS(200),TS(200),ES(200),
     /DCX(200),DCY(200),DCZ(200),IPL(200)
      COMMON/TPLOUT/ETPL(8),XTPL(8),YTPL(8),ZTPL(8),TTPL(8),XXTPL(8),
     /YYTPL(8),ZZTPL(8),VZTPL(8),NETPL(8),ATTOINT,ATTERT,AIOERT
      COMMON/ANIS/PSCT(4000,512),ANGCT(4000,512),INDEX(512),NISO
      DIMENSION EPRM(4000000),IESPECP(100)
C -------------------------------------------------------------------
C   CALCULATES COLLISION EVENTS AND UPDATES DIFFUSION AND VELOCITY.
C   THIS ROUTINE HANDLES TERMINATIONS AT FIXED DRIFT TIMES.
C   BFIELD PARALLEL TO EFIELD
C -------------------------------------------------------------------
      S=0.0D0
      ST=0.0D0
      X=0.0D0
      Y=0.0D0
      Z=0.0D0
      ZTOT=0.0D0
      ZTOTS=0.0D0
      TTOT=0.0D0
      TTOTS=0.0D0
      SMALL=1.0D-20
      TMAX1=0.0D0
      RDUM=RSTART
      E1=ESTART
      CONST9=CONST3*0.01D0
      DO 25 I=1,300
   25 TIME(I)=0.0D0
      DO 26 I=1,30
   26 ICOLL(I)=0
      DO 27 I=1,512
   27 ICOLN(I)=0
      DO 28 I=1,4000
   28 SPEC(I)=0.0D0
      DO 33 I=1,100
   33 IESPECP(I)=0
      DO 34 I=1,8
      ETPL(I)=0.0D0
      XTPL(I)=0.0D0
      YTPL(I)=0.0D0
      ZTPL(I)=0.0D0
      TTPL(I)=0.0D0
      XXTPL(I)=0.0D0
      YYTPL(I)=0.0D0
      ZZTPL(I)=0.0D0
      VZTPL(I)=0.0D0
   34 NETPL(I)=0
      ID=0
      N4000=4000
      N300=300
      N100=100
      INTEM=8
      I100=0
      NCOL=0
      NNULL=0
      NELEC=0
      NEION=0
      NMXADD=0
      NPONT=0
      NCLUS=0
      J1=1
      ZSTRT=0.0D0
      TSSTRT=0.0D0
C     INITIAL DIRECTION COSINES
      DCZ1=DCOS(THETA)
      DCX1=DSIN(THETA)*DCOS(PHI)
      DCY1=DSIN(THETA)*DSIN(PHI)
C INITIAL VELOCITY
      VTOT=CONST9*DSQRT(E1)
      CX1=DCX1*VTOT
      CY1=DCY1*VTOT
      CZ1=DCZ1*VTOT
      E100=E1
      DCZ100=DCZ1
      DCX100=DCX1
      DCY100=DCY1
      BP=EFIELD*EFIELD*CONST1
      F1=EFIELD*CONST2
      F2=EFIELD*CONST3
      API=DACOS(-1.0D0)
      F4=2.0D0*API
C SET TO MAXIMUM POSSIBLE COLLISION FREQ.
      TLIM=TCFMAX(1)
      DO 35 I=2,INTEM
   35 IF(TLIM.LT.TCFMAX(I)) TLIM=TCFMAX(I)
      JPRINT=NMAX/10
      IPRINT=0
      ITER=0
      IPLANE=0
      IPRIM=0
C  LOOP FOR NEW STARTING ELECTRONS
  544 IPRIM=IPRIM+1
      IF(IPRIM.GT.1) THEN
C CHECK IF PROGRAM WILL EXCEED MAXIMUM NUMBER OF ITERATIONS
C IN THIS CYCLE IF SO OUTPUT CURRENT RESULTS.
       IF(ITER.GT.NMAX) THEN
        IPRIM=IPRIM-1
        GO TO 700
       ENDIF
       X=0.0D0
       Y=0.0D0
       Z=0.0D0
       DCZ1=DCZ100
       DCX1=DCX100
       DCY1=DCY100
       E1=E100
       VTOT=CONST9*DSQRT(E1)
       CX1=DCX1*VTOT
       CY1=DCY1*VTOT
       CZ1=DCZ1*VTOT
       NCLUS=NCLUS+1
       ST=0.0D0
       TSSTRT=0.0D0
       ZSTRT=0.0D0
       IPLANE=0
      ENDIF
      IF(IPRIM.GT.4000000) THEN
      WRITE(6,944) IPRIM
 944  FORMAT(/,2X,'PROGRAM STOPPED TOO MANY PRIMARIES IPRIM =',I7)
      GO TO 700
      ENDIF
      EPRM(IPRIM)=E1
      IDUM=DINT(E1)+1
      IDUM=DMIN0(IDUM,N100)
      IESPECP(IDUM)=IESPECP(IDUM)+1
C START OF LOOP FOR NEWLY CREATED ELECTRONS
  555 TDASH=0.0D0
      NELEC=NELEC+1
      TSTOP=TSTEP+IPLANE*TSTEP
C MAIN LOOP
    1 CONTINUE
C     IF(ITER.GT.NMAX)  GO TO 315
      R1=drand48(RDUM)
      T=-DLOG(R1)/TLIM+TDASH
      TDASH=T
      AP=DCZ1*F2*DSQRT(E1)
  15  IF((T+ST).GE.TSTOP) THEN
       IPLANE=IPLANE+1
       TSTOP=TSTOP+TSTEP
C STORE POSITION AND ENERGY AT TIME PLANE =IPLANE.
       CALL TPLANEA(T,E1,CX1,CY1,DCZ1,AP,BP,EFIELD,IPLANE)
C CHECK IF PASSED THROUGH MORE THAN ONE PLANE IN THIS STEP
       IF((T+ST).GE.TSTOP.AND.TSTOP.LE.TFINAL) GO TO 15
       IF((T+ST).GE.TFINAL) THEN
        ZTOT=ZTOT+Z
        TTOT=TTOT+ST
        ZTOTS=ZTOTS+Z-ZSTRT
        TTOTS=TTOTS+ST-TSSTRT
        TSTOP=TSTEP
C NO MORE ELECTRONS IN CASCADE TRY NEW PRIMARY ELECTRON
        IF(NELEC.EQ.(NCLUS+1)) GO TO 544
C TAKE ELECTRONS FROM STORE
   20   X=XS(NPONT)
        Y=YS(NPONT)
        Z=ZS(NPONT)
        ST=TS(NPONT)
        E1=ES(NPONT)
        DCX1=DCX(NPONT)
        DCY1=DCY(NPONT)
        DCZ1=DCZ(NPONT)
        VTOT=CONST9*DSQRT(E1)
        CX1=DCX1*VTOT
        CY1=DCY1*VTOT
        CZ1=DCZ1*VTOT
        IPLANE=IPL(NPONT)
        NPONT=NPONT-1
        ZSTRT=Z
        TSSTRT=ST
        GO TO 555
       ENDIF
      ENDIF
 913  FORMAT(3X,' AFTER STORE ITER=',I10,' E1=',D12.3,' T=',D12.3,' AP='
     /,D12.3,' BP=',D12.3,' DCZ1=',D12.3)
      E=E1+(AP+BP*T)*T
      IF(E.LT.0.0D0) THEN
       WRITE(6,913)ITER,E,E1,AP,BP,DCZ1
       E=0.001D0
      ENDIF
      IE=DINT(E/ESTEP)+1
      IE=DMIN0(IE,N4000)
C
C     TEST FOR REAL OR NULL COLLISION
C
      R5=drand48(RDUM)
      TTEM=TCF(IE)/TLIM
      IF(R5.LE.TTEM)GO TO 137
      NNULL=NNULL+1
      GO TO 1
C
C  CALCULATE DIRECTION COSINES AND POSITIONS AT INSTANT BEFORE COLLISION
C    ALSO UPDATE DIFFUSION  AND ENERGY CALCULATIONS.
  137 T2=T*T
      IF(T.GE.TMAX1) TMAX1=T
      TDASH=0.0D0
      WBT=WB*T
      COSWT=DCOS(WBT)
      SINWT=DSIN(WBT)
      CONST6=DSQRT(E1/E)
      CX2=CX1*COSWT-CY1*SINWT
      CY2=CY1*COSWT+CX1*SINWT
      VTOT=CONST9*DSQRT(E)
      DCX2=CX2/VTOT
      DCY2=CY2/VTOT
      DCZ2=DCZ1*CONST6+EFIELD*T*CONST5/DSQRT(E)
      CONST7=CONST9*DSQRT(E1)
      A=T*CONST7
      NCOL=NCOL+1
      DX=(CX1*SINWT-CY1*(1.0D0-COSWT))/WB
      X=X+DX
      DY=(CY1*SINWT+CX1*(1.0D0-COSWT))/WB
      Y=Y+DY
      Z=Z+DCZ1*A+T2*F1
      ST=ST+T
      IT=DINT(T+1.0D0)
      IT=DMIN0(IT,N300)
      TIME(IT)=TIME(IT)+1.0D0
      SPEC(IE)=SPEC(IE)+1.0D0
C ---------------------------------------------------------------------
C     DETERMINATION OF REAL COLLISION TYPE
C ---------------------------------------------------------------------
C     R2=RNDM2(RDUM)
      R2=drand48(RDUM)
C FIND LOCATION WITHIN 4 UNITS IN COLLISION ARRAY
      CALL SORT(I,R2,IE)
  140 I=I+1
      IF(CF(IE,I).LT.R2) GO TO 140
      S1=RGAS(I)
      EI=EIN(I)
      IF(E.LT.EI) THEN
C     WRITE(6,994) E,EI,ITER
C994  FORMAT(2X,' WARNING ENERGY =',F8.3,' LESS THAN ENERGY LOSS EI=',F8
C    /.3,' AT ITER=',I12,' DUE TO BINNING ERROR')
C FIX ENERGY LOSS SMALLER THAN INCIDENT ENERGY IF A BINING ERROR OCCURS.
      EI=E-0.0001D0
      ENDIF
      IF(IPN(I).EQ.0) GO TO 666
C ATTACHMENT
      IF(IPN(I).EQ.-1) THEN
       NEION=NEION+1
       IPT=IARRY(I)
       ID=ID+1
       ITER=ITER+1
       IPRINT=IPRINT+1
       ICOLL(IPT)=ICOLL(IPT)+1
       ICOLN(I)=ICOLN(I)+1
       IT=DINT(T+1.0D0)
       IT=DMIN0(IT,N300)
       TIME(IT)=TIME(IT)+1.0D0
       ZTOT=ZTOT+Z
       TTOT=TTOT+ST
       ZTOTS=ZTOTS+Z-ZSTRT
       TTOTS=TTOTS+ST-TSSTRT
C  ELECTRON CAPTURED START NEW PRIMARY
       IF(NELEC.EQ.(NCLUS+1)) GO TO 544
C ELECTRON CAPTURED TAKE NEXT ELECTRON FROM STORE
       GO TO 20
      ENDIF
      R9=drand48(RDUM)
C     ESEC=R9*(E-EI)
C    USE OPAL PETERSON AND BEATY SPLITTING FACTOR.
      ESEC=WPL(I)*TAN(R9*ATAN((E-EI)/(2.0D0*WPL(I))))
      EI=ESEC+EI
C STORE POSITION ,ENERGY, DIRECTION COSINES AND TIME OF GENERATION
C OF IONISATION ELECTRON
      NCLUS=NCLUS+1
      NPONT=NPONT+1
      NMXADD=MAX(NPONT,NMXADD)
      IF(NPONT.GT.200) THEN
      WRITE(6,546) NPONT,ITER
 546  FORMAT(2X,' PROGRAM STOPPED . NPONT=',I4,' ITER=',I10)
      STOP
      ENDIF
      XS(NPONT)=X
      YS(NPONT)=Y
      ZS(NPONT)=Z
      TS(NPONT)=ST
      ES(NPONT)=ESEC
C RANDOMISE SECONDARY ELECTRON DIRECTION
      R3=drand48(RDUM)
      F3=1.0D0-2.0D0*R3
      THETA0=DACOS(F3)
      F6=DCOS(THETA0)
      F5=DSIN(THETA0)
      R4=drand48(rdum)
      PHI0=F4*R4
      F8=DSIN(PHI0)
      F9=DCOS(PHI0)
      DCX(NPONT)=F9*F5
      DCY(NPONT)=F8*F5
      DCZ(NPONT)=F6
      IPL(NPONT)=IPLANE
C
C  GENERATE SCATTERING ANGLES AND UPDATE  LABORATORY COSINES AFTER
C   COLLISION ALSO UPDATE ENERGY OF ELECTRON.
C
  666 IPT=IARRY(I)
      ID=ID+1
      ITER=ITER+1
      IPRINT=IPRINT+1
      ICOLL(IPT)=ICOLL(IPT)+1
      ICOLN(I)=ICOLN(I)+1
C IF EXCITATION THEN ADD PROBABILITY ,PENFRA(1,I),OF TRANSFER TO GIVE
C IONISATION OF THE OTHER GASES IN THE MIXTURE
      IF(IPEN.EQ.0) GO TO 5
      IF(PENFRA(1,I).NE.0.0) THEN
       RAN=drand48(RDUM)
       IF(RAN.GT.PENFRA(1,I)) GO TO 5
       NCLUS=NCLUS+1
       NPONT=NPONT+1
       IF(NPONT.GT.200) THEN
        WRITE(6,546) NPONT,ITER
        STOP
       ENDIF
C ENTER HERE POSSIBLE DELOCALISATION LENGTH FOR PENNING TRANSFER
       IF(PENFRA(2,I).EQ.0.0) THEN
        XS(NPONT)=X
        YS(NPONT)=Y
        ZS(NPONT)=Z
        GO TO 667
       ENDIF
       ASIGN=1.0
       RAN=drand48(RDUM)
       RAN1=drand48(RDUM)
       IF(RAN1.LT.0.5) ASIGN=-ASIGN
       XS(NPONT)=X-DLOG(RAN)*PENFRA(2,I)*ASIGN
       RAN=drand48(RDUM)
       RAN1=drand48(RDUM)
       IF(RAN1.LT.0.5) ASIGN=-ASIGN
       YS(NPONT)=Y-DLOG(RAN)*PENFRA(2,I)*ASIGN
       RAN=drand48(RDUM)
       RAN1=drand48(RDUM)
       IF(RAN1.LT.0.5) ASIGN=-ASIGN
       ZS(NPONT)=Z-DLOG(RAN)*PENFRA(2,I)*ASIGN
C ENTER POSSIBLE PENNING TRANSFER TIME
  667  TPEN=ST
       IF(PENFRA(3,I).EQ.0.0) GO TO 668
       RAN=drand48(RDUM)
       TPEN=ST-DLOG(RAN)*PENFRA(3,I)
  668  TS(NPONT)=TPEN
       ES(NPONT)=1.0
       DCX(NPONT)=DCX1
       DCY(NPONT)=DCY1
       DCZ(NPONT)=DCZ1
C FIND LAST TIME PLANE BEFORE TPEN
       TSTOP1=0.0
       IPLANE1=0
       DO 669 KDUM=1,ITFINAL
       TSTOP1=TSTEP+TSTOP1
       IF(TPEN.LT.TSTOP1) GO TO 670
       IPLANE1=IPLANE1+1
  669  CONTINUE
C PENNING TRANSFER OCCURS AFTER FINAL TIME PLANE. CLEAR ENTRY
       NPONT=NPONT-1
       NCLUS=NCLUS-1
       GO TO 5
  670  IPL(NPONT)=IPLANE1
      ENDIF
    5 S2=(S1*S1)/(S1-1.0D0)
C ANISOTROPIC SCATTERING
      R3=drand48(RDUM)
      IF(INDEX(I).EQ.1) THEN
       R31=drand48(RDUM)
       F3=1.0D0-R3*ANGCT(IE,I)
       IF(R31.GT.PSCT(IE,I)) F3=-F3
      ELSE IF(INDEX(I).EQ.2) THEN
       EPSI=PSCT(IE,I)
       F3=1.0D0-(2.0D0*R3*(1.0D0-EPSI)/(1.0D0+EPSI*(1.0D0-2.0D0*R3)))
      ELSE
C ISOTROPIC SCATTERING
       F3=1.0D0-2.0D0*R3
      ENDIF
      THETA0=DACOS(F3)
      R4=drand48(RDUM)
      PHI0=F4*R4
      F8=DSIN(PHI0)
      F9=DCOS(PHI0)
      IF(E.LT.EI) EI=0.0D0
      ARG1=1.0D0-S1*EI/E
      ARG1=DMAX1(ARG1,SMALL)
      D=1.0D0-F3*DSQRT(ARG1)
      E1=E*(1.0D0-EI/(S1*E)-2.0D0*D/S2)
      E1=DMAX1(E1,SMALL)
      Q=DSQRT((E/E1)*ARG1)/S1
      Q=DMIN1(Q,1.0D0)
      THETA=DASIN(Q*DSIN(THETA0))
      F6=DCOS(THETA)
      U=(S1-1.0D0)*(S1-1.0D0)/ARG1
      CSQD=F3*F3
      IF(F3.LT.0.0D0.AND.CSQD.GT.U) F6=-1.0D0*F6
      F5=DSIN(THETA)
      DCZ2=DMIN1(DCZ2,1.0D0)
      ARGZ=DSQRT(DCX2*DCX2+DCY2*DCY2)
      IF(ARGZ.EQ.0.0D0) THEN
C      WRITE(6,9232) ITER,ID,E1
C9232  FORMAT(3X,'WARNING ARGZ= 0.0 AT ITER =',I10,' ID =',I10,' E1=',E1
C    /2.3)
       DCZ1=F6
       DCX1=F9*F5
       DCY1=F8*F5
       GO TO 190
      ENDIF
      DCZ1=DCZ2*F6+ARGZ*F5*F8
      DCY1=DCY2*F6+(F5/ARGZ)*(DCX2*F9-DCY2*DCZ2*F8)
      DCX1=DCX2*F6-(F5/ARGZ)*(DCY2*F9+DCX2*DCZ2*F8)
  190 CONTINUE
      VTOT=CONST9*DSQRT(E1)
      CX1=DCX1*VTOT
      CY1=DCY1*VTOT
      CZ1=DCZ1*VTOT
C STORE DIRECTION COSINES AND ENERGY AFTER N COLLISIONS
C FOR LATER REUSE IN PRIMARY GENERATION
      I100=I100+1
      IF(I100.EQ.200) THEN
       DCZ100=DCZ1
       DCX100=DCX1
       DCY100=DCY1
       E100=E1
       I100=0
      ENDIF
      IF(IPRINT.GT.JPRINT) GO TO 200
      GO TO 1
C    INTERMEDIATE PRINTOUT
 200  IPRINT=0
      W=ZTOTS/TTOTS
      W=W*1.0D+09
      JCT=ID/100000
C     IF(J1.EQ.1) WRITE(6,201)
C 201 FORMAT(/,7X,'INTERMEDIATE OUTPUT',/,'    VEL      POS        TIME
C    /       COUNT    ')
C     WRITE(6,202) W,ZTOTS,TTOTS,JCT
C 202 FORMAT(1X,F8.3,2(1X,D10.3),4X,I6)
      J1=J1+1
      GO TO 1
C  MAIN LOOP END
  700 XID=DFLOAT(ID)
      IF(NELEC.GT.IPRIM) THEN
       ANEION=DFLOAT(NEION)
       ANBT=DFLOAT(NELEC-IPRIM)
       ATTOINT=ANEION/ANBT
       ATTERT=DSQRT(ANEION)/ANEION
       AIOERT=DSQRT(ANBT)/ANBT
      ELSE
       ANEION=DFLOAT(NEION)
       ATTOINT=-1.0D0
       ATTERT=DSQRT(ANEION)/ANEION
      ENDIF
      JCT=ID/100000
      IF(J1.EQ.1) THEN
      WRITE(6,940) NCLUS,ITER
  940 FORMAT(2(/),' PROGRAM STOPPED  (TOO FEW COLLISIONS), DECREASE THE
     /ESTIMATED ALPHA.  NCLUS = ',I7,'  ITER =',I9)
      STOP
      ENDIF
      WRITE(6,878) NELEC,NEION,IPRIM
 878  FORMAT(/,' TOTAL NO OF ELECTRONS=',I8,/,' TOTAL NO OF NEG. IONS=',
     /I8,/,' TOTAL NO OF PRIMARIES=',I8)
      EPRMBAR=0.0D0
      E2PRM=0.0D0
      IF(IPRIM.EQ.1) RETURN
      DO 310 I=1,IPRIM
      E2PRM=E2PRM+EPRM(I)*EPRM(I)
 310  EPRMBAR=EPRMBAR+EPRM(I)
      EBAR=EPRMBAR/IPRIM
      EERR=DSQRT(E2PRM/IPRIM-EBAR**2)
      WRITE(6,836) EBAR,EERR
 836  FORMAT(/,2X,'AVERAGE ENERGY OF PRIMARY ELECTRON =',F10.3,' EV.',/,
     /'   ENERGY SPREAD OF PRIMARY ELECTRON =',F10.3,' EV.')
C     WRITE(6,835) (IESPECP(J),J=1,100)
C835  FORMAT(/,2X,'ENERGY SPECTRUM OF PRIMARY ELECTRONS IN 1 EV. BINS',/
C    /,10(2X,10I5,/))
      RETURN
  315 IF(ITER.GT.NMAX) THEN
       WRITE(6,991) ITER,NMAX,NPONT,NELEC,IPRIM,NMXADD
 991   FORMAT(2(/),' PROGRAM STOPPED.  ITER =',I10,'    NMAX =',I10,/,
     /' NPONT=',I4,' NELEC=',I8,' IPRIM=',I4,' NMXADD=',I3)
       STOP
      ENDIF
      RETURN
      END
      SUBROUTINE TPLANEA(T,E1,CX1,CY1,DCZ1,AP,BP,EFLD,IPLANE)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS1/CONST1,CONST2,CONST3,CONST4,CONST5
      COMMON/BFLD/EOVB,WB,BTHETA,BMAG
      COMMON/CION/ALPHAST,VDST,TSTEP,ZSTEP,TFINAL,ZFINAL,ITFINAL,IPRIM
      COMMON/OUTPT/TIME(300),ICOLL(30),SPEC(4000),TMAX1,
     /AVE,DEN,XID,X,Y,Z,ST,NNULL,ICOLN(512)
      COMMON/TPLOUT/ETPL(8),XTPL(8),YTPL(8),ZTPL(8),TTPL(8),XXTPL(8),
     /YYTPL(8),ZZTPL(8),VZTPL(8),NETPL(8),ATTOINT,ATTERT,AIOERT
C-----------------------------------------------------------------------
C STORES POSITION, TIME AND ENERGY AND SUMS REQUIRED
C TO CALCULATE DEVIATIONS AND MEANS AT PLANE =IPLANE
C-----------------------------------------------------------------------
      TIMESP=IPLANE*TSTEP
C CALC TIME LEFT TO ARRIVE AT PLANE
      TIMLFT=TIMESP-ST
      T2LFT=TIMLFT*TIMLFT
      A=AP*TIMLFT
      B=BP*T2LFT
      EPLANE=E1+A+B
      WBT=WB*TIMLFT
      COSWT=DCOS(WBT)
      SINWT=DSIN(WBT)
      CONST6=DSQRT(E1/EPLANE)
      DCZ2=DCZ1*CONST6+EFLD*TIMLFT*CONST5/DSQRT(EPLANE)
      XPLANE=X+(CX1*SINWT-CY1*(1.0D0-COSWT))/WB
      YPLANE=Y+(CY1*SINWT+CX1*(1.0D0-COSWT))/WB
      ZPLANE=Z+DCZ1*TIMLFT*DSQRT(E1)*CONST3*0.01D0+T2LFT*EFLD*CONST2
      VZPLANE=DCZ2*DSQRT(EPLANE)*CONST3*0.01D0
      XTPL(IPLANE)=XTPL(IPLANE)+XPLANE
      YTPL(IPLANE)=YTPL(IPLANE)+YPLANE
      ZTPL(IPLANE)=ZTPL(IPLANE)+ZPLANE
      XXTPL(IPLANE)=XXTPL(IPLANE)+XPLANE*XPLANE
      YYTPL(IPLANE)=YYTPL(IPLANE)+YPLANE*YPLANE
      ZZTPL(IPLANE)=ZZTPL(IPLANE)+ZPLANE*ZPLANE
      ETPL(IPLANE)=ETPL(IPLANE)+EPLANE
      TTPL(IPLANE)=TTPL(IPLANE)+ST+TIMLFT
      VZTPL(IPLANE)=VZTPL(IPLANE)+VZPLANE
      NETPL(IPLANE)=NETPL(IPLANE)+1
      RETURN
      END
      DOUBLE PRECISION FUNCTION DMAX0(IA,IB)
      INTEGER*8 IA,IB
      IF(IA.LT.IB) THEN
       DMAX0=IB
      ELSE
       DMAX0=IA
      ENDIF
      RETURN
      END
      DOUBLE PRECISION FUNCTION DMIN0(IA,IB)
      INTEGER*8 IA,IB,IONE
      IONE=1
      IF(IA.GT.IB) THEN
       DMIN0=IB
      ELSE IF(IA.LT.IONE) THEN
       DMIN0=IONE
      ELSE
       DMIN0=IA
      ENDIF
      RETURN
      END
      DOUBLE PRECISION FUNCTION drand48(DUMMY)
*-----------------------------------------------------------------------
*   RNDM2  - Returns double precision random numbers by calling RM48.
*   (Last changed on  5/ 2/00.)
*-----------------------------------------------------------------------
       implicit none
       INTEGER NVEC
       PARAMETER(NVEC=1000)
       DOUBLE PRECISION RVEC(NVEC),DUMMY
       INTEGER IVEC
       DATA IVEC/0/
       SAVE RVEC,IVEC
*** Now generate random number between 0 and one.
       IF(IVEC.EQ.0.OR.IVEC.GE.NVEC)THEN
            CALL RM48(RVEC,NVEC)
            IVEC=1
       ELSE
            IVEC=IVEC+1
       ENDIF
*** Assign result.
       drand48=RVEC(IVEC)
       END
CCCCCCCC
*
* $Id: rm48.F,v 1.2 1996/12/12 16:32:06 cernlib Exp $
*
* $Log: rm48.F,v $
* Revision 1.2  1996/12/12 16:32:06  cernlib
* Variables ONE and ZERO added to SAVE statement, courtesy R.Veenhof
*
* Revision 1.1.1.1  1996/04/01 15:02:55  mclareni
* Mathlib gen
*
*
*#include "gen/pilot.h"
      SUBROUTINE RM48(RVEC,LENV)
C     Double-precision version of
C Universal random number generator proposed by Marsaglia and Zaman
C in report FSU-SCRI-87-50
C        based on RANMAR, modified by F. James, to generate vectors
C        of pseudorandom numbers RVEC of length LENV, where the numbers
C        in RVEC are numbers with at least 48-bit mantissas.
C   Input and output entry points: RM48IN, RM48UT.
C!!! ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
C!!!  Calling sequences for RM48:                                    ++
C!!!      CALL RM48 (RVEC, LEN)     returns a vector RVEC of LEN     ++
C!!!                   64-bit random floating point numbers between  ++
C!!!                   zero and one.                                 ++
C!!!      CALL RM48IN(I1,N1,N2)   initializes the generator from one ++
C!!!                   64-bit integer I1, and number counts N1,N2    ++
C!!!                  (for initializing, set N1=N2=0, but to restart ++
C!!!                    a previously generated sequence, use values  ++
C!!!                    output by RM48UT)                            ++
C!!!      CALL RM48UT(I1,N1,N2)   outputs the value of the original  ++
C!!!                  seed and the two number counts, to be used     ++
C!!!                  for restarting by initializing to I1 and       ++
C!!!                  skipping N2*100000000+N1 numbers.              ++
C!!! ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
C for 32-bit machines, use IMPLICIT DOUBLE PRECISION
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      DIMENSION RVEC(*)
      COMMON/R48ST1/U(97),C,I97,J97
      PARAMETER (MODCNS=1000000000)
      SAVE CD, CM, TWOM24, NTOT, NTOT2, IJKL,TWOM49, ONE, ZERO
      DATA NTOT,NTOT2,IJKL/-1,0,0/
C
      IF (NTOT .GE. 0)  GO TO 50
C
C        Default initialization. User has called RM48 without RM48IN.
      IJKL = 54217137
      NTOT = 0
      NTOT2 = 0
      KALLED = 0
      GO TO 1
C
      ENTRY      RM48IN(IJKLIN, NTOTIN,NTOT2N)
C         Initializing routine for RM48, may be called before
C         generating pseudorandom numbers with RM48.   The input
C         values should be in the ranges:  0<=IJKLIN<=900 OOO OOO
C                                          0<=NTOTIN<=999 999 999
C                                          0<=NTOT2N<<999 999 999!
C To get the standard values in Marsaglia's paper, IJKLIN=54217137
C                                            NTOTIN,NTOT2N=0
      IJKL = IJKLIN
      NTOT = MAX(NTOTIN,0)
      NTOT2= MAX(NTOT2N,0)
      KALLED = 1
C          always come here to initialize
    1 CONTINUE
      IJ = IJKL/30082
      KL = IJKL - 30082*IJ
      I = MOD(IJ/177, 177) + 2
      J = MOD(IJ, 177)     + 2
      K = MOD(KL/169, 178) + 1
      L = MOD(KL, 169)
      WRITE(6,'(A,I10,2X,2I10)') ' RM48 INITIALIZED:',IJKL,NTOT,NTOT2
CCC      PRINT '(A,4I10)', '   I,J,K,L= ',I,J,K,L
      ONE = 1.
      HALF = 0.5
      ZERO = 0.
      DO 2 II= 1, 97
      S = 0.
      T = HALF
      DO 3 JJ= 1, 48
         M = MOD(MOD(I*J,179)*K, 179)
         I = J
         J = K
         K = M
         L = MOD(53*L+1, 169)
         IF (MOD(L*M,64) .GE. 32)  S = S+T
    3    T = HALF*T
    2 U(II) = S
      TWOM49 = T
      TWOM24 = ONE
      DO 4 I24= 1, 24
    4 TWOM24 = HALF*TWOM24
      C  =   362436.*TWOM24
      CD =  7654321.*TWOM24
      CM = 16777213.*TWOM24
      I97 = 97
      J97 = 33
C       Complete initialization by skipping
C            (NTOT2*MODCNS + NTOT) random numbers
      DO 45 LOOP2= 1, NTOT2+1
      NOW = MODCNS
      IF (LOOP2 .EQ. NTOT2+1)  NOW=NTOT
      IF (NOW .GT. 0)  THEN
      WRITE(6,'(A,I15)') ' RM48IN SKIPPING OVER ',NOW
          DO 40 IDUM = 1, NTOT
          UNI = U(I97)-U(J97)
          IF (UNI .LT. ZERO)  UNI=UNI+ONE
          U(I97) = UNI
          I97 = I97-1
          IF (I97 .EQ. 0)  I97=97
          J97 = J97-1
          IF (J97 .EQ. 0)  J97=97
          C = C - CD
          IF (C .LT. ZERO)  C=C+CM
   40     CONTINUE
      ENDIF
   45 CONTINUE
      IF (KALLED .EQ. 1)  RETURN
C
C          Normal entry to generate LENV random numbers
   50 CONTINUE
      DO 100 IVEC= 1, LENV
      UNI = U(I97)-U(J97)
      IF (UNI .LT. ZERO)  UNI=UNI+ONE
      U(I97) = UNI
      I97 = I97-1
      IF (I97 .EQ. 0)  I97=97
      J97 = J97-1
      IF (J97 .EQ. 0)  J97=97
      C = C - CD
      IF (C .LT. ZERO)  C=C+CM
      UNI = UNI-C
      IF (UNI .LT. ZERO) UNI=UNI+ONE
      RVEC(IVEC) = UNI
C             Replace exact zeros by 2**-49
         IF (UNI .EQ. ZERO)  THEN
            RVEC(IVEC) = TWOM49
         ENDIF
  100 CONTINUE
      NTOT = NTOT + LENV
         IF (NTOT .GE. MODCNS)  THEN
         NTOT2 = NTOT2 + 1
         NTOT = NTOT - MODCNS
         ENDIF
      RETURN
C           Entry to output current status
      ENTRY RM48UT(IJKLUT,NTOTUT,NTOT2T)
      IJKLUT = IJKL
      NTOTUT = NTOT
      NTOT2T = NTOT2
      RETURN
      END
      SUBROUTINE GAS1(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      DIMENSION XEN(132),YELM(132),YELT(132),YEPS(132),
     /XVBV4(17),YVBV4(17),XVBV1(17),YVBV1(17),XVBV3(17),YVBV3(17),
     /XVIB5(18),YVIB5(18),XVIB6(18),YVIB6(18),
     /XEXC(31),YEXC(31),XION(52),YION(52),YINC(52),XATT(11),YATT(11)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      DATA XEN/0.0,.001,.002,.003,.004,.005,.006,.007,.008,.009,
     /0.01,.012,.014,.016,.018,0.02,.025,0.03,.035,0.04,
     /.045,0.05,.055,0.06,.065,0.07,.075,0.08,.085,0.09,
     /0.10,0.12,0.14,0.17,0.20,0.24,0.30,0.40,0.50,0.60,
     /0.80,1.00,1.20,1.40,1.70,2.00,3.00,5.00,6.00,7.00,
     /8.00,9.00,10.0,12.0,15.0,20.0,25.0,30.0,40.0,50.0,
     /60.0,80.0,100.,125.,150.,200.,250.,300.,400.,500.,
     /600.,700.,800.,1000.,1250.,1500.,1750.,2000.,2500.,3000.,
     /3500.,4000.,5000.,6000.,7000.,8000.,9000.,10000.,1.25D4,1.50D4,
     /1.75D4,2.0D4,2.5D4,3.0D4,3.5D4,4.0D4,4.5D4,5.0D4,6.0D4,7.0D4,
     /8.0D4,9.0D4,1.0D5,1.25D5,1.5D5,1.75D5,2.0D5,2.5D5,3.0D5,3.5D5,
     /4.0D5,4.5D5,5.0D5,6.0D5,7.0D5,8.0D5,9.0D5,1.0D6,1.25D6,1.5D6,
     /1.75D6,2.0D6,2.5D6,3.0D6,3.5D6,4.0D6,4.5D6,5.0D6,6.0D6,7.0D6,
     /8.0D6,1.0D7/
C ELASTIC MOMENTUM TRANSFER X-SECTION
      DATA YELM/12.5,8.70,7.00,5.95,5.20,4.70,4.30,3.95,3.65,3.40,
     /3.20,2.85,2.58,2.37,2.19,2.04,1.77,1.57,1.41,1.30,
     /1.20,1.12,1.05,0.99,0.93,0.88,0.84,0.80,0.76,0.72,
     /0.65,0.48,0.35,0.29,0.29,0.34,0.47,0.87,1.35,1.85,
     /2.95,4.00,4.75,5.15,5.45,5.65,5.80,6.00,6.10,6.30,
     /6.50,6.80,7.20,8.30,9.50,10.1,9.60,8.80,7.85,6.72,
     /5.90,5.06,4.16,3.57,2.99,1.92,1.53,1.20,0.88,0.66,
     /.525,0.43,0.37,0.30,.228,.169,.131,.104,.0711,.0519,
     /.0397,.0314,.0212,.0153,.0117,.00918,.00743,.00615,.00412,.00297,
     /2.25D-3,1.77D-3,1.18D-3,8.51D-4,6.45D-4,5.08D-4,4.12D-4,3.41D-4,
     /2.47D-4,1.88D-4,
     /1.49D-4,1.21D-4,1.01D-4,6.88D-5,5.05D-5,3.90D-5,3.13D-5,2.17D-5,
     /1.62D-5,1.27D-5,
     /1.03D-5,8.56D-6,7.27D-6,5.49D-6,4.34D-6,3.54D-6,2.96D-6,2.52D-6,
     /1.81D-6,1.36D-6,
     /1.07D-6,8.68D-7,6.08D-7,4.53D-7,3.51D-7,2.82D-7,2.31D-7,1.93D-7,
     /1.42D-7,1.08D-7,
     /8.59D-8,5.79D-8/
C ELASTIC X-SECTION ASSUMED ISOTROPIC BELOW 0.6 EV
      DATA YELT/12.5,8.70,7.00,5.95,5.20,4.70,4.30,3.95,3.65,3.40,
     /3.20,2.85,2.58,2.37,2.19,2.04,1.77,1.57,1.41,1.30,
     /1.20,1.12,1.05,0.99,0.93,0.88,0.84,0.80,0.76,0.72,
     /0.65,0.48,0.35,0.29,0.29,0.34,0.47,0.87,1.35,1.85,
     /3.77,4.89,5.66,6.43,7.43,8.34,10.6,12.5,11.6,11.0,
     /11.0,11.7,12.9,14.5,16.8,17.6,18.1,17.2,15.9,14.9,
     /14.3,13.0,11.7,10.5,9.65,8.10,6.83,6.02,5.02,4.36,
     /3.83,3.40,3.08,2.65,2.17,1.89,1.55,1.40,1.19,1.11,
     /.921,.822,.696,.568,.492,.435,.390,.353,.286,.241,
     /.209,.185,.150,.127,.111,.0984,.0888,.0810,.0694,.0611,
     /.0522,.050,.0461,.0391,.0344,.0311,.0287,.0253,.0230,.0214,
     /.0202,.0193,.0186,.0176,.0169,.0164,.0160,.0157,.0152,.0148,
     /.0146,.0145,.0143,.0142,.0141,.0141,.0140,.0140,.0140,.0139,
     /.0139,.0139/
C EPSILON FOR ELASTIC ANGULAR DISTRIBUTION
      DATA YEPS/40*0.0,
     /.31944,.26899,.23839,.29336,.38730,.46203,.62112,.69396,.64495,
     /.59170,
     /.57021,.58174,.60860,.59206,.60014,.59037,.63994,.66049,.67963,
     /.72329,
     /.76015,.78141,.81052,.82334,.84708,.89820,.90642,.92120,.93462,
     /.94699,
     /.95392,.95883,.96167,.96468,.96812,.97439,.97626,.980014,.984995,
     /.989075,
     /.990155,.991558,.993652,.994554,.995333,.995972,.996446,.996814,
     /.997470,.997904,
     /.998217,.998451,.998772,.998984,.999141,.999251,.999339,.999410,
     /.999514,.999589,
     /.999647,.999688,.999722,.999783,.999824,.999853,.999874,.999904,
     /.999923,.999936,
     /.999946,.999954,.999960,.999969,.999975,.999979,.999982,.999985,
     /.999989,.999992,
     /.999993,.999995,.999996,.999997,.999998,.999998,.999999,.999999,
     /.999999,.999999,
     /.999999,.999999/
C  VIBRATION V4 (RESONANCE ONLY)
      DATA XVBV4/0.0783,4.00,5.00,6.00,7.00,8.00,9.00,10.0,15.0,20.0,
     /50.0,100.,1000.,10000.,1.D5,1.D6,1.D7/
      DATA YVBV4/0.0,0.0,0.05,0.35,1.06,1.40,1.26,0.97,0.07,.022,
     /1.D-4,1.D-5,1.D-6,1.D-7,1.D-8,1.D-9,1.D-9/
C  VIBRATION V1 (RESONANCE ONLY)
      DATA XVBV1/0.1126,4.00,5.00,6.00,7.00,8.00,9.00,10.0,15.0,20.0,
     /50.0,100.,1000.,10000.,1.D5,1.D6,1.D7/
      DATA YVBV1/0.0,0.0,.016,.118,0.36,0.47,0.42,0.33,.023,.007,
     /3.D-5,3.D-6,3.D-7,3.D-8,3.D-9,3.D-10,3.D-10/
C  VIBRATION V3 (RESONANCE ONLY)
      DATA XVBV3/0.1588,4.00,5.00,6.00,7.00,8.00,9.00,10.0,15.0,20.0,
     /50.0,100.,1000.,1.D4,1.D5,1.D6,1.D7/
      DATA YVBV3/0.0,0.0,0.15,1.05,3.19,4.20,3.78,2.90,0.20,.067,
     /1.D-4,1.D-5,1D-6,1.D-7,1.D-8,1.D-9,1.D-9/
C  VIBRATION HARMONIC 2(V3)
      DATA XVIB5/0.3176,1.00,4.00,5.00,6.00,7.00,8.00,9.00,10.0,15.0,
     /20.0,50.0,100.0,1000.,1.D4,1.D5,1.D6,1.D7/
      DATA YVIB5/0.0,.001,0.01,.031,0.23,0.67,0.87,0.79,0.60,.042,
     /.014,.0006,1.D-5,1.D-6,1.D-7,1.D-8,1.D-9,1.D-9/
C VIBRATION HARMONIC (3(V3) + ALL OTHER HARMONICS)
      DATA XVIB6/0.4764,1.00,4.00,5.00,6.00,7.00,8.00,9.00,10.0,15.0,
     /20.0,50.0,100.,1000.,1.D4,1.D5,1.D6,1.D7/
      DATA YVIB6/0.0,.001,0.05,0.13,0.88,2.66,3.50,3.15,2.43,.168,
     /.043,.001,1.D-4,1.D-5,1.D-6,1.D-7,1.D-8,1.D-8/
C
      DATA XION/15.9,16.0,17.0,18.0,19.0,20.0,22.0,24.0,26.0,28.0,
     /30.0,32.0,34.0,36.0,38.0,40.0,42.0,44.0,46.0,48.0,
     /50.0,60.0,70.0,80.0,90.0,100.,125.,150.,175.,200.,
     /250.,300.,350.,400.,450.,500.,600.,700.,800.,900.,
     /1000.,1250.,1500.,1750.,2000.,2500.,3000.,4000.,5000.,6000.,
     /8000.,10000./
C GROSS IONISATION
      DATA YION/0.0,.034,.080,.137,.204,.295,.479,.656,.937,1.19,
     /1.41,1.62,1.83,2.03,2.18,2.38,2.60,2.78,2.98,3.25,
     /3.41,3.97,4.39,4.76,4.91,5.12,5.31,5.28,5.21,5.10,
     /4.78,4.59,4.31,4.05,3.83,3.51,3.11,2.83,2.61,2.38,
     /2.23,1.89,1.64,1.50,1.34,1.15,0.99,.784,.652,.561,
     /.439,.363/
C COUNTING IONISATION
      DATA YINC/0.0,.034,.080,.137,.204,.295,.479,.656,.937,1.19,
     /1.41,1.62,1.83,2.03,2.18,2.38,2.60,2.78,2.98,3.25,
     /3.41,3.97,4.39,4.73,4.86,5.04,5.21,5.15,5.08,4.95,
     /4.64,4.45,4.18,3.91,3.70,3.39,3.00,2.73,2.52,2.30,
     /2.15,1.82,1.58,1.45,1.29,1.11,.955,.757,.629,.541,
     /.424,.350/
C ATTACHMENT
      DATA XATT/4.00,4.10,5.00,6.00,7.00,8.00,9.00,10.0,11.0,
     /12.0,100./
      DATA YATT/.0,.00001,.00092,.0066,.0135,.0142,.0051,.0010,.0004,
     /.00001,.0000001/
C  DISSOCIATION X-SECTION EXCLUDING DISSOCIATIVE IONISATION X-SECTION
      DATA XEXC/12.56,13.0,14.0,15.0,16.0,18.0,20.0,25.0,30.0,35.0,
     /40.0,45.0,50.0,60.0,70.0,80.0,100.,120.,140.,160.,
     /180.,200.,250.,300.,400.,500.,600.,1000.,2000.,4000.,
     /10000./
      DATA YEXC/0.0,.030,.080,.180,0.31,0.54,0.74,1.03,1.18,1.28,
     /1.35,1.38,1.41,1.43,1.44,1.44,1.43,1.41,1.40,1.36,
     /1.34,1.30,1.24,1.14,0.99,0.83,0.72,0.47,0.28,0.16,
     /.076/
C ----------------------------------------------------------------------
C   NEW ANALYSIS UPDATED TO MARCH  2008
C   ALLOWS SUPERELASTIC SCATTERING TO V2,V4,V1 AND V3 VIBRATIONAL LEVELS
C   BORN ANGULAR DISTRIBUTION FOR  V4 AND V3 VIBRATIONAL LEVELS
C   INCLUDED NEW IONISATION X-SECTIONS BY NISHIMURA AND READJUSTED
C   DISSOCIATION X-SECTION TO FIT TOWNSEND MEASUREMENTS.
C   ELASTIC X-SECTION BELOW 0.6 EV ASSUMED ISOTROPIC SINCE NO ACCURATE
C   DATA EXIST ON ELASTIC SCATTERING AT THE RAMSAUER MINIMUM.
C   THE ELASTIC X-SECTION BETWEEN 0.0 AND 0.6 EV IS NOT SENSITIVE
C   ENOUGH TO DRIFT AND DIFFUSION TO ACCURATELY PREDICT THE
C   POSITION OF THE RAMSAUER MINIMUM. THE ABSOLUTE VALUE OF THE ELASTIC
C   X-SECTION BELOW THE RAMSAUER MINIMUM ( LESS THAN 0.18 EV) SEEMS TO
C   BE LOWER THAN PREDICTIONS BY MANN AND LINDER OR FIELD ET AL.
C    THE TEMPERATURE DEPENDENCE OF THE LOW FIELD MOBILITY CF GEE AND
C   FREEMAN WHICH IS REPRODUCED BY THIS X-SECTION SET SEEMS ALSO TO
C   EXCLUDE HIGHER ELASTIC X-SECTIONS IN THE REGION BETWEEN 0.02 AND
C   0.1 EV.
C   THE DATA BASE NOW FITS NAKAMURAS DRIFT VELOCITY IN CF4 AND CF4 ARGON
C   MIXTURES TO WITHIN EXPERIMENTAL ERRORS . NAKAMURAS DATA IS MUCH MORE
C   ACCURATE THAN HUNTERS DATA SO WE REJECT HUNTERS DATA IN THE NEW
C   ANALYSIS.
C   THE TOWNSEND IONISATION AND ATTACHMENT RATES AGREE WELL WITH THE
C   PUBLISHED DATA .
C ---------------------------------------------------------------
      IF(NANISO.EQ.0) THEN
       NAME=' CF4 ISOT  2008'
      ELSE
       NAME=' CF4 ANISO 2008'
      ENDIF
C--------------------------------------------------------------------
C BORN BETHE VALUES FOR IONISATION
      CONST=1.873884D-20
      EMASS2=1021997.804
      AM2=7.20
      C=93.0
C  BORN BETHE FOR EXCITATION
      AM2EXC=1.6
      CEXC=20.7
C
      NIN=11
      DO 1 J=1,6
    1 KEL(J)=NANISO
      DO 2 J=1,NIN
    2 KIN(J)=0
C ASSUME CAPITELLI LONGO TYPE OF ANGULAR DISTRIBUTION FOR VIBRATIONAL
C  LEVELS V4 V3 2V3 AND THE SUM OF HIGHER HARMONICS
      KIN(4)=1
      KIN(8)=1
      KIN(9)=1
      KIN(10)=1
C ANGULAR DISTRIBUTION FOR DISSOCIATIVE EXCITATION CAN BE EITHER
C CAPITELLI LONGO OR OKHRIMOVSKKY TYPES
      KIN(11)=NANISO
C RATIO OF MOMENTUM TRANSFER TO TOTAL X-SEC FOR RESONANCE
C PART OF VIBRATIONAL X-SECTIONS
      RAT=0.75
C
      NDATA=132
      NVBV4=17
      NVBV1=17
      NVBV3=17
      NVIB5=18
      NVIB6=18
      NION=52
      NATT=11
      NEXC=31
C
      E(1)=0.0
      E(2)=2.0*EMASS/(88.0043*AMU)
      E(3)=15.90
C EXCITATION X-SECTION AT 1.2 MEV
      E(4)=0.0047D-16
C IONISING X-SECTION AT 1.2 MEV
      E(5)=0.0211D-16
C OPAL AND BEATY IONISATION ENERGY SPLITTING AT 1.2 MEV
      E(6)=19.5
C  OPAL BEATY IONISATION ENERGY SPLITTING AT LOW ENERGY
      EOBY=E(3)
C
      EIN(1)=-0.0539
      EIN(2)=0.0539
      EIN(3)=-0.0783
      EIN(4)=0.0783
      EIN(5)=-0.1126
      EIN(6)=0.1126
      EIN(7)=-0.1588
      EIN(8)=0.1588
      EIN(9)=0.3176
      EIN(10)=0.4764
      EIN(11)=12.56
C OFFSET ENERGY FOR IONISATION ELECTRON ANGULAR DISTRIBUTION
      IOFF=IFIX(SNGL(0.5+E(3)/ESTEP))
C OFFSET ENERGY FOR DISSOCIATION ANGULAR DISTRIBUTION
      IOFF11=IFIX(SNGL(0.5+EIN(11)/ESTEP))
C***********************************************************************
C ENTER PENNING TRANSFER FRACTION FOR EACH LEVEL
C ONLY DISSOCIATION X-SECTION (LEVEL 11) HAS ENOUGH ENERGY TO GIVE
C  POSSIBLE PENNING TRANSFER
      DO 7 K=1,11
      DO 7 L=1,3
    7 PENFRA(L,K)=0.0
C PENNING TRANSFER FRACTION FOR LEVEL 11
      PENFRA(1,11)=0.0
C PENNING TRANSFER DISTANCE IN MICRONS
      PENFRA(2,11)=1.0
C PENNING TRANSFER TIME IN PICOSECONDS
      PENFRA(3,11)=1.0
      IF(IPEN.EQ.0) GO TO 8
      IF(PENFRA(1,11).EQ.0.0) GO TO 8
      WRITE(6,999) NAME,EIN(11),PENFRA(1,11),PENFRA(2,11),PENFRA(3,11)
  999 FORMAT(' GAS = ',A15,' ENERGY LEVEL = ',F7.4,' EV.',/,' PENNING PR
     /OBABILITY = ',F5.3,' ABS.LENGTH = ',F7.2,' DECAY TIME = ',F7.1,/)
    8 CONTINUE
C***********************************************************************
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC  ANISOTROPIC   CF4   '
      IF(NANISO.EQ.0) THEN
       SCRPT(2)=' ELASTIC  ISOTROPIC   CF4     '
      ENDIF
      SCRPT(3)=' IONISATION    ELOSS= 15.90   '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' VIB  V2       ELOSS= -0.0539 '
      SCRPT(8)=' VIB  V2       ELOSS=  0.0539 '
      SCRPT(9)=' VIB  V4       ELOSS= -0.0783 '
      SCRPT(10)=' VIB  V4 ANIS  ELOSS=  0.0783 '
      SCRPT(11)=' VIB  V1       ELOSS= -0.1126 '
      SCRPT(12)=' VIB  V1       ELOSS=  0.1126 '
      SCRPT(13)=' VIB  V3       ELOSS= -0.1588 '
      SCRPT(14)=' VIB  V3 ANIS  ELOSS=  0.1588 '
      SCRPT(15)=' VIB 2V3       ELOSS=  0.3176 '
      SCRPT(16)=' VIB HARMONIC  ELOSS=  0.4764 '
      SCRPT(17)=' EXC DISOCIATN ELOSS= 12.56   '
C  VIBRATIONAL DEGENERACY
      DEGV4=3.0
      DEGV3=3.0
      DEGV2=2.0
      DEGV1=1.0
C CALC VIB LEVEL POPULATIONS
      APOPV2=DEGV2*DEXP(EIN(1)/AKT)
      APOPV4=DEGV4*DEXP(EIN(3)/AKT)
      APOPV1=DEGV1*DEXP(EIN(5)/AKT)
      APOPV3=DEGV3*DEXP(EIN(7)/AKT)
      APOPGS=1.0
      APOPSUM=APOPGS+APOPV2+APOPV4+APOPV1+APOPV3
      APOPGS=1.0/APOPSUM
      APOPV2=APOPV2/APOPSUM
      APOPV4=APOPV4/APOPSUM
      APOPV1=APOPV1/APOPSUM
      APOPV3=APOPV3/APOPSUM
C RENORMALISE GROUND STATE TO ALLOW FOR EXCITATION X-SEC FROM
C EXCITED VIBRATIONAL STATES (EXACT APPROX IF THE HOT TRANSITIONS HAVE
C EQUAL X-SEC TO THE GROUND STATE TRANSITIONS)
C
      APOPGS=1.0
C
      EN=-ESTEP/2.0
      DO 9000 I=1,NSTEP
      EN=EN+ESTEP
      DO 10 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 20
   10 CONTINUE
      J=NDATA
   20 A=(YELM(J)-YELM(J-1))/(XEN(J)-XEN(J-1))
      B=(XEN(J-1)*YELM(J)-XEN(J)*YELM(J-1))/(XEN(J-1)-XEN(J))
      QMOM=(A*EN+B)*1.D-16
      A=(YELT(J)-YELT(J-1))/(XEN(J)-XEN(J-1))
      B=(XEN(J-1)*YELT(J)-XEN(J)*YELT(J-1))/(XEN(J-1)-XEN(J))
      QELA=(A*EN+B)*1.D-16
      A=(YEPS(J)-YEPS(J-1))/(XEN(J)-XEN(J-1))
      B=(XEN(J-1)*YEPS(J)-XEN(J)*YEPS(J-1))/(XEN(J-1)-XEN(J))
      PQ2=(A*EN+B)
      PQ1=0.5+(QELA-QMOM)/QELA
      IF(NANISO.EQ.0) PEQEL(2,I)=0.5
      IF(NANISO.EQ.1) PEQEL(2,I)=PQ1
      IF(NANISO.EQ.2) PEQEL(2,I)=PQ2
      Q(2,I)=QELA
      IF(NANISO.EQ.0) Q(2,I)=QMOM
C  GROSS IONISATION
      Q(3,I)=0.0
      PEQEL(3,I)=0.5
      IF(NANISO.EQ.2) PEQEL(3,I)=0.0
      IF(EN.LE.E(3)) GO TO 200
      IF(EN.GT.XION(NION)) GO TO 123
      DO 110 J=2,NION
      IF(EN.LE.XION(J)) GO TO 120
  110 CONTINUE
      J=NION
  120 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
      GO TO 124
C USE BORN BETHE X-SECTION ABOVE XION(NION) EV
  123 GAMMA=(EMASS2+2.0D0*EN)/EMASS2
      BETA=DSQRT(1.0D0-1.0D0/(GAMMA*GAMMA))
      BETA2=BETA*BETA
      X2=1.0D0/BETA2
      X1=X2*DLOG(BETA2/(1.0D0-BETA2))-1.0D0
      Q(3,I)=CONST*(AM2*X1+C*X2)/0.965
  124 CONTINUE
C USE ANISOTROPIC SCATTERING FOR PRIMARY IONISATION ELECTRON AT
C ENERGIES ABOVE 2 * IONISATION ENERGY
C ANISOTROPIC ANGULAR DISTRIBUTION SAME AS ELASTIC ANGULAR DISTRIBUTION
C AT AN ENERGY OFFSET BY THE IONISATION ENERGY
      IF(EN.LE.(2.0*E(3))) GO TO 200
      PEQEL(3,I)=PEQEL(2,(I-IOFF))
C
  200 Q(4,I)=0.0
      IF(EN.LE.XATT(1)) GO TO 250
      IF(EN.GT.XATT(NATT)) GO TO 250
      DO 210 J=2,NATT
      IF(EN.LE.XATT(J)) GO TO 220
  210 CONTINUE
      J=NATT
  220 A=(YATT(J)-YATT(J-1))/(XATT(J)-XATT(J-1))
      B=(XATT(J-1)*YATT(J)-XATT(J)*YATT(J-1))/(XATT(J-1)-XATT(J))
      Q(4,I)=(A*EN+B)*1.D-16
C COUNTING IONISATION
  250 Q(5,I)=0.0
      PEQEL(5,I)=0.5
      IF(NANISO.EQ.2) PEQEL(5,I)=0.0
      IF(EN.LE.E(3)) GO TO 300
      IF(EN.GT.XION(NION)) GO TO 280
      DO 260 J=2,NION
      IF(EN.LE.XION(J)) GO TO 270
  260 CONTINUE
      J=NION
  270 A=(YINC(J)-YINC(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YINC(J)-XION(J)*YINC(J-1))/(XION(J-1)-XION(J))
      Q(5,I)=(A*EN+B)*1.D-16
      GO TO 290
C USE BORN BETHE X-SECTION ABOVE XION(NION) EV
  280 Q(5,I)=CONST*(AM2*X1+C*X2)
  290 CONTINUE
C USE ANISOTROPIC SCATTERING FOR PRIMARY IONISATION ELECTRON AT
C ENERGIES ABOVE 2 * IONISATION ENERGY
C ANISOTROPIC ANGULAR DISTRIBUTION SAME AS ELASTIC ANGULAR DISTRIBUTION
C AT AN ENERGY OFFSET BY THE IONISATION ENERGY
      IF(EN.LE.(2.0*E(3))) GO TO 295
      PEQEL(5,I)=PEQEL(2,(I-IOFF))
  295 CONTINUE
C
  300 Q(6,I)=0.0
C SCALE FACTOR FOR VIBRATIONAL DIPOLE V3 ABOVE 0.4EV
      VDSC=1.0
      IF(EN.GT.0.4) THEN
       EPR=EN
       IF(EN.GT.5.0) EPR=5.0
       VDSC=(14.4-EPR)/14.0
      ENDIF
C
C SUPERELASTIC OF VIBRATION V2 ISOTROPIC
C
      QIN(1,I)=0.0
      PEQIN(1,I)=0.5
      IF(EN.LE.0.0) GO TO 350
      EFAC=DSQRT(1.0-(EIN(1)/EN))
      QIN(1,I)=0.007*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      QIN(1,I)=QIN(1,I)*APOPV2*1.D-16/DEGV2
  350 CONTINUE
C VIBRATION V2 ISOTROPIC
      QIN(2,I)=0.0
      PEQIN(2,I)=0.5
      IF(EN.LE.EIN(2)) GO TO 400
      EFAC=DSQRT(1.0-(EIN(2)/EN))
      QIN(2,I)=0.007*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      QIN(2,I)=QIN(2,I)*APOPGS*1.D-16
  400 CONTINUE
C
C SUPERELASTIC OF VIBRATION V4 ISOTROPIC
C
      QIN(3,I)=0.0
      PEQIN(3,I)=0.5
      IF(EN.LE.0.0) GO TO 450
      DO 410 J=2,NVBV4
      IF((EN-EIN(3)).LE.XVBV4(J)) GO TO 420
  410 CONTINUE
      J=NVBV4
  420 A=(YVBV4(J)-YVBV4(J-1))/(XVBV4(J)-XVBV4(J-1))
      B=(XVBV4(J-1)*YVBV4(J)-XVBV4(J)*YVBV4(J-1))/(XVBV4(J-1)-XVBV4(J))
      EFAC=DSQRT(1.0-(EIN(3)/EN))
      QIN(3,I)=0.0500*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      QIN(3,I)=QIN(3,I)+(EN-EIN(3))*(A*(EN-EIN(3))+B)/EN
      QIN(3,I)=QIN(3,I)*APOPV4*1.D-16/DEGV4
  450 CONTINUE
C VIBRATION V4 ANISOTROPIC
      QIN(4,I)=0.0
      PEQIN(4,I)=0.5
      IF(EN.LE.EIN(4)) GO TO 500
      DO 460 J=2,NVBV4
      IF(EN.LE.XVBV4(J)) GO TO 470
  460 CONTINUE
      J=NVBV4
  470 A=(YVBV4(J)-YVBV4(J-1))/(XVBV4(J)-XVBV4(J-1))
      B=(XVBV4(J-1)*YVBV4(J)-XVBV4(J)*YVBV4(J-1))/(XVBV4(J-1)-XVBV4(J))
      EFAC=DSQRT(1.0-(EIN(4)/EN))
      QIN(4,I)=0.0500*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      ELF=EN-EIN(4)
      FWD=DLOG((EN+ELF)/(EN+ELF-2.0*DSQRT(EN*ELF)))
      BCK=DLOG((EN+ELF+2.0*DSQRT(EN*ELF))/(EN+ELF))
C RATIO OF MT TO TOTAL X-SECT FOR RESONANCE PART = RAT
      XMT=((1.5-FWD/(FWD+BCK))*QIN(4,I)+RAT*(A*EN+B))*APOPGS*1.D-16
      QIN(4,I)=((A*EN+B)+QIN(4,I))*APOPGS*1.D-16
      PEQIN(4,I)=0.5+(QIN(4,I)-XMT)/QIN(4,I)
  500 CONTINUE
C SUPERELASTIC OF VIBRATION V1 ISOTROPIC
      QIN(5,I)=0.0
      PEQIN(5,I)=0.5
      IF(EN.LE.0.0) GO TO 550
      DO 510 J=2,NVBV1
      IF((EN-EIN(5)).LE.XVBV1(J)) GO TO 520
  510 CONTINUE
      J=NVBV1
  520 A=(YVBV1(J)-YVBV1(J-1))/(XVBV1(J)-XVBV1(J-1))
      B=(XVBV1(J-1)*YVBV1(J)-XVBV1(J)*YVBV1(J-1))/(XVBV1(J-1)-XVBV1(J))
      EFAC=DSQRT(1.0-(EIN(5)/EN))
      QIN(5,I)=0.0224*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      QIN(5,I)=QIN(5,I)+(EN-EIN(5))*(A*(EN-EIN(5))+B)/EN
      QIN(5,I)=QIN(5,I)*APOPV1*1.D-16/DEGV1
  550 CONTINUE
C  VIBRATION V1  ISOTROPIC
      QIN(6,I)=0.0
      PEQIN(6,I)=0.5
      IF(EN.LE.EIN(6)) GO TO 600
      DO 560 J=2,NVBV1
      IF(EN.LE.XVBV1(J)) GO TO 570
  560 CONTINUE
      J=NVBV1
  570 A=(YVBV1(J)-YVBV1(J-1))/(XVBV1(J)-XVBV1(J-1))
      B=(XVBV1(J-1)*YVBV1(J)-XVBV1(J)*YVBV1(J-1))/(XVBV1(J-1)-XVBV1(J))
      EFAC=DSQRT(1.0-(EIN(6)/EN))
      QIN(6,I)=0.0224*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      QIN(6,I)=((A*EN+B)+QIN(6,I))*APOPGS*1.D-16
  600 CONTINUE
C SUPERELASTIC OF VIBRATION V3 ISOTROPIC
      QIN(7,I)=0.0
      PEQIN(7,I)=0.5
      IF(EN.LE.0.0) GO TO 650
      DO 610 J=2,NVBV3
      IF((EN-EIN(7)).LE.XVBV3(J)) GO TO 620
  610 CONTINUE
      J=NVBV3
  620 A=(YVBV3(J)-YVBV3(J-1))/(XVBV3(J)-XVBV3(J-1))
      B=(XVBV3(J-1)*YVBV3(J)-XVBV3(J)*YVBV3(J-1))/(XVBV3(J-1)-XVBV3(J))
      EFAC=DSQRT(1.0-(EIN(7)/EN))
      QIN(7,I)=VDSC*1.610*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      QIN(7,I)=QIN(7,I)+(EN-EIN(7))*(A*(EN-EIN(7))+B)/EN
      QIN(7,I)=QIN(7,I)*APOPV3*1.D-16/DEGV3
  650 CONTINUE
C VIBRATION V3 ANISOTROPIC
      QIN(8,I)=0.0
      PEQIN(8,I)=0.5
      IF(EN.LE.EIN(8)) GO TO 700
      DO 660 J=2,NVBV3
      IF(EN.LE.XVBV3(J)) GO TO 670
  660 CONTINUE
      J=NVBV3
  670 A=(YVBV3(J)-YVBV3(J-1))/(XVBV3(J)-XVBV3(J-1))
      B=(XVBV3(J-1)*YVBV3(J)-XVBV3(J)*YVBV3(J-1))/(XVBV3(J-1)-XVBV3(J))
      EFAC=DSQRT(1.0-(EIN(8)/EN))
      QIN(8,I)=VDSC*1.610*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      ELF=EN-EIN(8)
      FWD=DLOG((EN+ELF)/(EN+ELF-2.0*DSQRT(EN*ELF)))
      BCK=DLOG((EN+ELF+2.0*DSQRT(EN*ELF))/(EN+ELF))
C   ASSUME RATIO MOM T./ TOT X-SECT FOR RESONANCE PART = RAT
      XMT=((1.5-FWD/(FWD+BCK))*QIN(8,I)+RAT*(A*EN+B))*APOPGS*1.D-16
      QIN(8,I)=((A*EN+B)+QIN(8,I))*APOPGS*1.D-16
      PEQIN(8,I)=0.5+(QIN(8,I)-XMT)/QIN(8,I)
  700 CONTINUE
C VIBRATION HARMONIC 2V3
      QIN(9,I)=0.0
      PEQIN(9,I)=0.5
      IF(EN.LE.EIN(9)) GO TO 800
      DO 710 J=2,NVIB5
      IF(EN.LE.XVIB5(J)) GO TO 720
  710 CONTINUE
      J=NVIB5
  720 A=(YVIB5(J)-YVIB5(J-1))/(XVIB5(J)-XVIB5(J-1))
      B=(XVIB5(J-1)*YVIB5(J)-XVIB5(J)*YVIB5(J-1))/(XVIB5(J-1)-XVIB5(J))
      QIN(9,I)=(A*EN+B)*APOPGS*1.D-16
      PEQIN(9,I)=0.5+(1.0-RAT)
  800 CONTINUE
C VIBRATION HARMONIC 3V3
      QIN(10,I)=0.0
      PEQIN(10,I)=0.5
      IF(EN.LE.EIN(10)) GO TO 900
      DO 810 J=2,NVIB6
      IF(EN.LE.XVIB6(J)) GO TO 820
  810 CONTINUE
      J=NVIB6
  820 A=(YVIB6(J)-YVIB6(J-1))/(XVIB6(J)-XVIB6(J-1))
      B=(XVIB6(J-1)*YVIB6(J)-XVIB6(J)*YVIB6(J-1))/(XVIB6(J-1)-XVIB6(J))
      QIN(10,I)=(A*EN+B)*APOPGS*1.D-16
      PEQIN(10,I)=0.5+(1.0-RAT)
  900 CONTINUE
C
      QIN(11,I)=0.0
      PEQIN(11,I)=0.5
      IF(NANISO.EQ.2) PEQIN(11,I)=0.0
      IF(EN.LE.EIN(11)) GO TO 950
      IF(EN.GT.XEXC(NEXC)) GO TO 930
      DO 910 J=2,NEXC
      IF(EN.LE.XEXC(J)) GO TO 920
  910 CONTINUE
      J=NEXC
  920 A=(YEXC(J)-YEXC(J-1))/(XEXC(J)-XEXC(J-1))
      B=(XEXC(J-1)*YEXC(J)-XEXC(J)*YEXC(J-1))/(XEXC(J-1)-XEXC(J))
      QIN(11,I)=(A*EN+B)*1.D-16
      GO TO 940
C USE BORN BETHE X-SECTION ABOVE XEXC(NEXC) EV
  930 QIN(11,I)=CONST*(AM2EXC*X1+CEXC*X2)
C ANGULAR DISTRIBUTION COPIED FROM THE ELASTIC OFFSET BY TWICE THE
C LEVEL ENERGY
  940 IF(EN.LE.(2.0*EIN(11))) GO TO 950
      PEQIN(11,I)=PEQEL(2,(I-IOFF11))
  950 CONTINUE
C
      Q(1,I)=Q(2,I)+Q(5,I)+Q(4,I)+QIN(1,I)+QIN(2,I)+QIN(3,I)+QIN(4,I)+
     /QIN(5,I)+QIN(6,I)+QIN(7,I)+QIN(8,I)+QIN(9,I)+QIN(10,I)+QIN(11,I)
 9000 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(11)) NIN=10
      IF(EFINAL.LE.EIN(10)) NIN=9
      IF(EFINAL.LE.EIN(9)) NIN=8
      RETURN
      END
      SUBROUTINE GAS2(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      DIMENSION XEN(60),YSEC(60),YEL(60),XEPS(160),YEPS(160),
     /XENI(75),YENI(75),YENC(75),
     /X1S5(105),Y1S5(105),YEPS1(105),X1S4(113),Y1S4(113),YEPS2(113),
     /X1S3(104),Y1S3(104),YEPS3(104),X1S2(119),Y1S2(119),YEPS4(119),
     /X2P10(100),Y2P10(100),YEP2P10(100),X2P9(65),Y2P9(65),YEP2P9(65),
     /X2P8(62),Y2P8(62),YEP2P8(62),X2P7(67),Y2P7(67),YEP2P7(67),
     /X2P6(64),Y2P6(64),YEP2P6(64),X2P5(74),Y2P5(74),YEP2P5(74),
     /X2P4(67),Y2P4(67),YEP2P4(67),X2P3(67),Y2P3(67),YEP2P3(67),
     /X2P2(66),Y2P2(66),YEP2P2(66),X2P1(74),Y2P1(74),YEP2P1(74),
     /X3D6(68),Y3D6(68),YEP3D6(68),X3D5(72),Y3D5(72),YEP3D5(72),
     /X3D4P(77),Y3D4P(77),YEP3D4P(77),X3D4(86),Y3D4(86),YEP3D4(86),
     /X3D3(77),Y3D3(77),YEP3D3(77),X3D1PP(72),Y3D1PP(72),YEP3D1PP(72),
     /X3D1P(66),Y3D1P(66),YEP3D1P(66),
     /X3S1PPPP(83),Y3S1PPPP(83),YEP3S1PPPP(83),
     /X3S1PPP(62),Y3S1PPP(62),YEP3S1PPP(62),
     /X3S1PP(81),Y3S1PP(81),YEP3S1PP(81),X2S5(72),Y2S5(72),YEP2S5(72),
     /X2S3(72),Y2S3(72),YEP2S3(72),
     /IOFFN(44)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
C  ENERGY
      DATA XEN/1.00,1.20,1.50,1.70,2.00,2.50,3.00,4.00,5.00,6.00,
     /7.00,8.00,9.00,10.0,11.0,12.0,13.0,14.0,15.0,16.0,
     /18.0,20.0,25.0,30.0,40.0,50.0,60.0,70.0,80.0,90.0,
     /100.,125.,150.,200.,250.,300.,350.,400.,500.,600.,
     /700.,800.,1000.,1500.,2000.,3000.,4000.,5000.,6000.,10000.,
     /20000.,40000.,1.D5,1.5D5,2.D5,4.D5,6.D5,1.D6,1.5D6,2.D6/
C ELASTIC MOMENTUM TRANSFER
      DATA YSEC/1.3913,1.66,2.05,2.33,2.70,3.43,4.20,5.70,7.60,9.60,
     /11.5,13.1,14.4,15.6,15.9,16.0,15.6,15.0,14.2,13.3,
     /11.5,10.0,7.75,6.25,4.45,3.50,2.80,2.25,2.00,1.70,
     /1.50,1.22,1.00,0.78,0.64,0.55,0.48,0.43,.355,0.30,
     /0.26,0.22,0.16,.095,.063,.033,.021,.0146,.0108,.0047,
     /.00145,4.3D-4,8.6D-5,4.3D-5,2.7D-5,8.9D-6,4.8D-6,2.2D-6,1.18D-6,
     /7.6D-7/
C ELASTIC
      DATA YEL/1.4945,1.80,2.25,2.63,3.20,4.15,5.10,7.05,8.90,11.1,
     /13.4,15.8,18.1,20.3,21.9,23.0,23.4,23.5,23.2,22.2,
     /19.4,17.0,13.3,11.0,8.44,7.16,6.28,5.78,5.25,4.89,
     /4.50,3.95,3.51,3.03,2.70,2.48,2.30,2.10,1.90,1.72,
     /1.58,1.47,1.27,0.98,.818,.620,.510,.434,.380,.250,
     /.138,.076,.036,.027,.023,.0156,.0127,.0101,.0087,.0078/
C EPSILON FOR ELASTIC ANGULAR DISTRIBUTION
      DATA XEPS/.0,.0001,.0002,.0003,.0004,.0006,.0008,.001,.0012,.0014,
     /.0017,.002,.0025,.003,.004,.005,.006,.008,.010,.012,
     /.014,.017,.020,.025,.030,.035,.040,.045,.050,.055,
     /.060,.065,.070,.075,.080,.085,.090,.095,.100,.110,
     /0.12,0.13,0.14,0.15,0.16,0.17,0.18,0.19,0.20,0.21,
     /0.22,0.23,0.24,0.25,0.26,0.27,0.28,0.29,0.30,0.31,
     /0.32,0.33,0.34,0.35,0.36,0.37,0.38,0.39,0.40,0.41,
     /0.42,0.43,0.44,0.45,0.46,0.47,0.48,0.49,0.50,0.51,
     /0.52,0.53,0.54,0.55,0.56,0.57,0.58,0.59,0.60,0.61,
     /0.62,0.63,0.65,0.67,0.70,0.75,0.80,0.85,0.90,0.95,
     /1.00,1.20,1.50,1.70,2.00,2.50,3.00,4.00,5.00,6.00,
     /7.00,8.00,9.00,10.0,11.0,12.0,13.0,14.0,15.0,16.0,
     /18.0,20.0,25.0,30.0,40.0,50.0,60.0,70.0,80.0,90.0,
     /100.,125.,150.,200.,250.,300.,350.,400.,500.,600.,
     /700.,800.,1000.,1500.,2000.,3000.,4000.,5000.,6000.,10000.,
     /20000.,40000.,1.D5,1.5D5,2.D5,4.D5,6.D5,1.D6,1.5D6,2.D6/
      DATA YEPS/1.0,.013,.0186,.023,.0266,.0327,.0381,.0428,.0470,.0508,
     /.0567,.0616,.0696,.0766,.0897,.1012,.1121,.1319,.1499,.1668,
     /.1827,.2053,.2273,.2605,.2929,.3230,.3531,.3813,.4091,.4358,
     /.4621,.4881,.5134,.5377,.5616,.5846,.6068,.6284,.6495,.6892,
     /.7255,.7586,.7882,.8141,.8363,.8548,.8696,.8805,.8877,.8911,
     /.8907,.8860,.8769,.8631,.8441,.8198,.7896,.7535,.7118,.6647,
     /.6128,.5566,.4981,.4380,.3778,.3182,.2600,.2043,.1523,.1030,
     /.0586,.018,-.019,-.0521,-.0812,-.107,-.1293,-.1487,-.1654,-.1796,
     /-.191,-.2014,-.208,-.2137,-.2179,-.2205,-.222,-.222,-.2213,-.2194,
     /-.2165,-.213,-.2035,-.192,-.171,-.1296,-.0836,-.0358,.0124,.0589,
     /.1034,.1164,.1329,.1701,.2318,.2568,.2610,.2826,.2170,.2011,
     /.2108,.2530,.3010,.3391,.3975,.4381,.4760,.5121,.5446,.5604,
     /.5680,.5734,.5800,.5970,.6434,.6848,.7284,.7814,.7887,.8171,
     /.8287,.8478,.8656,.8848,.8982,.9078,.9157,.9180,.9283,.9351,
     /.9403,.9478,.9591,.9714,.9790,.9871,.9907,.9928,.9942,.9965,
     /.99827,.99917,.99969,.999807,.999863,.999939,.999961,.999979,
     /.999987,.999991/
C IONISATION ( VALUES ABOVE 20KEV GENERATED BY BORN BETHE IN SUB)
      DATA XENI/15.75961,16.0,16.5,17.0,17.5,18.0,18.5,19.0,19.5,20.0,
     /20.5,21.0,21.5,22.0,22.5,23.0,23.5,24.0,24.5,25.0,
     /25.5,26.0,28.0,30.0,32.0,34.0,36.0,38.0,40.0,45.0,
     /50.0,55.0,60.0,65.0,70.0,75.0,80.0,85.0,90.0,95.0,
     /100.,110.,120.,130.,140.,150.,160.,180.,200.,250.,
     /300.,350.,400.,450.,500.,600.,700.,800.,900.,1000.,
     /1200.,1400.,1600.,1800.,2000.,2500.,3000.,3500.,4000.,5000.,
     /6000.,8000.,10000.,14000.,20000./
C GROSS IONISATION
      DATA YENI/0.00,.031,.094,.163,.235,.310,.386,.465,.546,.627,
     /.713,.787,.858,.933,.994,1.06,1.12,1.18,1.24,1.30,
     /1.35,1.41,1.60,1.80,1.96,2.11,2.24,2.33,2.39,2.49,
     /2.53,2.60,2.66,2.73,2.77,2.82,2.84,2.85,2.86,2.86,
     /2.85,2.83,2.81,2.76,2.73,2.68,2.62,2.52,2.39,2.17,
     /1.97,1.80,1.67,1.54,1.44,1.28,1.15,1.04,.971,.898,
     /.768,.688,.638,.576,.526,.446,.384,.340,.302,.255,
     /.220,.172,.144,.110,.0825/
C COUNTING IONISATION
      DATA YENC/0.00,.031,.094,.163,.235,.310,.386,.465,.546,.627,
     /.713,.787,.858,.933,.994,1.06,1.12,1.18,1.24,1.30,
     /1.35,1.41,1.60,1.80,1.96,2.11,2.24,2.33,2.39,2.49,
     /2.52,2.56,2.58,2.62,2.63,2.67,2.68,2.68,2.69,2.69,
     /2.68,2.66,2.64,2.59,2.56,2.52,2.46,2.37,2.24,2.04,
     /1.85,1.69,1.57,1.45,1.35,1.21,1.08,.981,.912,.843,
     /.721,.646,.599,.540,.494,.419,.361,.319,.283,.239,
     /.206,.162,.136,.104,.0775/
C 1S5 METASTABLE
      DATA X1S5/11.548,11.60,11.63,11.64,11.66,11.70,11.75,11.80,11.82,
     /11.83,
     /11.84,11.86,11.88,11.90,11.93,12.00,12.10,12.20,12.30,12.40,
     /12.50,12.60,12.70,12.80,12.83,12.86,12.90,12.91,12.93,12.96,
     /13.00,13.03,13.05,13.08,13.10,13.12,13.15,13.18,13.20,13.26,
     /13.28,13.29,13.35,13.40,13.45,13.47,13.50,13.60,13.70,13.80,
     /14.0,14.5,15.0,16.0,17.0,18.0,20.0,22.0,24.0,26.0,
     /28.0,30.0,35.0,40.0,45.0,50.0,60.0,70.0,80.0,90.0,
     /100.,150.,200.,250.,300.,350.,400.,450.,500.,600.,
     /800.,1000.,1500.,2000.,3000.,4000.,5000.,6000.,8000.,1.D4,
     /1.5D4,2.D4,3.D4,4.D4,6.D4,1.D5,2.D5,4.D5,7.D5,1.D6,
     /1.5D6,2.0D6,4.D6,7.D6,1.D7/
C UNITS 10-18 CM**2
      DATA Y1S5/0.00,0.39,0.68,0.68,0.56,0.49,0.46,0.50,0.63,0.94,
     /1.26,0.91,0.63,0.58,0.55,0.61,0.73,0.91,1.14,1.37,
     /1.59,1.78,1.89,1.89,1.85,1.77,1.54,1.82,1.42,1.26,
     /1.26,2.16,2.89,2.16,1.51,1.19,0.97,1.09,0.94,0.85,
     /1.13,0.98,1.08,1.16,1.21,1.40,1.31,1.42,1.65,2.35,
     /2.80,4.02,4.94,5.58,6.16,6.44,6.20,4.90,3.80,3.20,
     /2.50,2.00,1.15,0.80,0.52,0.37,0.24,.135,.088,.060,
     /.042,.013,.0056,.0029,.0017,.00107,.00072,.00051,.00037,.000216,
     /9.2D-5,4.7D-5,1.4D-5,6.0D-6,1.8D-6,7.6D-7,3.9D-7,2.3D-7,9.9D-8,
     /5.2D-8,
     /1.6D-8,7.0D-9,2.3D-9,1.0D-9,3.6D-10,1.0D-10,2.5D-11,8.8D-12,
     /5.1D-12,4.1D-12,
     /3.5D-12,3.2D-12,3.0D-12,2.9D-12,2.9D-12/
      DATA YEPS1/105*0.0/
C 1S4 RESONANCE RADIATION 106.66 NM WAVELENGTH
      DATA X1S4/11.624,11.65,11.66,11.67,11.68,11.69,11.70,11.74,11.75,
     /11.77,
     /11.79,11.82,11.84,11.87,11.88,11.90,11.95,12.00,12.05,12.10,
     /12.20,12.30,12.40,12.50,12.60,12.70,12.80,12.85,12.90,12.905,
     /12.91,12.93,12.97,13.00,13.03,13.05,13.06,13.07,13.09,13.10,
     /13.15,13.18,13.20,13.21,13.23,13.26,13.30,13.35,13.40,13.45,
     /13.47,13.49,13.60,13.70,13.80,14.0,15.0,16.0,17.0,18.0,
     /19.0,20.0,24.0,27.0,30.0,40.0,50.0,60.0,80.0,100.,
     /140.,200.,250.,300.,400.,500.,600.,800.,1000.,1200.,
     /1500.,2000.,2500.,3000.,4000.,5000.,6000.,8000.,1.0D4,1.2D4,
     /1.4D4,1.7D4,2.0D4,2.5D4,3.0D4,4.0D4,5.0D4,7.0D4,1.0D5,1.5D5,
     /2.0D5,3.0D5,4.0D5,6.0D5,8.0D5,1.0D6,1.3D6,1.7D6,2.0D6,3.0D6,
     /4.0D6,7.0D6,1.0D7/
C UNITS 10**-18 CM**2
      DATA Y1S4/0.00,0.50,0.82,0.87,0.87,0.86,0.82,0.61,0.58,0.63,
     /0.68,0.72,0.79,0.50,0.45,.412,.423,.438,0.48,0.51,
     /0.62,0.76,0.91,1.06,1.20,1.29,1.32,1.30,1.18,1.12,
     /1.27,1.11,1.04,1.07,1.32,1.82,1.94,1.78,1.23,1.14,
     /0.98,1.26,1.17,1.31,1.17,1.10,1.05,1.01,1.04,1.08,
     /1.20,1.15,1.24,1.32,1.75,2.59,5.02,6.23,6.86,7.43,
     /8.00,8.05,8.05,8.00,7.80,7.30,6.80,6.30,5.60,5.00,
     /4.30,3.60,3.30,3.00,2.50,2.15,1.90,1.55,1.32,1.16,
     /0.97,0.78,0.66,0.58,0.47,0.39,0.34,.270,.225,.193,
     /.170,.145,.127,.106,.0917,.0731,.0616,.0480,.0375,.0291,
     /.0249,.0207,.0187,.0170,.0163,.0160,.0159,.0160,.0162,.0167,
     /.0172,.0184,.0192/
      DATA YEPS2/113*0.0/
C 1S3 METASTABLE
      DATA X1S3/11.723,11.75,11.76,11.78,11.79,11.80,11.84,11.86,11.90,
     /11.95,
     /12.00,12.10,12.20,12.30,12.40,12.50,12.60,12.70,12.80,12.85,
     /12.90,12.91,12.92,12.94,12.98,12.99,13.00,13.01,13.04,13.05,
     /13.06,13.08,13.10,13.15,13.18,13.20,13.21,13.23,13.25,13.27,
     /13.30,13.35,13.40,13.45,13.47,13.49,13.60,13.70,13.80,14.0,
     /14.5,15.0,16.0,17.0,18.0,20.0,22.0,24.0,26.0,28.0,
     /30.0,35.0,40.0,45.0,50.0,60.0,70.0,80.0,90.0,100.,
     /150.,200.,250.,300.,350.,400.,450.,500.,600.,800.,
     /1000.,1500.,2000.,3000.,4000.,5000.,6000.,8000.,1.D4,1.5D4,
     /2.D4,3.D4,4.D4,6.D4,1.D5,2.D5,4.D5,7.D5,1.D6,1.5D6,
     /2.0D6,4.D6,7.D6,1.D7/
C UNITS 10**-18 CM**2
      DATA Y1S3/0.00,.098,0.21,0.25,0.25,0.24,0.13,0.13,.098,.086,
     /.086,.095,.117,.144,.176,.216,.252,.283,.301,.297,
     /.266,.207,.315,.270,.243,.355,.288,.256,.288,.418,
     /.544,.495,.392,.297,.297,.459,0.62,.495,.400,.342,
     /.256,.131,.135,.140,.247,.198,.225,.252,.413,0.56,
     /0.80,0.99,1.12,1.23,1.29,1.24,0.98,0.76,0.64,0.50,
     /0.40,0.23,0.16,.104,.074,.048,.027,.0176,.0120,.0084,
     /.0026,.00112,5.8D-4,3.4D-4,2.14D-4,1.44D-4,1.0D-4,7.4D-5,4.3D-5,
     /1.8D-5,
     /9.4D-6,2.8D-6,1.2D-6,3.6D-7,1.5D-7,7.8D-8,4.6D-8,2.0D-8,1.0D-8,
     /3.1D-9,
     /1.4D-9,4.6D-10,2.0D-10,7.2D-11,2.0D-11,5.0D-12,1.8D-12,1.0D-12,
     /8.2D-13,7.0D-13,
     /6.4D-13,6.0D-13,5.8D-13,5.8D-13/
      DATA YEPS3/104*0.0/
C 1S2 RESONANCE RADIATION 104.82 NM WAVELENGTH
      DATA X1S2/11.828,11.85,11.86,11.88,11.90,11.93,11.96,12.00,12.05,
     /12.10,
     /12.20,12.30,12.40,12.50,12.60,12.70,12.80,12.85,12.90,12.91,
     /12.93,12.95,13.00,13.02,13.06,13.10,13.13,13.15,13.17,13.20,
     /13.21,13.23,13.25,13.27,13.30,13.35,13.40,13.45,13.46,13.48,
     /13.50,13.60,13.70,13.80,14.0,15.0,16.0,17.0,18.0,19.0,
     /20.0,22.0,24.0,26.0,28.0,30.0,35.0,40.0,50.0,60.0,
     /80.0,100.,120.,140.,170.,200.,250.,300.,350.,400.,
     /450.,500.,600.,800.,1000.,1200.,1400.,1700.,2000.,2500.,
     /3000.,3500.,4000.,5000.,6000.,8000.,1.0D4,1.2D4,1.4D4,1.7D4,
     /2.0D4,2.5D4,3.0D4,3.5D4,4.0D4,5.0D4,6.0D4,8.0D4,1.0D5,1.2D5,
     /1.4D5,1.7D5,2.0D5,2.5D5,3.0D5,3.5D4,4.0D5,5.0D5,6.0D5,8.0D5,
     /1.0D6,1.2D6,1.4D6,1.7D6,2.0D6,4.0D6,6.0D6,8.0D6,1.0D7/
C UNITS 10**-18 CM**2
      DATA Y1S2/0.00,0.86,1.08,0.98,0.88,0.76,0.69,0.66,0.66,0.67,
     /0.72,0.80,0.91,1.06,1.25,1.40,1.53,1.57,1.59,1.92,
     /1.69,1.64,1.63,1.71,2.32,1.83,1.76,1.68,1.66,2.00,
     /2.34,2.10,1.96,1.76,1.68,1.52,1.62,1.83,1.89,1.80,
     /1.85,2.06,2.19,3.57,4.06,7.00,9.43,11.7,13.8,16.0,
     /17.2,18.8,19.8,20.6,21.3,22.0,23.6,24.7,25.5,25.3,
     /24.0,22.3,20.7,19.3,17.5,16.0,14.0,12.5,11.3,10.3,
     /9.54,8.87,7.79,6.31,5.34,4.65,4.13,3.55,3.12,2.61,
     /2.25,1.99,1.79,1.49,1.28,1.01,.841,.724,.637,.544,
     /.476,.397,.343,.304,.274,.230,.201,.163,.140,.125,
     /.113,.101,.0931,.0837,.0775,.0732,.0701,.0661,.0636,.0611,
     /.0600,.0597,.0597,.0600,.0606,.0645,.0676,.0700,.0719/
      DATA YEPS4/119*0.0/
      DATA X2P10/12.907,12.912,12.922,12.934,12.949,12.966,13.00,13.012,
     /13.035,13.042,
     /13.053,13.064,13.068,13.075,13.089,13.107,13.141,13.154,13.162,
     /13.170,
     /13.180,13.190,13.202,13.214,13.220,13.234,13.239,13.265,13.271,
     /13.276,
     /13.300,13.400,13.445,13.458,13.467,13.480,13.50,13.60,14.0,15.0,
     /16.0,18.0,19.0,20.0,21.0,22.0,25.0,30.0,35.0,40.0,
     /50.0,60.0,80.0,100.,120.,140.,170.,200.,250.,300.,
     /400.,500.,600.,800.,1000.,1200.,1400.,1700.,2000.,2400.,
     /3000.,4000.,6000.,8000.,9000.,1.0D4,1.2D4,1.4D4,1.7D4,2.0D4,
     /3.0D4,4.0D4,6.0D4,8.0D4,1.0D5,1.2D5,1.4D5,1.7D5,2.0D5,3.0D5,
     /4.0D5,6.0D5,8.0D5,1.0D6,1.2D6,1.4D6,2.0D6,3.0D6,5.0D6,1.0D7/
      DATA Y2P10/0.00,0.76,0.40,0.57,0.53,0.61,0.95,1.40,1.78,1.88,
     /1.74,1.18,0.70,0.34,0.13,0.21,0.39,0.70,1.01,1.07,
     /1.33,1.17,1.43,0.70,0.36,0.14,0.11,0.11,0.25,0.18,
     /0.19,0.21,0.22,0.34,0.51,0.34,0.32,0.31,0.39,0.77,
     /1.13,1.82,2.03,2.16,2.20,2.17,1.89,1.20,0.81,0.58,
     /0.33,0.21,0.11,.065,.042,.031,.0216,.0158,.0103,.0072,
     /.0041,.0026,.0018,.0010,6.7D-4,4.7D-4,3.4D-4,2.3D-4,1.7D-4,1.2D-4,
     /7.6D-5,4.3D-5,1.9D-5,1.1D-5,8.8D-6,7.1D-6,5.0D-6,3.7D-6,2.6D-6,
     /1.9D-6,
     /8.9D-7,5.3D-7,2.6D-7,1.6D-7,1.1D-7,8.7D-8,7.0D-8,5.4D-8,4.4D-8,
     /2.8D-8,
     /2.2D-8,1.7D-8,1.4D-8,1.3D-8,1.25D-8,1.2D-8,1.13D-8,1.08D-8,
     /1.05D-8,1.04D-8/
      DATA YEP2P10/100*0.0/
      DATA X2P9/13.076,14.0,15.0,16.0,18.0,19.0,20.0,21.0,22.0,25.0,
     /30.0,35.0,40.0,50.0,60.0,80.0,100.,150.,200.,250.,
     /300.,350.,400.,500.,600.,700.,800.,900.,1000.,1200.,
     /1400.,1700.,2000.,2500.,3000.,3500.,4000.,5000.,6000.,8000.,
     /1.0D4,1.2D4,1.4D4,1.7D4,2.0D4,2.5D4,3.0D4,4.0D4,5.0D4,6.0D4,
     /8.0D4,1.0D5,1.2D5,1.4D5,1.7D5,2.0D5,3.0D5,5.0D5,7.0D5,1.0D6,
     /1.3D6,2.0D6,4.0D6,7.0D6,1.0D7/
      DATA Y2P9/0.00,0.55,1.23,1.90,2.75,2.94,3.00,2.98,2.92,2.55,
     /1.73,1.19,0.85,0.50,0.32,0.17,0.11,.048,.026,.017,
     /.0111,.0082,.0063,.0041,.00285,.0021,.0016,.00128,.00104,.00072,
     /5.3D-4,3.6D-4,2.6D-4,1.7D-4,1.2D-4,8.7D-5,6.7D-5,4.3D-5,3.0D-5,
     /1.7D-5,
     /1.1D-5,7.8D-6,5.8D-6,4.0D-6,2.9D-6,1.9D-6,1.4D-6,8.2D-7,5.5D-7,
     /4.0D-7,
     /2.5D-7,1.8D-7,1.35D-7,1.08D-7,8.4D-8,6.8D-8,4.4D-8,2.9D-8,2.4D-8,
     /2.0D-8,
     /1.9D-8,1.7D-8,1.6D-8,1.6D-8,1.6D-8/
      DATA YEP2P9/65*0.0/
      DATA X2P8/13.095,14.0,15.0,16.0,18.0,20.0,22.0,25.0,30.0,35.0,
     /40.0,50.0,60.0,80.0,100.,120.,140.,170.,200.,250.,
     /300.,400.,600.,800.,1000.,1200.,1400.,1700.,2000.,2500.,
     /3000.,3500.,4000.,5000.,6000.,8000.,10000.,1.2D4,1.4D4,1.7D4,
     /2.0D4,2.5D4,3.0D4,4.0D4,6.0D4,8.0D4,1.0D5,1.2D5,1.4D5,1.7D5,
     /2.0D5,3.0D5,4.0D5,6.0D5,8.0D5,1.0D6,1.4D6,2.0D6,3.0D6,4.0D6,
     /7.0D6,1.0D7/
      DATA Y2P8/0.00,0.38,0.85,1.25,1.85,2.10,2.30,2.35,2.40,2.36,
     /2.20,1.80,1.50,1.13,0.90,0.74,0.65,0.54,0.47,0.37,
     /0.31,0.24,.165,.125,0.10,.077,.071,.059,.050,.040,
     /.034,.029,.025,.0205,.017,.0128,.0103,.0087,.0075,.0062,
     /.0053,.0043,.0036,.0028,.0020,.00156,.00131,.00114,.00102,.00090,
     /8.1D-4,6.5D-4,5.7D-4,5.0D-4,4.6D-4,4.4D-4,4.2D-4,4.1D-4,4.0D-4,
     /4.0D-4,
     /3.9D-4,3.9D-4/
      DATA YEP2P8/62*0.0/
      DATA X2P7/13.153,14.0,15.0,16.0,18.0,19.0,20.0,21.0,22.0,25.0,
     /30.0,35.0,40.0,50.0,60.0,80.0,100.,120.,140.,170.,
     /200.,250.,300.,400.,500.,600.,800.,1000.,1200.,1400.,
     /1700.,2000.,2500.,3000.,4000.,5000.,6000.,8000.,10000.,1.2D4,
     /1.4D4,1.7D4,2.0D4,2.5D4,3.0D4,3.5D4,4.0D4,5.0D4,6.0D4,8.0D4,
     /1.0D5,1.2D5,1.4D5,1.7D5,2.0D5,2.5D5,3.0D5,4.0D5,6.0D5,8.0D5,
     /1.0D6,1.4D6,2.0D6,3.0D6,4.0D6,6.0D6,1.0D7/
      DATA Y2P7/0.00,0.20,0.56,0.92,1.56,1.74,1.81,1.81,1.76,1.60,
     /1.25,1.00,0.84,0.61,0.44,0.27,0.18,.128,.096,.066,
     /.048,.031,.022,.0125,.0081,.0056,.0032,.00205,.0014,.00105,
     /.00072,.00052,.00033,.00023,.00013,8.5D-5,5.9D-5,3.4D-5,2.2D-5,
     /1.5D-5,
     /1.1D-5,7.9D-6,5.8D-6,3.8D-6,2.7D-6,2.1D-6,1.6D-6,1.1D-6,8.0D-7,
     /5.0D-7,
     /3.5D-7,2.7D-7,2.1D-7,1.7D-7,1.4D-7,1.0D-7,8.7D-8,6.7D-8,5.1D-8,
     /4.4D-8,
     /4.0D-8,3.7D-8,3.4D-8,3.3D-8,3.25D-8,3.21D-8,3.19D-8/
      DATA YEP2P7/67*0.0/
      DATA X2P6/13.172,14.0,15.0,16.0,18.0,19.0,20.0,22.0,25.0,30.0,
     /35.0,40.0,50.0,60.0,80.0,100.,150.,200.,250.,300.,
     /400.,500.,600.,700.,800.,1000.,1200.,1400.,1700.,2000.,
     /2500.,3000.,4000.,5000.,6000.,8000.,1.D4,1.2D4,1.4D4,1.7D4,
     /2.0D4,2.5D4,3.0D4,4.0D4,5.0D4,6.0D4,8.0D4,1.0D5,1.2D5,1.4D5,
     /1.7D5,2.0D5,2.5D5,3.0D5,4.0D5,5.0D5,6.0D5,8.0D5,1.0D6,1.4D6,
     /2.0D6,3.0D6,5.0D6,1.0D7/
      DATA Y2P6/0.00,0.36,0.81,1.24,1.84,2.04,2.10,2.20,2.18,1.95,
     /1.80,1.65,1.42,1.27,1.04,0.87,0.62,0.48,0.40,0.33,
     /0.25,0.20,0.17,.146,.128,.103,.086,.074,.057,.049,
     /.042,.035,.026,.021,.018,.013,.011,.0089,.0077,.0064,
     /.0055,.0045,.0038,.0029,.0024,.0020,.0016,.00135,.00118,.00106,
     /9.3D-4,8.4D-4,7.4D-4,6.7D-4,5.9D-4,5.4D-4,5.1D-4,4.8D-4,4.6D-4,
     /4.4D-4,
     /4.2D-4,4.1D-4,4.1D-4,4.1D-4/
      DATA YEP2P6/64*0.0/
      DATA X2P5/13.273,14.0,15.0,16.0,18.0,19.0,20.0,21.0,22.0,25.0,
     /30.0,35.0,40.0,50.0,60.0,80.0,100.,120.,140.,170.,
     /200.,250.,300.,350.,400.,450.,500.,600.,800.,1000.,
     /1200.,1400.,1700.,2000.,2500.,3000.,3500.,4000.,5000.,6000.,
     /8000.,1.0D4,1.2D4,1.4D4,1.7D4,2.0D4,2.5D4,3.0D4,3.5D4,4.0D4,
     /5.0D4,6.0D4,8.0D4,1.0D5,1.2D5,1.4D5,1.7D5,2.0D5,2.5D5,3.0D5,
     /3.5D5,4.0D5,5.0D5,6.0D5,8.0D5,1.0D6,1.2D6,1.4D6,1.7D6,2.0D6,
     /3.0D6,4.0D6,7.0D6,1.0D7/
      DATA Y2P5/0.00,0.09,0.28,0.47,0.83,0.97,1.08,1.16,1.20,1.26,
     /1.25,1.23,1.20,1.08,0.96,0.75,0.60,0.52,0.44,0.37,
     /0.31,0.25,0.21,0.18,.159,.141,.129,.108,.081,.066,
     /.055,.047,.038,.033,.026,.022,.019,.016,.013,.011,
     /.0084,.0068,.0057,.0049,.0041,.0035,.0028,.0025,.0021,.0019,
     /.0015,.0013,.0010,8.7D-4,7.5D-4,6.7D-4,5.9D-4,5.3D-4,4.7D-4,
     /4.3D-4,
     /4.0D-4,3.8D-4,3.5D-4,3.3D-4,3.1D-4,2.9D-4,2.8D-4,2.8D-4,2.7D-4,
     /2.7D-4,
     /2.6D-4,2.6D-4,2.6D-4,2.6D-4/
      DATA YEP2P5/74*0.0/
      DATA X2P4/13.283,14.0,15.0,16.0,18.0,19.0,20.0,21.0,22.0,25.0,
     /30.0,35.0,40.0,50.0,60.0,80.0,100.,120.,140.,170.,
     /200.,250.,300.,400.,500.,600.,800.,1000.,1200.,1400.,
     /1700.,2000.,2500.,3000.,4000.,5000.,6000.,8000.,10000.,1.2D4,
     /1.4D4,1.7D4,2.0D4,2.5D4,3.0D4,3.5D4,4.0D4,5.0D4,6.0D4,8.0D4,
     /1.0D5,1.2D5,1.4D5,1.7D5,2.0D5,2.5D5,3.0D5,4.0D5,6.0D5,8.0D5,
     /1.0D6,1.4D6,2.0D6,3.0D6,4.0D6,6.0D6,1.0D7/
      DATA Y2P4/0.00,0.18,0.55,0.90,1.53,1.71,1.77,1.77,1.72,1.57,
     /1.23,0.98,0.82,0.60,0.43,0.26,0.18,.125,.094,.065,
     /.047,.030,.022,.0123,.0079,.0055,.0031,.00201,.0014,.00103,
     /.00071,.00051,.00032,.00022,.00013,8.3D-5,5.7D-5,3.3D-5,2.1D-5,
     /1.5D-5,
     /1.1D-5,7.7D-6,5.7D-6,3.7D-6,2.6D-6,2.1D-6,1.6D-6,1.1D-6,7.8D-7,
     /4.9D-7,
     /3.4D-7,2.7D-7,2.1D-7,1.7D-7,1.4D-7,9.8D-8,8.5D-8,6.6D-8,5.0D-8,
     /4.3D-8,
     /3.9D-8,3.6D-8,3.3D-8,3.3D-8,3.25D-8,3.21D-8,3.19D-8/
      DATA YEP2P4/67*0.0/
      DATA X2P3/13.302,14.0,15.0,16.0,18.0,19.0,20.0,21.0,22.0,25.0,
     /30.0,35.0,40.0,50.0,60.0,80.0,100.,150.,200.,250.,
     /300.,350.,400.,500.,600.,800.,1000.,1200.,1400.,1700.,
     /2000.,2500.,3000.,3500.,4000.,5000.,6000.,8000.,1.0D4,1.2D4,
     /1.4D4,1.7D4,2.0D4,2.5D4,3.0D4,3.5D4,4.0D4,5.0D4,6.0D4,8.0D4,
     /1.0D5,1.2D5,1.4D5,1.7D5,2.0D5,3.0D5,4.0D5,5.0D5,6.0D5,8.0D5,
     /1.0D6,1.4D6,1.7D6,2.0D6,4.0D6,7.0D6,1.0D7/
      DATA Y2P3/0.00,.155,0.39,0.62,1.11,1.34,1.51,1.62,1.70,1.82,
     /1.85,1.76,1.62,1.33,1.10,0.82,0.66,0.44,0.32,0.26,
     /.214,.184,.162,.131,.109,.083,.066,.055,.048,.039,
     /.0335,.0269,.0224,.0193,.0169,.0136,.0113,.0086,.0069,.0058,
     /.0050,.0041,.0036,.0029,.0024,.0021,.0019,.0015,.00132,.00104,
     /8.7D-4,7.6D-4,6.8D-4,6.0D-4,5.4D-4,4.3D-4,3.8D-4,3.5D-4,3.3D-4,
     /3.1D-4,
     /3.0D-4,2.8D-4,2.8D-4,2.7D-4,2.7D-4,2.6D-4,2.6D-4/
      DATA YEP2P3/67*0.0/
      DATA X2P2/13.328,14.0,15.0,16.0,18.0,19.0,20.0,22.0,25.0,30.0,
     /35.0,40.0,50.0,60.0,80.0,100.,120.,140.,170.,200.,
     /250.,300.,350.,400.,450.,500.,600.,800.,1000.,1200.,
     /1400.,1700.,2000.,2500.,3000.,3500.,4000.,6000.,8000.,1.0D4,
     /1.2D4,1.4D4,1.7D4,2.0D4,2.5D4,3.0D4,4.0D4,6.0D4,8.0D4,1.0D5,
     /1.2D5,1.4D5,1.7D5,2.0D5,2.5D5,3.0D5,4.0D5,6.0D5,8.0D5,1.0D6,
     /1.2D6,1.4D6,2.0D6,4.0D6,7.0D6,1.0D7/
      DATA Y2P2/0.00,0.20,0.46,0.60,0.74,0.77,.785,0.78,0.73,0.62,
     /0.53,0.44,0.33,0.25,0.15,0.10,.071,.053,.037,.027,
     /.0175,.0122,.0090,.0070,.0055,.0045,.0031,.0018,.00114,7.9D-4,
     /5.9D-4,4.0D-4,2.9D-4,1.9D-4,1.3D-4,9.5D-5,7.3D-5,3.3D-5,1.9D-5,
     /1.2D-5,
     /8.5D-6,6.4D-6,4.4D-6,3.2D-6,2.1D-6,1.5D-6,9.0D-7,4.4D-7,2.8D-7,
     /1.9D-7,
     /1.5D-7,1.2D-7,9.2D-8,7.5D-8,5.8D-8,4.8D-8,3.8D-8,2.8D-8,2.4D-8,
     /2.2D-8,
     /2.1D-8,2.0D-8,1.9D-8,1.8D-8,1.8D-8,1.8D-8/
      DATA YEP2P2/66*0.0/
      DATA X2P1/13.480,14.0,15.0,16.0,18.0,19.0,20.0,21.0,22.0,25.0,
     /30.0,35.0,40.0,50.0,60.0,80.0,100.,120.,140.,170.,
     /200.,250.,300.,350.,400.,450.,500.,600.,800.,1000.,
     /1200.,1400.,1700.,2000.,2500.,3000.,3500.,4000.,5000.,6000.,
     /8000.,1.0D4,1.2D4,1.4D4,1.7D4,2.0D4,2.5D4,3.0D4,3.5D4,4.0D4,
     /5.0D4,6.0D4,8.0D4,1.0D5,1.2D5,1.4D5,1.7D5,2.0D5,2.5D5,3.0D5,
     /3.5D5,4.0D5,5.0D5,6.0D5,8.0D5,1.0D6,1.2D6,1.4D6,1.7D6,2.0D6,
     /3.0D6,4.0D6,7.0D6,1.0D7/
      DATA Y2P1/0.00,0.29,0.94,1.58,2.75,3.22,3.60,3.85,4.00,4.20,
     /4.15,4.10,4.00,3.60,3.20,2.50,2.00,1.73,1.48,1.22,
     /1.03,0.83,0.70,0.61,0.53,0.47,0.43,0.36,0.27,0.22,
     /.182,.157,.128,.110,.088,.074,.063,.055,.044,.037,
     /.028,.0226,.0189,.0163,.0136,.0116,.0094,.0080,.0069,.0062,
     /.0051,.0043,.0034,.0029,.0025,.00225,.00198,.00178,.00157,.00143,
     /.00133,.00126,.00116,.00109,.00102,9.7D-4,9.4D-4,9.3D-4,9.1D-4,
     /9.0D-4,
     /8.8D-4,8.7D-4,8.6D-4,8.6D-4/
      DATA YEP2P1/74*0.0/
      DATA X3D6/13.845,14.0,15.0,16.0,17.0,18.0,19.0,20.0,22.0,25.0,
     /30.0,35.0,40.0,45.0,50.0,60.0,70.0,80.0,100.,120.,
     /140.,170.,200.,250.,300.,350.,400.,450.,500.,600.,
     /700.,800.,1000.,1200.,1400.,1700.,2000.,2500.,3000.,4000.,
     /6000.,8000.,1.0D4,1.2D4,1.4D4,1.7D4,2.0D4,2.5D4,3.0D4,4.0D4,
     /5.0D4,6.0D4,8.0D4,1.0D5,1.2D5,1.4D5,1.7D5,2.0D5,3.0D5,4.0D5,
     /6.0D5,8.0D5,1.0D6,1.4D6,2.0D6,4.0D6,7.0D6,1.0D7/
      DATA Y3D6/0.00,0.11,0.64,0.92,1.05,1.10,1.10,1.07,0.97,0.79,
     /0.56,0.39,0.28,0.21,0.16,.099,.065,.045,.024,.014,
     /.0091,.0052,.0032,.0017,9.9D-4,6.2D-4,4.2D-4,3.0D-4,2.2D-4,1.3D-4,
     /8.0D-5,5.4D-5,2.8D-5,1.6D-5,1.0D-5,5.7D-6,3.5D-6,1.8D-6,1.1D-6,
     /4.5D-7,
     /1.4D-7,5.8D-8,3.0D-8,1.8D-8,1.1D-8,6.6D-9,4.1D-9,2.2D-9,1.3D-9,
     /6.1D-10,
     /3.4D-10,2.1D-10,1.0D-10,6.1D-11,4.1D-11,2.9D-11,2.0D-11,1.5D-11,
     /7.6D-12,5.2D-12,
     /3.4D-12,2.7D-12,2.4D-12,2.1D-12,1.9D-12,1.7D-12,1.7D-12,1.7D-12/
      DATA YEP3D6/68*0.0/
      DATA X3D5/13.864,14.0,15.0,16.0,17.0,18.0,19.0,20.0,22.0,25.0,
     /30.0,35.0,40.0,45.0,50.0,60.0,70.0,80.0,100.,120.,
     /140.,170.,200.,250.,300.,400.,500.,600.,700.,800.,
     /1000.,1200.,1400.,1700.,2000.,2500.,3000.,3500.,4000.,5000.,
     /6000.,8000.,1.0D4,1.2D4,1.4D4,1.7D4,2.0D4,2.5D4,3.0D4,4.0D4,
     /5.0D4,6.0D4,8.0D4,1.0D5,1.2D5,1.4D5,1.7D5,2.0D5,2.5D5,3.0D5,
     /4.0D5,5.0D5,6.0D5,8.0D5,1.0D6,1.4D6,2.0D6,3.0D6,4.0D6,6.0D6,
     /8.0D6,1.0D7/
      DATA Y3D5/0.00,0.40,3.00,4.50,5.25,5.50,5.50,5.35,4.90,4.00,
     /2.80,2.05,1.50,1.15,0.98,0.65,0.46,0.35,0.19,0.14,
     /.115,.095,.077,.065,.055,.043,.036,.032,.028,.026,
     /.022,.019,.017,.015,.0128,.0107,.0093,.0082,.0074,.0061,
     /.0053,.0042,.0035,.0030,.0026,.0023,.0020,.00165,.00143,.00114,
     /9.6D-4,8.4D-4,6.8D-4,5.8D-4,5.2D-4,4.7D-4,4.2D-4,3.9D-4,3.5D-4,
     /3.2D-4,
     /2.9D-4,2.8D-4,2.7D-4,2.6D-4,2.5D-4,2.5D-4,2.5D-4,2.6D-4,2.7D-4,
     /2.8D-4,
     /2.9D-4,3.0D-4/
      DATA YEP3D5/72*0.0/
      DATA X3D4P/13.979,15.0,16.0,17.0,18.0,19.0,20.0,22.0,25.0,30.0,
     /35.0,40.0,45.0,50.0,55.0,60.0,70.0,80.0,90.0,100.,
     /120.,140.,170.,200.,250.,300.,350.,400.,450.,500.,
     /600.,700.,800.,1000.,1200.,1400.,1700.,2000.,2500.,3000.,
     /3500.,4000.,5000.,6000.,8000.,1.0D4,1.2D4,1.4D4,1.7D4,2.0D4,
     /2.5D4,3.0D4,3.5D4,4.0D4,5.0D4,6.0D4,8.0D4,1.0D5,1.2D5,1.4D5,
     /1.7D5,2.0D5,2.5D5,3.0D5,3.5D5,4.0D5,5.0D5,6.0D5,8.0D5,1.0D6,
     /1.2D6,1.4D6,2.0D6,3.0D6,4.0D6,7.0D6,1.0D7/
      DATA Y3D4P/0.00,2.16,3.31,3.88,4.11,4.14,4.04,3.68,3.03,2.12,
     /1.50,1.09,.813,.619,.482,.381,.251,.173,.125,.092,
     /.055,.035,.020,.0125,.0065,.0038,.0024,.0016,.00115,8.4D-4,
     /4.9D-4,3.1D-4,2.1D-4,1.1D-4,6.2D-5,3.9D-5,2.2D-5,1.4D-5,7.0D-6,
     /4.1D-6,
     /2.6D-6,1.7D-6,8.9D-7,5.2D-7,2.2D-7,1.1D-7,6.9D-8,4.4D-8,2.5D-8,
     /1.6D-8,
     /8.5D-9,5.1D-9,3.4D-9,2.4D-9,1.3D-9,8.2D-10,4.0D-10,2.4D-10,
     /1.6D-10,1.1D-10,
     /7.7D-11,5.7D-11,3.9D-11,2.9D-11,2.4D-11,2.0D-11,1.6D-11,1.3D-11,
     /1.1D-11,9.3D-12,
     /8.5D-12,8.0D-12,7.3D-12,6.9D-12,6.7D-12,6.5D-12,6.5D-12/
      DATA YEP3D4P/77*0.0/
      DATA X3D4/14.013,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,25.0,
     /30.0,35.0,40.0,45.0,50.0,55.0,60.0,65.0,70.0,75.0,
     /80.0,90.0,100.,120.,140.,170.,200.,250.,300.,350.,
     /400.,450.,500.,550.,600.,650.,700.,750.,800.,900.,
     /1000.,1200.,1400.,1700.,2000.,2500.,3000.,3500.,4000.,4500.,
     /5000.,5500.,6000.,7000.,8000.,1.0D4,1.2D4,1.4D4,1.7D4,2.0D4,
     /2.5D4,3.0D4,3.5D4,4.0D4,4.5D4,5.0D4,6.0D4,8.0D4,1.0D5,1.2D5,
     /1.4D5,1.7D5,2.0D5,2.5D5,3.0D5,3.5D5,4.0D5,5.0D5,6.0D5,8.0D5,
     /1.0D6,1.4D6,2.0D6,3.0D6,6.0D6,1.0D7/
      DATA Y3D4/0.00,0.63,1.05,1.31,1.48,1.57,1.62,1.63,1.62,1.52,
     /1.28,1.06,0.88,0.73,0.62,0.53,0.46,0.40,0.35,0.31,
     /0.28,.225,.186,.133,.099,.069,.050,.033,.023,.017,
     /.0131,.0104,.0084,.0070,.0059,.0050,.0043,.0038,.0033,.0026,
     /.0021,.0015,.0011,7.5D-4,5.4D-4,3.5D-4,2.4D-4,1.8D-4,1.4D-4,
     /1.1D-4,
     /8.9D-5,7.4D-5,6.2D-5,4.6D-5,3.5D-5,2.3D-5,1.6D-5,1.2D-5,8.2D-6,
     /6.1D-6,
     /4.0D-6,2.8D-6,2.2D-6,1.7D-6,1.4D-6,1.1D-6,8.3D-7,5.2D-7,3.7D-7,
     /2.8D-7,
     /2.2D-7,1.7D-7,1.4D-7,1.1D-7,9.1D-8,7.9D-8,7.0D-8,6.0D-8,5.3D-8,
     /4.6D-8,
     /4.2D-8,3.8D-8,3.6D-8,3.4D-8,3.3D-8,3.3D-8/
      DATA YEP3D4/86*0.0/
      DATA X3D3/13.903,14.0,15.0,16.0,17.0,18.0,19.0,20.0,22.0,25.0,
     /30.0,35.0,40.0,45.0,50.0,60.0,70.0,80.0,90.0,100.,
     /120.,140.,170.,200.,250.,300.,350.,400.,450.,500.,
     /550.,600.,700.,800.,1000.,1200.,1400.,1700.,2000.,2500.,
     /3000.,3500.,4000.,4500.,5000.,5500.,6000.,7000.,8000.,1.0D4,
     /1.2D4,1.4D4,1.7D4,2.0D4,2.5D4,3.0D4,4.0D4,5.0D4,6.0D4,8.0D4,
     /1.0D5,1.2D5,1.4D5,1.7D5,2.0D5,2.5D5,3.0D5,4.0D5,5.0D5,6.0D5,
     /8.0D5,1.0D6,1.4D6,2.0D6,4.0D6,7.0D6,1.0D7/
      DATA Y3D3/0.00,0.15,1.60,3.00,3.70,4.30,4.50,4.40,4.20,3.60,
     /2.63,1.86,1.35,1.00,0.76,0.47,0.31,0.21,0.15,.114,
     /.068,.043,.025,.0154,.0080,.0047,.0030,.0020,.00141,.00103,
     /7.8D-4,6.0D-4,3.8D-4,2.5D-4,1.3D-4,7.6D-5,4.8D-5,2.7D-5,1.7D-5,
     /8.6D-6,
     /5.0D-6,3.2D-6,2.1D-6,1.5D-6,1.1D-6,8.3D-7,6.4D-7,4.1D-7,2.8D-7,
     /1.4D-7,
     /8.5D-8,5.4D-8,3.1D-8,2.0D-8,1.1D-8,6.3D-9,2.9D-9,1.6D-9,1.0D-9,
     /4.9D-10,
     /2.9D-10,1.9D-10,1.4D-10,9.5D-11,7.0D-11,4.8D-11,3.6D-11,2.5D-11,
     /1.9D-11,1.6D-11,
     /1.3D-11,1.1D-11,9.9D-12,9.0D-12,8.2D-12,8.0D-12,8.0D-12/
      DATA YEP3D3/77*0.0/
      DATA X3D1PP/14.063,15.0,16.0,17.0,18.0,19.0,20.0,22.0,25.0,30.0,
     /35.0,40.0,45.0,50.0,60.0,70.0,80.0,90.0,100.,120.,
     /140.,170.,200.,250.,300.,350.,400.,450.,500.,600.,
     /700.,800.,1000.,1200.,1400.,1700.,2000.,2500.,3000.,3500.,
     /4000.,5000.,6000.,8000.,1.0D4,1.2D4,1.4D4,1.7D4,2.0D4,2.5D4,
     /3.0D4,3.5D4,4.0D4,5.0D4,6.0D4,8.0D4,1.0D5,1.2D5,1.4D5,1.7D5,
     /2.0D5,2.5D5,3.0D5,4.0D5,5.0D5,6.0D5,8.0D5,1.0D6,1.4D6,2.0D6,
     /3.0D6,1.0D7/
      DATA Y3D1PP/0.00,0.60,1.10,1.50,1.70,1.80,1.85,1.85,1.65,1.35,
     /1.00,0.73,0.57,0.45,0.32,0.23,0.18,.145,.120,.085,
     /.064,.044,.032,.021,.015,.0109,.0084,.0067,.0054,.0038,
     /.0028,.0022,.0014,9.6D-4,7.1D-4,4.8D-4,3.5D-4,2.3D-4,1.6D-4,
     /1.2D-4,
     /8.9D-5,5.7D-5,4.0D-5,2.3D-5,1.5D-5,1.0D-5,7.7D-6,5.3D-6,3.9D-6,
     /2.6D-6,
     /1.8D-6,1.4D-6,1.1D-6,7.4D-7,5.4D-7,3.4D-7,2.4D-7,1.8D-7,1.5D-7,
     /1.1D-7,
     /9.2D-8,7.1D-8,5.9D-8,4.5D-8,3.9D-8,3.5D-8,3.0D-8,2.7D-8,2.5D-8,
     /2.3D-8,
     /2.2D-8,2.1D-8/
      DATA YEP3D1PP/72*0.0/
      DATA X3D1P/14.099,15.0,16.0,18.0,19.0,20.0,21.0,22.0,25.0,30.0,
     /35.0,40.0,50.0,60.0,80.0,100.,150.,200.,250.,300.,
     /350.,400.,500.,600.,800.,1000.,1200.,1400.,1700.,2000.,
     /2500.,3000.,3500.,4000.,5000.,6000.,8000.,1.0D4,1.2D4,1.4D4,
     /1.7D4,2.0D4,2.5D4,3.0D4,3.5D4,4.0D4,5.0D4,6.0D4,8.0D4,1.0D5,
     /1.2D5,1.4D5,1.7D5,2.0D5,3.0D5,4.0D5,5.0D5,6.0D5,8.0D5,1.0D6,
     /1.4D6,1.7D6,2.0D6,4.0D6,7.0D6,1.0D7/
      DATA Y3D1P/0.00,0.08,0.18,0.33,0.40,0.45,0.48,0.50,0.54,0.55,
     /0.52,0.48,0.40,0.33,0.24,0.20,0.13,.095,.077,.064,
     /.055,.048,.039,.032,.025,.020,.016,.014,.012,.0099,
     /.0080,.0067,.0057,.0050,.0040,.0034,.0026,.0020,.0017,.0015,
     /.0012,.0011,8.6D-4,7.1D-4,6.2D-4,5.6D-4,4.5D-4,3.9D-4,3.1D-4,
     /2.6D-4,
     /2.3D-4,2.0D-4,1.8D-4,1.6D-4,1.3D-4,1.1D-4,1.0D-4,9.8D-5,9.2D-5,
     /8.9D-5,
     /8.3D-5,8.3D-5,8.1D-5,8.0D-5,7.7D-5,7.7D-5/
      DATA YEP3D1P/66*0.0/
      DATA X3S1PPPP/14.214,15.0,16.0,17.0,18.0,19.0,20.0,22.0,24.0,27.0,
     /30.0,35.0,40.0,45.0,50.0,55.0,60.0,70.0,80.0,90.0,
     /100.,120.,140.,170.,200.,250.,300.,350.,400.,450.,
     /500.,550.,600.,700.,800.,1000.,1200.,1400.,1700.,2000.,
     /2500.,3000.,3500.,4000.,4500.,5000.,6000.,7000.,8000.,1.0D4,
     /1.2D4,1.4D4,1.7D4,2.0D4,2.5D4,3.0D4,3.5D4,4.0D4,5.0D4,6.0D4,
     /7.0D4,8.0D4,1.0D5,1.2D5,1.4D5,1.7D5,2.0D5,2.5D5,3.0D5,3.5D5,
     /4.0D5,5.0D5,6.0D5,8.0D5,1.0D6,1.2D6,1.4D6,1.7D6,2.0D6,3.0D6,
     /4.0D6,7.0D6,1.0D7/
      DATA Y3S1PPPP/0.00,0.80,1.65,2.10,2.30,2.35,2.32,2.15,1.89,1.54,
     /1.25,0.89,0.65,0.48,0.37,0.29,0.23,0.15,.103,.074,
     /.055,.033,.021,.012,.0075,.0039,.0023,.0014,9.7D-4,6.8D-4,
     /5.0D-4,3.8D-4,2.9D-4,1.8D-4,1.2D-4,6.4D-5,3.7D-5,2.3D-5,1.3D-5,
     /8.1D-6,
     /4.2D-6,2.4D-6,1.5D-6,1.0D-6,7.3D-7,5.3D-7,3.1D-7,2.0D-7,1.3D-7,
     /7.0D-8,
     /4.1D-8,2.6D-8,1.5D-8,9.5D-9,5.1D-9,3.1D-9,2.0D-9,1.4D-9,7.8D-10,
     /4.9D-10,
     /3.3D-10,2.4D-10,1.4D-10,9.4D-11,6.8D-11,4.6D-11,3.4D-11,2.3D-11,
     /1.8D-11,1.4D-11,
     /1.2D-11,9.3D-12,7.8D-12,6.3D-12,5.5D-12,5.1D-12,4.8D-12,4.5D-12,
     /4.4D-12,4.1D-12,
     /4.0D-12,3.9D-12,3.9D-12/
      DATA YEP3S1PPPP/83*0.0/
      DATA X3S1PPP/14.236,15.0,16.0,18.0,19.0,20.0,21.0,22.0,25.0,30.0,
     /35.0,40.0,50.0,60.0,80.0,100.,150.,200.,250.,300.,
     /350.,400.,500.,600.,800.,1000.,1200.,1400.,1700.,2000.,
     /2500.,3000.,3500.,4000.,5000.,6000.,8000.,1.0D4,1.2D4,1.4D4,
     /1.7D4,2.0D4,2.5D4,3.0D4,3.5D4,4.0D4,5.0D4,6.0D4,8.0D4,1.0D5,
     /1.2D5,1.4D5,1.7D5,2.0D5,3.0D5,4.0D5,5.0D5,6.0D5,8.0D5,1.0D6,
     /1.4D6,1.0D7/
      DATA Y3S1PPP/0.00,0.12,0.27,0.50,0.60,0.68,0.72,0.75,0.81,0.82,
     /0.78,0.72,0.60,0.52,0.36,0.30,0.20,0.14,.116,.096,
     /.082,.072,.059,.048,.038,.030,.024,.021,.018,.0150,
     /.0120,.0101,.0086,.0075,.0060,.0051,.0039,.0030,.0026,.0023,
     /.0018,.0016,.00129,.00106,9.3D-4,8.4D-4,6.7D-4,5.9D-4,4.6D-4,
     /3.9D-4,
     /3.5D-4,3.0D-4,2.7D-4,2.4D-4,1.9D-4,1.6D-4,1.5D-4,1.4D-4,1.4D-4,
     /1.3D-4,
     /1.2D-4,1.2D-5/
      DATA YEP3S1PPP/62*0.0/
      DATA X3S1PP/14.234,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,25.0,
     /30.0,35.0,40.0,45.0,50.0,55.0,60.0,70.0,80.0,90.0,
     /100.,120.,140.,170.,200.,250.,300.,350.,400.,450.,
     /500.,550.,600.,700.,800.,900.,1000.,1200.,1400.,1700.,
     /2000.,2500.,3000.,3500.,4000.,4500.,5000.,6000.,7000.,8000.,
     /1.0D4,1.2D4,1.4D4,1.7D4,2.0D4,2.5D4,3.0D4,3.5D4,4.0D4,5.0D4,
     /6.0D4,7.0D4,8.0D4,1.0D5,1.2D5,1.4D5,1.7D5,2.0D5,2.5D5,3.0D5,
     /3.5D5,4.0D5,5.0D5,6.0D5,8.0D5,1.0D6,1.4D6,2.0D6,3.0D6,5.0D6,
     /1.0D7/
      DATA Y3S1PP/0.00,0.55,1.06,1.31,1.42,1.44,1.42,1.37,1.31,1.09,
     /0.77,0.55,0.40,0.30,0.23,0.18,0.14,.0918,.0635,.0456,
     /.0339,.0202,.0129,.0074,.0046,.0024,.0014,8.9D-4,6.0D-4,4.2D-4,
     /3.1D-4,2.3D-4,1.8D-4,1.2D-4,7.6D-5,5.4D-5,3.9D-5,2.3D-5,1.4D-5,
     /8.1D-6,
     /5.0D-6,2.6D-6,1.5D-6,9.5D-7,6.4D-7,4.5D-7,3.3D-7,1.9D-7,1.2D-7,
     /8.3D-8,
     /4.3D-8,2.5D-8,1.6D-8,9.3D-9,5.9D-9,3.1D-9,1.9D-9,1.2D-9,8.6D-10,
     /4.8D-10,
     /3.0D-10,2.0D-10,1.5D-10,8.7D-11,5.8D-11,4.2D-11,2.8D-11,2.1D-11,
     /1.4D-11,1.1D-11,
     /8.7D-12,7.4D-12,5.7D-12,4.8D-12,3.9D-12,3.4D-12,3.0D-12,2.7D-12,
     /2.5D-12,2.4D-12,
     /2.4D-12/
      DATA YEP3S1PP/81*0.0/
      DATA X2S5/14.068,15.0,16.0,17.0,18.0,19.0,20.0,22.0,25.0,30.0,
     /35.0,40.0,45.0,50.0,60.0,70.0,80.0,90.0,100.,120.,
     /140.,170.,200.,250.,300.,350.,400.,450.,500.,600.,
     /700.,800.,1000.,1200.,1400.,1700.,2000.,2500.,3000.,3500.,
     /4000.,5000.,6000.,8000.,1.0D4,1.2D4,1.4D4,1.7D4,2.0D4,2.5D4,
     /3.0D4,3.5D4,4.0D4,5.0D4,6.0D4,8.0D4,1.0D5,1.2D5,1.4D5,1.7D5,
     /2.0D5,2.5D5,3.0D5,4.0D5,5.0D5,6.0D5,8.0D5,1.0D6,1.4D6,2.0D6,
     /3.0D6,1.0D7/
      DATA Y2S5/0.00,0.60,1.10,1.50,1.70,1.80,1.85,1.85,1.65,1.35,
     /1.00,0.73,0.57,0.45,0.32,0.23,0.18,.145,.120,.085,
     /.064,.044,.032,.021,.015,.0109,.0084,.0067,.0054,.0038,
     /.0028,.0022,.0014,9.6D-4,7.1D-4,4.8D-4,3.5D-4,2.3D-4,1.6D-4,
     /1.2D-4,
     /8.9D-5,5.7D-5,4.0D-5,2.3D-5,1.5D-5,1.0D-5,7.7D-6,5.3D-6,3.9D-6,
     /2.6D-6,
     /1.8D-6,1.4D-6,1.1D-6,7.4D-7,5.4D-7,3.4D-7,2.4D-7,1.8D-7,1.5D-7,
     /1.1D-7,
     /9.2D-8,7.1D-8,5.9D-8,4.5D-8,3.9D-8,3.5D-8,3.0D-8,2.7D-8,2.5D-8,
     /2.3D-8,
     /2.2D-8,2.1D-8/
      DATA YEP2S5/72*0.0/
      DATA X2S3/14.241,15.0,16.0,17.0,18.0,19.0,20.0,22.0,25.0,30.0,
     /35.0,40.0,45.0,50.0,60.0,70.0,80.0,90.0,100.,120.,
     /140.,170.,200.,250.,300.,350.,400.,450.,500.,600.,
     /700.,800.,1000.,1200.,1400.,1700.,2000.,2500.,3000.,3500.,
     /4000.,5000.,6000.,8000.,1.0D4,1.2D4,1.4D4,1.7D4,2.0D4,2.5D4,
     /3.0D4,3.5D4,4.0D4,5.0D4,6.0D4,8.0D4,1.0D5,1.2D5,1.4D5,1.7D5,
     /2.0D5,2.5D5,3.0D5,4.0D5,5.0D5,6.0D5,8.0D5,1.0D6,1.4D6,2.0D6,
     /3.0D6,1.0D7/
      DATA Y2S3/0.00,0.12,0.22,0.30,0.34,0.36,0.37,0.37,0.33,0.27,
     /0.20,.146,.114,.090,.064,.046,.036,.029,.024,.017,
     /.013,.0088,.0064,.0042,.0030,.0022,.0017,.0013,.0011,7.6D-4,
     /5.6D-4,4.4D-4,2.8D-4,1.9D-4,1.4D-4,9.6D-5,7.0D-5,4.6D-5,3.2D-5,
     /2.4D-5,
     /1.8D-5,1.1D-5,8.0D-6,4.6D-6,3.0D-6,2.0D-6,1.5D-6,1.1D-6,7.8D-7,
     /5.2D-7,
     /3.6D-7,2.8D-7,2.2D-7,1.5D-7,1.1D-7,6.8D-8,4.8D-8,3.6D-8,3.0D-8,
     /2.2D-8,
     /1.8D-8,1.4D-8,1.2D-8,9.0D-9,7.8D-9,7.0D-9,6.0D-9,5.4D-9,5.0D-9,
     /4.6D-9,
     /4.4D-9,4.2D-9/
      DATA YEP2S3/72*0.0/
C----------------------------------------------------------------------
      IF(NANISO.EQ.0) THEN
       NAME='ARGON ISOT 2009'
      ELSE
       NAME='ARGON ANIS 2009'
      ENDIF
C ----------------------------------------------------------------
C  MULTI-TERM CROSS-SECTION.
C  FOR PURE ARGON:
C  ACCURACY OF DERIVED VELOCITY AND DIFFUSION COEFFICIENTS 0.5% BELOW
C  3000VOLTS . BELOW 20000VOLTS ACCURACY 1.0%. IONISATION COEFFICIENT
C  AND DRIFT VELOCITY ACCURACY BETTER THAN  5% BELOW 1,000,000 VOLTS
C  ANISOTROPIC ELASTIC SCATTERING VERSION
C  2007:INCREASED DATA BASE UPPER ENERGY TO 2MEV
C  2007:INCLUDED NEW ANISTROPIC SCATTERING FUNCTION
C  2007:INCLUDED POSSIBLE PENNING TRANSFER FRACTION
C  2009:SPLIT EXCITATION X-SECTION INTO 44 LEVELS AND MODIFIED
C       ELASTIC X-SECTION.
C-----------------------------------------------------------------
C
C  PARAMETERS OF PHASE SHIFT ANALYSIS.
C
      APOL=11.08
      LMAX=100
      AA=-1.459
      DD=68.93
      FF=-97.0
      A1=8.69
      API=DACOS(-1.0D0)
      A0=0.52917720859D-8
      RY=13.60569193
      CONST=1.873884D-20
      EMASS2=1021997.804
      BBCONST=16.0*API*A0*A0*RY*RY/EMASS2
      CONST=1.873884D-20
      AM2=3.593
      C=39.70
C
      NIN=44
      DO 1 J=1,6
    1 KEL(J)=NANISO
      DO 2 J=1,NIN
    2 KIN(J)=NANISO
C
      NDATA=60
      NEPSI=160
      NIDATA=75
      N1S5=105
      N1S4=113
      N1S3=104
      N1S2=119
      N2P10=100
      N2P9=65
      N2P8=62
      N2P7=67
      N2P6=64
      N2P5=74
      N2P4=67
      N2P3=67
      N2P2=66
      N2P1=74
      N3D6=68
      N3D5=72
      N3D3=77
      N3D4P=77
      N3D4=86
      N3D1PP=72
      N2S5=72
      N3D1P=66
      N3S1PPPP=83
      N3S1PP=81
      N3S1PPP=62
      N2S3=72
      E(1)=0.0
      E(2)=2.0*EMASS/(39.948*AMU)
      E(3)=15.75961
C EXCITATION X-SECTION AT 1.5MEV
      E(4)=0.18D-18
C IONISING X-SECTION AT 1.5MEV
      E(5)=0.9204D-18
C EOBY FOR MINIMUM IONISING PARTICLE
      E(6)=15.0
C EOBY AT LOW ENERGY
      EOBY=10.0
      IOFF=IFIX(SNGL(0.5+E(3)/ESTEP))
      EIN(1)=11.548
      EIN(2)=11.624
      EIN(3)=11.723
      EIN(4)=11.828
      EIN(5)=12.907
      EIN(6)=13.076
      EIN(7)=13.095
      EIN(8)=13.153
      EIN(9)=13.172
      EIN(10)=13.273
      EIN(11)=13.283
      EIN(12)=13.302
      EIN(13)=13.328
      EIN(14)=13.480
      EIN(15)=13.845
      EIN(16)=13.864
      EIN(17)=13.903
      EIN(18)=13.979
      EIN(19)=14.013
      EIN(20)=14.063
      EIN(21)=14.068
      EIN(22)=14.090
      EIN(23)=14.099
      EIN(24)=14.153
      EIN(25)=14.214
      EIN(26)=14.234
      EIN(27)=14.236
      EIN(28)=14.241
      EIN(29)=14.255
      EIN(30)=14.304
      EIN(31)=14.711
      EIN(32)=14.848
      EIN(33)=14.859
      EIN(34)=15.004
      EIN(35)=15.022
      EIN(36)=15.118
      EIN(37)=15.186
      EIN(38)=15.190
      EIN(39)=15.308
      EIN(40)=15.351
      EIN(41)=15.360
      EIN(42)=15.366
      EIN(43)=15.350
      EIN(44)=15.660
C**********************************************************************
C ENTER PENNING TRANSFER FRACTION FOR EACH LEVEL
C USE TRANSFER FRACTION IN RANGE BETWEEN 0.0 AND 0.2 FOR MOST MIXTURES
      DO 50 NL=1,NIN
      PENFRA(1,NL)=0.0
C PENNING TRANSFER DISTANCE MICRONS
      PENFRA(2,NL)=1.0
C PENNING TRANSFER TIME PICOSECONDS
   50 PENFRA(3,NL)=1.0
C**********************************************************************
      IF(IPEN.EQ.0) GO TO 4
      DO 3 KDUM=1,NIN
      IF(PENFRA(1,KDUM).EQ.0.0) GO TO 3
      WRITE(6,999) NAME,EIN(KDUM),PENFRA(1,KDUM),PENFRA(2,KDUM),
     /PENFRA(3,KDUM)
  999 FORMAT(' GAS = ',A15,' ENERGY LEVEL = ',F7.4,' EV.',/,' PENNING PR
     /OBABILITY =',F5.3,' ABS.LENGTH =',F7.2,' DECAY TIME =',F7.1,/)
    3 CONTINUE
    4 DO 5 NL=1,NIN
    5 IOFFN(NL)=IFIX(SNGL(0.5+EIN(NL)/ESTEP))
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC (ANIS)  ARGON        '
      IF(NANISO.EQ.0) THEN
      SCRPT(2)=' ELASTIC (ISO)   ARGON        '
      ENDIF
      SCRPT(3)=' IONISATION    ELOSS= 15.75961'
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' EXC 1S5    J=2 M ELVL= 11.548'
      SCRPT(8)=' EXC 1S4    J=1 R ELVL= 11.624'
      SCRPT(9)=' EXC 1S3    J=0 M ELVL= 11.723'
      SCRPT(10)=' EXC 1S2    J=1 R ELVL= 11.828'
      SCRPT(11)=' EXC 2P10   J=1   ELVL= 12.907'
      SCRPT(12)=' EXC 2P9    J=3   ELVL= 13.076'
      SCRPT(13)=' EXC 2P8    J=2   ELVL= 13.095'
      SCRPT(14)=' EXC 2P7    J=1   ELVL= 13.153'
      SCRPT(15)=' EXC 2P6    J=2   ELVL= 13.172'
      SCRPT(16)=' EXC 2P5    J=0   ELVL= 13.273'
      SCRPT(17)=' EXC 2P4    J=1   ELVL= 13.283'
      SCRPT(18)=' EXC 2P3    J=2   ELVL= 13.302'
      SCRPT(19)=' EXC 2P2    J=1   ELVL= 13.328'
      SCRPT(20)=' EXC 2P1    J=0   ELVL= 13.480'
      SCRPT(21)=' EXC 3D6    J=0   ELVL= 13.845'
      SCRPT(22)=' EXC 3D5    J=1 R ELVL= 13.864'
      SCRPT(23)=' EXC 3D3    J=2   ELVL= 13.903'
      SCRPT(24)=' EXC 3D4!   J=4   ELVL= 13.979'
      SCRPT(25)=' EXC 3D4    J=3   ELVL= 14.013'
      SCRPT(26)=' EXC 3D1!!  J=2   ELVL= 14.063'
      SCRPT(27)=' EXC 2S5    J=2   ELVL= 14.068'
      SCRPT(28)=' EXC 2S4    J=1 R ELVL= 14.090'
      SCRPT(29)=' EXC 3D1!   J=3   ELVL= 14.099'
      SCRPT(30)=' EXC 3D2    J=1 R ELVL= 14.153'
      SCRPT(31)=' EXC 3S1!!!!J=2   ELVL= 14.214'
      SCRPT(32)=' EXC 3S1!!  J=2   ELVL= 14.234'
      SCRPT(33)=' EXC 3S1!!! J=3   ELVL= 14.236'
      SCRPT(34)=' EXC 2S3    J=0   ELVL= 14.241'
      SCRPT(35)=' EXC 2S2    J=1 R ELVL= 14.255'
      SCRPT(36)=' EXC 3S1!   J=1 R ELVL= 14.304'
      SCRPT(37)=' EXC 4D5    J=1 R ELVL= 14.711'
      SCRPT(38)=' EXC 3S4    J=1 R ELVL= 14.848'
      SCRPT(39)=' EXC 4D2    J=1 R ELVL= 14.859'
      SCRPT(40)=' EXC 4S1!   J=1 R ELVL= 15.004'
      SCRPT(41)=' EXC 3S2    J=1 R ELVL= 15.022'
      SCRPT(42)=' EXC 5D5    J=1 R ELVL= 15.118'
      SCRPT(43)=' EXC 4S4    J=1 R ELVL= 15.186'
      SCRPT(44)=' EXC 5D2    J=1 R ELVL= 15.190'
      SCRPT(45)=' EXC 6D5    J=1 R ELVL= 15.308'
      SCRPT(46)=' EXC 5S1!   J=1 R ELVL= 15.351'
      SCRPT(47)=' EXC 4S2    J=1 R ELVL= 15.360'
      SCRPT(48)=' EXC 5S4    J=1 R ELVL= 15.366'
      SCRPT(49)=' EXC 6D2    J=1 R ELVL= 15.350'
      SCRPT(50)=' EXC HIGH   J=1 R ELVL= 15.660'
      EN=-ESTEP/2.0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      IF(EN.GT.EIN(1)) THEN
       GAMMA=(EMASS2+2.0D0*EN)/EMASS2
       GAMMA2=GAMMA*GAMMA
       BETA=DSQRT(1.0D0-1.0D0/(GAMMA*GAMMA))
       BETA2=BETA*BETA
      ENDIF
      IF(EN.GT.1.0) GO TO 100
      IF(EN.EQ.0.0) QELA=7.491D-16
      IF(EN.EQ.0.0) QMOM=7.491D-16
      IF(EN.EQ.0.0) GO TO 200
      AK=DSQRT(EN/ARY)
      AK2=AK*AK
      AK3=AK2*AK
      AK4=AK3*AK
      AN0=-AA*AK*(1.0+(4.0*APOL/3.0)*AK2*DLOG(AK))-(API*APOL/3.0)*AK2+
     /DD*AK3+FF*AK4
      AN1=(API/15.0)*APOL*AK2-A1*AK3
      AN2=API*APOL*AK2/105.0
      AN0=DATAN(AN0)
      AN1=DATAN(AN1)
      AN2=DATAN(AN2)
      ANHIGH=AN2
      SUM=(DSIN(AN0-AN1))**2
      SUM=SUM+2.0*(DSIN(AN1-AN2))**2
      SIGEL=(DSIN(AN0))**2+3.0*(DSIN(AN1))**2
      DO 10 J=2,LMAX-1
      ANLOW=ANHIGH
      SUMI=6.0/((2.0*J+5.0)*(2.0*J+3.0)*(2.0*J+1.0)*(2.0*J-1.0))
      SUM=SUM+(J+1.0)*(DSIN(DATAN(API*APOL*AK2*SUMI)))**2
      ANHIGH=DATAN(API*APOL*AK2/((2.0*J+5.0)*(2.0*J+3.0)*(2.0*J+1.0)))
      SIGEL=SIGEL+(2.0*J+1.0)*(DSIN(ANLOW))**2
   10 CONTINUE
      QELA=SIGEL*4.0*PIR2/AK2
      QMOM=SUM*4.0*PIR2/AK2
      GO TO 200
  100 CONTINUE
      DO 110 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 120
  110 CONTINUE
      J=NDATA
  120 A=(YEL(J)-YEL(J-1))/(XEN(J)-XEN(J-1))
      B=(XEN(J-1)*YEL(J)-XEN(J)*YEL(J-1))/(XEN(J-1)-XEN(J))
      QELA=(A*EN+B)*1.0D-16
      A=(YSEC(J)-YSEC(J-1))/(XEN(J)-XEN(J-1))
      B=(XEN(J-1)*YSEC(J)-XEN(J)*YSEC(J-1))/(XEN(J-1)-XEN(J))
      QMOM=(A*EN+B)*1.0D-16
  200 CONTINUE
      PQ1=0.5+(QELA-QMOM)/QELA
      DO 201 J=2,NEPSI
      IF(EN.LE.XEPS(J)) GO TO 202
  201 CONTINUE
      J=NEPSI
  202 A=(YEPS(J)-YEPS(J-1))/(XEPS(J)-XEPS(J-1))
      B=(XEPS(J-1)*YEPS(J)-XEPS(J)*YEPS(J-1))/(XEPS(J-1)-XEPS(J))
      PQ2=A*EN+B
      IF(NANISO.EQ.0) PEQEL(2,I)=0.5
      IF(NANISO.EQ.1) PEQEL(2,I)=PQ1
      IF(NANISO.EQ.2) PEQEL(2,I)=PQ2
      Q(2,I)=QELA
      IF(NANISO.EQ.0) Q(2,I)=QMOM
C   GROSS IONISATION
      Q(3,I)=0.0
      PEQEL(3,I)=0.5D0
      IF(NANISO.EQ.2) PEQEL(3,I)=0.0D0
      IF(EN.LE.E(3)) GO TO 230
      IF(EN.GT.XENI(75)) GO TO 221
      DO 210 J=2,NIDATA
      IF(EN.LE.XENI(J)) GO TO 220
  210 CONTINUE
      J=NIDATA
  220 A=(YENI(J)-YENI(J-1))/(XENI(J)-XENI(J-1))
      B=(XENI(J-1)*YENI(J)-XENI(J)*YENI(J-1))/(XENI(J-1)-XENI(J))
      Q(3,I)=(A*EN+B)*1.0D-16
      GO TO 222
C USE BORN-BETHE X-SECTION ABOVE XENI(75) EV
  221 X2=1.0D0/BETA2
      X1=X2*DLOG(BETA2/(1.0D0-BETA2))-1.0D0
      Q(3,I)=CONST*(AM2*X1+C*X2)/0.939
  222 CONTINUE
C USE ANISOTROPIC SCATTERING FOR PRIMARY IONISATION ELECTRON FOR
C ENERGIES ABOVE 2 * IONISATION ENERGY
C ANISOTROPIC ANGULAR DISTRIBUTION SAME AS ELASTIC AT ENERGY OFFSET BY
C IONISATION ENERGY
      IF(EN.LE.(2.0*E(3))) GO TO 230
      PEQEL(3,I)=PEQEL(2,(I-IOFF))
  230 Q(4,I)=0.0
C COUNTING IONISATION
      Q(5,I)=0.0
      PEQEL(5,I)=0.5D0
      IF(NANISO.EQ.2) PEQEL(5,I)=0.0D0
      IF(EN.LE.E(3)) GO TO 250
      IF(EN.GT.XENI(75)) GO TO 241
      DO 231 J=2,NIDATA
      IF(EN.LE.XENI(J)) GO TO 240
  231 CONTINUE
      J=NIDATA
  240 A=(YENC(J)-YENC(J-1))/(XENI(J)-XENI(J-1))
      B=(XENI(J-1)*YENC(J)-XENI(J)*YENC(J-1))/(XENI(J-1)-XENI(J))
      Q(5,I)=(A*EN+B)*1.0D-16
      GO TO 242
C USE BORN-BETHE X-SECTION ABOVE XENI(75) EV
  241 Q(5,I)=CONST*(AM2*X1+C*X2)
  242 CONTINUE
C USE ANISOTROPIC SCATTERING FOR PRIMARY IONISATION ELECTRON FOR
C ENERGIES ABOVE 2 * IONISATION ENERGY
C ANISOTROPIC ANGULAR DISTRIBUTION SAME AS ELASTIC AT ENERGY OFFSET BY
C IONISATION ENERGY
      IF(EN.LE.(2.0*E(3))) GO TO 250
      PEQEL(5,I)=PEQEL(2,(I-IOFF))
  250 CONTINUE
      Q(6,I)=0.0
C
      DO 251 NL=1,NIN
      QIN(NL,I)=0.0
      PEQIN(NL,I)=0.5D0
      IF(NANISO.EQ.2) THEN
       PEQIN(NL,I)=0.0D0
      ENDIF
  251 CONTINUE
C 1S5
      IF(EN.LE.EIN(1)) GO TO 413
      DO 310 J=2,N1S5
      IF(EN.LE.X1S5(J)) GO TO 311
  310 CONTINUE
      J=N1S5
  311 A=(Y1S5(J)-Y1S5(J-1))/(X1S5(J)-X1S5(J-1))
      B=(X1S5(J-1)*Y1S5(J)-X1S5(J)*Y1S5(J-1))/(X1S5(J-1)-X1S5(J))
      QIN(1,I)=(A*EN+B)*1.0D-18
      IF(EN.LE.(2.0*EIN(1))) GO TO 312
      PEQIN(1,I)=PEQEL(2,(I-IOFFN(1)))
C 1S4
  312 IF(EN.LE.EIN(2)) GO TO 413
      DO 313 J=2,N1S4
      IF(EN.LE.X1S4(J)) GO TO 314
  313 CONTINUE
      J=N1S4
  314 A=(Y1S4(J)-Y1S4(J-1))/(X1S4(J)-X1S4(J-1))
      B=(X1S4(J-1)*Y1S4(J)-X1S4(J)*Y1S4(J-1))/(X1S4(J-1)-X1S4(J))
      QIN(2,I)=(A*EN+B)*1.0D-18
      IF(EN.LE.(2.0*EIN(2))) GO TO 315
      PEQIN(2,I)=PEQEL(2,(I-IOFFN(2)))
C 1S3
  315 IF(EN.LE.EIN(3)) GO TO 413
      DO 316 J=2,N1S3
      IF(EN.LE.X1S3(J)) GO TO 317
  316 CONTINUE
      J=N1S3
  317 A=(Y1S3(J)-Y1S3(J-1))/(X1S3(J)-X1S3(J-1))
      B=(X1S3(J-1)*Y1S3(J)-X1S3(J)*Y1S3(J-1))/(X1S3(J-1)-X1S3(J))
      QIN(3,I)=(A*EN+B)*1.0D-18
      IF(EN.LE.(2.0*EIN(3))) GO TO 318
      PEQIN(3,I)=PEQEL(2,(I-IOFFN(3)))
C 1S2
  318 IF(EN.LE.EIN(4)) GO TO 413
      DO 319 J=2,N1S2
      IF(EN.LE.X1S2(J)) GO TO 320
  319 CONTINUE
      J=N1S2
  320 A=(Y1S2(J)-Y1S2(J-1))/(X1S2(J)-X1S2(J-1))
      B=(X1S2(J-1)*Y1S2(J)-X1S2(J)*Y1S2(J-1))/(X1S2(J-1)-X1S2(J))
      QIN(4,I)=(A*EN+B)*1.0D-18
      IF(EN.LE.(2.0*EIN(4))) GO TO 321
      PEQIN(4,I)=PEQEL(2,(I-IOFFN(4)))
C
C P STATES
C
C 2P10
  321 IF(EN.LE.EIN(5)) GO TO 413
      DO 322 J=2,N2P10
      IF(EN.LE.X2P10(J)) GO TO 323
  322 CONTINUE
      J=N2P10
  323 A=(Y2P10(J)-Y2P10(J-1))/(X2P10(J)-X2P10(J-1))
      B=(X2P10(J-1)*Y2P10(J)-X2P10(J)*Y2P10(J-1))/(X2P10(J-1)-X2P10(J))
      QIN(5,I)=(A*EN+B)*1.D-18
      IF(EN.LE.(2.0*EIN(5))) GO TO 324
      PEQIN(5,I)=PEQEL(2,(I-IOFFN(5)))
C 2P9
  324 IF(EN.LE.EIN(6)) GO TO 413
      DO 325 J=2,N2P9
      IF(EN.LE.X2P9(J)) GO TO 326
  325 CONTINUE
      J=N2P9
  326 A=(Y2P9(J)-Y2P9(J-1))/(X2P9(J)-X2P9(J-1))
      B=(X2P9(J-1)*Y2P9(J)-X2P9(J)*Y2P9(J-1))/(X2P9(J-1)-X2P9(J))
      QIN(6,I)=(A*EN+B)*1.D-18
      IF(EN.LE.(2.0*EIN(6))) GO TO 327
      PEQIN(6,I)=PEQEL(2,(I-IOFFN(6)))
C 2P8
  327 IF(EN.LE.EIN(7)) GO TO 413
      DO 328 J=2,N2P8
      IF(EN.LE.X2P8(J)) GO TO 329
  328 CONTINUE
      J=N2P8
  329 A=(Y2P8(J)-Y2P8(J-1))/(X2P8(J)-X2P8(J-1))
      B=(X2P8(J-1)*Y2P8(J)-X2P8(J)*Y2P8(J-1))/(X2P8(J-1)-X2P8(J))
      QIN(7,I)=(A*EN+B)*1.D-18
      IF(EN.LE.(2.0*EIN(7))) GO TO 330
      PEQIN(7,I)=PEQEL(2,(I-IOFFN(7)))
C 2P7
  330 IF(EN.LE.EIN(8)) GO TO 413
      DO 331 J=2,N2P7
      IF(EN.LE.X2P7(J)) GO TO 332
  331 CONTINUE
      J=N2P7
  332 A=(Y2P7(J)-Y2P7(J-1))/(X2P7(J)-X2P7(J-1))
      B=(X2P7(J-1)*Y2P7(J)-X2P7(J)*Y2P7(J-1))/(X2P7(J-1)-X2P7(J))
      QIN(8,I)=(A*EN+B)*1.D-18
      IF(EN.LE.(2.0*EIN(8))) GO TO 333
      PEQIN(8,I)=PEQEL(2,(I-IOFFN(8)))
C 2P6
  333 IF(EN.LE.EIN(9)) GO TO 413
      DO 334 J=2,N2P6
      IF(EN.LE.X2P6(J)) GO TO 335
  334 CONTINUE
      J=N2P6
  335 A=(Y2P6(J)-Y2P6(J-1))/(X2P6(J)-X2P6(J-1))
      B=(X2P6(J-1)*Y2P6(J)-X2P6(J)*Y2P6(J-1))/(X2P6(J-1)-X2P6(J))
      QIN(9,I)=(A*EN+B)*1.D-18
      IF(EN.LE.(2.0*EIN(9))) GO TO 336
      PEQIN(9,I)=PEQEL(2,(I-IOFFN(9)))
C 2P5
  336 IF(EN.LE.EIN(10)) GO TO 413
      DO 337 J=2,N2P5
      IF(EN.LE.X2P5(J)) GO TO 338
  337 CONTINUE
      J=N2P5
  338 A=(Y2P5(J)-Y2P5(J-1))/(X2P5(J)-X2P5(J-1))
      B=(X2P5(J-1)*Y2P5(J)-X2P5(J)*Y2P5(J-1))/(X2P5(J-1)-X2P5(J))
      QIN(10,I)=(A*EN+B)*1.D-18
      IF(EN.LE.(2.0*EIN(10))) GO TO 339
      PEQIN(10,I)=PEQEL(2,(I-IOFFN(10)))
C 2P4
  339 IF(EN.LE.EIN(11)) GO TO 413
      DO 340 J=2,N2P4
      IF(EN.LE.X2P4(J)) GO TO 341
  340 CONTINUE
      J=N2P4
  341 A=(Y2P4(J)-Y2P4(J-1))/(X2P4(J)-X2P4(J-1))
      B=(X2P4(J-1)*Y2P4(J)-X2P4(J)*Y2P4(J-1))/(X2P4(J-1)-X2P4(J))
      QIN(11,I)=(A*EN+B)*1.D-18
      IF(EN.LE.(2.0*EIN(11))) GO TO 342
      PEQIN(11,I)=PEQEL(2,(I-IOFFN(11)))
C 2P3
  342 IF(EN.LE.EIN(12)) GO TO 413
      DO 343 J=2,N2P3
      IF(EN.LE.X2P3(J)) GO TO 344
  343 CONTINUE
      J=N2P3
  344 A=(Y2P3(J)-Y2P3(J-1))/(X2P3(J)-X2P3(J-1))
      B=(X2P3(J-1)*Y2P3(J)-X2P3(J)*Y2P3(J-1))/(X2P3(J-1)-X2P3(J))
      QIN(12,I)=(A*EN+B)*1.D-18
      IF(EN.LE.(2.0*EIN(12))) GO TO 345
      PEQIN(12,I)=PEQEL(2,(I-IOFFN(12)))
C 2P2
  345 IF(EN.LE.EIN(13)) GO TO 413
      DO 346 J=2,N2P2
      IF(EN.LE.X2P2(J)) GO TO 347
  346 CONTINUE
      J=N2P2
  347 A=(Y2P2(J)-Y2P2(J-1))/(X2P2(J)-X2P2(J-1))
      B=(X2P2(J-1)*Y2P2(J)-X2P2(J)*Y2P2(J-1))/(X2P2(J-1)-X2P2(J))
      QIN(13,I)=(A*EN+B)*1.D-18
      IF(EN.LE.(2.0*EIN(13))) GO TO 348
      PEQIN(13,I)=PEQEL(2,(I-IOFFN(13)))
C 2P1
  348 IF(EN.LE.EIN(14)) GO TO 413
      DO 349 J=2,N2P1
      IF(EN.LE.X2P1(J)) GO TO 350
  349 CONTINUE
      J=N2P1
  350 A=(Y2P1(J)-Y2P1(J-1))/(X2P1(J)-X2P1(J-1))
      B=(X2P1(J-1)*Y2P1(J)-X2P1(J)*Y2P1(J-1))/(X2P1(J-1)-X2P1(J))
      QIN(14,I)=(A*EN+B)*1.D-18
      IF(EN.LE.(2.0*EIN(14))) GO TO 351
      PEQIN(14,I)=PEQEL(2,(I-IOFFN(14)))
C 3D6
  351 IF(EN.LE.EIN(15)) GO TO 413
      DO 352 J=2,N3D6
      IF(EN.LE.X3D6(J)) GO TO 353
  352 CONTINUE
      J=N3D6
  353 A=(Y3D6(J)-Y3D6(J-1))/(X3D6(J)-X3D6(J-1))
      B=(X3D6(J-1)*Y3D6(J)-X3D6(J)*Y3D6(J-1))/(X3D6(J-1)-X3D6(J))
      QIN(15,I)=(A*EN+B)*1.D-18
      IF(EN.LE.(2.0*EIN(15))) GO TO 354
      PEQIN(15,I)=PEQEL(2,(I-IOFFN(15)))
C 3D5
  354 IF(EN.LE.EIN(16)) GO TO 413
      DO 355 J=2,N3D5
      IF(EN.LE.X3D5(J)) GO TO 356
  355 CONTINUE
      J=N3D5
  356 A=(Y3D5(J)-Y3D5(J-1))/(X3D5(J)-X3D5(J-1))
      B=(X3D5(J-1)*Y3D5(J)-X3D5(J)*Y3D5(J-1))/(X3D5(J-1)-X3D5(J))
      QIN(16,I)=(A*EN+B)*1.D-18
      IF(EN.LE.(2.0*EIN(16))) GO TO 357
      PEQIN(16,I)=PEQEL(2,(I-IOFFN(16)))
C 3D3
  357 IF(EN.LE.EIN(17)) GO TO 413
      DO 358 J=2,N3D3
      IF(EN.LE.X3D3(J)) GO TO 359
  358 CONTINUE
      J=N3D3
  359 A=(Y3D3(J)-Y3D3(J-1))/(X3D3(J)-X3D3(J-1))
      B=(X3D3(J-1)*Y3D3(J)-X3D3(J)*Y3D3(J-1))/(X3D3(J-1)-X3D3(J))
      QIN(17,I)=(A*EN+B)*1.D-18
      IF(EN.LE.(2.0*EIN(17))) GO TO 360
      PEQIN(17,I)=PEQEL(2,(I-IOFFN(17)))
C 3D4'
  360 IF(EN.LE.EIN(18)) GO TO 413
      DO 361 J=2,N3D4P
      IF(EN.LE.X3D4P(J)) GO TO 362
  361 CONTINUE
      J=N3D4P
  362 A=(Y3D4P(J)-Y3D4P(J-1))/(X3D4P(J)-X3D4P(J-1))
      B=(X3D4P(J-1)*Y3D4P(J)-X3D4P(J)*Y3D4P(J-1))/(X3D4P(J-1)-X3D4P(J))
      QIN(18,I)=(A*EN+B)*1.D-18
      IF(EN.LE.(2.0*EIN(18))) GO TO 363
      PEQIN(18,I)=PEQEL(2,(I-IOFFN(18)))
C 3D4
  363 IF(EN.LE.EIN(19)) GO TO 413
      DO 364 J=2,N3D4
      IF(EN.LE.X3D4(J)) GO TO 365
  364 CONTINUE
      J=N3D4
  365 A=(Y3D4(J)-Y3D4(J-1))/(X3D4(J)-X3D4(J-1))
      B=(X3D4(J-1)*Y3D4(J)-X3D4(J)*Y3D4(J-1))/(X3D4(J-1)-X3D4(J))
      QIN(19,I)=(A*EN+B)*1.D-18
      IF(EN.LE.(2.0*EIN(19))) GO TO 366
      PEQIN(19,I)=PEQEL(2,(I-IOFFN(19)))
C 3D1''
  366 IF(EN.LE.EIN(20)) GO TO 413
      DO 367 J=2,N3D1PP
      IF(EN.LE.X3D1PP(J)) GO TO 368
  367 CONTINUE
      J=N3D1PP
  368 A=(Y3D1PP(J)-Y3D1PP(J-1))/(X3D1PP(J)-X3D1PP(J-1))
      B=(X3D1PP(J-1)*Y3D1PP(J)-X3D1PP(J)*Y3D1PP(J-1))/(X3D1PP(J-1)-
     /X3D1PP(J))
      QIN(20,I)=(A*EN+B)*1.D-18
      IF(EN.LE.(2.0*EIN(20))) GO TO 369
      PEQIN(20,I)=PEQEL(2,(I-IOFFN(20)))
C 2S5
  369 IF(EN.LE.EIN(21)) GO TO 413
      DO 370 J=2,N2S5
      IF(EN.LE.X2S5(J)) GO TO 371
  370 CONTINUE
      J=N2S5
  371 A=(Y2S5(J)-Y2S5(J-1))/(X2S5(J)-X2S5(J-1))
      B=(X2S5(J-1)*Y2S5(J)-X2S5(J)*Y2S5(J-1))/(X2S5(J-1)-X2S5(J))
      QIN(21,I)=(A*EN+B)*1.D-18
      IF(EN.LE.(2.0*EIN(21))) GO TO 372
      PEQIN(21,I)=PEQEL(2,(I-IOFFN(21)))
C 2S4 F=0.0257
  372 IF(EN.LE.EIN(22)) GO TO 413
      QIN(22,I)=0.0257/(EIN(22)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0*
     /EIN(22)))-BETA2)*BBCONST*(1.0-(4.0*EIN(22)/(EMASS2*BETA2)))
      IF(EN.LE.(2.0*EIN(22))) GO TO 375
      PEQIN(22,I)=PEQEL(2,(I-IOFFN(22)))
C 3D1'
  375 IF(EN.LE.EIN(23)) GO TO 413
      DO 376 J=2,N3D1P
      IF(EN.LE.X3D1P(J)) GO TO 377
  376 CONTINUE
      J=N3D1P
  377 A=(Y3D1P(J)-Y3D1P(J-1))/(X3D1P(J)-X3D1P(J-1))
      B=(X3D1P(J-1)*Y3D1P(J)-X3D1P(J)*Y3D1P(J-1))/(X3D1P(J-1)-X3D1P(J))
      QIN(23,I)=(A*EN+B)*1.D-18
      IF(EN.LE.(2.0*EIN(23))) GO TO 378
      PEQIN(23,I)=PEQEL(2,(I-IOFFN(23)))
C 3D2  F=0.074
  378 IF(EN.LE.EIN(24)) GO TO 413
      QIN(24,I)=0.0740/(EIN(24)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0*
     /EIN(24)))-BETA2)*BBCONST*(1.0-(4.0*EIN(24)/(EMASS2*BETA2)))
      IF(EN.LE.(2.0*EIN(24))) GO TO 381
      PEQIN(24,I)=PEQEL(2,(I-IOFFN(24)))
C 3S1''''
  381 IF(EN.LE.EIN(25)) GO TO 413
      DO 382 J=2,N3S1PPPP
      IF(EN.LE.X3S1PPPP(J)) GO TO 383
  382 CONTINUE
      J=N3S1PPPP
  383 A=(Y3S1PPPP(J)-Y3S1PPPP(J-1))/(X3S1PPPP(J)-X3S1PPPP(J-1))
      B=(X3S1PPPP(J-1)*Y3S1PPPP(J)-X3S1PPPP(J)*Y3S1PPPP(J-1))/
     /(X3S1PPPP(J-1)-X3S1PPPP(J))
      QIN(25,I)=(A*EN+B)*1.D-18
      IF(EN.LE.(2.0*EIN(25))) GO TO 384
      PEQIN(25,I)=PEQEL(2,(I-IOFFN(25)))
C 3S1''
  384 IF(EN.LE.EIN(26)) GO TO 413
      DO 385 J=2,N3S1PP
      IF(EN.LE.X3S1PP(J)) GO TO 386
  385 CONTINUE
      J=N3S1PP
  386 A=(Y3S1PP(J)-Y3S1PP(J-1))/(X3S1PP(J)-X3S1PP(J-1))
      B=(X3S1PP(J-1)*Y3S1PP(J)-X3S1PP(J)*Y3S1PP(J-1))/(X3S1PP(J-1)-
     /X3S1PP(J))
      QIN(26,I)=(A*EN+B)*1.D-18
      IF(EN.LE.(2.0*EIN(26))) GO TO 387
      PEQIN(26,I)=PEQEL(2,(I-IOFFN(26)))
C 3S1'''
  387 IF(EN.LE.EIN(27)) GO TO 413
      DO 388 J=2,N3S1PPP
      IF(EN.LE.X3S1PPP(J)) GO TO 389
  388 CONTINUE
      J=N3S1PPP
  389 A=(Y3S1PPP(J)-Y3S1PPP(J-1))/(X3S1PPP(J)-X3S1PPP(J-1))
      B=(X3S1PPP(J-1)*Y3S1PPP(J)-X3S1PPP(J)*Y3S1PPP(J-1))/
     /(X3S1PPP(J-1)-X3S1PPP(J))
      QIN(27,I)=(A*EN+B)*1.D-18
      IF(EN.LE.(2.0*EIN(27))) GO TO 390
      PEQIN(27,I)=PEQEL(2,(I-IOFFN(27)))
C 2S3
  390 IF(EN.LE.EIN(28)) GO TO 413
      DO 391 J=2,N2S3
      IF(EN.LE.X2S3(J)) GO TO 392
  391 CONTINUE
      J=N2S3
  392 A=(Y2S3(J)-Y2S3(J-1))/(X2S3(J)-X2S3(J-1))
      B=(X2S3(J-1)*Y2S3(J)-X2S3(J)*Y2S3(J-1))/(X2S3(J-1)-X2S3(J))
      QIN(28,I)=(A*EN+B)*1.D-18
      IF(EN.LE.(2.0*EIN(28))) GO TO 393
      PEQIN(28,I)=PEQEL(2,(I-IOFFN(28)))
C 2S2  F=0.011
  393 IF(EN.LE.EIN(29)) GO TO 413
      QIN(29,I)=0.0110/(EIN(29)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0*
     /EIN(29)))-BETA2)*BBCONST*(1.0-(4.0*EIN(29)/(EMASS2*BETA2)))
      IF(EN.LE.(2.0*EIN(29))) GO TO 396
      PEQIN(29,I)=PEQEL(2,(I-IOFFN(29)))
C 3S1' F=0.092
  396 IF(EN.LE.EIN(30)) GO TO 413
      QIN(30,I)=0.0920/(EIN(30)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0*
     /EIN(30)))-BETA2)*BBCONST*(1.0-(4.0*EIN(30)/(EMASS2*BETA2)))
      IF(EN.LE.(2.0*EIN(30))) GO TO 399
      PEQIN(30,I)=PEQEL(2,(I-IOFFN(30)))
C 4D5 F=0.0019
  399 IF(EN.LE.EIN(31)) GO TO 413
      QIN(31,I)=0.0019/(EIN(31)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0*
     /EIN(31)))-BETA2)*BBCONST*(1.0-(4.0*EIN(31)/(EMASS2*BETA2)))
      IF(EN.LE.(2.0*EIN(31))) GO TO 400
      PEQIN(31,I)=PEQEL(2,(I-IOFFN(31)))
C 3S4 F=0.0144
  400 IF(EN.LE.EIN(32)) GO TO 413
      QIN(32,I)=0.0144/(EIN(32)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0*
     /EIN(32)))-BETA2)*BBCONST*(1.0-(4.0*EIN(32)/(EMASS2*BETA2)))
      IF(EN.LE.(2.0*EIN(32))) GO TO 401
      PEQIN(32,I)=PEQEL(2,(I-IOFFN(32)))
C 4D2 F=0.0484
  401 IF(EN.LE.EIN(33)) GO TO 413
      QIN(33,I)=0.0484/(EIN(33)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0*
     /EIN(33)))-BETA2)*BBCONST*(1.0-(4.0*EIN(33)/(EMASS2*BETA2)))
      IF(EN.LE.(2.0*EIN(33))) GO TO 402
      PEQIN(33,I)=PEQEL(2,(I-IOFFN(33)))
C 4S1' F=0.0209
  402 IF(EN.LE.EIN(34)) GO TO 413
      QIN(34,I)=0.0209/(EIN(34)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0*
     /EIN(34)))-BETA2)*BBCONST*(1.0-(4.0*EIN(34)/(EMASS2*BETA2)))
      IF(EN.LE.(2.0*EIN(34))) GO TO 403
      PEQIN(34,I)=PEQEL(2,(I-IOFFN(34)))
C 3S2  F=0.0220
  403 IF(EN.LE.EIN(35)) GO TO 413
      QIN(35,I)=0.0220/(EIN(35)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0*
     /EIN(35)))-BETA2)*BBCONST*(1.0-(4.0*EIN(35)/(EMASS2*BETA2)))
      IF(EN.LE.(2.0*EIN(35))) GO TO 404
      PEQIN(35,I)=PEQEL(2,(I-IOFFN(35)))
C 5D5  F=0.0041
  404 IF(EN.LE.EIN(36)) GO TO 413
      QIN(36,I)=0.0041/(EIN(36)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0*
     /EIN(36)))-BETA2)*BBCONST*(1.0-(4.0*EIN(36)/(EMASS2*BETA2)))
      IF(EN.LE.(2.0*EIN(36))) GO TO 405
      PEQIN(36,I)=PEQEL(2,(I-IOFFN(36)))
C 4S4  F=0.0426
  405 IF(EN.LE.EIN(37)) GO TO 413
      QIN(37,I)=0.0426/(EIN(37)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0*
     /EIN(37)))-BETA2)*BBCONST*(1.0-(4.0*EIN(37)/(EMASS2*BETA2)))
      IF(EN.LE.(2.0*EIN(37))) GO TO 406
      PEQIN(37,I)=PEQEL(2,(I-IOFFN(37)))
C 5D2  F=0.0426
  406 IF(EN.LE.EIN(38)) GO TO 413
      QIN(38,I)=0.0426/(EIN(38)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0*
     /EIN(38)))-BETA2)*BBCONST*(1.0-(4.0*EIN(38)/(EMASS2*BETA2)))
      IF(EN.LE.(2.0*EIN(38))) GO TO 407
      PEQIN(38,I)=PEQEL(2,(I-IOFFN(38)))
C 6D5  F=0.00075
  407 IF(EN.LE.EIN(39)) GO TO 413
      QIN(39,I)=.00075/(EIN(39)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0*
     /EIN(39)))-BETA2)*BBCONST*(1.0-(4.0*EIN(39)/(EMASS2*BETA2)))
      IF(EN.LE.(2.0*EIN(39))) GO TO 408
      PEQIN(39,I)=PEQEL(2,(I-IOFFN(39)))
C 5S1' F=0.00051
  408 IF(EN.LE.EIN(40)) GO TO 413
      QIN(40,I)=.00051/(EIN(40)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0*
     /EIN(40)))-BETA2)*BBCONST*(1.0-(4.0*EIN(40)/(EMASS2*BETA2)))
      IF(EN.LE.(2.0*EIN(40))) GO TO 409
      PEQIN(40,I)=PEQEL(2,(I-IOFFN(40)))
C 4S2  F=0.00074
  409 IF(EN.LE.EIN(41)) GO TO 413
      QIN(41,I)=.00074/(EIN(41)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0*
     /EIN(41)))-BETA2)*BBCONST*(1.0-(4.0*EIN(41)/(EMASS2*BETA2)))
      IF(EN.LE.(2.0*EIN(41))) GO TO 410
      PEQIN(41,I)=PEQEL(2,(I-IOFFN(41)))
C 5S4  F=0.0130
  410 IF(EN.LE.EIN(42)) GO TO 413
      QIN(42,I)=0.0130/(EIN(42)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0*
     /EIN(42)))-BETA2)*BBCONST*(1.0-(4.0*EIN(42)/(EMASS2*BETA2)))
      IF(EN.LE.(2.0*EIN(42))) GO TO 411
      PEQIN(42,I)=PEQEL(2,(I-IOFFN(42)))
C 6D2  F=0.0290
  411 IF(EN.LE.EIN(43)) GO TO 413
      QIN(43,I)=0.0290/(EIN(43)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0*
     /EIN(43)))-BETA2)*BBCONST*(1.0-(4.0*EIN(43)/(EMASS2*BETA2)))
      IF(EN.LE.(2.0*EIN(43))) GO TO 412
      PEQIN(43,I)=PEQEL(2,(I-IOFFN(43)))
C SUM HIGHER J=1 STATES F=0.1359
  412 IF(EN.LE.EIN(44)) GO TO 413
      QIN(44,I)=0.1359/(EIN(44)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0*
     /EIN(44)))-BETA2)*BBCONST*(1.0-(4.0*EIN(44)/(EMASS2*BETA2)))
      IF(EN.LE.(2.0*EIN(44))) GO TO 413
      PEQIN(44,I)=PEQEL(2,(I-IOFFN(44)))
  413 CONTINUE
C
      Q1SSUM=QIN(1,I)+QIN(2,I)+QIN(3,I)+QIN(4,I)
      QPSSUM=QIN(5,I)+QIN(6,I)+QIN(7,I)+QIN(8,I)+QIN(9,I)+QIN(10,I)+
     /QIN(11,I)+QIN(12,I)+QIN(13,I)+QIN(14,I)
      QDSSUM=QIN(17,I)+QIN(18,I)+QIN(19,I)+QIN(20,I)+QIN(21,I)+QIN(22,I)
     /+QIN(23,I)+QIN(24,I)+QIN(25,I)+QIN(26,I)+QIN(27,I)+QIN(28,I)+
     /QIN(29,I)+QIN(30,I)+QIN(31,I)+QIN(32,I)+QIN(33,I)+QIN(34,I)+
     /QIN(35,I)+QIN(36,I)+QIN(37,I)+QIN(38,I)+QIN(39,I)+QIN(40,I)+
     /QIN(41,I)+QIN(42,I)+QIN(43,I)+QIN(44,I)+QIN(15,I)+QIN(16,I)
      TOTSUM=Q1SSUM+QPSSUM+QDSSUM
C     WRITE(6,997) EN,QIN(1,I),QIN(2,I),QIN(3,I),QIN(4,I),Q1SSUM,QPSSUM,
C    /,QDSSUM,TOTSUM
C 997 FORMAT(' EN =',D12.3,' Q1S5 =',D12.3,' Q1S4 =',D12.3,' Q1S3 =',
C    /D12.3,' Q1S2 =',D12.3,/,' S1 =',D12.3,' P2=',D12.3,' D3 =',D12.3,
C    /' QTOT=',D12.3)
C  TOTAL X-SECTION
      Q(1,I)=QELA+Q(5,I)+Q1SSUM+QPSSUM+QDSSUM
  900 CONTINUE
C SAVE COMPUTE TIME
      DO 910 K=1,NIN
      IF(EFINAL.LE.EIN(K)) THEN
       NIN=K-1
       GO TO 911
      ENDIF
  910 CONTINUE
  911 CONTINUE
C
      RETURN
      END
      SUBROUTINE GAS3(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      DIMENSION XEN(99),YEM(99),YEL(99),YEPS(99),
     /XION(51),YION(51),YINC(51),XEXC(30),YEXC(30),XEXS(30),YEXS(30)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
C ELASTIC
      DATA XEN/0.00,.008,.009,0.01,.013,.017,.020,.025,0.03,0.04,
     /0.05,0.06,0.07,0.08,0.09,0.10,0.12,0.15,0.18,0.20,
     /0.25,0.30,0.40,0.50,0.60,0.70,0.80,0.90,1.00,1.20,
     /1.50,1.80,2.00,2.50,3.00,4.00,5.00,6.00,7.00,8.00,
     /9.00,10.0,11.0,12.0,14.0,16.0,18.0,20.0,25.0,30.0,
     /40.0,50.0,60.0,70.0,80.0,90.0,100.,125.,150.,200.,
     /250.,300.,400.,500.,600.,800.,1000.,1500.,2000.,3000.,
     /4000.,6000.,8000.,10000.,1.25D4,1.5D4,2.0D4,2.5D4,3.0D4,4.0D4,
     /6.0D4,8.0D4,1.0D5,1.25D5,1.50D5,2.0D5,2.5D5,3.0D5,4.0D5,6.0D5,
     /8.0D5,1.0D6,1.5D6,2.0D6,3.0D6,4.0D6,6.0D6,8.0D6,1.0D7/
C ELASTIC MOMENTUM TRANSFER
      DATA YEM/4.89,5.18,5.19,5.21,5.26,5.31,5.35,5.41,5.46,5.54,
     /5.62,5.68,5.74,5.79,5.83,5.86,5.94,6.04,6.12,6.16,
     /6.27,6.35,6.49,6.59,6.66,6.73,6.77,6.82,6.85,6.91,
     /6.96,6.98,6.99,6.96,6.89,6.62,6.31,6.00,5.68,5.35,
     /5.03,4.72,4.45,4.20,3.68,3.28,2.95,2.64,2.03,1.61,
     /1.06,0.77,0.57,0.46,0.37,0.30,0.26,.179,.132,.0807,
     /.0549,.0400,.0242,.0164,.0119,.00716,.00482,.00234,.0014,.000676,
     /4.03D-4,1.93D-4,1.15D-4,7.65D-5,5.10D-5,3.66D-5,2.17D-5,1.45D-5,
     /1.04D-5,6.18D-6,
     /2.99D-6,1.71D-6,1.21D-6,8.26D-7,6.05D-7,3.73D-7,2.58D-7,1.92D-7,
     /1.22D-7,6.48D-8,
     /4.17D-8,2.96D-8,1.58D-8,1.01D-8,5.24D-9,3.25D-9,1.63D-9,9.89D-10,
     /6.67D-10/
C ELASTIC TOTAL
      DATA YEL/4.89,5.19,5.20,5.21,5.26,5.29,5.33,5.37,5.41,5.47,
     /5.53,5.58,5.62,5.66,5.69,5.70,5.76,5.83,5.88,5.90,
     /5.96,6.01,6.08,6.12,6.14,6.16,6.16,6.17,6.16,6.16,
     /6.14,6.11,6.09,6.01,5.90,5.60,5.36,5.10,4.91,4.70,
     /4.51,4.32,4.21,4.10,3.75,3.49,3.27,3.03,2.56,2.13,
     /1.61,1.27,1.06,.884,.736,.668,.588,.460,.355,.244,
     /.194,.150,.117,.087,.071,.052,.041,.028,.022,.014,
     /.0108,.00722,.00544,.00437,.00352,.00295,.00224,.00182,.00154,
     /.00118,
     /.000830,.000654,.000550,.000466,.000411,.000342,.000301,.000274,
     /.000241,.000209,
     /.000195,.000186,.000177,.000172,.000169,.000167,.000166,.000166,
     /.000166/
C ANGULAR DISTRIBUTION PARAMETER EPSILON
      DATA YEPS/0.0,.00289,.00288,0.0,0.0,-.00562,-.00565,-.01118,
     /-.01386,-.01920,
     /-.02440,-.02688,-.03202,-.03445,-.03689,-.04209,-.04686,-.05400,
     /-.06119,-.06604,
     /-.07792,-.08474,-.10094,-.11490,-.12663,-.13826,-.14789,-.15724,
     /-.16707,-.18142,
     /-.19873,-.21165,-.21951,-.23447,-.24855,-.26918,-.26215,-.26104,
     /-.23265,-.20568,
     /-.17192,-.13835,-.08559,-.03703,0.02838,0.09142,0.14469,0.19052,
     /0.30369,0.35818,
     /0.48666,0.55167,0.63175,0.65099,0.67007,0.72517,0.73196,0.78150,
     /0.79668,0.83079,
     /0.86696,0.87845,0.91682,0.92737,0.93870,0.95363,0.96280,0.97662,
     /.983705,.988614,
     /.991805,.994606,.995963,.996795,.997452,.997887,.998428,.998754,
     /.998956,.999239,
     /.9995075,.9996596,.9997208,.9997819,.9998234,.9998743,.9999042,
     /.9999236,.9999469,.9999692,
     /.9999796,.9999853,.9999922,.9999951,.9999975,.9999985,.9999993,
     /.9999996,.9999997/
C  IONISATION (VALUES ABOVE 20KEV GENERATED BY BORN-BETHE IN SUB)
      DATA XION/24.587,25.0,25.5,26.0,26.5,27.0,28.0,29.0,30.0,32.0,
     /34.0,36.0,38.0,40.0,45.0,50.0,55.0,60.0,70.0,80.0,
     /100.,120.,150.,175.,200.,250.,300.,400.,500.,600.,
     /700.,800.,900.,1000.,1200.,1400.,1600.,1800.,2000.,2500.,
     /3000.,4000.,5000.,6000.,8000.,10000.,12000.,14000.,16000.,18000.,
     /20000./
C GROSS IONISATION
      DATA YION/.0,.0048,.0105,.0161,.0217,.0279,.0391,.0509,.0621,.085,
     /.105,.125,.143,.158,.195,.227,.250,.272,.302,.323,
     /.348,.356,.351,.340,.328,.304,.281,.240,.210,.186,
     /.168,.151,.139,.126,.109,.0964,.0871,.0795,.0729,.0608,
     /.0523,.0410,.0336,.0293,.0229,.0192,.0164,.0147,.0130,.0119,
     /.0108/
C COUNTING IONISATION
      DATA YINC/.0,.0048,.0105,.0161,.0217,.0279,.0391,.0509,.0621,.085,
     /.105,.125,.143,.158,.195,.227,.250,.272,.302,.323,
     /.348,.355,.350,.339,.327,.302,.279,.239,.209,.185,
     /.167,.150,.138,.125,.108,.0959,.0867,.0791,.0725,.0605,
     /.0520,.0408,.0334,.0292,.0228,.0191,.0163,.0146,.0129,.0118,
     /.0107/
C TRIPLET EXCITATION
      DATA XEXC/19.82,20.0,20.2,20.5,20.6,20.8,21.0,21.3,22.0,25.0,
     /30.0,40.0,50.0,60.0,70.0,80.0,90.0,100.,150.,200.,
     /400.,1000.,2000.,10000.,20000.,100000.,2.0D5,1.0D6,2.0D6,1.0D7/
      DATA YEXC/0.00,.047,.053,.035,.029,.043,.042,.041,.046,.075,
     /.071,.054,.038,.026,.017,.013,.0094,.0075,.0022,.00094,
     /1.2D-4,8.D-6,1.D-6,8.D-9,1.D-9,8.D-12,1.D-12,8.D-15,1.D-15,8.D-18/
C  SINGLET EXCITATION
      DATA XEXS/20.61,20.9,21.0,21.5,22.0,22.5,25.0,28.0,30.0,35.0,
     /40.0,45.0,50.0,60.0,70.0,80.0,90.0,100.,150.,200.,
     /300.,400.,500.,600.,800.,1000.,1500.,2000.,3000.,4000./
      DATA YEXS/0.00,.025,.022,.0265,.0315,.036,.065,.082,.092,.115,
     /.133,.148,.155,.175,.177,.178,.178,.177,.163,.148,
     /.121,.099,.086,.075,.061,.051,.038,.030,.022,.0173/
C --------------------------------------------------------------------
      IF(NANISO.EQ.0) THEN
       NAME='HE4 (ISOT) 2007'
      ELSE
       NAME='HE4 (ANIS) 2007'
      ENDIF
C --------------------------------------------------------------------
C  HELIUM 4 BEST KNOWN GAS USED AS STANDARD ACCURACY BETTER THAN 0.2%
C  AT ALL FIELDS.
C  2002: UPDATED 1997 DATA TO INCLUDE ANISOTROPIC ELASTIC SCATTTERING
C  2007: INCREASED DATA FILE UP TO 10 MEV
C  2007: NEW ANISTROPIC SCATTERING FUNCTION INTRODUCED
C  2007: PENNING FRACTION INTRODUCED
C --------------------------------------------------------------------
C
C BORN-BETHE VALUES FOR IONISATION
      CONST=1.873884D-20
      EMASS2=1021997.804
      AM2=0.489
      C=5.50
C SINGLET EXCITATION
      AM2EXS=0.261
      CEXS=2.52
C
      NIN=2
      DO 1 J=1,6
    1 KEL(J)=NANISO
      DO 2 J=1,NIN
    2 KIN(J)=NANISO
      NDATA=99
      NION=51
      NEXC=30
      NEXS=30
      E(1)=0.0
      E(2)=2.0*EMASS/(4.00260*AMU)
      E(3)=24.587
C ENTER EXCITATION X-SECTION AT 1.5MEV
      E(4)=0.595D-19
C ENTER IONISING X-SECTION AT 1.5MEV
      E(5)=0.1272D-18
C ENTER EOBY FOR MINIMUM IONISING PARTICLE
      E(6)=10.6
C EOBY AT LOW ENERGY
      EOBY=15.8
      IOFF=IFIX(SNGL(0.5+E(3)/ESTEP))
      EIN(1)=19.82
      EIN(2)=20.61
C***********************************************************
C ENTER PENNING FRACTION FOR EACH LEVEL
C PENNING FRACTION BETWEEN 0.9 AND 1.0 FOR ALL MIXTURES
      PENFRA(1,1)=1.0
      PENFRA(1,2)=1.0
C  PENNING TRANSFER DISTANCE MICRONS
      PENFRA(2,1)=1.00
      PENFRA(2,2)=1.00
C PENNING TRANSFER TIME PICOSECONDS
      PENFRA(3,1)=1.0
      PENFRA(3,2)=1.0
C***********************************************************
      IF(IPEN.EQ.0) GO TO 4
      DO 3 KDUM=1,NIN
      IF(PENFRA(1,KDUM).EQ.0.0) GO TO 3
      WRITE(6,999) NAME,EIN(KDUM),PENFRA(1,KDUM),PENFRA(2,KDUM),
     /PENFRA(3,KDUM)
  999 FORMAT(' GAS = ',A15,' ENERGY LEVEL = ',F7.4,' EV.',/,' PENNING PR
     /OBABILITY =',F5.3,' ABS.LENGTH =',F7.2,' DECAY TIME =',F7.1,/)
    3 CONTINUE
    4 IOFF1=IFIX(SNGL(0.5+EIN(1)/ESTEP))
      IOFF2=IFIX(SNGL(0.5+EIN(2)/ESTEP))
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC ANISOTROPIC HELIUM 4 '
      IF(NANISO.EQ.0) THEN
       SCRPT(2)=' ELASTIC ISOTROPIC HELIUM 4   '
      ENDIF
      SCRPT(3)=' IONISATION    ELOSS= 24.587  '
      SCRPT(4)='                              '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' EXC TRPLT     ELOSS= 19.82   '
      SCRPT(8)=' EXC SNGLT     ELOSS= 20.61   '
      EN=-ESTEP/2.0D0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      DO 10 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 20
   10 CONTINUE
      J=NDATA
   20 A=(YEL(J)-YEL(J-1))/(XEN(J)-XEN(J-1))
      B=(XEN(J-1)*YEL(J)-XEN(J)*YEL(J-1))/(XEN(J-1)-XEN(J))
      QELA=(A*EN+B)*1.0D-16
C
      A=(YEM(J)-YEM(J-1))/(XEN(J)-XEN(J-1))
      B=(XEN(J-1)*YEM(J)-XEN(J)*YEM(J-1))/(XEN(J-1)-XEN(J))
      QMOM=(A*EN+B)*1.0D-16
      PQ1=0.5+(QELA-QMOM)/QELA
C
      A=(YEPS(J)-YEPS(J-1))/(XEN(J)-XEN(J-1))
      B=(XEN(J-1)*YEPS(J)-XEN(J)*YEPS(J-1))/(XEN(J-1)-XEN(J))
      PQ2=A*EN+B
C
      IF(NANISO.EQ.1) PEQEL(2,I)=PQ1
      IF(NANISO.EQ.2) PEQEL(2,I)=PQ2
      Q(2,I)=QELA
      IF(NANISO.EQ.0) THEN
       Q(2,I)=QMOM
       PEQEL(2,I)=0.5
      ENDIF
C GROSS IONISATION
      Q(3,I)=0.0D0
      PEQEL(3,I)=0.5D0
      IF(NANISO.EQ.2) PEQEL(3,I)=0.0D0
      IF(EN.LE.E(3)) GO TO 200
      IF(EN.GT.XION(NION)) GO TO 121
      DO 110 J=2,NION
      IF(EN.LE.XION(J)) GO TO 120
  110 CONTINUE
      J=NION
  120 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
      GO TO 122
C USE BORN-BETHE X-SECTION ABOVE XION(NION) EV
  121 GAMMA=(EMASS2+2.0D0*EN)/EMASS2
      BETA=DSQRT(1.0D0-1.0D0/(GAMMA*GAMMA))
      BETA2=BETA*BETA
      AX2=1.0D0/BETA2
      AX1=AX2*DLOG(BETA2/(1.0D0-BETA2))-1.0D0
      Q(3,I)=CONST*(AM2*AX1+C*AX2)/0.995
  122 CONTINUE
C USE ANISOTROPIC SCATTERING FOR PRIMARY IONISATION ELECTRON FOR
C ENERGIES ABOVE 2 * IONISATION ENERGY
C ANISOTROPIC ANGULAR DISTRIBUTION SAME AS ELASTIC AT ENERGY OFFSET BY
C IONISATION ENERGY
      IF(EN.LE.(2.0*E(3))) GO TO 200
      PEQEL(3,I)=PEQEL(2,(I-IOFF))
C ATTACHMENT
  200 Q(4,I)=0.0D0
C COUNTING IONISATION
      Q(5,I)=0.0D0
      PEQEL(5,I)=0.5D0
      IF(NANISO.EQ.2) PEQEL(5,I)=0.0D0
      IF(EN.LE.E(3)) GO TO 250
      IF(EN.GT.XION(NION)) GO TO 241
      DO 230 J=2,NION
      IF(EN.LE.XION(J)) GO TO 240
  230 CONTINUE
      J=NION
  240 A=(YINC(J)-YINC(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YINC(J)-XION(J)*YINC(J-1))/(XION(J-1)-XION(J))
      Q(5,I)=(A*EN+B)*1.0D-16
      GO TO 242
C USE BORN-BETHE X-SECTION ABOVE XION(NION) EV
  241 Q(5,I)=CONST*(AM2*AX1+C*AX2)
  242 CONTINUE
      IF(EN.LE.(2.0D0*E(3))) GO TO 250
      PEQEL(5,I)=PEQEL(2,(I-IOFF))
  250 Q(6,I)=0.0D0
C
      QIN(1,I)=0.0D0
      PEQIN(1,I)=0.5D0
      IF(NANISO.EQ.2) PEQIN(1,I)=0.0D0
      IF(EN.LE.EIN(1)) GO TO 600
      DO 510 J=2,NEXC
      IF(EN.LE.XEXC(J)) GO TO 520
  510 CONTINUE
      J=NEXC
  520 A=(YEXC(J)-YEXC(J-1))/(XEXC(J)-XEXC(J-1))
      B=(XEXC(J-1)*YEXC(J)-XEXC(J)*YEXC(J-1))/(XEXC(J-1)-XEXC(J))
      QIN(1,I)=(A*EN+B)*1.D-16
      IF(EN.LE.(2.0*EIN(1))) GO TO 600
      PEQIN(1,I)=PEQEL(2,(I-IOFF1))
  600 CONTINUE
C
      QIN(2,I)=0.0D0
      PEQIN(2,I)=0.5D0
      IF(NANISO.EQ.2) PEQIN(2,I)=0.0D0
      IF(EN.LE.EIN(2)) GO TO 700
      IF(EN.GT.XEXS(NEXS)) GO TO 630
      DO 610 J=2,NEXS
      IF(EN.LE.XEXS(J)) GO TO 620
  610 CONTINUE
      J=NEXS
  620 A=(YEXS(J)-YEXS(J-1))/(XEXS(J)-XEXS(J-1))
      B=(XEXS(J-1)*YEXS(J)-XEXS(J)*YEXS(J-1))/(XEXS(J-1)-XEXS(J))
      QIN(2,I)=(A*EN+B)*1.D-16
      GO TO 660
C USE BORN BETHE ABOVE XEXS(NEXS) EV
  630 QIN(2,I)=CONST*(AM2EXS*AX1+CEXS*AX2)
  660 IF(EN.LE.(2.0*EIN(2))) GO TO 700
      PEQIN(2,I)=PEQEL(2,(I-IOFF2))
  700 CONTINUE
C
      Q(1,I)=QELA+Q(5,I)+QIN(1,I)+QIN(2,I)
  900 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(2)) NIN=1
      IF(EFINAL.LE.EIN(1)) NIN=0
C
      RETURN
      END
      SUBROUTINE GAS4(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      DIMENSION XEN(99),YEM(99),YEL(99),YEPS(99),
     /XION(51),YION(51),YINC(51),XEXC(30),YEXC(30),XEXS(30),YEXS(30)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
C ELASTIC
      DATA XEN/0.00,.008,.009,0.01,.013,.017,.020,.025,0.03,0.04,
     /0.05,0.06,0.07,0.08,0.09,0.10,0.12,0.15,0.18,0.20,
     /0.25,0.30,0.40,0.50,0.60,0.70,0.80,0.90,1.00,1.20,
     /1.50,1.80,2.00,2.50,3.00,4.00,5.00,6.00,7.00,8.00,
     /9.00,10.0,11.0,12.0,14.0,16.0,18.0,20.0,25.0,30.0,
     /40.0,50.0,60.0,70.0,80.0,90.0,100.,125.,150.,200.,
     /250.,300.,400.,500.,600.,800.,1000.,1500.,2000.,3000.,
     /4000.,6000.,8000.,10000.,1.25D4,1.5D4,2.0D4,2.5D4,3.0D4,4.0D4,
     /6.0D4,8.0D4,1.0D5,1.25D5,1.50D5,2.0D5,2.5D5,3.0D5,4.0D5,6.0D5,
     /8.0D5,1.0D6,1.5D6,2.0D6,3.0D6,4.0D6,6.0D6,8.0D6,1.0D7/
C ELASTIC MOMENTUM TRANSFER
      DATA YEM/4.89,5.18,5.19,5.21,5.26,5.31,5.35,5.41,5.46,5.54,
     /5.62,5.68,5.74,5.79,5.83,5.86,5.94,6.04,6.12,6.16,
     /6.27,6.35,6.49,6.59,6.66,6.73,6.77,6.82,6.85,6.91,
     /6.96,6.98,6.99,6.96,6.89,6.62,6.31,6.00,5.68,5.35,
     /5.03,4.72,4.45,4.20,3.68,3.28,2.95,2.64,2.03,1.61,
     /1.06,0.77,0.57,0.46,0.37,0.30,0.26,.179,.132,.0807,
     /.0549,.0400,.0242,.0164,.0119,.00716,.00482,.00234,.0014,.000676,
     /4.03D-4,1.93D-4,1.15D-4,7.65D-5,5.10D-5,3.66D-5,2.17D-5,1.45D-5,
     /1.04D-5,6.18D-6,
     /2.99D-6,1.71D-6,1.21D-6,8.26D-7,6.05D-7,3.73D-7,2.58D-7,1.92D-7,
     /1.22D-7,6.48D-8,
     /4.17D-8,2.96D-8,1.58D-8,1.01D-8,5.24D-9,3.25D-9,1.63D-9,9.89D-10,
     /6.67D-10/
C ELASTIC TOTAL
      DATA YEL/4.89,5.19,5.20,5.21,5.26,5.29,5.33,5.37,5.41,5.47,
     /5.53,5.58,5.62,5.66,5.69,5.70,5.76,5.83,5.88,5.90,
     /5.96,6.01,6.08,6.12,6.14,6.16,6.16,6.17,6.16,6.16,
     /6.14,6.11,6.09,6.01,5.90,5.60,5.36,5.10,4.91,4.70,
     /4.51,4.32,4.21,4.10,3.75,3.49,3.27,3.03,2.56,2.13,
     /1.61,1.27,1.06,.884,.736,.668,.588,.460,.355,.244,
     /.194,.150,.117,.087,.071,.052,.041,.028,.022,.014,
     /.0108,.00722,.00544,.00437,.00352,.00295,.00224,.00182,.00154,
     /.00118,
     /.000830,.000654,.000550,.000466,.000411,.000342,.000301,.000274,
     /.000241,.000209,
     /.000195,.000186,.000177,.000172,.000169,.000167,.000166,.000166,
     /.000166/
C ANGULAR DISTRIBUTION PARAMETER EPSILON
      DATA YEPS/0.0,.00289,.00288,0.0,0.0,-.00562,-.00565,-.01118,
     /-.01386,-.01920,
     /-.02440,-.02688,-.03202,-.03445,-.03689,-.04209,-.04686,-.05400,
     /-.06119,-.06604,
     /-.07792,-.08474,-.10094,-.11490,-.12663,-.13826,-.14789,-.15724,
     /-.16707,-.18142,
     /-.19873,-.21165,-.21951,-.23447,-.24855,-.26918,-.26215,-.26104,
     /-.23265,-.20568,
     /-.17192,-.13835,-.08559,-.03703,0.02838,0.09142,0.14469,0.19052,
     /0.30369,0.35818,
     /0.48666,0.55167,0.63175,0.65099,0.67007,0.72517,0.73196,0.78150,
     /0.79668,0.83079,
     /0.86696,0.87845,0.91682,0.92737,0.93870,0.95363,0.96280,0.97662,
     /.983705,.988614,
     /.991805,.994606,.995963,.996795,.997452,.997887,.998428,.998754,
     /.998956,.999239,
     /.9995075,.9996596,.9997208,.9997819,.9998234,.9998743,.9999042,
     /.9999236,.9999469,.9999692,
     /.9999796,.9999853,.9999922,.9999951,.9999975,.9999985,.9999993,
     /.9999996,.9999997/
C  IONISATION (VALUES ABOVE 20KEV GENERATED BY BORN-BETHE IN SUB)
      DATA XION/24.587,25.0,25.5,26.0,26.5,27.0,28.0,29.0,30.0,32.0,
     /34.0,36.0,38.0,40.0,45.0,50.0,55.0,60.0,70.0,80.0,
     /100.,120.,150.,175.,200.,250.,300.,400.,500.,600.,
     /700.,800.,900.,1000.,1200.,1400.,1600.,1800.,2000.,2500.,
     /3000.,4000.,5000.,6000.,8000.,10000.,12000.,14000.,16000.,18000.,
     /20000./
C GROSS IONISATION
      DATA YION/.0,.0048,.0105,.0161,.0217,.0279,.0391,.0509,.0621,.085,
     /.105,.125,.143,.158,.195,.227,.250,.272,.302,.323,
     /.348,.356,.351,.340,.328,.304,.281,.240,.210,.186,
     /.168,.151,.139,.126,.109,.0964,.0871,.0795,.0729,.0608,
     /.0523,.0410,.0336,.0293,.0229,.0192,.0164,.0147,.0130,.0119,
     /.0108/
C COUNTING IONISATION
      DATA YINC/.0,.0048,.0105,.0161,.0217,.0279,.0391,.0509,.0621,.085,
     /.105,.125,.143,.158,.195,.227,.250,.272,.302,.323,
     /.348,.355,.350,.339,.327,.302,.279,.239,.209,.185,
     /.167,.150,.138,.125,.108,.0959,.0867,.0791,.0725,.0605,
     /.0520,.0408,.0334,.0292,.0228,.0191,.0163,.0146,.0129,.0118,
     /.0107/
C TRIPLET EXCITATION
      DATA XEXC/19.82,20.0,20.2,20.5,20.6,20.8,21.0,21.3,22.0,25.0,
     /30.0,40.0,50.0,60.0,70.0,80.0,90.0,100.,150.,200.,
     /400.,1000.,2000.,10000.,20000.,100000.,2.0D5,1.0D6,2.0D6,1.0D7/
      DATA YEXC/0.00,.047,.053,.035,.029,.043,.042,.041,.046,.075,
     /.071,.054,.038,.026,.017,.013,.0094,.0075,.0022,.00094,
     /1.2D-4,8.D-6,1.D-6,8.D-9,1.D-9,8.D-12,1.D-12,8.D-15,1.D-15,8.D-18/
C  SINGLET EXCITATION
      DATA XEXS/20.61,20.9,21.0,21.5,22.0,22.5,25.0,28.0,30.0,35.0,
     /40.0,45.0,50.0,60.0,70.0,80.0,90.0,100.,150.,200.,
     /300.,400.,500.,600.,800.,1000.,1500.,2000.,3000.,4000./
      DATA YEXS/0.00,.025,.022,.0265,.0315,.036,.065,.082,.092,.115,
     /.133,.148,.155,.175,.177,.178,.178,.177,.163,.148,
     /.121,.099,.086,.075,.061,.051,.038,.030,.022,.0173/
C --------------------------------------------------------------------
      IF(NANISO.EQ.0) THEN
       NAME='HE3 (ISOT) 2007'
      ELSE
       NAME='HE3 (ANIS) 2007'
      ENDIF
C --------------------------------------------------------------------
C  HELIUM 3 BEST KNOWN GAS USED AS STANDARD ACCURACY BETTER THAN 0.2%
C  AT ALL FIELDS.
C  2002: UPDATED 1997 DATA TO INCLUDE ANISOTROPIC ELASTIC SCATTTERING
C  2007: INCREASED DATA FILE UP TO 10 MEV
C  2007: NEW ANISTROPIC SCATTERING FUNCTION INTRODUCED
C  2007: PENNING FRACTION INTRODUCED
C --------------------------------------------------------------------
C
C BORN-BETHE VALUES FOR IONISATION
      CONST=1.873884D-20
      EMASS2=1021997.804
      AM2=0.489
      C=5.50
C SINGLET EXCITATION
      AM2EXS=0.261
      CEXS=2.52
C
      NIN=2
      DO 1 J=1,6
    1 KEL(J)=NANISO
      DO 2 J=1,NIN
    2 KIN(J)=NANISO
      NDATA=99
      NION=51
      NEXC=30
      NEXS=30
      E(1)=0.0
      E(2)=2.0*EMASS/(3.01600*AMU)
      E(3)=24.587
C ENTER EXCITATION X-SECTION AT 1.5MEV
      E(4)=0.595D-19
C ENTER IONISING X-SECTION AT 1.5MEV
      E(5)=0.1272D-18
C ENTER EOBY FOR MINIMUM IONISING PARTICLE
      E(6)=10.6
C EOBY AT LOW ENERGY
      EOBY=15.8
      IOFF=IFIX(SNGL(0.5+E(3)/ESTEP))
      EIN(1)=19.82
      EIN(2)=20.61
C***********************************************************
C ENTER PENNING FRACTION FOR EACH LEVEL
C PENNING FRACTION BETWEEN 0.9 AND 1.0 FOR ALL MIXTURES
      PENFRA(1,1)=1.0
      PENFRA(1,2)=1.0
C  PENNING TRANSFER DISTANCE MICRONS
      PENFRA(2,1)=1.0
      PENFRA(2,2)=1.0
C PENNING TRANSFER TIME PICOSECONDS
      PENFRA(3,1)=1.0
      PENFRA(3,2)=1.0
C***********************************************************
      IF(IPEN.EQ.0) GO TO 4
      DO 3 KDUM=1,NIN
      IF(PENFRA(1,KDUM).EQ.0.0) GO TO 3
      WRITE(6,999) NAME,EIN(KDUM),PENFRA(1,KDUM),PENFRA(2,KDUM),
     /PENFRA(3,KDUM)
  999 FORMAT(' GAS = ',A15,' ENERGY LEVEL = ',F7.4,' EV.',/,' PENNING PR
     /OBABILITY =',F5.3,' ABS.LENGTH =',F7.2,' DECAY TIME =',F7.1,/)
    3 CONTINUE
    4 IOFF1=IFIX(SNGL(0.5+EIN(1)/ESTEP))
      IOFF2=IFIX(SNGL(0.5+EIN(2)/ESTEP))
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC ANISOTROPIC HELIUM 3 '
      IF(NANISO.EQ.0) THEN
       SCRPT(2)=' ELASTIC ISOTROPIC HELIUM 3   '
      ENDIF
      SCRPT(3)=' IONISATION    ELOSS= 24.587  '
      SCRPT(4)='                              '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' EXC TRPLT     ELOSS= 19.82   '
      SCRPT(8)=' EXC SNGLT     ELOSS= 20.61   '
      EN=-ESTEP/2.0D0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      DO 10 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 20
   10 CONTINUE
      J=NDATA
   20 A=(YEL(J)-YEL(J-1))/(XEN(J)-XEN(J-1))
      B=(XEN(J-1)*YEL(J)-XEN(J)*YEL(J-1))/(XEN(J-1)-XEN(J))
      QELA=(A*EN+B)*1.0D-16
C
      A=(YEM(J)-YEM(J-1))/(XEN(J)-XEN(J-1))
      B=(XEN(J-1)*YEM(J)-XEN(J)*YEM(J-1))/(XEN(J-1)-XEN(J))
      QMOM=(A*EN+B)*1.0D-16
      PQ1=0.5+(QELA-QMOM)/QELA
C
      A=(YEPS(J)-YEPS(J-1))/(XEN(J)-XEN(J-1))
      B=(XEN(J-1)*YEPS(J)-XEN(J)*YEPS(J-1))/(XEN(J-1)-XEN(J))
      PQ2=A*EN+B
C
      IF(NANISO.EQ.1) PEQEL(2,I)=PQ1
      IF(NANISO.EQ.2) PEQEL(2,I)=PQ2
      Q(2,I)=QELA
      IF(NANISO.EQ.0) THEN
       Q(2,I)=QMOM
       PEQEL(2,I)=0.5
      ENDIF
C GROSS IONISATION
      Q(3,I)=0.0D0
      PEQEL(3,I)=0.5D0
      IF(NANISO.EQ.2) PEQEL(3,I)=0.0D0
      IF(EN.LE.E(3)) GO TO 200
      IF(EN.GT.XION(NION)) GO TO 121
      DO 110 J=2,NION
      IF(EN.LE.XION(J)) GO TO 120
  110 CONTINUE
      J=NION
  120 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
      GO TO 122
C USE BORN-BETHE X-SECTION ABOVE XION(NION) EV
  121 GAMMA=(EMASS2+2.0D0*EN)/EMASS2
      BETA=DSQRT(1.0D0-1.0D0/(GAMMA*GAMMA))
      BETA2=BETA*BETA
      AX2=1.0D0/BETA2
      AX1=AX2*DLOG(BETA2/(1.0D0-BETA2))-1.0D0
      Q(3,I)=CONST*(AM2*AX1+C*AX2)/0.995
  122 CONTINUE
C USE ANISOTROPIC SCATTERING FOR PRIMARY IONISATION ELECTRON FOR
C ENERGIES ABOVE 2 * IONISATION ENERGY
C ANISOTROPIC ANGULAR DISTRIBUTION SAME AS ELASTIC AT ENERGY OFFSET BY
C IONISATION ENERGY
      IF(EN.LE.(2.0*E(3))) GO TO 200
      PEQEL(3,I)=PEQEL(2,(I-IOFF))
C ATTACHMENT
  200 Q(4,I)=0.0D0
C COUNTING IONISATION
      Q(5,I)=0.0D0
      PEQEL(5,I)=0.5D0
      IF(NANISO.EQ.2) PEQEL(5,I)=0.0D0
      IF(EN.LE.E(3)) GO TO 250
      IF(EN.GT.XION(NION)) GO TO 241
      DO 230 J=2,NION
      IF(EN.LE.XION(J)) GO TO 240
  230 CONTINUE
      J=NION
  240 A=(YINC(J)-YINC(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YINC(J)-XION(J)*YINC(J-1))/(XION(J-1)-XION(J))
      Q(5,I)=(A*EN+B)*1.0D-16
      GO TO 242
C USE BORN-BETHE X-SECTION ABOVE XION(NION) EV
  241 Q(5,I)=CONST*(AM2*AX1+C*AX2)
  242 CONTINUE
      IF(EN.LE.(2.0D0*E(3))) GO TO 250
      PEQEL(5,I)=PEQEL(2,(I-IOFF))
  250 Q(6,I)=0.0D0
C
      QIN(1,I)=0.0D0
      PEQIN(1,I)=0.5D0
      IF(NANISO.EQ.2) PEQIN(1,I)=0.0D0
      IF(EN.LE.EIN(1)) GO TO 600
      DO 510 J=2,NEXC
      IF(EN.LE.XEXC(J)) GO TO 520
  510 CONTINUE
      J=NEXC
  520 A=(YEXC(J)-YEXC(J-1))/(XEXC(J)-XEXC(J-1))
      B=(XEXC(J-1)*YEXC(J)-XEXC(J)*YEXC(J-1))/(XEXC(J-1)-XEXC(J))
      QIN(1,I)=(A*EN+B)*1.D-16
      IF(EN.LE.(2.0*EIN(1))) GO TO 600
      PEQIN(1,I)=PEQEL(2,(I-IOFF1))
  600 CONTINUE
C
      QIN(2,I)=0.0D0
      PEQIN(2,I)=0.5D0
      IF(NANISO.EQ.2) PEQIN(2,I)=0.0D0
      IF(EN.LE.EIN(2)) GO TO 700
      IF(EN.GT.XEXS(NEXS)) GO TO 630
      DO 610 J=2,NEXS
      IF(EN.LE.XEXS(J)) GO TO 620
  610 CONTINUE
      J=NEXS
  620 A=(YEXS(J)-YEXS(J-1))/(XEXS(J)-XEXS(J-1))
      B=(XEXS(J-1)*YEXS(J)-XEXS(J)*YEXS(J-1))/(XEXS(J-1)-XEXS(J))
      QIN(2,I)=(A*EN+B)*1.D-16
      GO TO 660
C USE BORN BETHE ABOVE XEXS(NEXS) EV
  630 QIN(2,I)=CONST*(AM2EXS*AX1+CEXS*AX2)
  660 IF(EN.LE.(2.0*EIN(2))) GO TO 700
      PEQIN(2,I)=PEQEL(2,(I-IOFF2))
  700 CONTINUE
C
      Q(1,I)=QELA+Q(5,I)+QIN(1,I)+QIN(2,I)
  900 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(2)) NIN=1
      IF(EFINAL.LE.EIN(1)) NIN=0
C
      RETURN
      END
      SUBROUTINE GAS5(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      DIMENSION XEN(87),YXSEC(87),XION(71),YION(71),XEL(84),YEL(84)
      DIMENSION X1(68),Y1(68),X2(76),Y2(76),X3(68),Y3(68),X4(68),Y4(68)
      DIMENSION X5(67),Y5(67),X6(64),Y6(64),X7(64),Y7(64),X8(64),Y8(64)
      DIMENSION X9(64),Y9(64),YINC(71),XEPS(158),YEPS(158)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
C ELASTIC MOMENTUM TRANSFER
      DATA XEN/1.00,1.20,1.50,1.80,2.00,2.50,3.00,4.00,5.00,6.00,
     /7.00,8.00,8.71,9.00,10.0,11.0,13.6,15.0,16.5,19.6,
     /20.0,30.0,40.0,50.0,60.0,70.0,77.0,100.,130.,150.,
     /170.,200.,250.,300.,350.,400.,500.,600.,700.,800.,
     /900.,1000.,1500.,2000.,2500.,3000.,3500.,4000.,5000.,6000.,
     /7000.,8000.,9000.,1.0D4,1.5D4,2.0D4,2.5D4,3.0D4,4.0D4,5.0D4,
     /6.0D4,7.0D4,8.0D4,9.0D4,1.0D5,1.25D5,1.50D5,1.75D5,2.0D5,2.5D5,
     /3.0D5,4.0D5,5.0D5,6.0D5,7.0D5,8.0D5,9.0D5,1.0D6,1.25D6,1.50D6,
     /1.75D6,2.0D6,3.0D6,4.0D6,6.0D6,8.0D6,1.0D7/
      DATA YXSEC/1.6178,1.69,1.75,1.79,1.82,1.86,1.91,1.98,2.07,2.14,
     /2.21,2.29,2.35,2.37,2.44,2.51,2.66,2.71,2.76,2.83,
     /2.84,2.84,2.78,2.58,2.30,2.12,2.03,1.53,1.21,1.03,
     /0.90,.756,.585,.474,.385,.321,.234,.180,.143,.117,
     /.0977,.0830,.0435,.0271,.0187,.0137,.0105,.00833,.00565,.00410,
     /.00312,.00246,.0020,.00166,.0008,.000478,.00032,.000231,.000138,
     /9.28D-5,
     /6.72D-5,5.12D-5,4.05D-5,3.30D-5,2.75D-5,1.88D-5,1.38D-5,1.06D-5,
     /8.54D-6,5.9D-6,
     /4.43D-6,2.81D-6,1.99D-6,1.50D-6,1.19D-6,9.71D-7,8.12D-7,6.91D-7,
     /4.95D-7,3.74D-7,
     /2.94D-7,2.38D-7,1.24D-7,7.74D-8,3.89D-8,2.36D-8,1.59D-8/
C ELASTIC TOTAL
      DATA XEL/1.00,1.20,1.50,1.80,2.00,2.50,3.00,4.00,5.00,6.00,
     /8.00,10.0,12.0,14.0,16.0,18.0,20.0,25.0,30.0,40.0,
     /50.0,60.0,70.0,80.0,90.0,100.,125.,150.,200.,250.,
     /300.,350.,400.,500.,600.,700.,800.,900.,1000.,1200.,
     /1500.,2000.,2500.,3000.,4000.,5000.,6000.,7000.,8000.,9000.,
     /1.0D4,1.5D4,2.0D4,2.5D4,3.0D4,4.0D4,5.0D4,6.0D4,7.0D4,8.0D4,
     /9.0D4,1.0D5,1.25D5,1.5D5,1.75D5,2.0D5,2.5D5,3.0D5,4.0D5,5.0D5,
     /6.0D5,7.0D5,8.0D5,9.0D5,1.0D6,1.25D6,1.5D6,1.75D6,2.0D6,3.0D6,
     /4.0D6,6.0D6,8.0D6,1.0D7/
      DATA YEL/1.5667,1.68,1.82,1.94,2.01,2.16,2.30,2.55,2.80,2.98,
     /3.23,3.39,3.54,3.63,3.67,3.68,3.70,3.63,3.54,3.31,
     /3.12,2.93,2.75,2.56,2.42,2.26,1.98,1.76,1.41,1.26,
     /1.10,1.02,.921,.806,.703,.643,.577,.539,.486,.434,
     /.368,.296,.233,.195,.168,.131,.115,.101,.0906,.0813,
     /.0738,.0507,.0389,.0317,.0269,.0208,.0172,.0147,.0129,.0116,
     /.0106,.00977,.00829,.00731,.00661,.00608,.00636,.00488,.00430,
     /.00396,
     /.00374,.00358,.00347,.00339,.00333,.00322,.00315,.00310,.00307,
     /.00301,.00298,.00296,.00296,.00295/
C ANGULAR DISTRIBUTION PARAMETER EPSILON
      DATA XEPS/0.0,.0001,.0002,.0003,.0004,.0005,.0006,.0008,.001,
     /.0012,
     /.0014,.0016,.0018,.0020,.0024,.0028,.0032,.0036,.0040,.0045,
     /.0050,.0055,.0060,.0070,.0080,.0090,.0100,.0120,.0140,.0160,
     /.0180,.0200,.0240,.0280,.0320,.0360,.0400,.0450,.0500,.0550,
     /0.060,0.070,0.080,0.090,0.100,0.120,0.140,0.160,0.180,0.200,
     /0.24,0.28,0.32,0.36,0.40,0.45,0.50,0.55,0.60,0.70,
     /0.80,0.90,1.00,1.20,1.50,1.80,2.00,2.50,3.00,4.00,
     /5.00,6.00,7.00,8.00,8.71,9.00,10.0,11.0,12.0,13.6,
     /14.0,15.0,16.0,16.5,18.0,19.6,20.0,25.0,30.0,40.0,
     /50.0,60.0,70.0,77.0,80.0,90.0,100.,125.,130.,150.,
     /170.,200.,250.,300.,350.,400.,500.,600.,700.,800.,
     /900.,1000.,1200.,1500.,2000.,2500.,3000.,3500.,4000.,5000.,
     /6000.,7000.,8000.,9000.,1.0D4,1.5D4,2.0D4,2.5D4,3.0D4,4.0D4,
     /5.0D4,6.0D4,7.0D4,8.0D4,9.0D4,1.0D5,1.25D5,1.5D5,1.75D5,2.0D5,
     /2.5D5,3.0D5,4.0D5,5.0D5,6.0D5,7.0D5,8.0D5,9.0D5,1.0D6,1.25D6,
     /1.5D6,1.75D6,2.0D6,3.0D6,4.0D6,6.0D6,8.0D6,1.0D7/
      DATA YEPS/0.0,-.02100,-.02805,-.03494,-.03914,-.04259,-.04678,
     /-.05337,-.05831,-.06325,
     /-.06804,-.07208,-.07522,-.07761,-.08388,-.09015,-.09478,-.09866,
     /-.10254,-.10730,
     /-.11177,-.11579,-.11891,-.12531,-.13154,-.13659,-.14163,-.14918,
     /-.15613,-.16248,
     /-.16779,-.17310,-.18075,-.18722,-.19324,-.19778,-.20202,-.20656,
     /-.21006,-.21313,
     /-.21604,-.22041,-.22362,-.22580,-.22725,-.22929,-.22929,-.22856,
     /-.22711,-.22478,
     /-.21852,-.21196,-.20422,-.19734,-.18766,-.17649,-.16544,-.15332,
     /-.14133,-.11787,
     /-.09463,-.07058,-.04888,-.00900,0.05765,0.11566,0.14122,0.20654,
     /0.25109,0.32789,
     /.37941,.40815,.41670,.42042,.41243,.41099,.40593,.39969,.39828,
     /.38331,
     /.38303,.37506,.36827,.36259,.35193,.34296,.34034,.31961,.29146,
     /.23744,
     /.25616,.31593,.33568,.32898,.34034,.40305,.46264,.51203,.52872,
     /.57697,
     /.61157,.63350,.71002,.74286,.79180,.81636,.86165,.88570,.90742,
     /.91920,
     /.93138,.93703,.94526,.96251,.97356,.97785,.98144,.98561,.98822,
     /.99015,
     /.99226,.99354,.99450,.99513,.99564,.99717,.99791,.998626,.998640,
     /.999047,
     /.999212,.999350,.999449,.999525,.999584,.999629,.999711,.999765,
     /.999805,.999832,
     /.999895,.999898,.999929,.999947,.999959,.999967,.999972,.9999769,
     /.9999803,.9999858,
     /.9999893,.9999917,.9999933,.9999966,.9999980,.9999990,.9999994,
     /.9999996/
C IONISATION (VALUES ABOVE 20KEV GENERATED BY BORN-BETHE IN SUB)
      DATA XION/21.56,22.0,22.5,23.0,23.5,24.0,24.5,25.0,25.5,26.0,
     /27.0,28.0,29.0,30.0,32.0,34.0,36.0,40.0,45.0,50.0,
     /55.0,60.0,65.0,70.0,75.0,80.0,90.0,100.,110.,120.,
     /130.,140.,150.,160.,175.,190.,200.,225.,250.,275.,
     /300.,350.,400.,500.,600.,700.,800.,900.,1000.,1200.,
     /1400.,1600.,1800.,2000.,2500.,3000.,3500.,4000.,4500.,5000.,
     /5500.,6000.,7000.,8000.,9000.,10000.,12000.,14000.,16000.,18000.,
     /20000./
C GROSS IONISATION
      DATA YION/0.00,.0032,.0076,.0121,.0172,.022,.027,.032,.037,.042,
     /.054,.066,.078,.091,.116,.141,.166,.215,.266,.322,
     /.372,.416,.458,.495,.527,.557,.604,.643,.679,.699,
     /.717,.730,.744,.751,.754,.753,.752,.744,.730,.711,
     /.692,.657,.617,.560,.507,.463,.425,.389,.363,.317,
     /.287,.260,.236,.218,.186,.160,.142,.127,.117,.107,
     /.0992,.0929,.0819,.0736,.0672,.0618,.0536,.0471,.0423,.0387,
     /.0355/
C COUNTING IONISATION
      DATA YINC/0.00,.0032,.0076,.0121,.0172,.022,.027,.032,.037,.042,
     /.054,.066,.078,.091,.116,.141,.166,.215,.266,.322,
     /.372,.416,.458,.495,.527,.556,.601,.637,.669,.687,
     /.701,.711,.722,.727,.727,.724,.721,.711,.697,.677,
     /.659,.624,.586,.532,.483,.442,.406,.372,.348,.303,
     /.274,.248,.225,.208,.178,.153,.136,.121,.112,.102,
     /.0947,.0887,.0782,.0703,.0642,.0590,.0512,.0450,.0404,.0370,
     /.0339/
C EXCITATION
C 1S5
      DATA X1/16.618,16.70,16.80,16.9,17.0,17.1,17.2,17.3,17.4,17.6,
     /17.8,18.0,18.2,18.3,18.4,18.5,18.6,18.7,18.8,19.0,
     /19.5,20.0,21.0,22.0,24.0,26.0,28.0,30.0,35.0,40.0,
     /44.0,50.0,60.0,70.0,80.0,90.0,100.,120.,150.,200.,
     /250.,500.,1000.,2000.,5000.,10000.,15000.,20000.,30000.,40000.,
     /6.0D4,8.0D4,1.0D5,1.5D5,2.0D5,3.0D5,4.0D5,6.0D5,8.0D5,1.0D6,
     /1.5D6,2.0D6,2.5D6,3.0D6,4.0D6,6.0D6,8.0D6,1.0D7/
      DATA Y1/0.0,.0009,.0022,.0042,.0072,.0054,.0046,.0050,.0053,.0060,
     /.0065,.0070,.0074,.0080,.0104,.0130,.0108,.0085,.0082,.0083,
     /.0086,.0087,.0086,.0083,.0073,.0070,.0067,.0062,.0045,.0031,
     /.0024,.0016,.0010,.0006,.0004,.00028,.0002,.00011,.00006,.00002,
     /1.1D-5,1.3D-6,1.47D-7,1.67D-8,9.60D-10,1.13D-10,3.30D-11,1.39D-11,
     /4.24D-12,1.87D-12,
     /6.14D-13,2.91D-13,1.68D-13,6.70D-14,3.76D-14,1.87D-14,1.25D-14,
     /8.0D-15,6.4D-15,5.6D-15,
     /4.7D-15,4.3D-15,4.2D-15,4.1D-15,4.0D-15,3.9D-15,3.85D-15,3.8D-15/
C 1S4
      DATA X2/16.670,16.70,16.80,16.9,17.0,17.2,
     /17.5,18.0,18.2,18.4,18.5,18.6,18.7,18.8,19.0,
     /19.5,20.0,21.0,22.0,24.0,26.0,28.0,30.0,35.0,40.0,
     /44.0,50.0,60.0,70.0,80.0,90.0,100.,120.,150.,200.,
     /250.,300.,400.,500.,600.,700.,800.,900.,1000.,1200.,
     /1500.,2000.,2400.,3000.,4000.,5000.,6000.,8000.,10000.,15000.,
     /2.0D4,3.0D4,4.0D4,6.0D4,8.0D4,1.0D5,1.5D5,2.0D5,3.0D5,4.0D5,
     /6.0D5,8.0D5,1.0D6,1.5D6,2.0D6,2.5D6,3.0D6,4.0D6,6.0D6,8.0D6,
     /1.0D7/
      DATA Y2/0.,.00004,.0021,.0030,.0060,.0040,
     /.0053,.0057,.0058,.0070,.0100,.0080,.0060,.0058,.0057,
     /.0057,.0059,.0057,.0062,.0069,.0074,.0076,.0078,.0081,.0084,
     /.0086,.0086,.0083,.0080,.0078,.0075,.0073,.0069,.0062,.0052,
     /.0047,.0041,.0034,.0029,.0026,.0023,.0021,.0019,.0018,.0015,
     /.0012,.0010,.0009,.0007,.00059,.00050,.00043,.00034,.00028,.00020,
     /.00016,1.14D-4,9.08D-5,6.7D-5,5.4D-5,4.7D-5,3.6D-5,3.1D-5,2.6D-5,
     /2.3D-5,
     /2.13D-5,2.05D-5,2.02D-5,2.01D-5,2.04D-5,2.07D-5,2.11D-5,2.18D-5,
     /2.28D-5,2.37D-5,2.43D-5/
C 1S3
      DATA X3/16.715,16.80,16.9,17.0,17.1,17.2,17.3,17.4,17.5,17.6,
     /17.8,18.0,18.2,18.3,18.4,18.5,18.6,18.7,18.8,19.0,
     /19.5,20.0,21.0,22.0,24.0,26.0,28.0,30.0,35.0,40.0,
     /44.0,50.0,60.0,70.0,80.0,90.0,100.,120.,150.,200.,
     /250.,500.,1000.,2000.,5000.,10000.,15000.,20000.,30000.,40000.,
     /6.0D4,8.0D4,1.0D5,1.5D5,2.0D5,3.0D5,4.0D5,6.0D5,8.0D5,1.0D6,
     /1.5D6,2.0D6,2.5D6,3.0D6,4.0D6,6.0D6,8.0D6,1.0D7/
      DATA Y3/0.,.0003,.0009,.0016,.0011,.0009,.0010,.0011,.0011,.0011,
     /.0012,.0013,.0014,.0015,.0022,.0029,.0022,.0017,.0015,.0016,
     /.0016,.0017,.0017,.0016,.0015,.0015,.0015,.0014,.0010,.00079,
     /.00065,.0005,.00033,.00023,.00017,.00013,.0001,6.5D-5,4.D-5,2.D-5,
     /1.1D-5,2.0D-6,3.59D-7,6.43D-8,6.68D-9,1.23D-9,4.6D-10,2.3D-10,
     /9.1D-11,4.7D-11,
     /2.0D-11,1.08D-11,7.0D-12,3.4D-12,2.1D-12,1.2D-12,8.9D-13,6.3D-13,
     /5.2D-13,4.7D-13,
     /4.1D-13,3.9D-13,3.7D-13,3.7D-13,3.6D-13,3.5D-13,3.5D-13,3.5D-13/
C 1S2
      DATA X4/16.847,17.0,17.1,17.5,18.0,18.5,19.0,
     /19.5,20.0,21.0,22.0,24.0,26.0,28.0,30.0,35.0,40.0,
     /44.0,50.0,60.0,70.0,80.0,90.0,100.,120.,150.,200.,
     /250.,300.,400.,500.,600.,700.,800.,900.,1000.,1200.,
     /1500.,2000.,2400.,3000.,4000.,5000.,6000.,8000.,10000.,15000.,
     /2.0D4,3.0D4,4.0D4,6.0D4,8.0D4,1.0D5,1.5D5,2.0D5,3.0D5,4.0D5,
     /6.0D5,8.0D5,1.0D6,1.5D6,2.0D6,2.5D6,3.0D6,4.0D6,6.0D6,8.0D6,
     /1.0D7/
      DATA Y4/0.,.0090,.0170,.0175,.0182,.0194,.0205,
     /.0215,.0225,.0245,.0266,.0310,.0430,.0580,.0700,.0870,.0960,
     /.1000,.1030,.1040,.1030,.1000,.0973,.0934,.0862,.0770,.0655,
     /.0571,.0509,.0420,.0360,.0316,.0282,.0256,.0235,.0217,.0189,
     /.0159,.0127,.0110,.0092,.0073,.0061,.0053,.0042,.0035,.0025,
     /.0020,.00142,.00114,.00084,.00068,.00059,.00046,.00039,.000325,
     /.000294,
     /.000267,.000257,.000253,.000252,.000256,.000260,.000264,.000273,
     /.000286,.000297,.000305/
C SUM OF 2P(10-2)  = 2P10+2P9+2P8+2P7+2P6+2P5+2P4+2P3+2P2
      DATA X5/18.381,18.5,18.6,18.7,18.8,19.0,19.5,20.0,21.0,22.0,
     /24.0,26.0,28.0,30.0,35.0,40.0,44.0,50.0,60.0,70.0,
     /80.0,90.0,100.,120.,150.,200.,250.,300.,400.,500.,
     /600.,700.,800.,900.,1000.,1200.,1500.,2000.,2400.,3000.,
     /4000.,5000.,6000.,8000.,10000.,15000.,20000.,30000.,40000.,60000.,
     /8.0D4,1.0D5,1.5D5,2.0D5,3.0D5,4.0D5,6.0D5,8.0D5,1.0D6,1.5D6,
     /2.0D6,2.5D6,3.0D6,4.0D6,6.0D6,8.0D6,1.0D7/
      DATA Y5/0.,.0005,.0050,.0210,.0110,.0098,.0118,.0140,.0191,.0225,
     /.0256,.0263,.0258,.0249,.0219,.0191,.0172,.0149,.0121,.0101,
     /.0087,.0076,.0067,.0055,.0043,.0031,.0025,.0020,.0015,.0012,
     /.00098,.00084,.00073,.00065,5.77D-4,4.79D-4,3.83D-4,2.86D-4,
     /2.39D-4,1.91D-4,
     /1.43D-4,1.15D-4,9.60D-5,7.23D-5,5.82D-5,3.93D-5,2.99D-5,2.05D-5,
     /1.58D-5,1.11D-5,
     /8.7D-6,7.3D-6,5.5D-6,4.6D-6,3.7D-6,3.2D-6,2.8D-6,2.6D-6,2.5D-6,
     /2.4D-6,
     /2.3D-6,2.3D-6,2.30D-6,2.2D-6,2.2D-6,2.2D-6,2.2D-6/
C 2P1
      DATA X6/18.965,19.2,20.0,20.5,21.0,22.0,23.0,24.0,26.0,28.0,
     /30.0,35.0,40.0,44.0,50.0,60.0,70.0,80.0,90.0,100.,
     /120.,150.,200.,250.,300.,400.,500.,600.,700.,800.,
     /900.,1000.,1200.,1500.,2000.,2400.,3000.,4000.,5000.,6000.,
     /8000.,10000.,15000.,2.0D4,3.0D4,4.0D4,6.0D4,8.0D4,1.0D5,1.5D5,
     /2.0D5,3.0D5,4.0D5,6.0D5,8.0D5,1.0D6,1.5D6,2.0D6,2.5D6,3.0D6,
     /4.0D6,6.0D6,8.0D6,1.0D7/
      DATA Y6/0.,.0014,.0023,.0029,.0035,.0048,.0062,.0075,.0105,.0135,
     /.0158,.0195,.0211,.0213,.0209,.0195,.0179,.0163,.0150,.0138,
     /.0118,.0097,.0074,.0060,.0051,.0038,.0031,.0026,.0022,.0019,
     /.0017,.00154,.00128,.00103,7.72D-4,6.45D-4,5.17D-4,3.89D-4,
     /3.12D-4,2.61D-4,
     /1.97D-4,1.58D-4,1.07D-4,8.14D-5,5.58D-5,4.3D-5,3.0D-5,2.4D-5,
     /2.0D-5,1.5D-5,
     /1.2D-5,1.0D-5,8.8D-6,7.6D-6,7.1D-6,6.8D-6,6.4D-6,6.3D-6,6.2D-6,
     /6.1D-6,
     /6.1D-6,6.1D-6,6.0D-6,6.0D-6/
C SUM 2S5 + 2S4 + 2S3 + 2S2
      DATA X7/19.663,20.5,21.0,21.5,22.0,23.0,24.0,25.0,26.0,28.0,
     /30.0,35.0,40.0,44.0,50.0,60.0,70.0,80.0,90.0,100.,
     /120.,150.,200.,250.,300.,400.,500.,600.,700.,800.,
     /900.,1000.,1200.,1500.,2000.,2400.,3000.,4000.,5000.,6000.,
     /8000.,10000.,15000.,2.0D4,3.0D4,4.0D4,6.0D4,8.0D4,1.0D5,1.5D5,
     /2.0D5,3.0D5,4.0D5,6.0D5,8.0D5,1.0D6,1.5D6,2.0D6,2.5D6,3.0D6,
     /4.0D6,6.0D6,8.0D6,1.0D7/
      DATA Y7/0.,.0021,.0031,.0040,.0047,.0058,.0067,.0074,.0079,.0087,
     /.0093,.0102,.0109,.0112,.0116,.0119,.0120,.0120,.0118,.0117,
     /.0112,.0105,.0094,.0084,.0077,.0065,.0057,.0051,.0046,.0042,
     /.0039,.00358,.00314,.00267,.00215,.00188,.00158,.00126,.00106,
     .9.13D-4,
     /7.25D-4,6.05D-4,4.36D-4,3.46D-4,2.51D-4,2.00D-4,1.48D-4,1.20D-4,
     /1.04D-4,8.06D-5,
     /6.9D-5,5.8D-5,5.2D-5,4.7D-5,4.6D-5,4.5D-5,4.5D-5,4.6D-5,4.6D-5,
     /4.7D-5,
     /4.9D-5,5.1D-5,5.3D-5,5.4D-5/
C SUM HIGHER LEVELS 3D + 3S
      DATA X8/20.033,20.5,21.0,21.5,22.0,23.0,24.0,25.0,26.0,28.0,
     /30.0,35.0,40.0,44.0,50.0,60.0,70.0,80.0,90.0,100.,
     /120.,150.,200.,250.,300.,400.,500.,600.,700.,800.,
     /900.,1000.,1200.,1500.,2000.,2400.,3000.,4000.,5000.,6000.,
     /8000.,10000.,15000.,2.0D4,3.0D4,4.0D4,6.0D4,8.0D4,1.0D5,1.5D5,
     /2.0D5,3.0D5,4.0D5,6.0D5,8.0D5,1.0D6,1.5D6,2.0D6,2.5D6,3.0D6,
     /4.0D6,6.0D6,8.0D6,1.0D7/
      DATA Y8/0.,1.13D-5,5.33D-5,1.21D-4,2.10D-4,4.45D-4,7.37D-4,
     /.00107,.00142,.00215,
     /.00285,.00436,.00547,.00612,.00682,.0075,.0078,.0080,.0080,.0079,
     /.0077,.0073,.0066,.0059,.0054,.0047,.0041,.0037,.0033,.0030,
     /.0028,.0026,.0023,.00195,.00158,.00138,.00116,.00093,.00078,
     /.00068,
     /.00054,.00045,.00032,.00026,.000186,.000149,.000110,8.96D-4,
     /7.705D-4,6.00D-4,
     /5.14D-4,4.29D-4,3.89D-4,3.53D-4,3.40D-4,3.35D-4,3.34D-4,3.39D-4,
     /3.45D-4,3.51D-4,
     /3.62D-4,3.80D-4,3.946D-4,4.06D-4/
C SUM 3P (3P1 T0 3P10)
      DATA X9/20.200,20.5,21.0,21.5,22.0,23.0,24.0,25.0,26.0,28.0,
     /30.0,35.0,40.0,44.0,50.0,60.0,70.0,80.0,90.0,100.,
     /120.,150.,200.,250.,300.,400.,500.,600.,700.,800.,
     /900.,1000.,1200.,1500.,2000.,2400.,3000.,4000.,5000.,6000.,
     /8000.,10000.,15000.,2.0D4,3.0D4,4.0D4,6.0D4,8.0D4,1.0D5,1.5D5,
     /2.0D5,3.0D5,4.0D5,6.0D5,8.0D5,1.0D6,1.5D6,2.0D6,2.5D6,3.0D6,
     /4.0D6,6.0D6,8.0D6,1.0D7/
      DATA Y9/0.,.0004,.0013,.0021,.0028,.0039,.0047,.0054,.0058,.0065,
     /.0068,.0070,.0068,.0066,.0062,.0055,.0050,.0045,.0041,.0037,
     /.0032,.0026,.0020,.0016,.0014,.00103,.00083,.00070,.00060,.00052,
     /.00047,4.19D-4,3.5D-4,2.8D-4,2.11D-4,1.76D-4,1.41D-4,1.06D-4,
     /8.52D-5,7.12D-5,
     /5.38D-5,4.33D-5,2.93D-5,2.23D-5,1.53D-5,1.18D-5,8.3D-6,6.5D-6,
     /5.5D-6,4.1D-6,
     /3.4D-6,2.7D-6,2.4D-6,2.1D-6,1.94D-6,1.86D-6,1.76D-6,1.72D-6,
     /1.69D-6,1.68D-6,
     /1.67D-6,1.66D-6,1.65D-6,1.65D-6/
C ---------------------------------------------------------------------
      IF(NANISO.EQ.0) THEN
       NAME='NEON ISOT  2007'
      ELSE
       NAME='NEON ANISO 2007'
      ENDIF
C ---------------------------------------------------------------------
C UPDATE OF 2002 FILE USES MORE DETAILED EXCITATION X-SECTIONS FOR USE
C IN PENNING CALCULATIONS.
C SHAPE 0F EXCITATION FUNCTIONS CLOSE TO THRESHOLD GUIDED BY
C ZEMAN AND BARTSCHAT J.PHYS. B 30(1997)4609
C ALL X-SECTIONS CONSISTENT WITH PUBLISHED ELECTRON SCATTERING DATA UP
C TO 2003
C FIT TO RATE COEFICIENTS OF :
C  TACHIBANA AN PHELPS : PHYS REV.A36(1987)999
C  TACHIBANA AND HARIMA J.PHYS.B 17(1984)879
C GOOD FIT TO DRIFT DIFFUSION DATA OF ROBERTSON AND ALSO DATA OF
C  LUCAS AND SAELEE . CLOSE FIT TO TOWNSEND DATA OF CHANIN AND RORK
C 2007: INCREASED DATA BASE UP TO 10MEV ENERGY
C 2007: INTRODUCED NEW ANGULAR DISTRIBUTION FUNCTION
C 2007: INTRODUCED PENNING TRANSFER FRACTION
C ---------------------------------------------------------------------
C
C BORN BETHE VALUES FOR IONISATION
      CONST=1.873884D-20
      EMASS2=1021997.804
      AM2=1.66
      C=17.50
      NIN=9
C
      DO 1 J=1,6
    1 KEL(J)=NANISO
      DO 2 J=1,NIN
    2 KIN(J)=NANISO
C
      NEL=84
      NDATA=87
      NEPSI=158
      NION=71
      NEXC1=68
      NEXC2=76
      NEXC3=68
      NEXC4=68
      NEXC5=67
      NEXC6=64
      NEXC7=64
      NEXC8=64
      NEXC9=64
      E(1)=0.0
      E(2)=2.0*EMASS/(20.179*AMU)
      E(3)=21.56
C EXCITATION X=SECTION AT 1.5MEV
      E(4)=0.663D-19
C ENTER IONISING X-SECTION AT 1.5MEV
      E(5)=0.408D-18
C ENTER EOBY FOR MINIMUM IONISING PARTICLE
      E(6)=19.6
C EOBY AT LOW ENERGY
      EOBY=24.2
      IOFF=IFIX(SNGL(0.5+E(3)/ESTEP))
      EIN(1)=16.618
      EIN(2)=16.670
      EIN(3)=16.715
      EIN(4)=16.857
      EIN(5)=18.381
      EIN(6)=18.965
      EIN(7)=19.663
      EIN(8)=20.033
      EIN(9)=20.200
C*****************************************************************
C ENTER PENNING TRANSFER FRACTION FOR EACH LEVEL
C PENNING TRANSFER EFFICIENCY IN NEON MIXTURES BETWEEN 0.3 AND 0.6
      PENFRA(1,1)=0.5
      PENFRA(1,2)=0.5
      PENFRA(1,3)=0.5
      PENFRA(1,4)=0.5
      PENFRA(1,5)=0.5
      PENFRA(1,6)=0.5
      PENFRA(1,7)=0.5
      PENFRA(1,8)=0.5
      PENFRA(1,9)=0.5
C PENNING TRANSFER DISTANCE MICRONS
      DO 3 J=1,9
      PENFRA(2,J)=1.0
C PENNING TRANSFER TIME PICOSECONDS
    3 PENFRA(3,J)=1.0
C*****************************************************************
      IF(IPEN.EQ.0) GO TO 5
      DO 4 KDUM=1,NIN
      IF(PENFRA(1,KDUM).EQ.0.0) GO TO 4
      WRITE(6,999) NAME,EIN(KDUM),PENFRA(1,KDUM),PENFRA(2,KDUM),
     /PENFRA(3,KDUM)
  999 FORMAT(' GAS = ',A15,' ENERGY LEVEL = ',F7.4,' EV.',/,' PENNING PR
     /OBABILITY =',F5.3,' ABS.LENGTH =',F7.2,' DECAY TIME =',F7.1,/)
    4 CONTINUE
    5 IOFF1=IFIX(SNGL(0.5+EIN(1)/ESTEP))
      IOFF2=IFIX(SNGL(0.5+EIN(2)/ESTEP))
      IOFF3=IFIX(SNGL(0.5+EIN(3)/ESTEP))
      IOFF4=IFIX(SNGL(0.5+EIN(4)/ESTEP))
      IOFF5=IFIX(SNGL(0.5+EIN(5)/ESTEP))
      IOFF6=IFIX(SNGL(0.5+EIN(6)/ESTEP))
      IOFF7=IFIX(SNGL(0.5+EIN(7)/ESTEP))
      IOFF8=IFIX(SNGL(0.5+EIN(8)/ESTEP))
      IOFF9=IFIX(SNGL(0.5+EIN(9)/ESTEP))
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC  ANISOTROPIC  NEON   '
      IF(NANISO.EQ.0) THEN
       SCRPT(2)=' ELASTIC ISOTROPIC NEON       '
      ENDIF
      SCRPT(3)=' IONISATION    ELOSS= 21.56   '
      SCRPT(4)='                              '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' EXC 1S5       ELOSS= 16.618  '
      SCRPT(8)=' EXC 1S4       ELOSS= 16.670  '
      SCRPT(9)=' EXC 1S3       ELOSS= 16.715  '
      SCRPT(10)=' EXC 1S2       ELOSS= 16.857  '
      SCRPT(11)=' EXCSUM 2P10-2 ELOSS= 18.381  '
      SCRPT(12)=' EXC 2P1     ) ELOSS= 18.965  '
      SCRPT(13)=' EXC SUM 2S    ELOSS= 19.663  '
      SCRPT(14)=' EXC 3D+3S     ELOSS= 20.033  '
      SCRPT(15)=' EXC 3P        ELOSS= 20.200  '
C PARAMETERS OF PHASE SHIFT ANALYSIS
      APOL=2.672
      LMAX=100
      AA=0.2135
      DD=3.86
      FF=-2.656
      A1=1.846
      B1=3.29
      A2=-0.037
      API=DACOS(-1.0D0)
C
      EN=-ESTEP/2.0D0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      IF(EN.GT.1.0) GO TO 100
      IF(EN.EQ.0.0) QELA=0.161D-16
      IF(EN.EQ.0.0) QMOM=0.161D-16
      IF(EN.EQ.0.0) GO TO 200
      AK=DSQRT(EN/ARY)
      AK2=AK*AK
      AK3=AK2*AK
      AK4=AK3*AK
      AK5=AK4*AK
      AN0=-AA*AK*(1.0+(4.0*APOL/3.0)*AK2*DLOG(AK))-(API*APOL/3.0)*AK2+
     /DD*AK3+FF*AK4
      AN1=((API/15.0)*APOL*AK2-A1*AK3)/(1.0+B1*AK2)
      AN2=API*APOL*AK2/105.0-A2*AK5
      ANHIGH=AN2
      SUM=(DSIN(AN0-AN1))**2
      SUM=SUM+2.0*(DSIN(AN1-AN2))**2
      SIGEL=(DSIN(AN0))**2+3.0*(DSIN(AN1))**2
      DO 10 J=2,LMAX-1
      ANLOW=ANHIGH
      ANHIGH=API*APOL*AK2/((2.*J+5.0)*(2.*J+3.0)*(2.*J+1.0))
      SUMI=6.0/((2.0*J+5.0)*(2.0*J+3.0)*(2.0*J+1.0)*(2.0*J-1.0))
      SUM=SUM+(J+1.0)*(DSIN(API*APOL*AK2*SUMI))**2
      SIGEL=SIGEL+(2.0*J+1.0)*(DSIN(ANLOW))**2
   10 CONTINUE
      QELA=SIGEL*4.0*PIR2/AK2
      QMOM=SUM*4.0*PIR2/AK2
      GO TO 200
  100 CONTINUE
      DO 110 J=2,NEL
      IF(EN.LE.XEL(J)) GO TO 120
  110 CONTINUE
      J=NEL
  120 A=(YEL(J)-YEL(J-1))/(XEL(J)-XEL(J-1))
      B=(XEL(J-1)*YEL(J)-XEL(J)*YEL(J-1))/(XEL(J-1)-XEL(J))
      QELA=(A*EN+B)*1.0D-16
      DO 150 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 160
  150 CONTINUE
      J=NDATA
  160 A=(YXSEC(J)-YXSEC(J-1))/(XEN(J)-XEN(J-1))
      B=(XEN(J-1)*YXSEC(J)-XEN(J)*YXSEC(J-1))/(XEN(J-1)-XEN(J))
      QMOM=(A*EN+B)*1.0D-16
  200 CONTINUE
      PQ1=0.5+(QELA-QMOM)/QELA
      DO 201 J=2,NEPSI
      IF(EN.LE.XEPS(J)) GO TO 202
  201 CONTINUE
      J=NEPSI
  202 A=(YEPS(J)-YEPS(J-1))/(XEPS(J)-XEPS(J-1))
      B=(XEPS(J-1)*YEPS(J)-XEPS(J)*YEPS(J-1))/(XEPS(J-1)-XEPS(J))
      PQ2=A*EN+B
      IF(NANISO.EQ.1) PEQEL(2,I)=PQ1
      IF(NANISO.EQ.2) PEQEL(2,I)=PQ2
      Q(2,I)=QELA
      IF(NANISO.EQ.0) THEN
       Q(2,I)=QMOM
       PEQEL(2,I)=0.5
      ENDIF
C GROSS IONISATION
      Q(3,I)=0.0D0
      PEQEL(3,I)=0.5D0
      IF(NANISO.EQ.2) PEQEL(3,I)=0.0D0
      IF(EN.LE.E(3)) GO TO 230
      IF(EN.GT.XION(NION)) GO TO 221
      DO 210 J=2,NION
      IF(EN.LE.XION(J)) GO TO 220
  210 CONTINUE
      J=NION
  220 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.0D-16
      GO TO 222
C USE BORN BETHE X-SECTION ABOVE XION(NION) EV
  221 GAMMA=(EMASS2+2.0D0*EN)/EMASS2
      BETA=DSQRT(1.0D0-1.0D0/(GAMMA*GAMMA))
      BETA2=BETA*BETA
      AX2=1.0D0/BETA2
      AX1=AX2*DLOG(BETA2/(1.0D0-BETA2))-1.0D0
      Q(3,I)=CONST*(AM2*AX1+C*AX2)/0.955
  222 CONTINUE
C USE ANISOTROPIC SCATTERING FOR PRIMARY IONISATION ELECTRON FOR
C ENERGIES ABOVE 2 * IONISATION ENERGY
C ANISOTROPIC ANGULAR DISTRIBUTION SAME AS ELASTIC AT ENERGY OFF SET BY
C THE IONISATION ENERGY
      IF(EN.LE.(2.0*E(3))) GO TO 230
      PEQEL(3,I)=PEQEL(2,(I-IOFF))
C ATTACHMENT
  230 Q(4,I)=0.0D0
C COUNTING IONISATION
      Q(5,I)=0.0D0
      PEQEL(5,I)=0.5D0
      IF(NANISO.EQ.2) PEQEL(5,I)=0.0D0
      IF(EN.LE.E(3)) GO TO 250
      IF(EN.GT.XION(NION)) GO TO 241
      DO 231 J=2,NION
      IF(EN.LE.XION(J)) GO TO 240
  231 CONTINUE
      J=NION
  240 A=(YINC(J)-YINC(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YINC(J)-XION(J)*YINC(J-1))/(XION(J-1)-XION(J))
      Q(5,I)=(A*EN+B)*1.0D-16
      GO TO 242
C USE BORN BETHE X-SECTION ABOVE XION(NION) EV
  241 Q(5,I)=CONST*(AM2*AX1+C*AX2)
  242 CONTINUE
C USE ANISOTROPIC SCATTERING FOR PRIMARY IONISATION ELECTRON FOR
C ENERGIES ABOVE 2 * IONISATION ENERGY
C ANISOTROPIC ANGULAR DISTRIBUTION SAME AS ELASTIC AT ENERGY OFF SET BY
C THE IONISATION ENERGY
      IF(EN.LE.(2.0D0*E(3))) GO TO 250
      PEQEL(5,I)=PEQEL(2,(I-IOFF))
  250 Q(6,I)=0.0D0
C
      QIN(1,I)=0.0D0
      PEQIN(1,I)=0.5D0
      IF(NANISO.EQ.2) PEQIN(1,I)=0.0D0
      IF(EN.LE.EIN(1)) GO TO 370
      DO 350 J=2,NEXC1
      IF(EN.LE.X1(J)) GO TO 360
  350 CONTINUE
      J=NEXC1
  360 A=(Y1(J)-Y1(J-1))/(X1(J)-X1(J-1))
      B=(X1(J-1)*Y1(J)-X1(J)*Y1(J-1))/(X1(J-1)-X1(J))
      QIN(1,I)=(A*EN+B)*1.0D-16
      IF(EN.LE.(2.0*EIN(1))) GO TO 370
      PEQIN(1,I)=PEQEL(2,(I-IOFF1))
  370 CONTINUE
C
      QIN(2,I)=0.0D0
      PEQIN(2,I)=0.5D0
      IF(NANISO.EQ.2) PEQIN(2,I)=0.0D0
      IF(EN.LE.EIN(2)) GO TO 430
      DO 410 J=2,NEXC2
      IF(EN.LE.X2(J)) GO TO 420
  410 CONTINUE
      J=NEXC2
  420 A=(Y2(J)-Y2(J-1))/(X2(J)-X2(J-1))
      B=(X2(J-1)*Y2(J)-X2(J)*Y2(J-1))/(X2(J-1)-X2(J))
      QIN(2,I)=(A*EN+B)*1.0D-16
      IF(EN.LE.(2.0*EIN(2))) GO TO 430
      PEQIN(2,I)=PEQEL(2,(I-IOFF2))
  430 CONTINUE
C
      QIN(3,I)=0.0D0
      PEQIN(3,I)=0.5D0
      IF(NANISO.EQ.2) PEQIN(3,I)=0.0D0
      IF(EN.LE.EIN(3)) GO TO 460
      DO 440 J=2,NEXC3
      IF(EN.LE.X3(J)) GO TO 450
  440 CONTINUE
      J=NEXC3
  450 A=(Y3(J)-Y3(J-1))/(X3(J)-X3(J-1))
      B=(X3(J-1)*Y3(J)-X3(J)*Y3(J-1))/(X3(J-1)-X3(J))
      QIN(3,I)=(A*EN+B)*1.0D-16
      IF(EN.LE.(2.0*EIN(3))) GO TO 460
      PEQIN(3,I)=PEQEL(2,(I-IOFF3))
  460 CONTINUE
C
      QIN(4,I)=0.0D0
      PEQIN(4,I)=0.5D0
      IF(NANISO.EQ.2) PEQIN(4,I)=0.0D0
      IF(EN.LE.EIN(4)) GO TO 530
      DO 510 J=2,NEXC4
      IF(EN.LE.X4(J)) GO TO 520
  510 CONTINUE
      J=NEXC4
  520 A=(Y4(J)-Y4(J-1))/(X4(J)-X4(J-1))
      B=(X4(J-1)*Y4(J)-X4(J)*Y4(J-1))/(X4(J-1)-X4(J))
      QIN(4,I)=(A*EN+B)*1.0D-16
      IF(EN.LE.(2.0*EIN(4))) GO TO 530
      PEQIN(4,I)=PEQEL(2,(I-IOFF4))
  530 CONTINUE

      QIN(5,I)=0.0D0
      PEQIN(5,I)=0.5D0
      IF(NANISO.EQ.2) PEQIN(5,I)=0.0D0
      IF(EN.LE.EIN(5)) GO TO 560
      DO 540 J=2,NEXC5
      IF(EN.LE.X5(J)) GO TO 550
  540 CONTINUE
      J=NEXC5
  550 A=(Y5(J)-Y5(J-1))/(X5(J)-X5(J-1))
      B=(X5(J-1)*Y5(J)-X5(J)*Y5(J-1))/(X5(J-1)-X5(J))
      QIN(5,I)=(A*EN+B)*1.0D-16
      IF(EN.LE.(2.0*EIN(5))) GO TO 560
      PEQIN(5,I)=PEQEL(2,(I-IOFF5))
  560 CONTINUE
C
      QIN(6,I)=0.0D0
      PEQIN(6,I)=0.5D0
      IF(NANISO.EQ.2) PEQIN(6,I)=0.0D0
      IF(EN.LE.EIN(6)) GO TO 630
      DO 610 J=2,NEXC6
      IF(EN.LE.X6(J)) GO TO 620
  610 CONTINUE
      J=NEXC6
  620 A=(Y6(J)-Y6(J-1))/(X6(J)-X6(J-1))
      B=(X6(J-1)*Y6(J)-X6(J)*Y6(J-1))/(X6(J-1)-X6(J))
      QIN(6,I)=(A*EN+B)*1.0D-16
      IF(EN.LE.(2.0*EIN(6))) GO TO 630
      PEQIN(6,I)=PEQEL(2,(I-IOFF6))
  630 CONTINUE
C
      QIN(7,I)=0.0D0
      PEQIN(7,I)=0.5D0
      IF(NANISO.EQ.2) PEQIN(7,I)=0.0D0
      IF(EN.LE.EIN(7)) GO TO 660
      DO 640 J=2,NEXC7
      IF(EN.LE.X7(J)) GO TO 650
  640 CONTINUE
      J=NEXC7
  650 A=(Y7(J)-Y7(J-1))/(X7(J)-X7(J-1))
      B=(X7(J-1)*Y7(J)-X7(J)*Y7(J-1))/(X7(J-1)-X7(J))
      QIN(7,I)=(A*EN+B)*1.0D-16
      IF(EN.LE.(2.0*EIN(7))) GO TO 660
      PEQIN(7,I)=PEQEL(2,(I-IOFF7))
  660 CONTINUE
C
      QIN(8,I)=0.0D0
      PEQIN(8,I)=0.5D0
      IF(NANISO.EQ.2) PEQIN(8,I)=0.0D0
      IF(EN.LE.EIN(8)) GO TO 730
      DO 710 J=2,NEXC8
      IF(EN.LE.X8(J)) GO TO 720
  710 CONTINUE
      J=NEXC8
  720 A=(Y8(J)-Y8(J-1))/(X8(J)-X8(J-1))
      B=(X8(J-1)*Y8(J)-X8(J)*Y8(J-1))/(X8(J-1)-X8(J))
      QIN(8,I)=(A*EN+B)*1.0D-16
      IF(EN.LE.(2.0*EIN(8))) GO TO 730
      PEQIN(8,I)=PEQEL(2,(I-IOFF8))
  730 CONTINUE
C
      QIN(9,I)=0.0D0
      PEQIN(9,I)=0.5D0
      IF(NANISO.EQ.2) PEQIN(9,I)=0.0D0
      IF(EN.LE.EIN(9)) GO TO 760
      DO 740 J=2,NEXC1
      IF(EN.LE.X9(J)) GO TO 750
  740 CONTINUE
      J=NEXC9
  750 A=(Y9(J)-Y9(J-1))/(X9(J)-X9(J-1))
      B=(X9(J-1)*Y9(J)-X9(J)*Y9(J-1))/(X9(J-1)-X9(J))
      QIN(9,I)=(A*EN+B)*1.0D-16
      IF(EN.LE.(2.0*EIN(9))) GO TO 760
      PEQIN(9,I)=PEQEL(2,(I-IOFF9))
  760 CONTINUE
C
      Q(1,I)=QELA+Q(5,I)+QIN(1,I)+QIN(2,I)+QIN(3,I)+QIN(4,I)+QIN(5,I)+
     /QIN(6,I)+QIN(7,I)+QIN(8,I)+QIN(9,I)
  900 CONTINUE
C  SAVE COMPUTING TIME
      IF(EFINAL.LT.EIN(9)) NIN=8
      IF(EFINAL.LT.EIN(8)) NIN=7
      IF(EFINAL.LT.EIN(7)) NIN=6
      IF(EFINAL.LT.EIN(6)) NIN=5
      IF(EFINAL.LT.EIN(5)) NIN=4
      IF(EFINAL.LT.EIN(4)) NIN=3
      IF(EFINAL.LT.EIN(3)) NIN=2
      IF(EFINAL.LT.EIN(2)) NIN=1
      IF(EFINAL.LT.EIN(1)) NIN=0
      RETURN
      END
      SUBROUTINE GAS6(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      DIMENSION XEN(115),YXSEC(115),XEL(130),YEL(130),
     /XEPS(146),YEPS(146),XION(70),YION(70),YINC(70),
     /XEXC1(105),YEXC1(105),XEXC2(86),YEXC2(86),
     /XEXC3(81),YEXC3(81),XEXC4(73),YEXC4(73)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
C ELASTIC MOMENTUM TRANSFER
      DATA XEN/1.D-6,.001,.003,.005,.007,0.01,.015,0.02,0.03,0.04,
     /0.05,0.06,0.07,0.08,0.09,0.10,0.12,0.14,0.17,0.20,
     /0.25,0.30,0.35,0.40,0.45,0.50,0.52,0.54,0.56,0.60,
     /0.70,0.80,0.90,1.00,1.20,1.40,1.70,2.00,2.50,3.00,
     /3.30,3.60,4.00,4.40,4.80,5.20,5.60,6.00,6.50,7.00,
     /7.50,8.00,9.00,10.0,11.0,12.0,13.0,14.0,15.0,16.0,
     /20.0,30.0,40.0,50.0,60.0,75.0,100.,150.,200.,300.,
     /400.,500.,700.,1000.,1250.,1500.,1750.,2000.,2500.,3000.,
     /3500.,4000.,4500.,5000.,6000.,7000.,8000.,9000.,1.0D4,1.25D4,
     /1.5D4,1.75D4,2.0D4,2.5D4,3.0D4,3.5D4,4.0D4,5.0D4,6.0D4,
     /8.0D4,1.0D5,1.25D5,1.5D5,1.75D5,2.0D5,2.5D5,3.0D5,
     /4.0D5,5.0D5,6.0D5,8.0D5,1.0D6,1.25D6,1.50D6,2.0D6/
      DATA YXSEC/37.4,33.1,30.0,27.9,26.2,24.2,21.6,19.5,16.3,13.9,
     /12.1,10.6,9.30,8.35,7.38,6.65,5.45,4.40,3.25,2.45,
     /1.55,0.92,0.52,0.26,.145,.103,.100,.104,.110,.133,
     /.235,.375,.535,0.74,1.26,1.74,2.55,3.40,4.75,6.35,
     /7.32,8.28,9.51,10.7,11.9,13.2,14.2,15.2,16.2,17.2,
     /17.9,18.4,18.7,18.1,17.2,16.0,14.8,13.6,12.5,11.4,
     /8.18,4.08,2.47,1.71,1.43,1.35,1.30,0.90,0.80,0.64,
     /0.54,0.48,0.41,.340,.270,.222,.183,.154,.113,.0881,
     /.0711,.0591,.0501,.0432,.033,.026,.0212,.0176,.0149,.0104,
     /.00778,.00605,.00486,.00336,.00248,.00192,.00153,.00105,.000773,
     /4.76D-4,3.28D-4,2.26D-4,1.68D-4,1.3D-4,1.05D-4,7.35D-5,5.51D-5,
     /3.53D-5,2.51D-5,1.90D-5,1.25D-5,8.81D-6,6.19D-6,4.68D-6,3.69D-6/
C ELASTIC
      DATA XEL/1.D-6,.001,.003,.005,.007,0.01,.015,0.02,0.03,0.04,
     /0.05,0.06,0.07,0.08,0.09,0.10,0.12,0.14,0.17,0.20,
     /0.25,0.30,0.35,0.40,0.45,0.50,0.55,0.60,0.65,0.70,
     /0.72,0.74,0.76,0.80,0.85,0.90,0.95,1.00,1.10,1.20,
     /1.30,1.40,1.50,1.75,2.00,2.25,2.50,3.00,3.50,4.00,
     /5.00,6.00,7.00,8.00,9.00,10.0,11.0,12.0,13.0,14.0,
     /15.0,16.0,18.0,20.0,22.5,25.0,27.5,30.0,35.0,40.0,
     /45.0,50.0,60.0,70.0,80.0,90.0,100.,125.,150.,175.,
     /200.,250.,300.,400.,500.,600.,700.,800.,1000.,1200.,
     /1500.,1800.,2000.,2500.,3000.,3500.,4000.,4500.,5000.,5500.,
     /6.0D3,7.0D3,8.0D3,1.0D4,1.25D4,1.5D4,1.75D4,2.0D4,2.5D4,3.0D4,
     /3.5D4,4.0D4,5.0D4,6.0D4,8.0D4,1.0D5,1.25D5,1.5D5,1.75D5,2.0D5,
     /2.5D5,3.0D5,4.0D5,5.0D5,6.0D5,8.0D5,1.0D6,1.25D6,1.5D6,2.0D6/
      DATA YEL/37.4,34.6,31.8,29.9,28.4,26.6,24.1,22.2,19.1,16.8,
     /14.9,13.4,12.1,11.0,10.0,9.15,7.71,6.56,5.21,4.38,
     /3.22,2.31,1.75,1.30,1.04,0.83,0.65,0.57,0.50,0.46,
     /0.45,0.44,0.45,0.46,0.48,0.53,0.60,0.67,0.85,1.07,
     /1.32,1.54,1.84,2.23,3.02,3.83,4.68,6.36,8.24,10.1,
     /14.1,18.5,22.0,25.0,26.2,27.2,27.6,27.5,26.8,26.3,
     /24.9,23.7,22.4,21.0,19.4,17.4,15.9,15.0,13.2,11.6,
     /10.8,9.84,8.98,8.20,7.36,6.55,5.86,5.07,4.37,4.07,
     /3.80,3.55,3.28,2.87,2.63,2.42,2.22,2.10,1.93,1.75,
     /1.57,1.44,1.38,1.31,1.13,1.05,.954,.890,.829,.800,
     /.745,.668,.617,.526,.450,.396,.354,.321,.272,.237,
     /.211,.191,.161,.141,.114,.0973,.0836,.0743,.0676,.0625,
     /.0554,.0507,.0448,.0414,.0392,.0365,.0350,.0338,.0331,.0323/
C ELASTIC ANGULAR DISTRIBUTION (EPSILON)
      DATA XEPS/0.00,.001,.003,.005,.007,.010,.015,.020,.030,.040,
     /0.05,0.06,0.07,0.08,0.09,0.10,0.12,0.14,0.17,0.20,
     /0.25,0.30,0.35,0.40,0.45,0.50,0.52,0.54,0.55,0.56,
     /0.60,0.65,0.70,0.72,0.74,0.76,0.80,0.85,0.90,0.95,
     /1.00,1.10,1.20,1.30,1.40,1.50,1.70,1.75,2.00,
     /2.25,2.50,3.00,3.30,3.50,3.60,4.00,4.40,4.80,5.00,
     /5.20,5.60,6.00,6.50,7.00,7.50,8.00,9.00,10.0,11.0,
     /12.0,13.0,14.0,15.0,16.0,18.0,20.0,22.5,25.0,27.5,
     /30.0,35.0,40.0,45.0,50.0,60.0,70.0,75.0,80.0,90.0,
     /100.,125.,150.,175.,200.,250.,300.,400.,500.,600.,
     /700.,800.,1000.,1200.,1250.,1500.,1750.,1800.,2000.,2500.,
     /3000.,3500.,4000.,4500.,5000.,5500.,6000.,7000.,8000.,9000.,
     /1.0D4,1.25D4,1.5D4,1.75D4,2.0D4,2.5D4,3.0D4,3.5D4,4.0D4,5.0D4,
     /6.0D4,8.0D4,1.0D5,1.25D5,1.5D5,1.75D5,2.0D5,2.5D5,
     /3.0D5,4.0D5,5.0D5,6.0D5,8.0D5,1.0D6,1.25D6,1.5D6,
     /2.0D6/
      DATA YEPS/.0,.065,.0848,.1001,.1159,.1348,.1548,.1754,.2178,.2555,
     /.2775,.3074,.3389,.3521,.3812,.3965,.4232,.4708,.5302,.6072,
     /.6925,.7733,.8566,.9208,.9528,.9599,.9557,.9464,.9403,.9354,
     /.9006,.8090,.6613,.5873,.4988,.4371,.2730,.0927,-.0141,-.0796,
     /-.156,-.2226,-.2626,-.1918,-.1933,-.1243,-.2739,-.3010,-.1874,
     /-.0888,-.0224,.0024,.0289,.0517,.0561,.0875,.1220,.1541,.1640,
     /.1745,.2216,.2638,.2941,.3204,.3485,.3839,.4140,.4776,.5310,
     /.5810,.6154,.6545,.6708,.6929,.7465,.7811,.8193,.8388,.8559,
     /.8747,.8987,.9132,.9275,.9354,.9430,.9387,.9353,.9310,.9201,
     /.9078,.9151,.9173,.9163,.9146,.9212,.9237,.9276,.9307,.9309,
     /.9295,.9310,.9342,.9422,.9440,.9519,.9593,.9606,.9654,.9756,
     /.9787,.9823,.9843,.9861,.9874,.9890,.9910,.9914,.9926,.9935,
     /.9942,.9955,.9963,.9969,.9973,.9977,.9983,.9985,.99874,.999016,
     /.999197,.999415,.999544,.999646,.999712,.999760,.999795,.999843,
     /.999875,.999913,.999935,.999949,.999965,.999975,.999983,.999987,
     /.999990/
C IONISATION ( VALUES ABOVE 2OKEV GENERATED BY BORN BETHE IN SUB)
      DATA XION/13.996,14.5,15.0,15.5,16.0,16.5,17.0,17.5,18.0,18.5,
     /19.0,19.5,20.0,21.0,22.0,23.0,24.0,26.0,28.0,30.0,
     /32.0,34.0,36.0,38.0,40.0,45.0,50.0,55.0,60.0,65.0,
     /70.0,80.0,90.0,100.,120.,140.,160.,180.,200.,250.,
     /300.,400.,500.,600.,700.,800.,900.,1000.,1200.,1400.,
     /1600.,1800.,2000.,2500.,3000.,3500.,4000.,4500.,5000.,5500.,
     /6000.,7000.,8000.,9000.,10000.,12000.,14000.,16000.,18000.,20000./
C GROSS IONISATION
      DATA YION/0.00,.078,.160,.255,.360,.450,.552,.655,.766,.878,
     /.980,1.09,1.20,1.34,1.53,1.63,1.84,2.19,2.43,2.66,
     /2.86,3.02,3.15,3.27,3.37,3.55,3.73,3.86,3.96,4.06,
     /4.09,4.15,4.13,4.09,3.97,3.79,3.63,3.47,3.34,3.02,
     /2.76,2.37,2.07,1.86,1.69,1.53,1.42,1.31,1.15,1.03,
     /.930,.854,.781,.667,.579,.510,.458,.415,.387,.356,
     /.332,.293,.264,.240,.219,.190,.167,.150,.138,.126/
C COUNTING IONISATION
      DATA YINC/0.00,.078,.160,.255,.360,.450,.552,.655,.766,.878,
     /.980,1.09,1.20,1.34,1.53,1.63,1.84,2.19,2.43,2.66,
     /2.86,3.02,3.15,3.27,3.37,3.53,3.64,3.72,3.77,3.83,
     /3.83,3.84,3.81,3.76,3.62,3.46,3.31,3.17,3.05,2.75,
     /2.50,2.12,1.84,1.65,1.49,1.34,1.25,1.14,.995,.886,
     /.795,.726,.664,.567,.492,.434,.389,.353,.329,.303,
     /.282,.249,.224,.204,.186,.162,.142,.128,.117,.107/
C EXCITATION TO FIRST 4 S STATES
      DATA XEXC1/9.915,9.92,9.93,9.94,9.95,9.96,9.98,10.0,10.02,10.04,
     /10.06,10.08,10.09,10.1,10.11,10.12,10.13,10.14,10.15,10.16,
     /10.17,10.18,10.19,10.2,10.25,10.3,10.4,10.5,10.6,10.7,
     /10.8,10.9,11.0,11.3,11.6,11.8,12.0,12.5,13.0,13.5,
     /14.0,14.5,15.0,15.5,16.0,17.0,18.0,19.0,20.0,22.0,
     /24.0,27.0,30.0,33.0,36.0,40.0,44.0,50.0,54.0,60.0,
     /70.0,80.0,90.0,100.,120.,140.,170.,200.,240.,280.,
     /320.,360.,400.,450.,500.,600.,700.,800.,1000.,1400.,
     /2000.,2400.,3000.,4000.,5000.,6000.,8000.,10000.,12000.,14000.,
     /17000.,20000.,30000.,40000.,50000.,60000.,80000.,100000.,
     /200000.,300000.,400000.,500000.,1000000.,1500000.,2000000./
      DATA YEXC1/0.00,
     /.00033,.00103,.00173,.00242,.00310,.00445,.00578,.00709,.00856,
     /.0105,.0127,.0152,.0217,.0372,.0640,.0937,.108,.0971,.0697,
     /.0443,.0300,.0250,.0244,.0287,.0333,.0422,.0507,.0593,.0697,
     /.081,.092,.103,.132,.158,.173,.188,.219,.244,.265,
     /.282,.296,.308,.318,.326,.338,.347,.353,.357,.361,
     /.361,.357,.351,.343,.335,.324,.314,.299,.289,.276,
     /.256,.239,.225,.212,.190,.173,.153,.138,.122,.110,
     /.0998,.0918,.0850,.0780,.0722,.0630,.0561,.0506,.0426,.0327,
     /.0246,.0212,.0177,.0140,.0116,.0100,.0079,.0066,.00563,.00496,
     /.00422,.0037,.00266,.00212,.00179,.00156,.00126,.00109,
     /.00072,.00060,.000542,.000510,.000463,.000461,.000466/
C EXCITATION TO NEXT GROUP OF P STATES
      DATA XEXC2/11.304,11.35,11.4,11.45,11.5,11.6,11.7,11.8,11.9,12.0,
     /12.1,12.2,12.3,12.4,12.5,12.6,12.7,12.8,12.9,13.0,
     /13.5,14.0,14.5,15.0,15.5,16.0,17.0,18.0,19.0,20.0,
     /22.0,24.0,27.0,30.0,33.0,36.0,40.0,44.0,50.0,54.0,
     /60.0,70.0,80.0,90.0,100.,120.,140.,170.,200.,240.,
     /280.,320.,360.,400.,450.,500.,600.,700.,800.,1000.,
     /1400.,2000.,2400.,3000.,4000.,5000.,6000.,8000.,10000.,
     /12000.,14000.,17000.,20000.,30000.,40000.,50000.,60000.,
     /80000.,100000.,200000.,300000.,400000.,500000.,1000000.,
     /1500000.,2000000./
      DATA YEXC2/0.0,
     /.00073,.00151,.0026,.0059,.0141,.0225,.0304,.0381,.0454,
     /.0523,.0589,.0653,.0713,.0771,.0826,.0878,.0928,.0976,.102,
     /.122,.137,.150,.159,.166,.171,.177,.180,.179,.177,
     /.170,.161,.147,.134,.122,.112,.101,.0911,.0797,.0735,
     /.0659,.0563,.0492,.0439,.0397,.0335,.0291,.0245,.0214,.0183,
     /.0161,.0145,.0132,.0121,.0110,.0101,.0087,.0077,.0069,.0058,
     /.00443,.00332,.00286,.00238,.00188,.00156,.00135,.00106,.000881,
     /.000758,.000667,.000568,.000498,.000359,.000286,.000241,.000210,
     /.000171,.000146,.0000971,.0000809,.0000732,.0000689,.0000626,
     /.0000624,.0000632/
C EXCITATION TO GROUP OF S  P AND D STATES ABOVE 12 EV
      DATA XEXC3/11.998,12.05,12.1,12.2,12.3,12.4,12.5,12.6,12.7,12.8,
     /12.9,13.0,13.2,13.4,13.6,13.8,14.0,14.5,15.0,15.5,
     /16.0,17.0,18.0,19.0,20.0,22.0,24.0,27.0,30.0,33.0,
     /36.0,40.0,44.0,50.0,54.0,60.0,70.0,80.0,90.0,100.,
     /120.,140.,170.,200.,240.,280.,320.,360.,400.,450.,
     /500.,600.,700.,800.,1000.,1400.,2000.,2400.,3000.,4000.,
     /5000.,6000.,8000.,10000.,12000.,14000.,17000.,20000.,30000.,
     /40000.,50000.,60000.,80000.,100000.,200000.,300000.,400000.,
     /500000.,1000000.,1500000.,2000000./
      DATA YEXC3/0.0,
     /.0014,.0027,.0170,.0308,.0441,.0570,.0696,.0818,.0937,
     /.105,.116,.138,.158,.177,.195,.212,.250,.282,.308,
     /.331,.365,.388,.403,.412,.416,.411,.394,.373,.352,
     /.331,.307,.285,.257,.242,.222,.195,.175,.159,.146,
     /.126,.111,.0955,.0841,.0729,.0647,.0583,.0532,.0490,.0448,
     /.0412,.0358,.0317,.0285,.0239,.0183,.0137,.0118,.00986,.00779,
     /.00648,.00558,.00440,.00365,.00314,.00277,.00236,.00207,.00149,
     /.00119,.00100,.00872,.00709,.000608,.000404,.0003360,.000304,
     /.000287,.000261,.000260,.000263/
C EXCIATION OF ALL STATES ABOVE 12.75 EV
      DATA XEXC4/12.75,12.8,12.9,13.0,13.2,13.4,13.6,13.8,14.0,14.5,
     /15.0,15.5,16.0,17.0,18.0,19.0,20.0,22.0,24.0,27.0,
     /30.0,33.0,36.0,40.0,44.0,50.0,54.0,60.0,70.0,80.0,
     /90.0,100.,120.,140.,170.,200.,240.,280.,320.,360.,
     /400.,450.,500.,600.,700.,800.,1000.,1400.,2000.,2400.,
     /3000.,4000.,5000.,6000.,8000.,10000.,12000.,14000.,17000.,20000.,
     /30000.,40000.,50000.,60000.,80000.,100000.,
     /200000.,300000.,400000.,500000.,1000000.,1500000.,2000000./
      DATA YEXC4/0.0,
     /.00005,.000455,.00124,.00388,.00780,.0129,.0189,.0259,.0465,
     /.0705,.097,.125,.184,.243,.300,.354,.453,.536,.637,
     /.712,.768,.809,.846,.868,.884,.887,.883,.864,.838,
     /.809,.780,.725,.676,.612,.560,.503,.458,.420,.389,
     /.362,.334,.311,.273,.244,.221,.187,.145,.110,.0948,
     /.0793,.0628,.0524,.0451,.0356,.0296,.0255,.0225,.0192,.0168,
     /.0121,.00965,.00813,.00710,.00577,.00495,
     /.00329,.00274,.00248,.00234,.00212,.00212,.00214/
C----------------------------------------------------------------------
      IF(NANISO.EQ.0) THEN
       NAME='KRYPTN ISO 2007'
      ELSE
       NAME='KRYPTN ANI 2007'
      ENDIF
C
C --------------------------------------------------------------------
C  DATA ON KRYPTON NOT AS GOOD AS ARGON . FIT TO HUNTERS DRIFT VELOCITY
C  AND DIFFUSION OF KOZUMI .TOWNSEND COEFFICIENT
C   OF KRUITOFF,HEYLEN AND BHATTACHYRA CONSISENT SO AVERAGED AND GOOD
C   AGREEMENT OBTAINED WITH CALCULATED VALUES.
C 2007: INCREASED UPPER ENERGY LIMIT TO 2MEV
C 2007: INCLUDED NEW ANGULAR DISTRIBUTION FUNCTION
C 2007: INCLUDED PENNING TRANSFER FRACTION
C --------------------------------------------------------------------
C
C  BORN BETHE VALUES FOR IONISATION
      CONST=1.873884D-20
      EMASS2=1021997.804
      AM2=5.50
      C=56.90
C
      NIN=4
      DO 1 J=1,6
    1 KEL(J)=NANISO
      DO 2 J=1,NIN
    2 KIN(J)=NANISO
C
      NEL=130
      NDATA=115
      NEPSI=146
      NION=70
      NEXC1=105
      NEXC2=86
      NEXC3=81
      NEXC4=73
      E(1)=0.0
      E(2)=2.0*EMASS/(83.80*AMU)
      E(3)=13.996
C EXCITATION X-SECTION AT 1.5MEV
      E(4)=0.2903D-18
C  IONISING X-SECTION AT 1.5MEV
      E(5)=0.133D-17
C EOBY AT MINIMUM IONISING
      E(6)=21.0
C EOBY AT LOW ENERGY
      EOBY=9.6
      IOFF=IFIX(SNGL(0.5+E(3)/ESTEP))
      EIN(1)=9.915
      EIN(2)=11.304
      EIN(3)=11.998
      EIN(4)=12.75
C**********************************************************************
C ENTER PENNING TRANSFER FRACTION FOR EACH LEVEL
C USE PENNING TRANSFER FRACTION BETWEEN 0.0 AND 0.2
      PENFRA(1,1)=0.0
      PENFRA(1,2)=0.0
      PENFRA(1,3)=0.0
      PENFRA(1,4)=0.0
C PENNING TRANSFER DISTANCE MICRONS
      PENFRA(2,1)=1.0
      PENFRA(2,2)=1.0
      PENFRA(2,3)=1.0
      PENFRA(2,4)=1.0
C PENNING TRANSFER TIME
      PENFRA(3,1)=1.0
      PENFRA(3,2)=1.0
      PENFRA(3,3)=1.0
      PENFRA(3,4)=1.0
C**********************************************************************
      IF(IPEN.EQ.0) GO TO 4
      DO 3 KDUM=1,NIN
      IF(PENFRA(1,KDUM).EQ.0.0) GO TO 3
      WRITE(6,999) NAME,EIN(KDUM),PENFRA(1,KDUM),PENFRA(2,KDUM),
     /PENFRA(3,KDUM)
  999 FORMAT(' GAS = ',A15,' ENERGY LEVEL = ',F7.4,' EV.',/,' PENNING PR
     /OBABILITY =',F5.3,' ABS.LENGTH =',F7.2,' DECAY TIME =',F7.1,/)
    3 CONTINUE
    4 IOFF1=IFIX(SNGL(0.5+EIN(1)/ESTEP))
      IOFF2=IFIX(SNGL(0.5+EIN(2)/ESTEP))
      IOFF3=IFIX(SNGL(0.5+EIN(3)/ESTEP))
      IOFF4=IFIX(SNGL(0.5+EIN(4)/ESTEP))
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC (ANIS)  KRYPTON      '
      IF(NANISO.EQ.0) THEN
      SCRPT(2)=' ELASTIC (ISO)   KRYPTON      '
      ENDIF
      SCRPT(3)=' IONISATION    ELOSS= 13.996  '
      SCRPT(4)='                              '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' EXC S-LEVELS  ELOSS=  9.915  '
      SCRPT(8)=' EXC P-LEVELS  ELOSS= 11.304  '
      SCRPT(9)=' EXC D+P-LVLS  ELOSS= 11.998  '
      SCRPT(10)=' EXC HIGHER    ELOSS= 12.75   '
      EN=-ESTEP/2.0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      IF(EN.EQ.0.0) THEN
       QELA=37.8D-16
       QMOM=37.8D-16
       GO TO 200
      ENDIF
      DO 110 J=2,NEL
      IF(EN.LE.XEL(J)) GO TO 120
  110 CONTINUE
      J=NEL
C USE LOG INTERPOLATION
  120 Y1=DLOG(YEL(J-1))
      Y2=DLOG(YEL(J))
      X1=DLOG(XEL(J-1))
      X2=DLOG(XEL(J))
      A=(Y2-Y1)/(X2-X1)
      B=(X1*Y2-X2*Y1)/(X1-X2)
      QELA=DEXP((A*DLOG(EN)+B))*1.0D-16
      DO 150 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 160
  150 CONTINUE
      J=NDATA
C USE LOG INTERPOLATION
  160 Y1=DLOG(YXSEC(J-1))
      Y2=DLOG(YXSEC(J))
      X1=DLOG(XEN(J-1))
      X2=DLOG(XEN(J))
      A=(Y2-Y1)/(X2-X1)
      B=(X1*Y2-X2*Y1)/(X1-X2)
      QMOM=DEXP((A*DLOG(EN)+B))*1.0D-16
  200 CONTINUE
      PQ1=0.5+(QELA-QMOM)/QELA
      DO 201 J=2,NEPSI
      IF(EN.LE.XEPS(J)) GO TO 202
  201 CONTINUE
      J=NEPSI
  202 A=(YEPS(J)-YEPS(J-1))/(XEPS(J)-XEPS(J-1))
      B=(XEPS(J-1)*YEPS(J)-XEPS(J)*YEPS(J-1))/(XEPS(J-1)-XEPS(J))
      PQ2=A*EN+B
      IF(NANISO.EQ.1) PEQEL(2,I)=PQ1
      IF(NANISO.EQ.2) PEQEL(2,I)=PQ2
      Q(2,I)=QELA
      IF(NANISO.EQ.0) THEN
       Q(2,I)=QMOM
       PEQEL(2,I)=0.5
      ENDIF
C  GROSS IONISATION X-SECTION
      Q(3,I)=0.0
      PEQEL(3,I)=0.5D0
      IF(NANISO.EQ.2) PEQEL(3,I)=0.0D0
      IF(EN.LE.E(3)) GO TO 230
      IF(EN.GT.XION(NION)) GO TO 221
      DO 210 J=2,NION
      IF(EN.LE.XION(J)) GO TO 220
  210 CONTINUE
      J=NION
  220 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.0D-16
      GO TO 222
C USE BORN BETHE ABOVE XION(NION) EV.
  221 GAMMA=(EMASS2+2.0D0*EN)/EMASS2
      BETA=DSQRT(1.0D0-1.0D0/(GAMMA*GAMMA))
      BETA2=BETA*BETA
      X2=1.0D0/BETA2
      X1=X2*DLOG(BETA2/(1.0D0-BETA2))-1.0D0
      Q(3,I)=CONST*(AM2*X1+C*X2)/0.85
  222 CONTINUE
C USE ANISOTROPIC SCATTERING FOR PRIMARY IONISATION ELECTRON FOR
C ENERGIES ABOVE 2 * IONISATION ENERGY
C ANISOTROPIC DISTRIBUTION SAME AS ELASTIC AT ENERGY OFFSET BY
C IONISATION ENERGY
      IF(EN.LE.(2.0*E(3))) GO TO 230
      PEQEL(3,I)=PEQEL(2,(I-IOFF))
C  ATTACHMENT
  230 CONTINUE
      Q(4,I)=0.0
C COUNTING IONISATION
      Q(5,I)=0.0
      PEQEL(5,I)=0.5D0
      IF(NANISO.EQ.2) PEQEL(5,I)=0.0D0
      IF(EN.LE.E(3)) GO TO 250
      IF(EN.GT.XION(NION)) GO TO 241
      DO 231 J=2,NION
      IF(EN.LE.XION(J)) GO TO 240
  231 CONTINUE
      J=NION
  240 A=(YINC(J)-YINC(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YINC(J)-XION(J)*YINC(J-1))/(XION(J-1)-XION(J))
      Q(5,I)=(A*EN+B)*1.D-16
      GO TO 242
C USE BORN BETHE X-SECTION ABOVE XION(NION) EV.
  241 Q(5,I)=CONST*(AM2*X1+C*X2)
  242 CONTINUE
C USE ANISOTROPIC SCATTERING FOR PRIMARY IONISATION ELECTRON FOR
C ENERGIES ABOVE 2 * IONISATION ENERGY
C ANISOTROPIC DISTRIBUTION SAME AS ELASTIC AT ENERGY OFFSET BY
C IONISATION ENERGY
      IF(EN.LE.(2.0*E(3))) GO TO 250
      PEQEL(5,I)=PEQEL(2,(I-IOFF))
  250 Q(6,I)=0.0
C EXCITATION TO FIRST FOUR 5S-LEVELS
      QIN(1,I)=0.0
      PEQIN(1,I)=0.5D0
      IF(NANISO.EQ.2) PEQIN(1,I)=0.0D0
      IF(EN.LE.EIN(1)) GO TO 370
      DO 350 J=2,NEXC1
      IF(EN.LE.XEXC1(J)) GO TO 360
  350 CONTINUE
      J=NEXC1
  360 A=(YEXC1(J)-YEXC1(J-1))/(XEXC1(J)-XEXC1(J-1))
      B=(XEXC1(J-1)*YEXC1(J)-XEXC1(J)*YEXC1(J-1))/(XEXC1(J-1)-XEXC1(J))
      QIN(1,I)=(A*EN+B)*1.0D-16
      IF(EN.LE.(2.0*EIN(1))) GO TO 370
      PEQIN(1,I)=PEQEL(2,(I-IOFF1))
  370 CONTINUE
C  EXCITATION TO 5P-LEVELS
      QIN(2,I)=0.0
      PEQIN(2,I)=0.5D0
      IF(NANISO.EQ.2) PEQIN(2,I)=0.0D0
      IF(EN.LE.EIN(2)) GO TO 470
      DO 450 J=2,NEXC2
      IF(EN.LE.XEXC2(J)) GO TO 460
  450 CONTINUE
      J=NEXC2
  460 A=(YEXC2(J)-YEXC2(J-1))/(XEXC2(J)-XEXC2(J-1))
      B=(XEXC2(J-1)*YEXC2(J)-XEXC2(J)*YEXC2(J-1))/(XEXC2(J-1)-XEXC2(J))
      QIN(2,I)=(A*EN+B)*1.0D-16
      IF(EN.LE.(2.0*EIN(2))) GO TO 470
      PEQIN(2,I)=PEQEL(2,(I-IOFF2))
  470 CONTINUE
C EXCITATION TO 5D + 4D + 5P' LEVELS (UP TO 12.5 EV)
      QIN(3,I)=0.0
      PEQIN(3,I)=0.5D0
      IF(NANISO.EQ.2) PEQIN(3,I)=0.0D0
      IF(EN.LE.EIN(3)) GO TO 570
      DO 550 J=2,NEXC3
      IF(EN.LE.XEXC3(J)) GO TO 560
  550 CONTINUE
      J=NEXC3
  560 A=(YEXC3(J)-YEXC3(J-1))/(XEXC3(J)-XEXC3(J-1))
      B=(XEXC3(J-1)*YEXC3(J)-XEXC3(J)*YEXC3(J-1))/(XEXC3(J-1)-XEXC3(J))
      QIN(3,I)=(A*EN+B)*1.0D-16
      IF(EN.LE.(2.0*EIN(3))) GO TO 570
      PEQIN(3,I)=PEQEL(2,(I-IOFF3))
  570 CONTINUE
C  EXCITATION TO ALL LEVELS ABOVE 12.75 EV.
      QIN(4,I)=0.0
      PEQIN(4,I)=0.5D0
      IF(NANISO.EQ.2) PEQIN(4,I)=0.0D0
      IF(EN.LE.EIN(4)) GO TO 670
      DO 650 J=2,NEXC4
      IF(EN.LE.XEXC4(J)) GO TO 660
  650 CONTINUE
      J=NEXC4
  660 A=(YEXC4(J)-YEXC4(J-1))/(XEXC4(J)-XEXC4(J-1))
      B=(XEXC4(J-1)*YEXC4(J)-XEXC4(J)*YEXC4(J-1))/(XEXC4(J-1)-XEXC4(J))
      QIN(4,I)=(A*EN+B)*1.0D-16
      IF(EN.LE.(2.0*EIN(4))) GO TO 670
      PEQIN(4,I)=PEQEL(2,(I-IOFF4))
  670 CONTINUE
      Q(1,I)=QELA+Q(5,I)+QIN(1,I)+QIN(2,I)+QIN(3,I)+QIN(4,I)
  900 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LT.EIN(4)) NIN=3
      IF(EFINAL.LT.EIN(3)) NIN=2
      IF(EFINAL.LT.EIN(2)) NIN=1
      IF(EFINAL.LT.EIN(1)) NIN=0
      RETURN
      END
      SUBROUTINE GAS7(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      DIMENSION XEN(139),YXSEC(139),XION(76),YION(76),YINC(76)
      DIMENSION XEXC1(104),YEXC1(104),XEXC2(82),YEXC2(82),XEXC3(73)
      DIMENSION YEXC3(73),XEXC4(68),YEXC4(68),XEL(131),YEL(131)
      DIMENSION XEPS(139),YEPS(139)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
C   ELASTIC MOMENTUM TRANSFER
      DATA XEN/0.00,.001,.005,.007,0.01,.015,0.02,.025,0.03,0.04,
     /0.05,0.06,0.07,0.08,0.10,0.12,0.14,0.17,0.20,0.25,
     /0.27,0.30,0.32,0.35,0.37,0.40,0.42,0.44,0.46,0.48,
     /0.50,0.51,0.52,0.53,0.54,0.55,0.56,0.57,0.58,0.59,
     /0.60,0.61,0.62,0.63,0.64,0.65,0.66,0.67,0.68,0.69,
     /0.70,.715,0.73,0.75,0.77,0.80,0.83,0.85,0.87,0.90,
     /1.00,1.08,1.14,1.20,1.30,1.40,1.50,1.70,2.00,2.50,
     /3.00,3.50,4.00,4.50,5.00,5.50,6.00,6.50,7.00,8.00,
     /9.00,10.0,12.0,15.0,18.0,20.0,25.0,30.0,40.0,50.0,
     /60.0,70.0,80.0,90.0,100.,125.,150.,200.,250.,300.,
     /400.,500.,600.,700.,800.,1000.,1500.,2000.,3000.,4000.,
     /5000.,6000.,8000.,1.0D4,1.5D4,2.0D4,3.0D4,4.0D4,5.0D4,6.0D4,
     /8.0D4,1.0D5,1.25D5,1.5D5,1.75D5,2.0D5,2.5D5,3.0D5,3.5D5,4.0D5,
     /4.5D5,5.0D5,6.0D5,7.0D5,8.0D5,9.0D5,1.0D6,1.5D6,2.0D6/
      DATA YXSEC/131.,115.,97.0,91.1,83.9,74.6,67.3,61.2,56.1,47.9,
     /41.4,36.2,31.8,28.2,22.5,18.1,14.8,11.1,8.36,5.33,
     /4.47,3.43,2.88,2.22,1.86,1.43,1.20,1.01,.844,.708,
     /.596,.548,.504,.465,.430,.399,.372,.348,.328,.310,
     /.296,.285,.276,.270,.266,.265,.266,.270,.276,.287,
     /.306,.341,.377,.427,.479,.562,.651,.713,.778,.880,
     /1.26,1.62,1.92,2.25,2.85,3.51,4.22,5.73,7.97,11.8,
     /15.8,20.4,24.4,28.0,30.7,31.5,32.3,31.6,31.0,27.5,
     /22.8,18.5,14.0,9.71,7.73,6.72,5.35,4.43,3.42,2.81,
     /2.42,2.17,2.00,1.89,1.80,1.73,1.65,1.34,1.15,1.05,
     /0.95,0.86,0.75,0.69,0.63,0.56,0.38,0.26,.155,.105,
     /.076,.059,.038,.027,.0148,.0094,.0050,.0031,.0022,.00163,
     /.001024,.000714,.000498,.000372,.000291,.000236,.000166,.000125,
     /.000099,.0000808,.0000676,.0000577,.0000438,.0000348,.0000285,
     /.0000239,.0000204,.0000108,.00000691/
C ELASTIC TOTAL
      DATA XEL/0.00,.001,.005,.007,0.01,.015,0.02,.025,0.03,0.04,
     /0.05,0.06,0.07,0.08,0.10,0.12,0.14,0.17,0.20,0.25,
     /0.27,0.30,0.32,0.35,0.37,0.40,0.42,0.44,0.46,0.48,
     /0.50,0.51,0.52,0.53,0.54,0.55,0.56,0.57,0.58,0.59,
     /0.60,0.61,0.62,0.63,0.64,0.65,0.66,0.67,0.68,0.69,
     /0.70,0.75,0.80,0.85,0.90,1.00,1.20,1.50,1.75,2.00,
     /2.50,2.75,3.00,3.75,4.00,4.50,5.00,5.50,6.00,6.50,
     /7.00,8.00,9.00,10.0,12.0,15.0,18.0,20.0,25.0,30.0,
     /40.0,50.0,60.0,70.0,80.0,90.0,100.,125.,150.,200.,
     /250.,300.,400.,500.,600.,700.,800.,1000.,1500.,2000.,
     /3000.,4000.,5000.,6000.,8000.,1.0D4,1.5D4,2.0D4,3.0D4,4.0D4,
     /5.0D4,6.0D4,8.0D4,1.0D5,1.25D5,1.5D5,1.75D5,2.0D5,2.5D5,3.0D5,
     /3.5D5,4.0D5,4.5D5,5.0D5,6.0D5,7.0D5,8.0D5,9.0D5,1.0D6,1.5D6,
     /2.0D6/
      DATA YEL/131.,117.,101.,95.4,88.8,80.1,73.3,67.5,62.6,54.7,
     /48.4,43.2,38.8,35.2,29.4,24.7,21.2,17.1,14.0,10.3,
     /9.10,7.75,6.94,5.95,5.40,4.50,4.25,3.95,3.65,3.45,
     /3.20,3.11,3.00,2.90,2.79,2.69,2.59,2.48,2.37,2.25,
     /2.14,2.02,1.92,1.80,1.69,1.58,1.48,1.40,1.32,1.28,
     /1.26,1.24,1.30,1.45,1.50,1.87,2.80,4.76,6.68,8.85,
     /13.7,16.3,18.7,24.5,29.0,32.7,36.8,39.3,41.7,41.7,
     /41.8,41.8,40.9,39.9,37.3,34.1,32.2,30.7,22.0,13.9,
     /8.27,6.63,5.76,5.42,5.36,5.20,5.01,4.72,4.65,4.65,
     /4.58,4.40,4.14,3.79,3.61,3.32,3.14,2.82,2.30,2.08,
     /1.72,1.47,1.26,1.11,.937,.817,.632,.523,.397,.326,
     /.279,.246,.203,.175,.152,.136,.124,.116,.103,.0946,
     /.0886,.0841,.0807,.0779,.0739,.0711,.0690,.0674,.0662,.0627,
     /.0612/
C ELASTIC ANGULAR DISTRIBUTION ( EPSILON)
      DATA XEPS/0.00,.001,.005,.007,.010,.015,.020,.025,.030,.040,
     /0.05,0.06,0.07,0.08,0.10,0.12,0.14,0.17,0.20,0.25,
     /0.27,0.30,0.32,0.35,0.37,0.40,0.42,0.44,0.46,0.48,
     /0.50,0.51,0.52,0.53,0.54,0.55,0.56,0.57,0.58,0.59,
     /0.60,0.61,0.62,0.63,0.64,0.65,0.66,0.67,0.68,0.69,
     /0.70,0.71,0.72,0.73,0.75,0.77,0.80,0.83,0.85,0.87,
     /0.90,1.00,1.10,1.20,1.30,1.40,1.50,1.70,2.00,2.50,
     /3.00,3.50,4.00,4.50,5.00,5.50,6.00,6.50,7.00,8.00,
     /9.00,10.0,12.0,15.0,18.0,20.0,25.0,30.0,40.0,50.0,
     /60.0,70.0,80.0,90.0,100.,120.,150.,200.,250.,300.,
     /400.,500.,600.,700.,800.,1000.,1500.,2000.,3000.,4000.,
     /5000.,6000.,8000.,10000.,15000.,2.0D4,3.0D4,4.0D4,5.0D4,6.0D4,
     /8.0D4,1.0D5,1.25D5,1.5D5,1.75D5,2.0D5,2.5D5,3.0D5,3.5D5,4.0D5,
     /4.5D5,5.0D5,6.0D5,7.0D5,8.0D5,9.0D5,1.0D6,1.5D6,2.0D6/
      DATA YEPS/.0,.0256,.0594,.0675,.0827,.1028,.1224,.1394,.155,.1852,
     /.2149,.2402,.2667,.2931,.3435,.3883,.4349,.4985,.5627,.6541,
     /.6823,.7316,.7579,.7956,.8197,.8410,.8674,.8859,.9019,.9178,
     /.9286,.9341,.9385,.9425,.9456,.9485,.9508,.9524,.9533,.9536,
     /.9533,.9520,.9507,.9477,.9440,.9386,.9322,.9249,.9155,.9063,
     /.8944,.8817,.8679,.8529,.8198,.7905,.7415,.7056,.6817,.6412,
     /.5753,.4668,.3741,.2896,.2352,.1953,.1692,.1283,.1485,.2062,
     /.2301,.1418,.2353,.2136,.2456,.2925,.3305,.3539,.3762,.4873,
     /.6094,.7107,.7936,.8657,.8963,.9096,.8942,.8403,.7593,.7496,
     /.7531,.7714,.7956,.8038,.8074,.8012,.8111,.8632,.8890,.8972,
     /.9030,.9046,.9163,.9162,.9204,.9216,.9400,.9595,.9741,.9810,
     /.9848,.9871,.9909,.9930,.9954,.99669,.99785,.99846,.99877,.99900,
     /.99927,.99943,.999558,.999641,.999696,.999744,.999804,.999844,
     /.999871,.999891,.999907,.999918,.999936,.999949,.999957,.999964,
     /.999969,.999984,.999990/
C IONISATION (VALUES ABOVE 20KEV GENERATED BY BORN BETHE IN SUB)
      DATA XION/12.13,12.5,13.0,13.5,14.0,14.5,15.0,15.5,16.0,16.5,
     /17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,26.0,28.0,
     /30.0,32.0,34.0,36.0,40.0,45.0,50.0,55.0,60.0,65.0,
     /70.0,80.0,90.0,100.,110.,120.,130.,140.,150.,160.,
     /180.,200.,250.,300.,350.,400.,450.,500.,550.,600.,
     /700.,800.,900.,1000.,1200.,1400.,1600.,1800.,2000.,2500.,
     /3000.,3500.,4000.,4500.,5000.,5500.,6000.,7000.,8000.,9000.,
     /10000.,12000.,14000.,16000.,18000.,20000./
C GROSS IONISATION
      DATA YION/0.00,.090,.236,.394,.559,.730,.906,1.09,1.27,1.42,
     /1.58,1.85,2.11,2.35,2.56,2.82,3.02,3.21,3.49,3.71,
     /3.93,4.15,4.30,4.42,4.60,4.82,4.96,5.08,5.19,5.24,
     /5.28,5.32,5.41,5.53,5.61,5.59,5.53,5.41,5.31,5.16,
     /4.91,4.71,4.29,3.96,3.66,3.40,3.19,3.01,2.81,2.67,
     /2.44,2.22,2.05,1.92,1.68,1.48,1.35,1.23,1.13,.964,
     /.836,.736,.663,.602,.555,.515,.480,.424,.382,.346,
     /.319,.273,.242,.218,.200,.186/
C COUNTING IONISATION
      DATA YINC/0.00,.090,.236,.394,.559,.730,.906,1.09,1.27,1.42,
     /1.58,1.85,2.11,2.35,2.56,2.82,3.02,3.21,3.49,3.71,
     /3.93,4.15,4.30,4.40,4.53,4.64,4.72,4.78,4.83,4.88,
     /4.91,4.91,4.89,4.89,4.86,4.77,4.66,4.55,4.46,4.33,
     /4.11,3.91,3.52,3.22,2.93,2.71,2.53,2.37,2.21,2.09,
     /1.89,1.72,1.58,1.47,1.28,1.12,1.03,.923,.855,.731,
     /.632,.557,.501,.455,.420,.389,.364,.320,.289,.262,
     /.241,.206,.183,.165,.152,.141/
C EXCITATION
      DATA XEXC1/8.315,8.35,8.40,8.45,8.50,8.55,8.60,8.65,8.70,8.75,
     /8.80,8.85,8.90,8.95,9.00,9.05,9.10,9.15,9.20,9.25,
     /9.30,9.35,9.40,9.45,9.50,9.55,9.60,9.65,9.70,9.75,
     /9.80,9.90,10.0,10.2,10.4,10.6,11.0,12.0,13.0,14.0,
     /15.0,16.0,18.0,20.0,22.0,24.0,26.0,28.0,30.0,35.0,
     /40.0,50.0,60.0,70.0,80.0,90.0,100.,120.,140.,160.,
     /180.,200.,240.,280.,320.,360.,400.,450.,500.,600.,
     /700.,800.,900.,1000.,1200.,1400.,1600.,2000.,2400.,2800.,
     /3200.,3600.,4000.,4500.,5000.,6000.,7000.,8000.,9000.,10000.,
     /15000.,20000.,30000.,40000.,60000.,80000.,1.0D5,2.0D5,3.0D5,4.0D5,
     /5.0D5,1.0D6,1.5D6,2.0D6/
      DATA YEXC1/0.00,.0116,.024,.027,.026,.029,.0346,.040,.0458,.0516,
     /.0584,.0670,.079,.093,.106,.115,.116,.112,.108,.106,
     /.107,.115,.125,.144,.206,.240,.214,.168,.146,.144,
     /.147,.156,.164,.178,.192,.206,.232,.288,.336,.387,
     /.425,.459,.512,.552,.581,.602,.616,.624,.629,.634,
     /.629,.590,.571,.538,.509,.480,.456,.413,.374,.350,
     /.326,.307,.269,.245,.221,.206,.192,.173,.158,.139,
     /.125,.110,.101,.0917,.080,.0706,.063,.053,.046,.040,
     /.0360,.033,.0302,.0274,.025,.0216,.019,.017,.015,.014,
     /.0100,.0079,.0057,.0045,.0033,.0027,.0023,.00153,.00127,.00114,
     /.00107,.00098,.00097,.00098/
      DATA XEXC2/9.447,9.45,9.50,9.55,9.60,9.65,9.70,9.75,9.80,9.90,
     /10.0,10.2,10.4,10.6,11.0,12.0,13.0,14.0,15.0,16.0,
     /18.0,20.0,22.0,24.0,26.0,28.0,30.0,35.0,40.0,50.0,
     /60.0,70.0,80.0,90.0,100.,120.,140.,160.,180.,200.,
     /240.,280.,320.,360.,400.,450.,500.,600.,700.,800.,
     /900.,1000.,1200.,1400.,1600.,2000.,2400.,2800.,3200.,3600.,
     /4000.,4500.,5000.,6000.,7000.,8000.,9000.,10000.,15000.,20000.,
     /30000.,40000.,60000.,80000.,1.0D5,2.0D5,3.0D5,4.0D5,5.0D5,1.0D6,
     /1.5D6,2.0D6/
      DATA YEXC2/0.00,.0035,.0108,.0158,.0157,.015,.0176,.027,.037,.063,
     /.0884,.134,.177,.214,.277,.392,.461,.504,.530,.544,
     /.557,.555,.547,.538,.526,.515,.503,.475,.450,.408,
     /.374,.346,.323,.302,.284,.255,.232,.214,.199,.185,
     /.164,.148,.134,.124,.114,.106,.097,.0851,.0756,.0684,
     /.0624,.0575,.0499,.0442,.0397,.0332,.0287,.0252,.0227,.0206,
     /.0189,.0172,.0157,.0135,.0119,.0107,.0097,.00884,.00632,.00499,
     /.00359,.00286,.00210,.00171,.00146,.00097,.00081,.00073,.00069,
     /.00062,.00062,.00063/
      DATA XEXC3/9.917,10.0,10.2,10.4,10.6,11.0,12.0,13.0,14.0,15.0,
     /16.0,18.0,20.0,22.0,24.0,26.0,28.0,30.0,35.0,40.0,
     /50.0,60.0,70.0,80.0,90.0,100.,120.,140.,160.,180.,
     /200.,240.,280.,320.,360.,400.,450.,500.,600.,700.,
     /800.,900.,1000.,1200.,1400.,1600.,2000.,2400.,2800.,3200.,
     /3600.,4000.,4500.,5000.,6000.,7000.,8000.,9000.,10000.,15000.,
     /20000.,30000.,40000.,60000.,80000.,1.0D5,2.0D5,3.0D5,4.0D5,5.0D5,
     /1.0D6,1.5D6,2.0D6/
      DATA YEXC3/0.00,.000005,.0389,.118,.190,.315,.615,.810,.939,1.03,
     /1.08,1.14,1.17,1.17,1.16,1.15,1.13,1.11,1.07,1.02,
     /.930,.858,.800,.745,.701,.661,.596,.544,.501,.466,
     /.435,.386,.348,.318,.292,.271,.249,.230,.202,.180,
     /.162,.149,.137,.119,.106,.0947,.0792,.0684,.0605,.0541,
     /.0492,.0451,.0410,.0375,.0324,.0284,.0254,.0231,.0212,.0152,
     /.0120,.00861,.00686,.00504,.00409,.00351,.00233,.00194,.00176,
     /.00165,.00150,.00144,.00151/
      DATA XEXC4/11.70,12.0,13.0,14.0,15.0,16.0,18.0,20.0,22.0,24.0,
     /26.0,28.0,30.0,35.0,40.0,50.0,60.0,70.0,80.0,90.0,
     /100.,120.,140.,160.,180.,200.,240.,280.,320.,360.,
     /400.,450.,500.,600.,700.,800.,900.,1000.,1200.,1400.,
     /1600.,2000.,2400.,2800.,3200.,3600.,4000.,4500.,5000.,6000.,
     /7000.,8000.,9000.,10000.,15000.,20000.,30000.,40000.,60000.,8E4,
     /100000.,200000.,3.0D5,4.0D5,5.0D5,1.0D6,1.5D6,2.0D6/
      DATA YEXC4/0.00,.00194,.0299,.0776,.134,.194,.308,.410,.494,.564,
     /.622,.668,.705,.767,.801,.820,.807,.784,.756,.727,
     /.698,.645,.598,.558,.523,.492,.442,.400,.367,.340,
     /.316,.291,.271,.237,.212,.192,.176,.162,.141,.125,
     /.112,.0946,.0818,.0722,.0648,.0589,.0540,.0492,.0450,.0388,
     /.0342,.0306,.0277,.0254,.0182,.0144,.0104,.00828,.00608,.00494,
     /.00424,.00281,.00234,.00212,.00200,.00181,.00180,.00183/
C-----------------------------------------------------------------------
      IF(NANISO.EQ.0) THEN
       NAME='XENON (ISO)2007'
      ELSE
       NAME='XENON (ANI)2007'
      ENDIF
C
C --------------------------------------------------------------------
C  DATA ON XENON NOT AS GOOD AS ARGON . USED MOMENTUM TRANSFER
C  X-SECTION FROM SCHMIDT. AND FIT TO TOWNSEND  COEFFICIENT OF
C  JACQUES ET AL J.PHYS D 19 (1986) 1731-1739 AND KRUITHOF TO OBTAIN
C  INELASTIC X-SECTIONS.
C 2007: INCREASED ENERGY RANGE TO 2MEV
C 2007: INCLUDED NEW ANGULAR DISTRIBUTION
C 2007: INCLUDED PENNING TRANSFER FRACTION
C --------------------------------------------------------------------
C
C  BORN BETHE VALUES FOR IONISATION
      CONST=1.873884D-20
      EMASS2=1021997.804
      AM2=8.04
      C=75.25
C
C
      NIN=4
      DO 1 J=1,6
    1 KEL(J)=NANISO
      DO 2 J=1,NIN
    2 KIN(J)=NANISO
C
      NDATA=139
      NEL=131
      NEPSI=139
      NION=76
      NEXC1=104
      NEXC2=82
      NEXC3=73
      NEXC4=68
      E(1)=0.0
      E(2)=2.0*EMASS/(131.30*AMU)
      E(3)=12.13
C EXCITATION X-SECTION AT 1.5 MEV
      E(4)=0.483D-18
C IONISING X-SECTION AT 1.5 MEV
      E(5)=0.1787D-17
C EOBY FOR MINIMUM IONISING PARTICLE
      E(6)=23.2
C EOBY AT LOW ENERGY
      EOBY=8.7
      IOFF=IFIX(SNGL(0.5+E(3)/ESTEP))
      EIN(1)=8.315
      EIN(2)=9.447
      EIN(3)=9.917
      EIN(4)=11.70
C***********************************************************************
C ENTER PENNING TRANSFER FRACTION FOR EACH LEVEL
C USE TRANSFER FRACTION BETWEEN 0.0 AND 0.1 FOR XENON
      PENFRA(1,1)=0.0
      PENFRA(1,2)=0.0
      PENFRA(1,3)=0.0
      PENFRA(1,4)=0.0
C PENNING TRANSFER DISTANCE MICRONS
      PENFRA(2,1)=1.0
      PENFRA(2,2)=1.0
      PENFRA(2,3)=1.0
      PENFRA(2,4)=1.0
C PENNING TRANSFER TIME PICOSECONDS
      PENFRA(3,1)=1.0
      PENFRA(3,2)=1.0
      PENFRA(3,3)=1.0
      PENFRA(3,4)=1.0
C***********************************************************************
      IF(IPEN.EQ.0) GO TO 4
      DO 3 KDUM=1,NIN
      IF(PENFRA(1,KDUM).EQ.0.0) GO TO 3
      WRITE(6,999) NAME,EIN(KDUM),PENFRA(1,KDUM),PENFRA(2,KDUM),
     /PENFRA(3,KDUM)
  999 FORMAT(' GAS = ',A15,' ENERGY LEVEL = ',F7.4,' EV.',/,' PENNING PR
     /OBABILITY =',F5.3,' ABS.LENGTH =',F7.2,' DECAY TIME =',F7.1,/)
    3 CONTINUE
    4 IOFF1=IFIX(SNGL(0.5+EIN(1)/ESTEP))
      IOFF2=IFIX(SNGL(0.5+EIN(2)/ESTEP))
      IOFF3=IFIX(SNGL(0.5+EIN(3)/ESTEP))
      IOFF4=IFIX(SNGL(0.5+EIN(4)/ESTEP))
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC (ANIS)  XENON        '
      IF(NANISO.EQ.0) THEN
      SCRPT(2)=' ELASTIC (ISO)   XENON        '
      ENDIF
      SCRPT(3)=' IONISATION    ELOSS= 12.13   '
      SCRPT(4)='                              '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' EXC           ELOSS=  8.315  '
      SCRPT(8)=' EXC           ELOSS=  9.447  '
      SCRPT(9)=' EXC           ELOSS=  9.917  '
      SCRPT(10)=' EXC           ELOSS= 11.70   '
      EN=-ESTEP/2.0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      IF(EN.LE.XEN(2)) THEN
       QELA=122.D-16
       QMOM=122.D-16
       GO TO 200
      ENDIF
      DO 110 J=2,NEL
      IF(EN.LE.XEL(J)) GO TO 120
  110 CONTINUE
      J=NEL
  120 YXJ=DLOG(YEL(J))
      YXJ1=DLOG(YEL(J-1))
      XNJ=DLOG(XEL(J))
      XNJ1=DLOG(XEL(J-1))
      A=(YXJ-YXJ1)/(XNJ-XNJ1)
      B=(XNJ1*YXJ-XNJ*YXJ1)/(XNJ1-XNJ)
      QELA=DEXP(A*DLOG(EN)+B)*1.D-16
      DO 150 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 160
  150 CONTINUE
      J=NDATA
  160 YXJ=DLOG(YXSEC(J))
      YXJ1=DLOG(YXSEC(J-1))
      XNJ=DLOG(XEN(J))
      XNJ1=DLOG(XEN(J-1))
      A=(YXJ-YXJ1)/(XNJ-XNJ1)
      B=(XNJ1*YXJ-XNJ*YXJ1)/(XNJ1-XNJ)
      QMOM=DEXP(A*DLOG(EN)+B)*1.D-16
  200 CONTINUE
      PQ1=0.5+(QELA-QMOM)/QELA
      DO 201 J=2,NEPSI
      IF(EN.LE.XEPS(J)) GO TO 202
  201 CONTINUE
      J=NEPSI
  202 A=(YEPS(J)-YEPS(J-1))/(XEPS(J)-XEPS(J-1))
      B=(XEPS(J-1)*YEPS(J)-XEPS(J)*YEPS(J-1))/(XEPS(J-1)-XEPS(J))
      PQ2=A*EN+B
      IF(NANISO.EQ.1) PEQEL(2,I)=PQ1
      IF(NANISO.EQ.2) PEQEL(2,I)=PQ2
      Q(2,I)=QELA
      IF(NANISO.EQ.0) THEN
       Q(2,I)=QMOM
       PEQEL(2,I)=0.5
      ENDIF
C  GROSS IONISATION
      Q(3,I)=0.0
      PEQEL(3,I)=0.5D0
      IF(NANISO.EQ.2) PEQEL(3,I)=0.0D0
      IF(EN.LE.E(3)) GO TO 230
      IF(EN.GT.XION(76)) GO TO 221
      DO 210 J=2,NION
      IF(EN.LE.XION(J)) GO TO 220
  210 CONTINUE
      J=NION
  220 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.0D-16
      GO TO 222
C USE BORN-BETHE X-SECTION ABOVE XION(76) EV
  221 GAMMA=(EMASS2+2.0D0*EN)/EMASS2
      BETA=DSQRT(1.0D0-1.0D0/(GAMMA*GAMMA))
      BETA2=BETA*BETA
      X2=1.0D0/BETA2
      X1=X2*DLOG(BETA2/(1.0D0-BETA2))-1.0D0
      Q(3,I)=CONST*(AM2*X1+C*X2)/0.75
  222 CONTINUE
C USE ANISOTROPIC SCATTERING FOR PRIMARY IONISATION ELECTRON FOR
C ENERGIES ABOVE 2 * IONISATION ENERGY
C ANISOTROPIC ANGULAR DISTRIBUTION SAME AS ELASTIC AT ENERGY OFF SET BY
C IONISATION ENERGY
      IF(EN.LE.(2.0*E(3))) GO TO 230
      PEQEL(3,I)=PEQEL(2,(I-IOFF))
C ATTACHMENT
  230 Q(4,I)=0.0
C COUNTING IONISATION
      Q(5,I)=0.0
      PEQEL(5,I)=0.5D0
      IF(NANISO.EQ.2) PEQEL(5,I)=0.0D0
      IF(EN.LE.E(3)) GO TO 250
      IF(EN.GT.XION(76)) GO TO 241
      DO 231 J=2,NION
      IF(EN.LE.XION(J)) GO TO 240
  231 CONTINUE
      J=NION
  240 A=(YINC(J)-YINC(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YINC(J)-XION(J)*YINC(J-1))/(XION(J-1)-XION(J))
      Q(5,I)=(A*EN+B)*1.0D-16
      GO TO 242
C USE BORN-BETHE X-SECTION ABOVE XION(76) EV
  241 Q(5,I)=CONST*(AM2*X1+C*X2)
  242 CONTINUE
C USE ANISOTROPIC SCATTERING FOR PRIMARY IONISATION ELECTRON FOR
C ENERGIES ABOVE 2 * IONISATION ENERGY
C ANISOTROPIC ANGULAR DISTRIBUTION SAME AS ELASTIC AT ENERGY OFF SET BY
C IONISATION ENERGY
      IF(EN.LE.(2.0*E(3))) GO TO 250
      PEQEL(5,I)=PEQEL(2,(I-IOFF))
  250 Q(6,I)=0.0
C
      QIN(1,I)=0.0
      PEQIN(1,I)=0.5D0
      IF(NANISO.EQ.2) PEQIN(1,I)=0.0D0
      IF(EN.LE.EIN(1)) GO TO 370
      DO 350 J=2,NEXC1
      IF(EN.LE.XEXC1(J)) GO TO 360
  350 CONTINUE
      J=NEXC1
  360 A=(YEXC1(J)-YEXC1(J-1))/(XEXC1(J)-XEXC1(J-1))
      B=(XEXC1(J-1)*YEXC1(J)-XEXC1(J)*YEXC1(J-1))/(XEXC1(J-1)-XEXC1(J))
      QIN(1,I)=(A*EN+B)*1.0D-16
      IF(EN.LE.(2.0*EIN(1))) GO TO 370
      PEQIN(1,I)=PEQEL(2,(I-IOFF1))
  370 CONTINUE
      QIN(2,I)=0.0
      PEQIN(2,I)=0.5D0
      IF(NANISO.EQ.2) PEQIN(2,I)=0.0D0
      IF(EN.LE.EIN(2)) GO TO 470
      DO 450 J=2,NEXC2
      IF(EN.LE.XEXC2(J)) GO TO 460
  450 CONTINUE
      J=NEXC2
  460 A=(YEXC2(J)-YEXC2(J-1))/(XEXC2(J)-XEXC2(J-1))
      B=(XEXC2(J-1)*YEXC2(J)-XEXC2(J)*YEXC2(J-1))/(XEXC2(J-1)-XEXC2(J))
      QIN(2,I)=(A*EN+B)*1.0D-16
      IF(EN.LE.(2.0*EIN(2))) GO TO 470
      PEQIN(2,I)=PEQEL(2,(I-IOFF2))
  470 CONTINUE
      QIN(3,I)=0.0
      PEQIN(3,I)=0.5D0
      IF(NANISO.EQ.2) PEQIN(3,I)=0.0D0
      IF(EN.LE.EIN(3)) GO TO 570
      DO 550 J=2,NEXC3
      IF(EN.LE.XEXC3(J)) GO TO 560
  550 CONTINUE
      J=NEXC3
  560 A=(YEXC3(J)-YEXC3(J-1))/(XEXC3(J)-XEXC3(J-1))
      B=(XEXC3(J-1)*YEXC3(J)-XEXC3(J)*YEXC3(J-1))/(XEXC3(J-1)-XEXC3(J))
      QIN(3,I)=(A*EN+B)*1.0D-16
      IF(EN.LE.(2.0*EIN(3))) GO TO 570
      PEQIN(3,I)=PEQEL(2,(I-IOFF3))
  570 CONTINUE
      QIN(4,I)=0.0
      PEQIN(4,I)=0.5D0
      IF(NANISO.EQ.4) PEQIN(4,I)=0.0D0
      IF(EN.LE.EIN(4)) GO TO 670
      DO 650 J=2,NEXC4
      IF(EN.LE.XEXC4(J)) GO TO 660
  650 CONTINUE
      J=NEXC4
  660 A=(YEXC4(J)-YEXC4(J-1))/(XEXC4(J)-XEXC4(J-1))
      B=(XEXC4(J-1)*YEXC4(J)-XEXC4(J)*YEXC4(J-1))/(XEXC4(J-1)-XEXC4(J))
      QIN(4,I)=(A*EN+B)*1.0D-16
      IF(EN.LE.(2.0*EIN(4))) GO TO 670
      PEQIN(4,I)=PEQEL(2,(I-IOFF4))
  670 CONTINUE
      Q(1,I)=QELA+Q(5,I)+QIN(1,I)+QIN(2,I)+QIN(3,I)+QIN(4,I)
  900 CONTINUE
      IF(EFINAL.LT.EIN(4)) NIN=3
      IF(EFINAL.LT.EIN(3)) NIN=2
      IF(EFINAL.LT.EIN(2)) NIN=1
      IF(EFINAL.LT.EIN(1)) NIN=0
      RETURN
      END
      SUBROUTINE GAS8(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      DIMENSION XEN(115),YELM(115),YELT(115),YEPS(115),XATT(6),YATT(6),
     /XVBV4(27),YVBV4(27),XVBV2(34),YVBV2(34),XVBV1(35),YVBV1(35),
     /XVBV3(26),YVBV3(26),XVBH1(21),YVBH1(21),XVBH2(21),YVBH2(21),
     /XION(70),YION(70),YINC(70),XDET(9),YDET(9),XDIS1(19),YDIS1(19),
     /XDIS2(32),YDIS2(32),XDIS3(31),YDIS3(31),XDIS4(29),YDIS4(29),
     iXDIS5(16),YDIS5(16),
     /XCHD(42),YCHD(42),XCHB(43),YCHB(43),XHAL(42),YHAL(42),
     /XHBE(42),YHBE(42)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      DATA XEN/0.00,.0001,.001,.004,.007,0.01,.012,.014,.017,0.02,
     /.025,0.03,.035,0.04,0.05,0.06,0.07,0.08,0.09,0.10,
     /0.12,0.14,0.17,0.20,0.24,0.28,0.32,0.36,0.40,0.45,
     /0.50,0.60,0.70,0.80,1.00,1.20,1.40,1.70,2.00,2.50,
     /3.00,3.50,4.00,5.00,6.00,7.00,8.00,9.00,10.0,12.0,
     /15.0,20.0,30.0,40.0,50.0,60.0,80.0,100.,150.,200.,
     /300.,400.,500.,600.,800.,1000.,1500.,2000.,3000.,4000.,
     /5000.,6000.,7000.,8000.,9000.,1.D4,1.25D4,1.5D4,1.75D4,2.0D4,
     /2.5D4,3.0D4,3.5D4,4.0D4,4.5D4,5.0D4,6.0D4,7.0D4,8.0D4,9.0D4,
     /1.0D5,1.25D5,1.5D5,1.75D5,2.0D5,2.5D5,3.0D5,3.5D5,4.0D5,4.5D5,
     /5.0D5,6.0D5,7.0D5,8.0D5,9.0D5,1.0D6,1.25D6,1.5D6,1.75D6,2.0D6,
     /2.5D6,3.0D6,4.0D6,7.0D6,1.0D7/
C ELASTIC MOMENTUM TRANSFER X-SECTION
      DATA YELM/26.7,25.4,22.6,18.8,16.5,14.8,13.9,13.0,12.0,11.0,
     /9.75,8.60,7.75,7.10,6.10,5.27,4.60,3.85,3.18,2.55,
     /1.74,1.19,0.70,.440,.300,.300,.345,.400,.470,.550,
     /.650,.850,1.08,1.30,1.75,2.25,2.70,3.50,4.35,6.00,
     /7.70,9.70,11.7,15.0,17.0,18.7,19.2,19.2,18.4,16.1,
     /12.6,8.70,5.15,3.60,2.70,2.15,1.50,1.10,0.62,0.42,
     /.235,0.16,.115,0.09,0.06,.045,.0223,.0134,.00654,.0039,
     /.00261,.00188,.00142,.00112,9.01D-4,7.44D-4,4.96D-4,3.56D-4,
     /2.69D-4,2.11D-4,
     /1.41D-4,1.01D-4,7.67D-5,6.03D-5,4.88D-5,4.04D-5,2.92D-5,2.22D-5,
     /1.76D-5,1.43D-5,
     /1.19D-5,8.09D-6,5.93D-6,4.57D-6,3.66D-6,2.54D-6,1.89D-6,1.48D-6,
     /1.20D-6,9.96D-7,
     /8.45D-7,6.38D-7,5.04D-7,4.11D-7,3.43D-7,2.92D-7,2.09D-7,1.58D-7,
     /1.24D-7,1.00D-7,
     /7.01D-8,5.21D-8,3.24D-8,1.24D-8,6.64D-9/
C ELASTIC TOTAL X-SECTION
      DATA YELT/26.7,25.6,23.3,19.9,17.9,16.4,15.5,14.8,13.8,12.9,
     /11.6,10.6,9.67,8.89,7.60,6.57,5.70,4.90,4.20,3.70,
     /2.80,2.20,1.62,1.23,0.95,0.82,0.75,0.72,0.71,0.73,
     /0.77,0.95,1.10,1.28,1.72,2.25,3.00,4.00,5.10,6.90,
     /8.81,11.0,13.3,17.6,21.2,23.5,24.3,24.4,23.8,22.2,
     /19.6,15.6,10.7,8.10,6.60,5.60,4.15,3.40,2.20,1.80,
     /1.20,0.90,0.75,0.62,0.48,0.40,0.29,.235,0.17,.135,
     /0.11,.095,.085,.078,.070,.064,.054,.046,.040,.037,
     /.0315,.0266,.0231,.0205,.0185,.0169,.0144,.0127,.0117,.0104,
     /.00957,.00812,.00715,.00647,.00595,.00524,.00477,.00444,.00420,
     /.00401,
     /.00387,.00365,.00350,.00340,.00331,.00325,.00314,.00308,.00303,
     /.00300,
     /.00296,.00294,.00292,.00289,.00289/
C EPSILON FOR ELASTIC ANGULAR DISTRIBUTION
      DATA YEPS/0.00,.0117,.0450,.0828,.1170,.1457,.1541,.1812,.1942,
     /.2188,
     /.2365,.2785,.2926,.2966,.2909,.2917,.2847,.3149,.3548,.4467,
     /.5331,.6282,.7417,.8087,.8425,.8018,.7143,.6116,.4821,.3600,
     /.2312,.1571,.0273,-.0234,-.0262,0.000,.1493,.1862,.2185,.1942,
     /.1876,.1762,.1793,.2194,.2920,.3007,.3087,.3133,.3326,.3986,
     /.5064,.6091,.6926,.7297,.7634,.7861,.8056,.8365,.8678,.9006,
     /.9232,.9333,.9460,.9501,.9595,.9650,.9791,.9859,.9915,.9941,
     /.99535,.99628,.99697,.99748,.99779,.99804,.99852,.99880,.99898,
     /.999159,
     /.999366,.999477,.999552,.999610,.999656,.999693,.999746,.999785,
     /.999819,.999837,
     /.9998542,.9998865,.9999077,.9999229,.9999340,.9999494,.9999596,
     /.9999667,.9999719,.9999759,
     /.9999791,.9999837,.9999868,.9999891,.9999908,.9999921,.9999943,
     /.9999957,.9999967,.9999973,
     /.9999982,.9999986,.9999992,.9999997,.9999998/
     /
C V4 DIPOLE PART AS ANALYTIC FUNCTION
      DATA XVBV4/.1625135,0.20,0.30,0.40,0.50,0.60,0.80,1.00,1.50,2.00,
     /3.00,5.00,6.00,7.00,8.00,9.00,10.0,12.5,15.0,20.0,
     /50.0,100.,1000.,10000.,1.0D5,1.0D6,1.0D7/
      DATA YVBV4/0.00,.0001,.060,.057,.055,.050,.040,.035,.041,.056,
     /.082,.278,.406,0.47,0.44,.383,.323,.266,.201,.126,
     /.051,.027,.0002,1.D-5,1.D-6,1.D-7,1.D-8/
C V2
      DATA XVBV2/.1901087,.195,0.20,0.21,0.22,0.23,0.24,0.26,0.28,0.30,
     /0.40,0.50,0.60,0.80,1.00,1.50,2.00,3.00,5.00,6.00,
     /7.00,8.00,9.00,10.0,12.5,15.0,20.0,50.0,100.,1000.,
     /10000.,1.0D5,1.0D6,1.0D7/
      DATA YVBV2/0.00,.028,.038,.051,.060,.066,.071,.075,.076,.077,
     /.080,.081,.082,.082,.083,.084,.086,.118,.308,.446,
     /0.49,0.46,.403,.333,.217,.171,.102,.040,.022,.0002,
     /1.D-5,1.D-6,1.D-7,1.D-8/
C V1
      DATA XVBV1/.3615974,.363,.365,.367,0.37,.375,0.38,0.39,0.40,0.42,
     /0.45,0.50,0.60,0.70,0.80,1.00,1.50,2.00,3.00,5.00,
     /6.00,7.00,8.00,9.00,10.0,12.5,15.0,20.0,50.0,100.,
     /1000.,10000.,1.0D5,1.0D6,1.0D7/
      DATA YVBV1/.0,.0028,.0043,.0054,.0066,.0083,.0095,.0115,.013,.015,
     /.017,.019,0.02,0.02,.021,.022,.023,.025,.042,.157,
     /.226,.260,.260,.215,.190,.151,.120,.085,.029,.012,
     /.0001,1.D-5,1.D-6,1.D-7,1.D-8/
C V3 DIPOLE PART AS ANALYTIC FUNCTION
      DATA XVBV3/.3743690,0.40,0.50,0.60,0.70,0.80,1.00,1.50,2.00,3.00,
     /5.00,6.00,7.00,8.00,9.00,10.0,12.5,15.0,20.0,50.0,
     /100.,1000.,10000.,1.0D5,1.0D6,1.0D7/
      DATA YVBV3/.0,.004,0.01,.011,.011,.011,.011,.015,.019,.105,
     /.508,.696,.780,.730,.633,.453,.217,.132,.053,.024,
     /.009,.0001,1.D-5,1.D-6,1.D-7,1.D-8/
C VIBRATION HARMONIC
      DATA XVBH1/.544,1.00,2.00,3.00,5.00,6.00,7.00,8.00,9.00,10.0,
     /12.5,15.0,17.5,20.0,50.0,100.,1000.,10000.,1.0D5,1.0D6,
     /1.0D7/
      DATA YVBH1/0.00,.0007,.0028,.014,.053,.068,.075,.075,.061,.044,
     /.031,.021,.015,.011,.005,.0017,.0001,.00001,1.D-6,1.D-7,
     /1.D-8/
C VIBRATION HARMONIC
      DATA XVBH2/.736,1.00,2.00,3.00,5.00,6.00,7.00,8.00,9.00,10.0,
     /12.5,15.0,17.5,20.0,50.0,100.,1000.,10000.,1.0D5,1.0D6,
     /1.0D7/
      DATA YVBH2/0.00,.0005,.0022,.0135,.044,.058,.064,.064,.053,.039,
     /.024,.014,.010,.006,.004,.0017,.0001,.00001,1.D-6,1.D-7,
     /1.D-8/
C IONISATION  X-SECTION ABOVE 1KEV GIVEN BY BORN-BETHE
      DATA XION/12.65,13.5,14.0,14.5,15.0,15.5,16.0,16.5,17.0,17.5,
     /18.0,18.5,19.0,19.5,21.0,21.5,22.0,22.5,23.0,23.5,
     /24.0,26.0,28.0,30.0,32.0,34.0,36.0,38.0,40.0,45.0,
     /50.0,55.0,60.0,65.0,70.0,75.0,80.0,85.0,90.0,95.0,
     /100.,105.,110.,115.,120.,125.,130.,135.,140.,145.,
     /150.,160.,180.,200.,250.,300.,350.,400.,450.,500.,
     /550.,600.,650.,700.,750.,800.,850.,900.,950.,1000./
C GROSS IONISATION (RAP AND ENGLANDER AND LINDSAY AND STEBBINGS)
      DATA YION/0.00,.035,.075,.132,.201,.282,.366,.451,.538,.625,
     /.715,.803,.892,.990,1.26,1.36,1.44,1.52,1.60,1.68,
     /1.75,2.00,2.23,2.41,2.58,2.72,2.83,2.95,3.06,3.25,
     /3.41,3.52,3.61,3.66,3.71,3.73,3.74,3.75,3.74,3.73,
     /3.71,3.68,3.66,3.63,3.60,3.57,3.53,3.50,3.46,3.42,
     /3.36,3.27,3.12,3.00,2.69,2.40,2.22,2.04,1.88,1.74,
     /1.64,1.53,1.44,1.36,1.30,1.25,1.19,1.15,1.10,1.053/
C COUNTING IONISATION
      DATA YINC/0.00,.035,.075,.132,.201,.282,.366,.451,.538,.625,
     /.715,.803,.892,.990,1.26,1.36,1.44,1.52,1.60,1.68,
     /1.75,2.00,2.22,2.40,2.57,2.71,2.82,2.93,3.04,3.23,
     /3.38,3.49,3.57,3.62,3.67,3.69,3.70,3.71,3.70,3.69,
     /3.67,3.64,3.62,3.59,3.56,3.53,3.49,3.46,3.43,3.39,
     /3.33,3.24,3.09,2.97,2.66,2.38,2.20,2.02,1.86,1.72,
     /1.62,1.52,1.43,1.35,1.29,1.24,1.18,1.14,1.09,1.042/
C ATTACHMENT  - DEATTACHMENT VIA H- 9.8 EV RESONANCE (RAWAT ET AL)
      DATA XDET/7.80,8.00,9.00,9.80,10.0,11.0,12.0,13.0,14.0/
      DATA YDET/0.00,.0049,.0134,.0153,.0150,.0113,.0038,.0095,0.00/
C ATTACHMENT  VIA CH2- ONLY (RAWAT ET AL)
      DATA XATT/9.00,10.0,10.4,11.0,12.0,13.0/
      DATA YATT/0.00,0.00092,.00112,.00089,.00027,0.00/
C DISSOCIATION ( HAYASHI ADJUSTED TO GIVE WINTERS TOTAL DISSOCIATION)
      DATA XDIS1/8.55,9.00,10.0,11.0,12.0,13.0,13.5,14.0,15.0,16.0,
     /17.0,18.0,19.0,20.0,22.0,25.0,30.0,35.0,40.0/
      DATA YDIS1/0.00,0.15,.225,.288,.300,.285,.263,.238,.180,.130,
     /.091,.063,.042,.0308,.017,.0063,.00175,.00068,0.00/
      DATA XDIS2/9.00,10.0,11.0,12.0,13.0,14.0,16.0,18.0,20.0,22.0,
     /25.0,30.0,35.0,40.0,50.0,60.0,80.0,100.,150.,200.,
     /300.,400.,500.,700.,1000.,1500.,2000.,3000.,4000.,6000.,
     /8000.,10000./
      DATA YDIS2/0.00,.042,.084,.126,.168,.196,.259,.308,.339,.364,
     /.378,.382,.384,.386,.397,.419,.427,.419,.355,.324,
     /.282,.233,.195,.140,.0988,.0691,.0529,.0388,.0282,.0205,
     /.0155,.0127/
      DATA XDIS3/10.5,11.0,12.0,13.0,14.0,16.0,18.0,20.0,22.0,25.0,
     /30.0,35.0,40.0,50.0,60.0,80.0,100.,150.,200.,300.,
     /400.,500.,700.,1000.,1500.,2000.,3000.,4000.,6000.,8000.,
     /10000./
      DATA YDIS3/0.00,.035,.140,.231,.315,.476,.574,.619,.644,.658,
     /.633,.602,.608,.625,.643,.625,.608,.530,.483,.406,
     /.342,.284,.204,.141,.0987,.0756,.0554,.0403,.0292,.0222,
     /.0181/
      DATA XDIS4/12.0,13.0,14.0,16.0,18.0,20.0,22.0,25.0,30.0,35.0,
     /40.0,50.0,60.0,80.0,100.,150.,200.,300.,400.,500.,
     /700.,1000.,1500.,2000.,3000.,4000.,6000.,8000.,10000./
      DATA YDIS4/0.00,.140,.280,.525,.700,.800,.854,.889,.941,.964,
     /.993,1.07,1.13,1.22,1.26,1.15,1.07,.912,.746,.641,
     /.455,.320,.224,.172,.126,.0915,.0663,.0503,.0412/
      DATA XDIS5/13.3,14.0,16.0,18.0,20.0,22.0,25.0,30.0,35.0,40.0,
     /50.0,60.0,80.0,100.,150.,200./
      DATA YDIS5/0.00,.0315,.252,.462,.620,.714,.790,.842,.828,.772,
     /.639,.503,.275,.090,.064,0.00/
C LIGHT EMISSION FROM CH(A2DELTA TO X2PI)
      DATA XCHD/13.4,13.5,14.5,18.5,20.6,21.6,22.5,23.6,27.7,31.8,
     /33.5,33.9,35.4,37.5,39.2,40.0,44.0,49.1,55.6,58.3,
     /60.1,63.2,67.0,71.3,76.3,80.3,100.,150.,200.,400.,
     /700.,1000.,1500.,2000.,2500.,3000.,3500.,4000.,1.D4,1.D5,
     /1.D6,1.D7/
      DATA YCHD/0.00,.0041,.0065,.0116,.0169,.0205,.0232,.0261,.0299,
     /.0327,
     /.0339,.0355,.0363,.0392,.0411,.0441,.0462,.0469,.0476,.0479,
     /.0481,.0485,.0489,.0491,.0487,.0477,.0403,.0292,.0232,.0131,
     /.0082,.0060,.0043,.0033,.0027,.0023,.00205,.00181,.0008,.00015,
     /.000017,.000002/
C LIGHT EMISSION FROM CH(B2SIGMA- TO X2PI)
      DATA XCHB/13.7,13.8,14.8,18.8,20.9,21.9,22.8,23.9,28.0,32.1,
     /33.8,34.2,35.7,37.8,39.5,42.1,43.4,44.3,49.4,56.0,
     /58.6,60.4,63.5,67.3,71.6,76.6,80.6,100.,150.,200.,
     /400.,700.,1000.,1500.,2000.,2500.,3000.,3500.,4000.,1.D4,
     /1.D5,1.D6,1.D7/
      DATA YCHB/0.00,2.44D-4,3.91D-4,6.96D-4,.00102,.00123,.0014,.00157,
     /.0018,.00197,
     /.00204,.00214,.00219,.00236,.00248,.00259,.00265,.00278,.00283,
     /.00286,
     /.00289,.00290,.00292,.00295,.00296,.00293,.00287,.00242,.00176,
     /.00139,
     /7.88D-4,4.93D-4,3.63D-4,2.57D-4,2.00D-4,1.65D-4,1.40D-4,1.23D-4,
     /1.09D-4,5.D-5,
     /8.D-6,1.D-6,1.5D-7/
C LIGHT EMISSION FROM H(ALPHA)
      DATA XHAL/16.14,16.3,16.6,16.9,17.2,18.1,19.2,20.0,20.8,22.6,
     /25.2,30.0,40.0,50.0,60.0,70.0,80.0,90.0,100.,144.,
     /185.,200.,224.,245.,284.,364.,453.,500.,600.,700.,
     /800.,1000.,1500.,2000.,2500.,3000.,3500.,4000.,1.D4,1.D5,
     /1.D6,1.D7/
      DATA YHAL/0.00,2.54D-4,3.80D-4,5.05D-4,6.60D-4,.00101,.00142,
     /.00175,.00209,.00288,
     /.00431,.00686,.01225,.0156,.0181,.0195,.0204,.0203,.0200,.0181,
     /.0148,.0134,.0127,.0119,.0103,.00789,.00598,.00529,.00425,.00357,
     /.00309,.00227,.0016,.00125,.00103,8.75D-4,7.7D-4,6.82D-4,3.D-4,
     /3.8D-5,4.8D-6,6.D-7/
C LIGHT EMISSION FROM H(BETA)
      DATA XHBE/16.8,18.0,21.9,23.4,24.5,25.5,26.4,28.2,30.0,33.7,
     /37.2,40.0,50.0,57.7,80.0,100.,141.,169.,200.,226.,
     /247.,284.,340.,363.,398.,455.,500.,550.,654.,700.,
     /800.,999.,1500.,2000.,2500.,3000.,3500.,4000.,1.D4,1.D5,
     /1.D6,1.D7/
      DATA YHBE/0.00,1.53D-4,5.44D-4,7.19D-4,8.85D-4,.00114,.00128,
     /.00159,.00194,.00228,
     /.00269,.00316,.00374,.00419,.00481,.00463,.00419,.00374,.00314,
     /.00288,
     /.00269,.00227,.00194,.00179,.00160,.00140,.00128,.00114,9.5D-4,
     /8.85D-4,
     /7.19D-4,5.45D-4,3.84D-4,3.00D-4,2.47D-4,2.10D-4,1.84D-4,1.63D-4,
     /7.5D-5,1.05D-5,1.5D-6,2.2D-7/
C-----------------------------------------------------------------------
C 2007: UPDATE OF 2004 DATABASE
C NOW SPLIT V24 AND V13 VIBRATIONS INTO V1 V2 V3 AND V4 X-SECTIONS
C  SHAPE OF VIBRATIONS GIVEN BY SHAPE FUNCTIONS FROM THEORETICAL
C  PREDICTIONS BY GIANTURCO ET AL.
C  VIBRATION ANGULAR DISTRIBUTIONS MODELLED BY MODIFIED CAPITELLI/LONGO
C  ELASTIC ANGULAR DISTRIBUTIONS CAN BE EITHER ISOTROPIC OR MODELLED
C  BY OKHRIMOVSKYY ET AL ALGORITHM
C IONISATION AND DISSOCIATION ANGULAR DISTRIBUTIONS GIVEN BY ELASTIC
C ANGULAR DISTRIBUTION WITH ENERGY OFFSET GIVEN BY THRESHOLD ENERGY.
C  DATABASE EXTENDED TO MIP REGION.
C NOW INCLUDES LIGHT EMISSION X-SECTIONS FROM
C SASIC ,PETROVIC ET AL NEW JOURNAL OF PHYSICS 6(2004)74
C----------------------------------------------------------------------
C ATTACHMENT CROSS-SECTION OF RAWAT ET AL : JOURNAL OF PHYSICS:
C CONFERENCE SERIES 80(2007)012018 NOW USED INSTEAD OF SHARP AND DOWELL
C DE-ATTACHMENT FOR PART OF ATTACHMENT TO H- ION ASSUMED DUE TO
C HIGH COLLISIONAL ENERGY FORMATION.
C ---------------------------------------------------------------------
C  FIT TO METHANE DRIFT VELOCITY OF HADDAD AND SCHMIDT AT LOW FIELD
C  AND HUNTER AND KLINE AT HIGH FIELD.
C  CALCULATED DRIFT VELOCITY IS WITHIN 1% AT ALL FIELDS UP TO 600 TD
C  TRANSVERSE DIFFUSION WITHIN 3% AT ALL FIELDS
C   LONGITUDINAL DIFFUSION WITHIN 3% AT ALL FIELDS
C REPRODUCES DRIFT VELOCITY AND LORENTZ ANGLES IN ARGON METHANE MIXTURES
C LORENTZ ANGLE ACCURACY LESS THAN 1 DEGREE IN ARGON MIXTURES
C DRIFT VELOCITY BETTER THAN 0.75% IN ARGON MIXTURES.
C ALL ENERGY DEPENDENT FANO FACTORS WITHIN EXPERIMENTAL ERRORS OF 5%
C-----------------------------------------------------------------------
      IF(NANISO.EQ.0) THEN
       NAME=' CH4 2008 ISOT '
      ELSE
       NAME=' CH4 2008 ANISO'
      ENDIF
C-----------------------------------------------------------------------
C BORN BETHE VALUES FOR IONISATION
      CONST=1.873884D-20
      EMASS2=1021997.804
      AM2=3.75
      C=42.5
C BORN BETHE FOR EXCITATION
      AM2EXC=1.40
      CEXC=19.0
C
      NIN=18
      DO 1 J=1,6
    1 KEL(J)=NANISO
C SUPERELASTIC AND HARMONIC VIBRATIONS ASSUMED ISOTROPIC
      KIN(1)=0
      KIN(3)=0
      KIN(7)=0
      KIN(8)=0
C   ATTACHMENT DE-ATTACHMENT ASSUMED ISOTROPIC
      KIN(9)=0
C V4,V2,V1 AND V3 VIBRATIONS ANISOTROPIC ( CAPITELLI-LONGO)
      KIN(2)=1
      KIN(4)=1
      KIN(5)=1
      KIN(6)=1
C ANGULAR DISTRIBUTION FOR DISSOCIATIVE EXCITATION CAN BE EITHER
C CAPITELLI LONGO OR OKHRIMOVSKYY TYPE
      DO 2 J=10,NIN
    2 KIN(J)=NANISO
C
C  RAT IS MOMENTUM TRANSFER TO TOTAL RATIO FOR VIBRATIONS IN THE
C  RESONANCE REGION AND ALSO FOR THE VIBRATIONS V1 AND V2 .
C  USED DIPOLE ANGULAR DISTRIBUTION FOR V3 AND V4 NEAR THRESHOLD.
      RAT=0.8
C
      NDATA=115
      NVIBV4=27
      NVIBV2=34
      NVIBV1=35
      NVIBV3=26
      NVIBH1=21
      NVIBH2=21
      NION=70
      NATT=6
      NDET=9
      NDIS1=19
      NDIS2=32
      NDIS3=31
      NDIS4=29
      NDIS5=16
      NCHD=42
      NCHB=43
      NHAL=42
      NHBE=42
C VIBRATIONAL DEGENERACY
      DEGV4=3.0
      DEGV2=2.0
      DEGV1=1.0
      DEGV3=3.0
C
      E(1)=0.0
      E(2)=2.0*EMASS/(16.0426*AMU)
      E(3)=12.65
C EXCITATION X-SECTION AT 1.2 MEV
      E(4)=0.0043D-16
C IONISING X-SECTION AT 1.2 MEV
      E(5)=0.00982D-16
C EOBY AT 1.5 MEV
      E(6)=8.0
C OPAL AND BEATY IONISATION ENERGY SPLITTING (LOW ENERGY)
      EOBY=7.3
C OFFSET ENERGY FOR IONISATION ELECTRON ANGULAR DISTRIBUTION
      IOFF=IFIX(SNGL(0.5+E(3)/ESTEP))
      EIN(1)=-0.1625135
      EIN(2)=0.1625135
      EIN(3)=-0.1901087
      EIN(4)=0.1901087
      EIN(5)=0.3615974
      EIN(6)=0.3743690
      EIN(7)=0.544
      EIN(8)=0.736
      EIN(9)=7.80
      EIN(10)=8.55
      EIN(11)=9.00
      EIN(12)=10.5
      EIN(13)=12.0
      EIN(14)=13.3
      EIN(15)=13.4
      EIN(16)=13.7
      EIN(17)=16.14
      EIN(18)=16.8
C OFFSET ENERGY FOR EXCITATION LEVELS ANGULAR DISTRIBUTION
      IOFF10=IFIX(SNGL(0.5+EIN(10)/ESTEP))
      IOFF11=IFIX(SNGL(0.5+EIN(11)/ESTEP))
      IOFF12=IFIX(SNGL(0.5+EIN(12)/ESTEP))
      IOFF13=IFIX(SNGL(0.5+EIN(13)/ESTEP))
      IOFF14=IFIX(SNGL(0.5+EIN(14)/ESTEP))
      IOFF15=IFIX(SNGL(0.5+EIN(15)/ESTEP))
      IOFF16=IFIX(SNGL(0.5+EIN(16)/ESTEP))
      IOFF17=IFIX(SNGL(0.5+EIN(17)/ESTEP))
      IOFF18=IFIX(SNGL(0.5+EIN(18)/ESTEP))
C***********************************************************************
C ENTER PENNING TRANSFER FRACTION FOR EACH LEVEL
C FIRST 9 LEVELS DO NOT HAVE ENOUGH ENERGY TO GIVE PENNING
C HIGHEST LEVELS 15,16,17 AND 18 REPRESENT LIGHT EMISSION FRAGMENTS
C AND SO DO NOT COUNT IN THE PENNING FRACTIONS
      DO 7 K=1,18
      DO 7 L=1,3
    7 PENFRA(L,K)=0.0
C PENNING TRANSFER FRACTION FOR LEVELS 10,11,12 13 AND 14
      PENFRA(1,10)=0.0
      PENFRA(1,11)=0.0
      PENFRA(1,12)=0.0
      PENFRA(1,13)=0.0
      PENFRA(1,14)=0.0
C PENNING TRANSFER DISTANCE IN MICRONS
      PENFRA(2,10)=1.0
      PENFRA(2,11)=1.0
      PENFRA(2,12)=1.0
      PENFRA(2,13)=1.0
      PENFRA(2,14)=1.0
C PENNING TRANSFER TIME IN PICOSECONDS
      PENFRA(3,10)=1.0
      PENFRA(3,11)=1.0
      PENFRA(3,12)=1.0
      PENFRA(3,13)=1.0
      PENFRA(3,14)=1.0
      IF(IPEN.EQ.0) GO TO 9
      DO 8 KDUM=10,14
      IF(PENFRA(1,KDUM).EQ.0.0) GO TO 8
      WRITE(6,999) NAME,EIN(KDUM),PENFRA(1,KDUM),PENFRA(2,KDUM),
     /PENFRA(3,KDUM)
  999 FORMAT(' GAS = ',A15,' ENERGY LEVEL = ',F7.4,' EV.',/,' PENNING PR
     /OBABILITY =',F5.3,' ABS.LENGTH =',F7.2,' DECAY TIME =',F7.1,/)
    8 CONTINUE
C***********************************************************************
C
    9 SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC  ANISOTROPIC METHANE '
      IF(NANISO.EQ.0) THEN
      SCRPT(2)=' ELASTIC  ISOTROPIC METHANE   '
      ENDIF
      SCRPT(3)=' IONISATION    ELOSS= 12.65   '
      SCRPT(4)=' ATTACHMENT (CH2- ONLY)       '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' VIB V4        ELOSS=-0.162513'
      SCRPT(8)=' VIB V4        ELOSS= 0.162513'
      SCRPT(9)=' VIB V2        ELOSS=-0.190109'
      SCRPT(10)=' VIB V2        ELOSS= 0.190109'
      SCRPT(11)=' VIB V1        ELOSS= 0.361597'
      SCRPT(12)=' VIB V3        ELOSS= 0.374369'
      SCRPT(13)=' VIB  HAR      ELOSS=  0.544  '
      SCRPT(14)=' VIB  HAR      ELOSS=  0.736  '
      SCRPT(15)=' ATT - DEATT    ELOSS=  7.8   '
      SCRPT(16)=' EXC DISSOCIATN ELOSS=  8.55  '
      SCRPT(17)=' EXC DISSOCIATN ELOSS=  9.0   '
      SCRPT(18)=' EXC DISSOCIATN ELOSS= 10.5   '
      SCRPT(19)=' EXC DISSOCIATN ELOSS= 12.0   '
      SCRPT(20)=' EXC DISSOCIATN ELOSS= 13.3   '
      SCRPT(21)=' A2D TO G.S.   ELOSS= 13.4    '
      SCRPT(22)=' B2PI TO G.S.  ELOSS= 13.7    '
      SCRPT(23)=' H(ALPHA)      ELOSS= 16.14   '
      SCRPT(24)=' H(BETA)       ELOSS= 16.8    '
C CALC LEVEL POPULATIONS
      APOPV4=DEGV4*DEXP(EIN(1)/AKT)
      APOPV2=DEGV2*DEXP(EIN(3)/AKT)
      APOPGS=1.0
      APOPSUM=APOPGS+APOPV4+APOPV2
      APOPGS=1.0/APOPSUM
      APOPV4=APOPV4/APOPSUM
      APOPV2=APOPV2/APOPSUM
C  RENORMALISE GROUND STATE TO ALLOW FOR INCREASED EXCITATION X-SEC
C  FROM EXCITED VIBRATIONAL STATE ( EXACT FOR TWICE GROUND STATE XSEC)
      APOPGS=1.0
C
      EN=-ESTEP/2.0
      DO 1000 I=1,NSTEP
      EN=EN+ESTEP
C USE LOG INTERPOLATION FOR ELASTIC
      IF(EN.LE.XEN(2)) THEN
       QELA=26.7D-16
       QMOM=26.7D-16
       PQ2=0.0
       GO TO 30
      ENDIF
      DO 3 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 4
   3  CONTINUE
      J=NDATA
   4  YXJ=DLOG(YELT(J))
      YXJ1=DLOG(YELT(J-1))
      XNJ=DLOG(XEN(J))
      XNJ1=DLOG(XEN(J-1))
      A=(YXJ-YXJ1)/(XNJ-XNJ1)
      B=(XNJ1*YXJ-XNJ*YXJ1)/(XNJ1-XNJ)
      QELA=DEXP(A*DLOG(EN)+B)*1.D-16
      YXJ=DLOG(YELM(J))
      YXJ1=DLOG(YELM(J-1))
      A=(YXJ-YXJ1)/(XNJ-XNJ1)
      B=(XNJ1*YXJ-XNJ*YXJ1)/(XNJ1-XNJ)
      QMOM=DEXP(A*DLOG(EN)+B)*1.D-16
C USE 1.0 OFFSET IN LOG INTERPOLATION (TO AVOID NEGATIVES)
      YXJ=DLOG(YEPS(J)+1.0)
      YXJ1=DLOG(YEPS(J-1)+1.0)
      A=(YXJ-YXJ1)/(XNJ-XNJ1)
      B=(XNJ1*YXJ-XNJ*YXJ1)/(XNJ1-XNJ)
      PQ2=DEXP(A*DLOG(EN)+B)-1.0
   30 CONTINUE
      PQ1=0.5+(QELA-QMOM)/QELA
      IF(NANISO.EQ.0) PEQEL(2,I)=0.5
      IF(NANISO.EQ.1) PEQEL(2,I)=PQ1
      IF(NANISO.EQ.2) PEQEL(2,I)=PQ2
      Q(2,I)=QELA
      IF(NANISO.EQ.0) Q(2,I)=QMOM
C GROSS IONISATION
      Q(3,I)=0.0
      PEQEL(3,I)=0.5
      IF(NANISO.EQ.2) PEQEL(3,I)=0.0
      IF(EN.LT.E(3)) GO TO 200
      IF(EN.GT.XION(NION)) GO TO 123
      DO 110 J=2,NION
      IF(EN.LE.XION(J)) GO TO 120
  110 CONTINUE
      J=NION
  120 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
      GO TO 124
C USE BORN BETHE X-SECTION ABOVE XION(NION) EV
  123 GAMMA=(EMASS2+2.0D0*EN)/EMASS2
      BETA=DSQRT(1.0D0-1.0D0/(GAMMA*GAMMA))
      BETA2=BETA*BETA
      X2=1.0D0/BETA2
      X1=X2*DLOG(BETA2/(1.0D0-BETA2))-1.0D0
      Q(3,I)=CONST*(AM2*X1+C*X2)/0.99
  124 CONTINUE
C   USE ANISOTROPIC SCATTERING FOR PRIMARY IONISATION ELECTRON FOR
C ENERGIES ABOVE 2 * IONISATION ENERGY
C  ANISOTROPIC DISTRIBUTION SAME AS ELASTIC AT ENERGY OFFSET BY
C  IONISATION ENERGY
      IF(EN.LE.(2.0*E(3))) GO TO 200
      PEQEL(3,I)=PEQEL(2,(I-IOFF))
C
C ATTACHMENT
  200 Q(4,I)=0.0
      IF(EN.LT.XATT(1)) GO TO 250
      IF(EN.GT.XATT(NATT)) GO TO 250
      DO 210 J=2,NATT
      IF(EN.LE.XATT(J)) GO TO 220
  210 CONTINUE
      J=NATT
  220 A=(YATT(J)-YATT(J-1))/(XATT(J)-XATT(J-1))
      B=(XATT(J-1)*YATT(J)-XATT(J)*YATT(J-1))/(XATT(J-1)-XATT(J))
      Q(4,I)=(A*EN+B)*1.D-16
C COUNTING IONISATION
  250 Q(5,I)=0.0
      PEQEL(5,I)=0.5
      IF(NANISO.EQ.2) PEQEL(5,I)=0.0
      IF(EN.LE.E(3)) GO TO 300
      IF(EN.GT.XION(NION)) GO TO 280
      DO 260 J=2,NION
      IF(EN.LE.XION(J)) GO TO 270
  260 CONTINUE
      J=NION
  270 A=(YINC(J)-YINC(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YINC(J)-XION(J)*YINC(J-1))/(XION(J-1)-XION(J))
      Q(5,I)=(A*EN+B)*1.D-16
      GO TO 290
C USE BORN-BETHE X-SECTION ABOVE XION(NION) EV
  280 Q(5,I)=CONST*(AM2*X1+C*X2)
  290 CONTINUE
C   USE ANISOTROPIC SCATTERING FOR PRIMARY IONISATION ELECTRON FOR
C ENERGIES ABOVE 2 * IONISATION ENERGY
C  ANISOTROPIC DISTRIBUTION SAME AS ELASTIC AT ENERGY OFFSET BY
C  IONISATION ENERGY
      IF(EN.LE.(2.0*E(3))) GO TO 295
      PEQEL(5,I)=PEQEL(2,(I-IOFF))
  295 CONTINUE
C
  300 Q(6,I)=0.0
C V4  SUPERELASTIC ISOTROPIC
      QIN(1,I)=0.0
      PEQIN(1,I)=0.5
      IF(EN.LE.0.0) GO TO 350
      DO 310 J=2,NVIBV4
      IF((EN+EIN(2)).LE.XVBV4(J)) GO TO 320
  310 CONTINUE
      J=NVIBV4
  320 A=(YVBV4(J)-YVBV4(J-1))/(XVBV4(J)-XVBV4(J-1))
      B=(XVBV4(J-1)*YVBV4(J)-XVBV4(J)*YVBV4(J-1))/(XVBV4(J-1)-XVBV4(J))
      EFAC=DSQRT(1.0-(EIN(1)/EN))
      QIN(1,I)=0.077*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      QIN(1,I)=QIN(1,I)+(EN+EIN(2))*(A*(EN+EIN(2))+B)/EN
      QIN(1,I)=QIN(1,I)*APOPV4*1.D-16
      QIN(1,I)=QIN(1,I)/DEGV4
  350 CONTINUE
C V4   ANISOTROPIC
      QIN(2,I)=0.0
      IF(EN.LE.EIN(2)) GO TO 400
      DO 360 J=2,NVIBV4
      IF(EN.LE.XVBV4(J)) GO TO 370
  360 CONTINUE
      J=NVIBV4
  370 A=(YVBV4(J)-YVBV4(J-1))/(XVBV4(J)-XVBV4(J-1))
      B=(XVBV4(J-1)*YVBV4(J)-XVBV4(J)*YVBV4(J-1))/(XVBV4(J-1)-XVBV4(J))
      EFAC=DSQRT(1.0-(EIN(2)/EN))
      QIN(2,I)=0.077*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      ELF=EN-EIN(2)
      FWD=DLOG((EN+ELF)/(EN+ELF-2.0*DSQRT(EN*ELF)))
      BCK=DLOG((EN+ELF+2.0*DSQRT(EN*ELF))/(EN+ELF))
C RATIO OF MT TO TOTAL X-SECT FOR RESONANCE PART =RAT
      XMT=((1.5-FWD/(FWD+BCK))*QIN(2,I)+RAT*(A*EN+B))*APOPGS*1.D-16
      QIN(2,I)=((A*EN+B)+QIN(2,I))*APOPGS*1.D-16
      PEQIN(2,I)=0.5+(QIN(2,I)-XMT)/QIN(2,I)
C V2 SUPERELASTIC ISOTROPIC
  400 QIN(3,I)=0.0
      PEQIN(3,I)=0.5
      IF(EN.LE.0.0) GO TO 450
      DO 410 J=2,NVIBV2
      IF((EN+EIN(4)).LE.XVBV2(J)) GO TO 420
  410 CONTINUE
      J=NVIBV2
  420 A=(YVBV2(J)-YVBV2(J-1))/(XVBV2(J)-XVBV2(J-1))
      B=(XVBV2(J-1)*YVBV2(J)-XVBV2(J)*YVBV2(J-1))/(XVBV2(J-1)-XVBV2(J))
      QIN(3,I)=(EN+EIN(4))*(A*(EN+EIN(4))+B)/EN
      QIN(3,I)=QIN(3,I)*APOPV2*1.D-16
      QIN(3,I)=QIN(3,I)/DEGV2
C V2 ANISOTROPIC
  450 QIN(4,I)=0.0
      PEQIN(4,I)=0.5
      IF(EN.LE.EIN(4)) GO TO 500
      DO 460 J=2,NVIBV2
      IF(EN.LE.XVBV2(J)) GO TO 470
  460 CONTINUE
      J=NVIBV2
  470 A=(YVBV2(J)-YVBV2(J-1))/(XVBV2(J)-XVBV2(J-1))
      B=(XVBV2(J-1)*YVBV2(J)-XVBV2(J)*YVBV2(J-1))/(XVBV2(J-1)-XVBV2(J))
      QIN(4,I)=(A*EN+B)*APOPGS*1.D-16
      PEQIN(4,I)=1.5-RAT
C V1  ANISOTROPIC
  500 QIN(5,I)=0.0
      PEQIN(5,I)=0.5
      IF(EN.LE.EIN(5)) GO TO 550
      DO 510 J=2,NVIBV1
      IF(EN.LE.XVBV1(J)) GO TO 520
  510 CONTINUE
      J=NVIBV1
  520 A=(YVBV1(J)-YVBV1(J-1))/(XVBV1(J)-XVBV1(J-1))
      B=(XVBV1(J-1)*YVBV1(J)-XVBV1(J)*YVBV1(J-1))/(XVBV1(J-1)-XVBV1(J))
      QIN(5,I)=(A*EN+B)*1.D-16
      PEQIN(5,I)=1.5-RAT
C V3  ANISOTROPIC
  550 QIN(6,I)=0.0
      IF(EN.LE.EIN(6)) GO TO 600
      DO 560 J=2,NVIBV3
      IF(EN.LE.XVBV3(J)) GO TO 570
  560 CONTINUE
      J=NVIBV3
  570 A=(YVBV3(J)-YVBV3(J-1))/(XVBV3(J)-XVBV3(J-1))
      B=(XVBV3(J-1)*YVBV3(J)-XVBV3(J)*YVBV3(J-1))/(XVBV3(J-1)-XVBV3(J))
      EFAC=DSQRT(1.0-(EIN(6)/EN))
      QIN(6,I)=0.076*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      ELF=EN-EIN(6)
      FWD=DLOG((EN+ELF)/(EN+ELF-2.0*DSQRT(EN*ELF)))
      BCK=DLOG((EN+ELF+2.0*DSQRT(EN*ELF))/(EN+ELF))
C RATIO OF MT TO TOTAL X-SECT FOR RESONANCE PART =RAT
      XMT=((1.5-FWD/(FWD+BCK))*QIN(6,I)+RAT*(A*EN+B))*1.D-16
      QIN(6,I)=((A*EN+B)+QIN(6,I))*1.D-16
      PEQIN(6,I)=0.5+(QIN(6,I)-XMT)/QIN(6,I)
C  VIBRATION HARMONICS 1 (ISOTROPIC)
  600 QIN(7,I)=0.0
      PEQIN(7,I)=0.5
      IF(EN.LE.EIN(7)) GO TO 650
      DO 610 J=2,NVIBH1
      IF(EN.LE.XVBH1(J)) GO TO 620
  610 CONTINUE
      J=NVIBH1
  620 A=(YVBH1(J)-YVBH1(J-1))/(XVBH1(J)-XVBH1(J-1))
      B=(XVBH1(J-1)*YVBH1(J)-XVBH1(J)*YVBH1(J-1))/(XVBH1(J-1)-XVBH1(J))
      QIN(7,I)=(A*EN+B)*1.D-16
C  VIBRATION HARMONICS 2  (ISOTROPIC)
  650 QIN(8,I)=0.0
      PEQIN(8,I)=0.5
      IF(EN.LE.EIN(8)) GO TO 700
      DO 660 J=2,NVIBH2
      IF(EN.LE.XVBH2(J)) GO TO 670
  660 CONTINUE
      J=NVIBH2
  670 A=(YVBH2(J)-YVBH2(J-1))/(XVBH2(J)-XVBH2(J-1))
      B=(XVBH2(J-1)*YVBH2(J)-XVBH2(J)*YVBH2(J-1))/(XVBH2(J-1)-XVBH2(J))
      QIN(8,I)=(A*EN+B)*1.D-16
C ATTACHMENT - DEATTACHMENT RESONANCE VIA H- AT 9.8EV RESONANCE
  700 QIN(9,I)=0.0
      PEQIN(9,I)=0.5
      IF(EN.LE.EIN(9)) GO TO 800
      IF(EN.GT.XDET(NDET)) GO TO 800
      DO 710 J=2,NDET
      IF(EN.LE.XDET(J)) GO TO 720
  710 CONTINUE
      J=NDET
  720 A=(YDET(J)-YDET(J-1))/(XDET(J)-XDET(J-1))
      B=(XDET(J-1)*YDET(J)-XDET(J)*YDET(J-1))/(XDET(J-1)-XDET(J))
      QIN(9,I)=(A*EN+B)*1.D-16
C  DISSOCIATIVE EXCITATION
  800 QIN(10,I)=0.0
      PEQIN(10,I)=0.5
      IF(NANISO.EQ.2) PEQIN(10,I)=0.0
      IF(EN.LE.EIN(10)) GO TO 850
      IF(EN.GT.XDIS1(NDIS1)) GO TO 850
      DO 810 J=2,NDIS1
      IF(EN.LE.XDIS1(J)) GO TO 820
  810 CONTINUE
      J=NDIS1
  820 A=(YDIS1(J)-YDIS1(J-1))/(XDIS1(J)-XDIS1(J-1))
      B=(XDIS1(J-1)*YDIS1(J)-XDIS1(J)*YDIS1(J-1))/(XDIS1(J-1)-XDIS1(J))
      QIN(10,I)=(A*EN+B)*1.D-16
      IF(EN.LE.(3.0*EIN(10))) GO TO 850
      PEQIN(10,I)=PEQEL(2,(I-IOFF10))
  850 CONTINUE
C  DISSOCIATIVE EXCITATION
      QIN(11,I)=0.0
      PEQIN(11,I)=0.5
      IF(NANISO.EQ.2) PEQIN(11,I)=0.0
      IF(EN.LE.EIN(11)) GO TO 900
      IF(EN.GT.XDIS2(NDIS2)) GO TO 880
      DO 860 J=2,NDIS2
      IF(EN.LE.XDIS2(J)) GO TO 870
  860 CONTINUE
      J=NDIS2
  870 A=(YDIS2(J)-YDIS2(J-1))/(XDIS2(J)-XDIS2(J-1))
      B=(XDIS2(J-1)*YDIS2(J)-XDIS2(J)*YDIS2(J-1))/(XDIS2(J-1)-XDIS2(J))
      QIN(11,I)=(A*EN+B)*1.D-16
      GO TO 890
C USE BORN-BETHE X-SECTION ABOVE XDIS2(NDIS2) EV
  880 QIN(11,I)=CONST*(AM2EXC*X1+CEXC*X2)*0.176
  890 IF(EN.LE.(3.0*EIN(11))) GO TO 900
      PEQIN(11,I)=PEQEL(2,(I-IOFF11))
  900 CONTINUE
C    DISSOCIATIVE EXCITATION
      QIN(12,I)=0.0
      PEQIN(12,I)=0.5
      IF(NANISO.EQ.2) PEQIN(12,I)=0.0
      IF(EN.LE.EIN(12)) GO TO 950
      IF(EN.GT.XDIS3(NDIS3)) GO TO 930
      DO 910 J=2,NDIS3
      IF(EN.LE.XDIS3(J)) GO TO 920
  910 CONTINUE
      J=NDIS3
  920 A=(YDIS3(J)-YDIS3(J-1))/(XDIS3(J)-XDIS3(J-1))
      B=(XDIS3(J-1)*YDIS3(J)-XDIS3(J)*YDIS3(J-1))/(XDIS3(J-1)-XDIS3(J))
      QIN(12,I)=(A*EN+B)*1.D-16
      GO TO 940
C USE BORN-BETHE X-SECTION ABOVE XDIS3(NDIS3) EV
  930 QIN(12,I)=CONST*(AM2EXC*X1+CEXC*X2)*0.251
  940 IF(EN.LE.(3.0*EIN(12))) GO TO 950
      PEQIN(12,I)=PEQEL(2,(I-IOFF12))
  950 CONTINUE
C    DISSOCIATIVE EXCITATION
      QIN(13,I)=0.0
      PEQIN(13,I)=0.5
      IF(NANISO.EQ.2) PEQIN(13,I)=0.0
      IF(EN.LE.EIN(13)) GO TO 990
      IF(EN.GT.XDIS4(NDIS4)) GO TO 980
      DO 960 J=2,NDIS4
      IF(EN.LE.XDIS4(J)) GO TO 970
  960 CONTINUE
      J=NDIS4
  970 A=(YDIS4(J)-YDIS4(J-1))/(XDIS4(J)-XDIS4(J-1))
      B=(XDIS4(J-1)*YDIS4(J)-XDIS4(J)*YDIS4(J-1))/(XDIS4(J-1)-XDIS4(J))
      QIN(13,I)=(A*EN+B)*1.D-16
      GO TO 985
C USE BORN-BETHE X-SECTION ABOVE XDIS4(NDIS4)
  980 QIN(13,I)=CONST*(AM2EXC*X1+CEXC*X2)*0.573
  985 IF(EN.LE.(3.0*EIN(13))) GO TO 990
      PEQIN(13,I)=PEQEL(2,(I-IOFF13))
  990 CONTINUE
C    DISSOCIATIVE EXCITATION
      QIN(14,I)=0.0
      PEQIN(14,I)=0.5
      IF(NANISO.EQ.2) PEQIN(14,I)=0.0
      IF(EN.LE.EIN(14)) GO TO 1050
      IF(EN.GT.XDIS5(NDIS5)) GO TO 1050
      DO 1010 J=2,NDIS5
      IF(EN.LE.XDIS5(J)) GO TO 1020
 1010 CONTINUE
      J=NDIS5
 1020 A=(YDIS5(J)-YDIS5(J-1))/(XDIS5(J)-XDIS5(J-1))
      B=(XDIS5(J-1)*YDIS5(J)-XDIS5(J)*YDIS5(J-1))/(XDIS5(J-1)-XDIS5(J))
      QIN(14,I)=(A*EN+B)*1.D-16
      IF(EN.LE.(3.0*EIN(14))) GO TO 1050
      PEQIN(14,I)=PEQEL(2,(I-IOFF14))
 1050 CONTINUE
C  DISSOCIATIVE EXC TO STATES DECAYING VIA CH(A2DELTA TO G.S.)
      QIN(15,I)=0.0
      PEQIN(15,I)=0.5
      IF(NANISO.EQ.2) PEQIN(15,I)=0.0
      IF(EN.LE.EIN(15)) GO TO 1100
      IF(EN.GT.XCHD(NCHD)) GO TO 1100
      DO 1060 J=2,NCHD
      IF(EN.LE.XCHD(J)) GO TO 1070
 1060 CONTINUE
      J=NCHD
 1070 A=(YCHD(J)-YCHD(J-1))/(XCHD(J)-XCHD(J-1))
      B=(XCHD(J-1)*YCHD(J)-XCHD(J)*YCHD(J-1))/(XCHD(J-1)-XCHD(J))
      QIN(15,I)=(A*EN+B)*1.D-16
      IF(EN.LE.(3.0*EIN(15))) GO TO 1100
      PEQIN(15,I)=PEQEL(2,(I-IOFF15))
 1100 CONTINUE
C  DISSOCIATIVE EXC TO STATES DECAYING VIA CH(B2SIGMA- TO G.S.)
      QIN(16,I)=0.0
      PEQIN(16,I)=0.5
      IF(NANISO.EQ.2) PEQIN(16,I)=0.0
      IF(EN.LE.EIN(16)) GO TO 1150
      IF(EN.GT.XCHB(NCHB)) GO TO 1150
      DO 1110 J=2,NCHB
      IF(EN.LE.XCHB(J)) GO TO 1120
 1110 CONTINUE
      J=NCHB
 1120 A=(YCHB(J)-YCHB(J-1))/(XCHB(J)-XCHB(J-1))
      B=(XCHB(J-1)*YCHB(J)-XCHB(J)*YCHB(J-1))/(XCHB(J-1)-XCHB(J))
      QIN(16,I)=(A*EN+B)*1.D-16
      IF(EN.LE.(3.0*EIN(16))) GO TO 1150
      PEQIN(16,I)=PEQEL(2,(I-IOFF16))
 1150 CONTINUE
C  DISSOCIATIVE EXC TO STATES DECAYING VIA H(ALPHA)
      QIN(17,I)=0.0
      PEQIN(17,I)=0.5
      IF(NANISO.EQ.2) PEQIN(17,I)=0.0
      IF(EN.LE.EIN(17)) GO TO 1200
      IF(EN.GT.XHAL(NHAL)) GO TO 1200
      DO 1160 J=2,NHAL
      IF(EN.LE.XHAL(J)) GO TO 1170
 1160 CONTINUE
      J=NHAL
 1170 A=(YHAL(J)-YHAL(J-1))/(XHAL(J)-XHAL(J-1))
      B=(XHAL(J-1)*YHAL(J)-XHAL(J)*YHAL(J-1))/(XHAL(J-1)-XHAL(J))
      QIN(17,I)=(A*EN+B)*1.D-16
      IF(EN.LE.(3.0*EIN(17))) GO TO 1200
      PEQIN(17,I)=PEQEL(2,(I-IOFF17))
 1200 CONTINUE
C  DISSOCIATIVE EXC TO STATES DECAYING VIA H(BETA)
      QIN(18,I)=0.0
      PEQIN(18,I)=0.5
      IF(NANISO.EQ.2) PEQIN(18,I)=0.0
      IF(EN.LE.EIN(18)) GO TO 1250
      IF(EN.GT.XHBE(NHBE)) GO TO 1250
      DO 1210 J=2,NHBE
      IF(EN.LE.XHBE(J)) GO TO 1220
 1210 CONTINUE
      J=NHBE
 1220 A=(YHBE(J)-YHBE(J-1))/(XHBE(J)-XHBE(J-1))
      B=(XHBE(J-1)*YHBE(J)-XHBE(J)*YHBE(J-1))/(XHBE(J-1)-XHBE(J))
      QIN(18,I)=(A*EN+B)*1.D-16
      IF(EN.LE.(3.0*EIN(18))) GO TO 1250
      PEQIN(18,I)=PEQEL(2,(I-IOFF18))
 1250 CONTINUE
C
C
      Q(1,I)=Q(2,I)+Q(5,I)+Q(4,I)+QIN(1,I)+QIN(2,I)+QIN(3,I)+QIN(4,I)+
     /QIN(5,I)+QIN(6,I)+QIN(7,I)+QIN(8,I)+QIN(9,I)+QIN(10,I)+QIN(11,I)+
     /QIN(12,I)+QIN(13,I)+QIN(14,I)+QIN(15,I)+QIN(16,I)+QIN(17,I)+
     /QIN(18,I)
C
 1000 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(18)) NIN=17
      IF(EFINAL.LE.EIN(17)) NIN=16
      IF(EFINAL.LE.EIN(16)) NIN=15
      IF(EFINAL.LE.EIN(15)) NIN=14
      IF(EFINAL.LE.EIN(14)) NIN=13
      IF(EFINAL.LE.EIN(13)) NIN=12
      IF(EFINAL.LE.EIN(12)) NIN=11
      IF(EFINAL.LE.EIN(11)) NIN=10
      IF(EFINAL.LE.EIN(10)) NIN=9
      IF(EFINAL.LE.EIN(9)) NIN=8
      IF(EFINAL.LE.EIN(8)) NIN=7
      IF(EFINAL.LE.EIN(7)) NIN=6
      IF(EFINAL.LE.EIN(6)) NIN=5
      IF(EFINAL.LE.EIN(5)) NIN=4
      IF(EFINAL.LE.EIN(4)) NIN=3
C
      RETURN
      END
      SUBROUTINE GAS9(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      DIMENSION XEN(55),YXSEC(55),XATT(16),YATT(16),XION(50),YION(50),
     /XVIB1(28),YVIB1(28),XVIB2(28),YVIB2(28),XVIB3(28),YVIB3(28),
     /XVIB4(25),YVIB4(25),XVIB5(19),YVIB5(19),
     /XEXC(25),YEXC(25),XEXC1(23),YEXC1(23),XEXC2(19),YEXC2(19)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      DATA XEN/0.00,.001,.002,.003,.004,.005,.007,0.01,.014,0.02,
     /0.03,0.04,0.05,0.06,0.07,0.08,0.09,0.10,0.11,0.12,
     /0.13,0.14,0.16,0.18,0.20,0.24,0.30,0.40,0.50,0.60,
     /0.80,1.00,1.40,2.00,3.00,4.00,5.00,6.00,7.00,8.00,
     /9.00,10.0,15.0,20.0,30.0,40.0,70.0,100.,140.,200.,
     /1000.,2000.,10000.,20000.,100000./
      DATA YXSEC/40.0,34.0,31.0,29.0,28.0,27.0,25.0,22.5,20.0,16.0,
     /12.0,7.25,4.70,3.25,2.40,1.80,1.40,1.15,1.10,1.10,
     /1.10,1.10,1.20,1.55,1.90,3.00,4.10,6.00,7.30,7.90,
     /8.30,8.80,9.60,10.6,12.6,15.8,19.8,22.2,23.0,21.5,
     /19.0,16.2,10.9,7.00,4.90,3.76,2.15,1.41,1.00,0.70,
     /0.14,0.07,.012,.006,.0012/
      DATA XVIB1/.117,0.13,0.15,0.20,0.23,0.25,0.30,0.40,0.50,0.70,
     /1.00,1.50,2.00,3.00,4.00,5.00,6.00,7.50,8.50,10.0,
     /15.0,20.0,30.0,40.0,100.,1000.,10000.,100000./
      DATA YVIB1/0.00,0.06,0.09,.115,0.12,0.12,0.11,0.09,.078,.055,
     /0.04,0.04,0.06,0.11,0.16,0.21,0.27,0.37,0.37,0.30,
     /0.21,0.11,0.06,.036,0.01,.001,.0001,.00001/
      DATA XVIB2/.148,0.16,0.17,0.20,0.23,0.25,0.30,0.40,0.50,0.70,
     /1.00,1.50,2.00,3.00,4.00,5.00,6.00,7.50,8.50,10.0,
     /15.0,20.0,30.0,40.0,100.,1000.,10000.,100000./
      DATA YVIB2/0.00,.057,0.10,0.14,0.15,0.16,0.16,0.14,0.12,0.09,
     /0.07,0.07,0.09,0.15,0.22,0.29,0.38,0.48,0.48,0.40,
     /0.28,0.16,0.09,0.06,.016,.0016,.00016,.000016/
      DATA XVIB3/.182,0.19,0.20,0.23,0.25,0.30,0.35,0.40,0.50,0.70,
     /1.00,1.50,2.00,3.00,4.00,5.00,6.00,7.50,8.50,10.0,
     /15.0,20.0,30.0,40.0,100.,1000.,10000.,100000./
      DATA YVIB3/0.00,0.11,0.13,0.27,0.33,0.37,0.38,0.37,0.32,0.23,
     /0.16,0.16,0.19,0.35,0.52,0.68,0.88,1.15,1.15,0.95,
     /0.65,0.37,0.20,0.12,0.03,.003,.0003,.00003/
      DATA XVIB4/.366,0.40,0.45,0.50,0.60,0.70,0.80,1.00,1.50,2.00,
     /3.00,4.00,5.00,6.00,7.50,8.50,10.0,15.0,20.0,30.0,
     /40.0,100.,1000.,10000.,100000./
      DATA YVIB4/0.00,0.20,0.32,0.34,0.36,0.37,0.37,0.34,0.30,0.36,
     /0.53,0.78,1.02,1.35,1.48,1.25,0.95,0.55,0.23,0.13,
     /0.08,.016,.0016,.00016,.000016/
      DATA XVIB5/.548,1.00,1.50,2.00,3.00,4.00,5.00,6.00,7.50,8.50,
     /10.0,15.0,20.0,30.0,40.0,100.,1000.,10000.,100000./
      DATA YVIB5/0.00,.001,0.01,.016,.035,0.06,0.09,0.12,0.13,0.11,
     /0.08,.045,0.02,0.01,.007,.0016,.00016,.000016,.0000016/
      DATA XION/11.52,12.0,12.5,13.0,14.0,15.0,16.0,17.0,18.0,19.0,
     /20.0,25.0,30.0,35.0,40.0,45.0,50.0,60.0,70.0,80.0,
     /90.0,100.,125.,150.,175.,200.,250.,300.,350.,400.,
     /450.,500.,600.,700.,800.,900.,1000.,1250.,1500.,1750.,
     /2000.,2500.,3000.,4000.,6000.,8000.,12000.,20000.,40000.,100000./
      DATA YION/0.00,.014,0.06,.135,.345,0.63,0.94,1.28,1.62,1.95,
     /2.24,3.48,4.45,4.94,5.41,5.84,6.04,6.67,6.93,6.86,
     /6.84,6.89,6.53,6.32,5.98,5.68,5.01,4.60,4.18,3.86,
     /3.47,3.33,3.03,2.71,2.38,2.25,2.03,1.75,1.52,1.37,
     /1.22,1.08,0.90,0.72,0.53,0.42,0.30,0.20,0.11,.045/
      DATA XATT/6.85,7.00,7.20,7.50,8.00,8.50,9.00,9.50,10.0,10.5,
     /11.0,11.5,12.0,12.5,13.0,13.2/
      DATA YATT/0.00,0.67,1.10,1.65,2.80,4.40,6.60,10.3,14.7,12.3,
     /9.70,6.20,3.50,1.30,0.50,0.00/
      DATA XEXC/8.20,9.00,10.0,11.0,12.0,14.0,16.0,20.0,25.0,30.0,
     /40.0,60.0,80.0,100.,150.,200.,300.,400.,600.,1000.,
     /2000.,4000.,10000.,20000.,100000./
      DATA YEXC/0.00,0.40,0.70,0.80,0.90,1.00,1.05,1.20,1.35,1.45,
     /1.50,1.50,1.50,1.40,1.30,1.20,1.00,0.90,0.70,0.50,
     /0.25,0.13,0.05,.025,.005/
      DATA XEXC1/10.3,11.0,12.0,14.0,16.0,20.0,25.0,30.0,
     /40.0,60.0,80.0,100.,150.,200.,300.,400.,600.,1000.,
     /2000.,4000.,10000.,20000.,100000./
      DATA YEXC1/0.00,0.15,0.30,0.55,0.85,1.15,1.35,1.45,
     /1.50,1.50,1.50,1.40,1.30,1.20,1.00,0.90,0.70,0.50,
     /0.25,0.13,0.05,.025,.005/
      DATA XEXC2/17.0,20.0,25.0,30.0,
     /40.0,60.0,80.0,100.,150.,200.,300.,400.,600.,1000.,
     /2000.,4000.,10000.,20000.,100000./
      DATA YEXC2/0.00,0.25,0.55,0.70,
     /0.75,0.70,0.67,0.64,0.58,0.50,0.40,0.32,0.23,0.15,
     /0.08,.045,0.02,0.01,.002/
      NAME=' ETHANE 1999   '
C ---------------------------------------------------------------------
C UPDATED TO DEC 1994 . INCLUDES LATEST ELECTRON SCATTERING RESULTS
C GIVES BETTER FIT THAN PREVIOUS DATA SET
C 1999 MOD USES VIBRATION AT 35.8 MV AND ALSO SUPER ELASTICS.
C          ALSO MOD TO ELASTIC AT LOW ENERGY BELOW 20 MV
C ---------------------------------------------------------------------
      NIN=11
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      NDATA=55
      NION=50
      NATT=16
      NVIB1=28
      NVIB2=28
      NVIB3=28
      NVIB4=25
      NVIB5=19
      NEXC=25
      NEXC1=23
      NEXC2=19
      E(1)=0.0
      E(2)=2.0*EMASS/(30.06964*AMU)
      E(3)=11.52
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=11.52
      EIN(1)=-0.0358
      EIN(2)=0.0358
      EIN(3)=-0.117
      EIN(4)=0.117
      EIN(5)=0.148
      EIN(6)=0.182
      EIN(7)=0.366
      EIN(8)=0.548
      EIN(9)=8.2
      EIN(10)=10.3
      EIN(11)=17.0
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       ETHANE         '
      SCRPT(3)=' IONISATION    ELOSS= 11.52   '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' VIB           ELOSS= -0.0358 '
      SCRPT(8)=' VIB           ELOSS=  0.0358 '
      SCRPT(9)=' VIB           ELOSS= -0.117  '
      SCRPT(10)=' VIB           ELOSS=  0.117  '
      SCRPT(11)=' VIB           ELOSS=  0.148  '
      SCRPT(12)=' VIB           ELOSS=  0.182  '
      SCRPT(13)=' VIB           ELOSS=  0.366  '
      SCRPT(14)=' VIB           ELOSS=  0.548  '
      SCRPT(15)=' EXC           ELOSS=  8.2    '
      SCRPT(16)=' EXC           ELOSS= 10.3    '
      SCRPT(17)=' EXC           ELOSS= 17.0    '
      APOP=DEXP(EIN(1)/AKT)
      POPVH=DEXP(EIN(3)/AKT)
      EN=-ESTEP/2.0
      DO 1000 I=1,NSTEP
      EN=EN+ESTEP
      DO 10 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 20
   10 CONTINUE
      J=NDATA
   20 A=(YXSEC(J)-YXSEC(J-1))/(XEN(J)-XEN(J-1))
      B=(XEN(J-1)*YXSEC(J)-XEN(J)*YXSEC(J-1))/(XEN(J-1)-XEN(J))
      Q(2,I)=(A*EN+B)*1.D-16
      Q(3,I)=0.0
      IF(EN.LT.E(3)) GO TO 200
      DO 110 J=2,NION
      IF(EN.LE.XION(J)) GO TO 120
  110 CONTINUE
      J=NION
  120 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
  200 Q(4,I)=0.0
      IF(EN.LT.XATT(1)) GO TO 300
      IF(EN.GE.XATT(NATT)) GO TO 300
      DO 210 J=2,NATT
      IF(EN.LE.XATT(J)) GO TO 220
  210 CONTINUE
      J=NATT
  220 A=(YATT(J)-YATT(J-1))/(XATT(J)-XATT(J-1))
      B=(XATT(J-1)*YATT(J)-XATT(J)*YATT(J-1))/(XATT(J-1)-XATT(J))
      Q(4,I)=(A*EN+B)*1.D-21
  300 Q(5,I)=0.0
      Q(6,I)=0.0
C SUPER V TORSION
      QIN(1,I)=0.0
      IF(EN.EQ.0.0) GO TO 1300
      EFAC=DSQRT(1.0-(EIN(1)/EN))
      QIN(1,I)=0.003*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      QIN(1,I)=QIN(1,I)*APOP/(1.0+APOP)*1.D-16
C
 1300 CONTINUE
      QIN(2,I)=0.0
      IF(EN.LE.EIN(2)) GO TO 1301
      EFAC=DSQRT(1.0-(EIN(2)/EN))
      QIN(2,I)=0.003*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      QIN(2,I)=QIN(2,I)*1.0/(1.0+APOP)*1.D-16
 1301 CONTINUE
C SUPERELASTIC VIB1
C
      QIN(3,I)=0.0
      IF(EN.LE.0.0) GO TO 305
      DO 301 J=2,NVIB1
      IF((EN+EIN(4)).LE.XVIB1(J)) GO TO 302
  301 CONTINUE
      J=NVIB1
  302 A=(YVIB1(J)-YVIB1(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB1(J)-XVIB1(J)*YVIB1(J-1))/(XVIB1(J-1)-XVIB1(J))
      QIN(3,I)=(EN+EIN(4))*(A*(EN+EIN(4))+B)*1.D-16/EN
      QIN(3,I)=QIN(3,I)*POPVH/(1.0+POPVH)
  305 CONTINUE
C
      QIN(4,I)=0.0
      IF(EN.LE.EIN(4)) GO TO 400
      DO 310 J=2,NVIB1
      IF(EN.LE.XVIB1(J)) GO TO 320
  310 CONTINUE
      J=NVIB1
  320 A=(YVIB1(J)-YVIB1(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB1(J)-XVIB1(J)*YVIB1(J-1))/(XVIB1(J-1)-XVIB1(J))
      QIN(4,I)=(A*EN+B)*1.D-16
      QIN(4,I)=QIN(4,I)/(1.0+POPVH)
  400 CONTINUE
      QIN(5,I)=0.0
      IF(EN.LE.EIN(5)) GO TO 500
      DO 410 J=2,NVIB2
      IF(EN.LE.XVIB2(J)) GO TO 420
  410 CONTINUE
      J=NVIB2
  420 A=(YVIB2(J)-YVIB2(J-1))/(XVIB2(J)-XVIB2(J-1))
      B=(XVIB2(J-1)*YVIB2(J)-XVIB2(J)*YVIB2(J-1))/(XVIB2(J-1)-XVIB2(J))
      QIN(5,I)=(A*EN+B)*1.D-16
  500 CONTINUE
      QIN(6,I)=0.0
      IF(EN.LE.EIN(6)) GO TO 600
      DO 510 J=2,NVIB3
      IF(EN.LE.XVIB3(J)) GO TO 520
  510 CONTINUE
      J=NVIB3
  520 A=(YVIB3(J)-YVIB3(J-1))/(XVIB3(J)-XVIB3(J-1))
      B=(XVIB3(J-1)*YVIB3(J)-XVIB3(J)*YVIB3(J-1))/(XVIB3(J-1)-XVIB3(J))
      QIN(6,I)=(A*EN+B)*1.D-16
  600 CONTINUE
      QIN(7,I)=0.0
      IF(EN.LE.EIN(7)) GO TO 700
      DO 610 J=2,NVIB4
      IF(EN.LE.XVIB4(J)) GO TO 620
  610 CONTINUE
      J=NVIB4
  620 A=(YVIB4(J)-YVIB4(J-1))/(XVIB4(J)-XVIB4(J-1))
      B=(XVIB4(J-1)*YVIB4(J)-XVIB4(J)*YVIB4(J-1))/(XVIB4(J-1)-XVIB4(J))
      QIN(7,I)=(A*EN+B)*1.D-16
  700 CONTINUE
      QIN(8,I)=0.0
      IF(EN.LE.EIN(8)) GO TO 800
      DO 710 J=2,NVIB5
      IF(EN.LE.XVIB5(J)) GO TO 720
  710 CONTINUE
      J=NVIB5
  720 A=(YVIB5(J)-YVIB5(J-1))/(XVIB5(J)-XVIB5(J-1))
      B=(XVIB5(J-1)*YVIB5(J)-XVIB5(J)*YVIB5(J-1))/(XVIB5(J-1)-XVIB5(J))
      QIN(8,I)=(A*EN+B)*1.D-16
  800 CONTINUE
      QIN(9,I)=0.0
      IF(EN.LE.EIN(9)) GO TO 900
      DO 810 J=2,NEXC
      IF(EN.LE.XEXC(J)) GO TO 820
  810 CONTINUE
      J=NEXC
  820 A=(YEXC(J)-YEXC(J-1))/(XEXC(J)-XEXC(J-1))
      B=(XEXC(J-1)*YEXC(J)-XEXC(J)*YEXC(J-1))/(XEXC(J-1)-XEXC(J))
      QIN(9,I)=(A*EN+B)*1.D-16
  900 CONTINUE
      QIN(10,I)=0.0
      IF(EN.LE.EIN(10)) GO TO 990
      DO 910 J=2,NEXC1
      IF(EN.LE.XEXC1(J)) GO TO 920
  910 CONTINUE
      J=NEXC1
  920 A=(YEXC1(J)-YEXC1(J-1))/(XEXC1(J)-XEXC1(J-1))
      B=(XEXC1(J-1)*YEXC1(J)-XEXC1(J)*YEXC1(J-1))/(XEXC1(J-1)-XEXC1(J))
      QIN(10,I)=(A*EN+B)*1.D-16
  990 CONTINUE
      QIN(11,I)=0.0
      IF(EN.LE.EIN(11)) GO TO 1990
      DO 1910 J=2,NEXC2
      IF(EN.LE.XEXC2(J)) GO TO 1920
 1910 CONTINUE
      J=NEXC2
 1920 A=(YEXC2(J)-YEXC2(J-1))/(XEXC2(J)-XEXC2(J-1))
      B=(XEXC2(J-1)*YEXC2(J)-XEXC2(J)*YEXC2(J-1))/(XEXC2(J-1)-XEXC2(J))
      QIN(11,I)=(A*EN+B)*1.D-16
 1990 CONTINUE
C
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+QIN(1,I)+QIN(2,I)+QIN(3,I)+QIN(4,I)+
     /QIN(5,I)+QIN(6,I)+QIN(7,I)+QIN(8,I)+QIN(9,I)+QIN(10,I)+QIN(11,I)
 1000 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(11)) NIN=10
      IF(EFINAL.LE.EIN(10)) NIN=9
      IF(EFINAL.LE.EIN(9)) NIN=8
      IF(EFINAL.LE.EIN(8)) NIN=7
      IF(EFINAL.LE.EIN(7)) NIN=6
      IF(EFINAL.LE.EIN(6)) NIN=5
      IF(EFINAL.LE.EIN(5)) NIN=4
      IF(EFINAL.LE.EIN(4)) NIN=3
      IF(EFINAL.LE.EIN(3)) NIN=2
      IF(EFINAL.LE.EIN(2)) NIN=1
      IF(EFINAL.LE.EIN(1)) NIN=0
      RETURN
      END
      SUBROUTINE GAS10(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      DIMENSION XEN(59),YXSEC(59),XION(46),YION(46),XATT(16),YATT(16),
     /XVIB1(28),YVIB1(28),XVIB2(28),YVIB2(28),XVIB3(25),YVIB3(25),
     /XVIB4(19),YVIB4(19),XEXC1(25),YEXC1(25),XEXC2(23),YEXC2(23),
     /XEXC3(19),YEXC3(19)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      DATA XEN/0.00,0.001,0.002,0.003,0.004,0.005,0.007,0.01,0.014,0.02,
     /0.03,0.04,0.05,0.06,0.07,0.08,0.09,0.10,0.11,0.12,
     /0.13,0.14,0.16,0.18,0.20,0.24,0.30,0.40,0.50,
     /0.60,0.80,1.00,1.40,2.00,3.00,4.00,5.00,6.00,7.50,
     /8.50,10.0,15.0,20.0,30.0,40.0,70.0,100.,140.,200.,
     /250.,300.,500.,1000.,1500.,3000.,6000.,10000.,20000.,100000./
      DATA YXSEC/55.0,55.0,46.0,40.0,36.0,32.0,27.5,22.5,19.5,16.5,
     /14.2,12.5,11.2,9.80,8.20,6.70,5.30,3.80,3.00,2.65,
     /2.60,2.60,2.90,3.40,4.30,6.10,8.40,10.0,11.2,
     /12.0,12.5,13.0,13.7,15.5,17.7,22.0,25.4,27.7,30.0,
     /26.0,23.1,16.7,13.0,9.00,6.80,4.00,2.88,1.70,1.05,
     /0.75,0.62,0.35,.155,0.10,.045,0.02,.012,.005,.001/
      DATA XION/10.95,12.0,13.0,14.0,15.0,17.5,20.0,25.0,30.0,35.0,
     /40.0,45.0,50.0,60.0,70.0,80.0,90.0,100.,125.,150.,
     /175.,200.,250.,300.,350.,400.,450.,500.,600.,700.,
     /800.,900.,1000.,1250.,1500.,1750.,2000.,2500.,3000.,5000.,
     /7000.,10000.,15000.,30000.,60000.,100000./
      DATA YION/0.00,0.21,0.47,0.76,1.14,2.30,3.31,5.21,6.47,7.37,
     /8.00,8.54,9.22,9.79,10.1,10.2,10.2,10.2,9.90,9.36,
     /8.84,8.35,7.80,6.84,6.25,5.78,5.26,4.93,4.33,3.99,
     /3.67,3.27,3.05,2.64,2.27,2.06,1.88,1.62,1.39,0.92,
     /0.69,0.51,0.36,.195,.105,.066/
      DATA XATT/6.85,7.00,7.20,7.50,8.00,8.50,9.00,9.50,10.0,10.5,
     /11.0,11.5,12.0,12.5,13.0,13.2/
      DATA YATT/0.00,0.90,1.48,2.23,3.78,5.94,8.91,13.9,19.8,16.6,
     /13.1,8.37,4.72,1.76,0.67,0.00/
      DATA XVIB1/.108,.125,0.15,0.20,0.23,0.25,0.30,0.40,0.50,0.70,
     /1.00,1.50,2.00,3.00,4.00,5.00,6.00,7.50,8.50,10.0,
     /15.0,20.0,30.0,40.0,100.,1000.,10000.,100000./
      DATA YVIB1/0.00,0.16,0.31,0.42,0.43,0.43,0.39,0.33,0.29,0.24,
     /0.19,0.19,0.23,0.37,0.55,0.72,0.93,1.22,1.22,1.00,
     /0.69,0.39,0.21,0.13,0.03,.003,.0003,.00003/
      DATA XVIB2/.173,0.18,0.19,0.20,0.23,0.25,0.30,0.40,0.50,0.70,
     /1.00,1.50,2.00,3.00,4.00,5.00,6.00,7.50,8.50,10.0,
     /15.0,20.0,30.0,40.0,100.,1000.,10000.,100000./
      DATA YVIB2/0.00,0.10,0.21,0.29,0.38,0.41,0.43,0.41,0.38,0.32,
     /0.26,0.24,0.25,0.37,0.55,0.72,0.93,1.22,1.22,1.00,
     /0.69,0.39,0.21,0.13,0.03,.003,.0003,.00003/
      DATA XVIB3/.363,0.40,0.45,0.50,0.60,0.70,0.80,1.00,1.50,2.00,
     /3.00,4.00,5.00,6.00,7.50,8.50,10.0,15.0,20.0,30.0,
     /40.0,100.,1000.,10000.,100000./
      DATA YVIB3/0.00,0.33,0.44,0.49,0.52,0.52,0.49,0.46,0.44,0.48,
     /0.70,1.00,1.30,1.68,1.85,1.60,1.18,0.68,0.30,0.17,
     /0.10,0.02,.002,.0002,.00002/
      DATA XVIB4/.519,1.00,1.50,2.00,3.00,4.00,5.00,6.00,7.50,8.50,
     /10.0,15.0,20.0,30.0,40.0,100.,1000.,10000.,100000./
      DATA YVIB4/0.00,.001,0.01,.020,.050,.094,0.12,0.16,0.18,0.15,
     /.114,.066,.028,.016,.010,.002,.0002,.00002,.000002/
      DATA XEXC1/7.70,9.00,10.0,11.0,12.0,14.0,16.0,20.0,25.0,30.0,
     /40.0,60.0,80.0,100.,150.,200.,300.,400.,600.,1000.,
     /2000.,4000.,10000.,20000.,100000./
      DATA YEXC1/0.00,1.00,1.45,1.55,1.60,1.65,1.65,1.65,1.65,1.65,
     /1.70,1.70,1.65,1.55,1.30,1.20,1.00,0.94,0.80,0.52,
     /0.25,0.13,0.05,.026,.005/
      DATA XEXC2/10.0,11.0,12.0,14.0,16.0,20.0,25.0,30.0,
     /40.0,60.0,80.0,100.,150.,200.,300.,400.,600.,1000.,
     /2000.,4000.,10000.,20000.,100000./
      DATA YEXC2/0.00,0.15,0.31,0.58,0.89,1.20,1.40,1.52,
     /1.65,1.70,1.65,1.55,1.30,1.20,1.00,0.94,0.80,0.52,
     /0.25,0.13,0.05,.026,.005/
      DATA XEXC3/17.0,20.0,25.0,30.0,
     /40.0,60.0,80.0,100.,150.,200.,300.,400.,600.,1000.,
     /2000.,4000.,10000.,20000.,100000./
      DATA YEXC3/0.00,0.33,0.72,1.00,
     /1.40,1.65,1.65,1.55,1.30,1.20,1.00,0.94,0.80,0.52,
     /0.25,0.13,0.05,.026,.005/
C
      NAME='PROPANE 1999   '
C ---------------------------------------------------------------------
      NIN=8
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      NDATA=59
      NION=46
      NATT=16
      NVIB1=28
      NVIB2=28
      NVIB3=25
      NVIB4=19
      NEXC1=25
      NEXC2=23
      NEXC3=19
      E(1)=0.0
      E(2)=2.0*EMASS/(44.09652*AMU)
      E(3)=10.95
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=10.95
      EIN(1)=-0.108
      EIN(2)=0.108
      EIN(3)=0.173
      EIN(4)=0.363
      EIN(5)=0.519
      EIN(6)=7.7
      EIN(7)=10.0
      EIN(8)=17.0
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       PROPANE        '
      SCRPT(3)=' IONISATION    ELOSS=10.95    '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' VIB           ELOSS= -0.108  '
      SCRPT(8)=' VIB           ELOSS=  0.108  '
      SCRPT(9)=' VIB           ELOSS=  0.173  '
      SCRPT(10)=' VIB           ELOSS=  0.363  '
      SCRPT(11)=' VIB           ELOSS=  0.519  '
      SCRPT(12)=' EXC           ELOSS=  7.70   '
      SCRPT(13)=' EXC           ELOSS= 10.0    '
      SCRPT(14)=' EXC           ELOSS= 17.0    '
      APOP=DEXP(EIN(1)/AKT)
      EN=-ESTEP/2.0
      DO 1000 I=1,NSTEP
      EN=EN+ESTEP
      DO 10 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 20
   10 CONTINUE
      J=NDATA
   20 A=(YXSEC(J)-YXSEC(J-1))/(XEN(J)-XEN(J-1))
      B=(XEN(J-1)*YXSEC(J)-XEN(J)*YXSEC(J-1))/(XEN(J-1)-XEN(J))
      Q(2,I)=(A*EN+B)*1.0D-16
      Q(3,I)=0.0
      IF(EN.LT.E(3)) GO TO 200
      DO 110 J=2,NION
      IF(EN.LE.XION(J)) GO TO 120
  110 CONTINUE
      J=NION
  120 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
  200 Q(4,I)=0.0
      IF(EN.LT.XATT(1)) GO TO 300
      IF(EN.GT.XATT(NATT)) GO TO 300
      DO 210 J=2,NATT
      IF(EN.LE.XATT(J)) GO TO 220
  210 CONTINUE
      J=NATT
  220 A=(YATT(J)-YATT(J-1))/(XATT(J)-XATT(J-1))
      B=(XATT(J-1)*YATT(J)-XATT(J)*YATT(J-1))/(XATT(J-1)-XATT(J))
      Q(4,I)=(A*EN+B)*1.D-21
  300 Q(5,I)=0.0
      Q(6,I)=0.0
C
      QIN(1,I)=0.0
      IF(EN.LE.0.0) GO TO 1100
      DO 1010 J=2,NVIB1
      IF((EN+EIN(2)).LE.XVIB1(J)) GO TO 1020
 1010 CONTINUE
      J=NVIB1
 1020 A=(YVIB1(J)-YVIB1(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB1(J)-XVIB1(J)*YVIB1(J-1))/(XVIB1(J-1)-XVIB1(J))
      QIN(1,I)=(EN+EIN(2))*(A*(EN+EIN(2))+B)*1.D-16/EN
      QIN(1,I)=QIN(1,I)*APOP/(1.0+APOP)
 1100 CONTINUE
      QIN(2,I)=0.0
      IF(EN.LE.EIN(2)) GO TO 400
      DO 310 J=2,NVIB1
      IF(EN.LE.XVIB1(J)) GO TO 320
  310 CONTINUE
      J=NVIB1
  320 A=(YVIB1(J)-YVIB1(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB1(J)-XVIB1(J)*YVIB1(J-1))/(XVIB1(J-1)-XVIB1(J))
      QIN(2,I)=(A*EN+B)*1.D-16
      QIN(2,I)=QIN(2,I)/(1.0+APOP)
  400 CONTINUE
      QIN(3,I)=0.0
      IF(EN.LE.EIN(3)) GO TO 500
      DO 410 J=2,NVIB2
      IF(EN.LE.XVIB2(J)) GO TO 420
  410 CONTINUE
      J=NVIB2
  420 A=(YVIB2(J)-YVIB2(J-1))/(XVIB2(J)-XVIB2(J-1))
      B=(XVIB2(J-1)*YVIB2(J)-XVIB2(J)*YVIB2(J-1))/(XVIB2(J-1)-XVIB2(J))
      QIN(3,I)=(A*EN+B)*1.D-16
  500 CONTINUE
      QIN(4,I)=0.0
      IF(EN.LE.EIN(4)) GO TO 600
      DO 510 J=2,NVIB3
      IF(EN.LE.XVIB3(J)) GO TO 520
  510 CONTINUE
      J=NVIB3
  520 A=(YVIB3(J)-YVIB3(J-1))/(XVIB3(J)-XVIB3(J-1))
      B=(XVIB3(J-1)*YVIB3(J)-XVIB3(J)*YVIB3(J-1))/(XVIB3(J-1)-XVIB3(J))
      QIN(4,I)=(A*EN+B)*1.D-16
  600 CONTINUE
      QIN(5,I)=0.0
      IF(EN.LE.EIN(5)) GO TO 700
      DO 610 J=2,NVIB4
      IF(EN.LE.XVIB4(J)) GO TO 620
  610 CONTINUE
      J=NVIB4
  620 A=(YVIB4(J)-YVIB4(J-1))/(XVIB4(J)-XVIB4(J-1))
      B=(XVIB4(J-1)*YVIB4(J)-XVIB4(J)*YVIB4(J-1))/(XVIB4(J-1)-XVIB4(J))
      QIN(5,I)=(A*EN+B)*1.D-16
  700 CONTINUE
      QIN(6,I)=0.0
      IF(EN.LE.EIN(6)) GO TO 800
      DO 710 J=2,NEXC1
      IF(EN.LE.XEXC1(J)) GO TO 720
  710 CONTINUE
      J=NEXC1
  720 A=(YEXC1(J)-YEXC1(J-1))/(XEXC1(J)-XEXC1(J-1))
      B=(XEXC1(J-1)*YEXC1(J)-XEXC1(J)*YEXC1(J-1))/(XEXC1(J-1)-XEXC1(J))
      QIN(6,I)=(A*EN+B)*1.D-16
  800 CONTINUE
      QIN(7,I)=0.0
      IF(EN.LE.EIN(7)) GO TO 900
      DO 810 J=2,NEXC2
      IF(EN.LE.XEXC2(J)) GO TO 820
  810 CONTINUE
      J=NEXC2
  820 A=(YEXC2(J)-YEXC2(J-1))/(XEXC2(J)-XEXC2(J-1))
      B=(XEXC2(J-1)*YEXC2(J)-XEXC2(J)*YEXC2(J-1))/(XEXC2(J-1)-XEXC2(J))
      QIN(7,I)=(A*EN+B)*1.D-16
  900 CONTINUE
      QIN(8,I)=0.0
      IF(EN.LE.EIN(8)) GO TO 990
      DO 910 J=2,NEXC3
      IF(EN.LE.XEXC3(J)) GO TO 920
  910 CONTINUE
      J=NEXC3
  920 A=(YEXC3(J)-YEXC3(J-1))/(XEXC3(J)-XEXC3(J-1))
      B=(XEXC3(J-1)*YEXC3(J)-XEXC3(J)*YEXC3(J-1))/(XEXC3(J-1)-XEXC3(J))
      QIN(8,I)=(A*EN+B)*1.D-16
  990 CONTINUE
C
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+QIN(1,I)+QIN(2,I)+QIN(3,I)+QIN(4,I)+
     /QIN(5,I)+QIN(6,I)+QIN(7,I)+QIN(8,I)
 1000 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(8)) NIN=7
      IF(EFINAL.LE.EIN(7)) NIN=6
      IF(EFINAL.LE.EIN(6)) NIN=5
      IF(EFINAL.LE.EIN(5)) NIN=4
      IF(EFINAL.LE.EIN(4)) NIN=3
      IF(EFINAL.LE.EIN(3)) NIN=2
      IF(EFINAL.LE.EIN(2)) NIN=1
      IF(EFINAL.LE.EIN(1)) NIN=0
      RETURN
      END
      SUBROUTINE GAS11(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      DIMENSION XEN(122),YELM(122),YELT(122),YEPS(122),
     /XION(38),YION(38),YINC(38),XATT(10),YATT(10),
     /XVIB1(36),YVIB1(36),XVIB2(30),YVIB2(30),XVIB3(30),YVIB3(30),
     /XVIB4(35),YVIB4(35),XVIB5(21),YVIB5(21),XEXC1(24),YEXC1(24),
     /XEXC2(21),YEXC2(21),XEXC3(20),YEXC3(20)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
C ELASTIC
      DATA XEN/0.00,0.001,0.002,0.003,0.004,0.005,0.007,0.01,0.014,0.02,
     /.025,0.03,.035,0.04,0.05,0.06,0.07,0.08,0.09,0.10,
     /0.11,0.12,0.13,0.14,0.16,0.18,0.20,0.23,0.26,0.30,
     /0.35,0.40,0.50,0.60,0.80,1.00,1.40,2.00,3.00,4.00,
     /5.00,6.00,7.00,8.00,9.00,10.0,12.5,15.0,20.0,25.0,
     /30.0,40.0,50.0,60.0,70.0,80.0,100.,120.,140.,170.,
     /200.,250.,300.,400.,500.,750.,1000.,1250.,1500.,1750.,
     /2000.,2500.,3000.,3500.,4000.,4500.,5000.,6000.,7000.,8000.,
     /9000.,1.D4,1.25D4,1.5D4,1.75D4,2.D4,2.5D4,3.D4,3.5D4,4.D4,
     /4.5D4,5.D4,6.D4,7.D4,8.D4,9.D4,1.D5,1.25D5,1.5D5,1.75D5,
     /2.0D5,2.5D5,3.D5,3.5D5,4.D5,4.5D5,5.D5,6.D5,7.D5,8.D5,
     /9.D5,1.D6,1.25D6,1.5D6,1.75D6,2.D6,2.5D6,3.D6,3.5D6,4.D6,
     /5.D6,1.D7/
C ELASTIC MOMENTUM TRANSFER X-SECTION
      DATA YELM/255.,255.,255.,255.,255.,210.,150.,105.,74.5,52.0,
     /41.4,34.5,29.6,25.9,20.7,17.2,14.8,13.0,11.7,10.8,
     /10.0,9.30,8.60,8.00,7.00,5.50,3.50,3.60,4.80,7.50,
     /9.60,11.2,12.9,13.8,14.7,15.3,16.1,17.3,19.8,23.2,
     /27.8,32.3,35.0,35.0,33.0,30.0,25.0,21.5,17.0,13.7,
     /11.5,9.00,7.30,6.10,5.20,4.50,3.50,2.80,2.21,1.72,
     /1.40,1.10,0.87,0.61,0.47,0.28,.171,.116,.0848,.0648,
     /.0505,.0345,.0249,.0189,.0149,.0120,.00996,.00717,.00542,.00426,
     /.00344,.00284,.00190,.00136,.00103,.000807,.000539,.000387,
     /.000293,.000231,
     /1.87D-4,1.55D-4,1.12D-4,8.50D-5,6.72D-5,5.46D-5,4.55D-5,3.10D-5,
     /2.27D-5,1.75D-5,
     /1.40D-5,9.71D-6,7.24D-6,5.66D-6,4.59D-6,3.81D-6,3.24D-6,2.44D-6,
     /1.93D-6,1.57D-6,
     /1.31D-6,1.12D-6,8.01D-7,6.04D-7,4.75D-7,3.84D-7,2.69D-7,2.00D-7,
     /1.55D-7,1.24D-7,
     /8.52D-8,2.55D-8/
C ELASTIC X-SECTION ASSUMED ISOTROPIC BELOW     2.0 EV
      DATA YELT/255.,255.,255.,255.,255.,210.,150.,105.,74.5,52.0,
     /41.4,34.5,29.6,25.9,20.7,17.2,14.8,13.0,11.7,10.8,
     /10.0,9.30,8.60,8.00,7.00,5.50,3.50,3.60,4.80,7.50,
     /9.60,11.2,12.9,13.8,14.7,15.3,16.1,17.3,25.0,32.0,
     /39.0,43.0,46.0,48.0,48.0,46.0,43.5,41.5,37.0,32.0,
     /27.5,22.5,19.0,16.5,14.7,13.3,11.0,9.60,8.40,7.20,
     /6.40,5.30,4.60,3.65,3.05,2.20,1.72,1.42,1.21,1.08,
     /0.96,0.80,.690,.600,.545,.490,.450,.385,.335,.305,
     /.275,.250,.210,.180,.158,.142,.119,.100,.0873,.0774,
     /.0698,.0636,.0545,.0479,.0443,.0392,.0361,.0306,.0270,.0244,
     /.0225,.0198,.0180,.0168,.0158,.0151,.0146,.0138,.0132,.0128,
     /.0125,.0123,.0119,.0116,.0114,.0113,.0112,.0111,.0110,.0110,
     /.0110,.0109/
C ELPSILON FOR ELASTIC ANGULAR DISTRIBUTION
      DATA YEPS/0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
     /0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
     /0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
     /0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,.3060,.3989,
     /.4153,.3631,.3497,.3932,.4489,.4946,.5894,.6535,.7149,.7455,
     /.7549,.7717,.7859,.7985,.8120,.8247,.8407,.8607,.8809,.8970,
     /.9097,.9164,.9270,.9390,.9456,.9585,.9704,.9773,.9815,.9849,
     /.98728,.99015,.99214,.99338,.99445,.99516,.99573,.99654,.99709,
     /.99756,
     /.99787,.99810,.998551,.998829,.999016,.999162,.999357,.999465,
     /.999546,.999603,
     /.999650,.999686,.999742,.999781,.999817,.9998342,.9998519,
     /.9998843,.9999063,.9999216,
     /.9999331,.9999488,.9999589,.9999663,.9999714,.9999755,.9999788,
     /.9999835,.9999866,.9999889,
     /.9999907,.9999920,.9999943,.9999957,.9999966,.9999973,.9999981,
     /.9999986,.9999989,.9999992,
     /.9999994,.9999998/
C IONISATION
      DATA XION/10.67,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,
     /20.0,22.0,24.0,26.0,28.0,30.0,33.0,36.0,40.0,45.0,
     /50.0,60.0,70.0,80.0,90.0,100.,125.,150.,200.,250.,
     /300.,400.,500.,600.,700.,800.,900.,1000./
C GROSS IONISATION
      DATA YION/0.00,.004,.074,0.19,0.39,0.63,0.89,1.17,1.70,2.33,
     /3.07,4.35,5.62,6.89,7.63,8.35,9.06,9.90,10.5,11.4,
     /12.0,12.6,13.2,13.2,13.1,13.0,12.7,12.0,10.8,9.40,
     /8.40,7.10,6.07,5.29,4.70,4.23,3.86,3.555/
C COUNTING IONISATION
      DATA YINC/38*0.0/
C ATTACHMENT
      DATA XATT/10*0.0/
      DATA YATT/10*0.0/
C VIBRATION/TORSION
      DATA XVIB1/.052,.055,.060,.065,.070,.075,0.08,0.10,0.12,0.14,
     /0.20,0.25,0.30,0.40,0.50,0.70,1.00,1.50,2.00,3.00,
     /4.00,5.00,6.00,7.00,8.00,10.0,15.0,20.0,30.0,40.0,
     /100.,1000.,1.D4,1.D5,1.D6,1.D7/
      DATA YVIB1/0.00,.014,.021,.024,.026,.027,.028,.028,.027,.025,
     /.021,.018,.016,.014,.012,.009,.008,.012,.015,.024,
     /.036,.047,.060,.079,.079,.065,.038,.025,.012,.008,
     /.003,3.D-4,3.D-5,3.D-6,3.D-7,3.D-8/
C VIBRATION
      DATA XVIB2/.108,.125,0.15,0.20,0.23,0.25,0.30,0.40,0.50,0.70,
     /1.00,1.50,2.00,3.00,4.00,5.00,6.00,7.00,8.00,10.0,
     /15.0,20.0,30.0,40.0,100.,1000.,1.D4,1.D5,1.D6,1.D7/
      DATA YVIB2/0.00,0.27,0.52,0.71,0.73,0.73,0.66,0.56,0.49,0.41,
     /0.32,0.32,0.39,0.63,0.93,1.22,1.57,2.06,2.06,1.69,
     /1.00,0.66,0.35,0.22,.088,.0088,8.8D-4,8.8D-5,8.8D-6,8.8D-7/
C VIBRATION
      DATA XVIB3/.173,0.18,0.19,0.20,0.23,0.25,0.30,0.40,0.50,0.70,
     /1.00,1.50,2.00,3.00,4.00,5.00,6.00,7.00,8.00,10.0,
     /15.0,20.0,30.0,40.0,100.,1000.,1.D4,1.D5,1.D6,1.D7/
      DATA YVIB3/0.00,0.13,0.27,0.38,0.49,0.53,0.56,0.53,0.49,0.42,
     /0.34,0.31,0.33,0.48,0.72,0.94,1.21,1.59,1.59,1.35,
     /0.80,0.52,0.28,.175,.070,.007,7.D-4,7.D-5,7.D-6,7.D-7/
C VIBRATION
      DATA XVIB4/.363,.365,0.37,0.38,0.39,0.40,0.42,0.45,0.50,0.55,
     /0.60,0.70,0.80,0.90,1.00,1.20,1.50,2.00,3.00,4.00,
     /5.00,6.00,7.00,8.00,10.0,15.0,20.0,30.0,40.0,100.,
     /1000.,1.D4,1.D5,1.D6,1.D7/
      DATA YVIB4/0.00,.108,.198,.299,.366,.416,.487,.555,.615,.645,
     /.655,.650,.630,.605,.580,0.55,0.57,0.67,1.05,1.50,
     /2.00,2.45,2.70,2.70,2.10,1.15,0.76,0.42,0.27,0.11,
     /.011,.0011,1.1D-4,1.1D-5,1.1D-6/
C VIBRATION HARMONICS
      DATA XVIB5/.519,1.00,1.50,2.00,3.00,4.00,5.00,6.00,7.00,8.00,
     /10.0,15.0,20.0,30.0,40.0,100.,1000.,1.D4,1.D5,1.D6,
     /1.D7/
      DATA YVIB5/0.00,.001,0.01,.033,.085,0.16,0.20,0.27,0.30,0.30,
     /0.23,.125,.085,.047,.032,.013,.0013,1.3D-4,1.3D-5,1.3D-6,
     /1.3D-7/
C EXCITATION
      DATA XEXC1/7.40,8.00,9.00,10.0,11.0,12.0,14.0,16.0,20.0,25.0,
     /30.0,40.0,50.0,60.0,70.0,80.0,100.,125.,150.,200.,
     /300.,400.,600.,1000./
      DATA YEXC1/0.00,.019,.250,.500,0.68,0.87,1.15,1.36,1.56,1.80,
     /2.04,2.50,2.95,3.45,3.75,4.00,4.00,3.70,3.25,2.50,1.72,
     /1.32,0.91,0.56/
C EXCITATION
      DATA XEXC2/9.70,11.0,12.0,14.0,16.0,20.0,25.0,30.0,40.0,50.0,
     /60.0,70.0,80.0,100.,125.,150.,200.,300.,400.,600.,
     /1000./
      DATA YEXC2/0.00,.133,.350,.630,0.87,1.15,1.40,1.57,1.90,2.25,
     /2.60,2.90,3.15,3.15,2.90,2.55,1.92,1.30,0.99,0.68,
     /.424/
C EXCITATION
      DATA XEXC3/14.0,16.0,18.0,20.0,25.0,30.0,35.0,40.0,50.0,60.0,
     /70.0,80.0,100.,125.,150.,200.,300.,400.,600.,1000./
      DATA YEXC3/0.00,.550,0.95,1.20,1.45,1.69,1.88,2.10,2.50,2.90,
     /3.25,3.50,3.50,3.25,2.85,2.25,1.55,1.18,0.82,0.51/
C**********************************************************************
C 2009 UPDATE OF 1999 SUBROUTINE
C      VERSION INCLUDES ANISOTROPIC SCATTERING. USED ISOTROPIC ELASTIC
C      SCATTERING BELOW 2 EV DUE TO LACK OF EXPERIMENTAL ELECTRON
C      SCATTERING DATA.
C      ALSO INCLUDES BETTER TREATMENT OF TORSIONAL EXCITATION (USED A
C      2-LEVEL APPROXIMATION FOR TORSION)
C      IMPROVED FANO FACTOR AND W FROM BETTER EXCITATION/DISSOCIATION
C      X-SECTIONS . PUBLISHED ELECTRON SCATTERING DATA UP TO 2009 IS
C      INCLUDED IN ANALYSIS. GOOD FIT +-1% TO SCHMIDTS HE/ISO DATA .
C      SCHMIDT AND MARTENS : HEIDELBERG PREPRINT :HD-PY 92/02
C      STILL SOME PROBLEMS WITH AR/ISO FITS +-2% BUT PROBABLY CAUSED
C      BY POOR QUALITY EXPERIMENTAL DRIFT VELOCITY DATA.
C      E.G. NO CONSISTANCY AT 3% LEVEL BETWEEN :
C      FUJII ET AL:  NIM A245(1986)35
C      AND BECKER : HTTP://CYCLO.MIT.EDU/DRIFT/WWW
C      FUTURE IMPROVEMENT: INCLUDE EFFECTIVE ROTATIONAL STATE AT 0.005EV
C***********************************************************************
C--------------------------------------------------------
      IF(NANISO.EQ.0) THEN
       NAME='ISOBUTANE 2009 '
      ELSE
       NAME='ISOBUTANE 2009A'
      ENDIF
C ---------------------------------------------------------------------
C BORN BETHE VALUES FOR IONISATION
      CONST=1.873884D-20
      EMASS2=1021997.804
      AM2=15.5
      C=160.0
C BORN BETHE VALUES FOR EXCITATIONS
      AM2EXC=5.69
      CEXC=62.6
C
      NIN=12
      DO 1 J=1,6
    1 KEL(J)=NANISO
      DO 2 J=1,NIN
    2 KIN(J)=0
C ANGULAR DISTRIBUTION FOR EXCITATION CAN BE EITHER
C CAPITELLI-LONGO OR OKHRIMOVSKKY TYPES
      KIN(10)=NANISO
      KIN(11)=NANISO
      KIN(12)=NANISO
C
      NDATA=122
      NION=38
      NATT=10
      NVIB1=36
      NVIB2=30
      NVIB3=30
      NVIB4=35
      NVIB5=21
      NEXC1=24
      NEXC2=21
      NEXC3=20
C
      E(1)=0.0
      E(2)=2.0*EMASS/(58.1234*AMU)
      E(3)=10.67
C EXCITATION X-SECTION AT 1.2 MEV
      E(4)=0.0145D-16
C IONISATION X-SECTION AT 1.2 MEV
      E(5)=0.0374D-16
C OPAL BEATY IONISATION ENERGY SPLITTING AT 1.2 MEV
      E(6)=7.00
C OPAL BEATY IONISATION ENERGY SPLITTING AT LOW ENERGY
      EOBY=8.80
C
      EIN(1)=-0.032
      EIN(2)=0.032
      EIN(3)=-0.108
      EIN(4)=0.108
      EIN(5)=-0.173
      EIN(6)=0.173
      EIN(7)=-0.363
      EIN(8)=0.363
      EIN(9)=0.519
      EIN(10)=7.4
      EIN(11)=9.70
      EIN(12)=14.0
C OFFSET ENERGY FOR IONISATION ELECTRON ANGULAR DISTRIBUTION
      IOFF=IFIX(SNGL(0.5+E(3)/ESTEP))
C OFFSET ENERGY FOR EXCITATION ELECTRON ANGULAR DISTRIBUTION
      IOFF10=IFIX(SNGL(0.5+EIN(10)/ESTEP))
      IOFF11=IFIX(SNGL(0.5+EIN(11)/ESTEP))
      IOFF12=IFIX(SNGL(0.5+EIN(12)/ESTEP))
C***********************************************************************
C PENNING TRANSFER FRACTION FOR EACH LEVEL
      DO 5 K=1,12
      DO 5 L=1,3
    5 PENFRA(L,K)=0.0
C PENNING TRANSFER FRACTION FOR EXCITATION LEVELS ONLY
      PENFRA(1,10)=0.0
      PENFRA(1,11)=0.0
      PENFRA(1,12)=0.0
C PENNING TRANSFER DISTANCE IN MICRONS
      PENFRA(2,10)=1.0
      PENFRA(2,11)=1.0
      PENFRA(2,12)=1.0
C PENNING TRANSFER TIME IN PICOSECONDS
      PENFRA(3,10)=1.0
      PENFRA(3,11)=1.0
      PENFRA(3,12)=1.0
      IF(IPEN.EQ.0) GO TO 8
      IF((PENFRA(1,10)+PENFRA(1,11)+PENFRA(1,12)).EQ.0.0) GO TO 8
      DO 6 K=10,12
    6 WRITE(6,999) NAME,EIN(K),PENFRA(1,K),PENFRA(2,K),PENFRA(3,K)
  999 FORMAT(' GAS = ',A15,' ENERGY LEVEL = ',F7.4,' EV.',/,' PENNING PR
     /OBABILITY = ',F5.3,' ABS.LENGTH = ',F7.2,' DECAY TIME = ',F7.1,/)
    8 CONTINUE
C***********************************************************************
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC  ANISOTROPIC I-C4H10 '
      IF(NANISO.EQ.0) THEN
       SCRPT(2)=' ELASTIC ISOTROPIC    I-C4H10 '
      ENDIF
      SCRPT(3)=' IONISATION    ELOSS= 10.67   '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' TORSION       ELOSS= -0.032  '
      SCRPT(8)=' TORSION       ELOSS=  0.032  '
      SCRPT(9)=' VIB BEND      ELOSS= -0.108  '
      SCRPT(10)=' VIB BEND      ELOSS=  0.108  '
      SCRPT(11)=' VIB STRETCH   ELOSS= -0.173  '
      SCRPT(12)=' VIB STRETCH   ELOSS=  0.173  '
      SCRPT(13)=' VIB STRETCH   ELOSS= -0.363  '
      SCRPT(14)=' VIB STRETCH   ELOSS=  0.363  '
      SCRPT(15)=' VIB STRETCH   ELOSS=  0.519  '
      SCRPT(16)=' EXCITATION    ELOSS=  7.4    '
      SCRPT(17)=' EXC/DISOC.    ELOSS=  9.70   '
      SCRPT(18)=' EXC/DISOC.    ELOSS= 14.0    '
C CALCULATE POPULATION OF TORSIONAL STATES
      APOP1=DEXP(EIN(1)/AKT)
      APOP2=DEXP(2.0*EIN(1)/AKT)
      APOP3=DEXP(3.0*EIN(1)/AKT)
      APOP4=DEXP(4.0*EIN(1)/AKT)
      APOP5=DEXP(5.0*EIN(1)/AKT)
      APOP6=DEXP(6.0*EIN(1)/AKT)
      APOP7=DEXP(7.0*EIN(1)/AKT)
      APOP8=DEXP(8.0*EIN(1)/AKT)
      APOP9=DEXP(9.0*EIN(1)/AKT)
      APOP10=DEXP(10.0*EIN(1)/AKT)
      APOPGST=1.0
      APOPSUM=APOPGST+APOP1+APOP2+APOP3+APOP4+APOP5+APOP6+APOP7+APOP8+
     /APOP9+APOP10
      APOPGST=1.0/APOPSUM
      APOP1=APOP1/APOPSUM
      APOP2=APOP2/APOPSUM
      APOP3=APOP3/APOPSUM
      APOP4=APOP4/APOPSUM
      APOP5=APOP5/APOPSUM
      APOP6=APOP6/APOPSUM
      APOP7=APOP7/APOPSUM
      APOP8=APOP8/APOPSUM
      APOP9=APOP9/APOPSUM
      APOP10=APOP10/APOPSUM
C  USE 2 LEVEL APPROXIMATION FOR TORSION
      APOP1=APOP1+APOP2+APOP3+APOP4+APOP5+APOP6+APOP7+APOP8+APOP9+APOP10
      APOPGST=1.0
C CALCULATE POPULATION  OF VIBRATIONAL STATES
C ASSUME ALL STATE DEGENERACIES ARE EQUAL
      APOPV2=DEXP(EIN(3)/AKT)
      APOPV3=DEXP(EIN(5)/AKT)
      APOPV4=DEXP(EIN(7)/AKT)
      APOPGS=1.0+APOPV2+APOPV3+APOPV4
      APOPV2=APOPV2/APOPGS
      APOPV3=APOPV3/APOPGS
      APOPV4=APOPV4/APOPGS
      APOPGS=1.0/APOPGS
C RENORMALISE GROUND STATE POPULATION ( GIVES CORRECTION THAT
C ALLOWS FOR VIBRATIONAL EXCITATION FROM EXCITED VIBRATIONAL STATES)
      APOPGS=1.0
C
      EN=-ESTEP/2.0
      DO 1000 I=1,NSTEP
      EN=EN+ESTEP
      DO 10 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 20
   10 CONTINUE
      J=NDATA
   20 A=(YELM(J)-YELM(J-1))/(XEN(J)-XEN(J-1))
      B=(XEN(J-1)*YELM(J)-XEN(J)*YELM(J-1))/(XEN(J-1)-XEN(J))
      QMOM=(A*EN+B)*1.D-16
      A=(YELT(J)-YELT(J-1))/(XEN(J)-XEN(J-1))
      B=(XEN(J-1)*YELT(J)-XEN(J)*YELT(J-1))/(XEN(J-1)-XEN(J))
      QELA=(A*EN+B)*1.D-16
      A=(YEPS(J)-YEPS(J-1))/(XEN(J)-XEN(J-1))
      B=(XEN(J-1)*YEPS(J)-XEN(J)*YEPS(J-1))/(XEN(J-1)-XEN(J))
      PQ2=(A*EN+B)
      PQ1=0.5+(QELA-QMOM)/QELA
      IF(NANISO.EQ.0) PEQEL(2,I)=0.5
      IF(NANISO.EQ.1) PEQEL(2,I)=PQ1
      IF(NANISO.EQ.2) PEQEL(2,I)=PQ2
      Q(2,I)=QELA
      IF(NANISO.EQ.0) Q(2,I)=QMOM
C GROSS IONISATION
      Q(3,I)=0.0
      PEQEL(3,I)=0.5
      IF(NANISO.EQ.2) PEQEL(3,I)=0.0
      IF(EN.LT.E(3)) GO TO 150
      IF(EN.GT.XION(NION)) GO TO 123
      DO 100 J=2,NION
      IF(EN.LE.XION(J)) GO TO 110
  100 CONTINUE
      J=NION
  110 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
      GO TO 124
C USE BORN BETHE X-SECTION ABOVE XION(NION) EV
  123 GAMMA=(EMASS2+2.0D0*EN)/EMASS2
      BETA=DSQRT(1.0D0-1.0D0/(GAMMA*GAMMA))
      BETA2=BETA*BETA
      X2=1.0D0/BETA2
      X1=X2*DLOG(BETA2/(1.0D0-BETA2))-1.0D0
      Q(3,I)=CONST*(AM2*X1+C*X2)
  124 CONTINUE
C USE ANISOTROPIC SCATTERING FOR PRIMARY IONISATION ELECTRON AT
C ENERGIES ABOVE  2 * IONISATION ENERGY
C ANISOTROPIC ANGULAR DISTRIBUTION EQUAL TO ELASTIC ANGULAR DISTRIBUTION
C AT AN ENERGY OFFSET BY THE IONISATION ENERGY
      IF(EN.LE.(2.0*E(3))) GO TO 150
      PEQEL(3,I)=PEQEL(2,(I-IOFF))
C ATTACHMENT (NO ATTACHMENT)
  150 Q(4,I)=0.0
C COUNTING IONISATION
  200 Q(5,I)=0.0
      PEQEL(5,I)=0.5
      IF(NANISO.EQ.2) PEQEL(5,I)=0.0
C SET COUNTING IONISATION = GROSS IONISATION (LACK OF EXPERIMENTAL DATA)
      Q(5,I)=Q(3,I)
      PEQEL(5,I)=PEQEL(3,I)
C
      Q(6,I)=0.0
C SUPERELASTIC TORSION
      QIN(1,I)=0.0
      PEQIN(1,I)=0.5
      IF(NANISO.EQ.2) PEQIN(1,I)=0.0
      IF(EN.EQ.0.0) GO TO 305
      EFAC=DSQRT(1.0-(EIN(1)/EN))
      QIN(1,I)=0.009*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      QIN(1,I)=APOP1*QIN(1,I)*1.D-16
C TORSION
  305 QIN(2,I)=0.0
      PEQIN(2,I)=0.5
      IF(NANISO.EQ.2) PEQIN(2,I)=0.0
      IF(EN.LE.EIN(2)) GO TO 400
      EFAC=DSQRT(1.0-(EIN(2)/EN))
      QIN(2,I)=0.009*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      QIN(2,I)=APOPGST*QIN(2,I)*1.D-16
C SUPERELASTIC VIB BEND MODES
  400 QIN(3,I)=0.0
      PEQIN(3,I)=0.5
      IF(NANISO.EQ.2) PEQIN(3,I)=0.0
      IF(EN.EQ.0.0) GO TO 450
      DO 410 J=2,NVIB2
      IF((EN+EIN(4)).LE.XVIB2(J)) GO TO 420
  410 CONTINUE
      J=NVIB2
  420 A=(YVIB2(J)-YVIB2(J-1))/(XVIB2(J)-XVIB2(J-1))
      B=(XVIB2(J-1)*YVIB2(J)-XVIB2(J)*YVIB2(J-1))/(XVIB2(J-1)-XVIB2(J))
      QIN(3,I)=APOPV2*(EN+EIN(4))*(A*(EN+EIN(4))+B)*1.D-16/EN
C VIB BEND MODES
  450 QIN(4,I)=0.0
      PEQIN(4,I)=0.5
      IF(NANISO.EQ.2) PEQIN(4,I)=0.0
      IF(EN.LE.EIN(4)) GO TO 500
      DO 460 J=2,NVIB2
      IF(EN.LE.XVIB2(J)) GO TO 470
  460 CONTINUE
      J=NVIB2
  470 A=(YVIB2(J)-YVIB2(J-1))/(XVIB2(J)-XVIB2(J-1))
      B=(XVIB2(J-1)*YVIB2(J)-XVIB2(J)*YVIB2(J-1))/(XVIB2(J-1)-XVIB2(J))
      QIN(4,I)=APOPGS*(A*EN+B)*1.D-16
C SUPERELASTIC VIB STRETCH MODES
  500 CONTINUE
      QIN(5,I)=0.0
      PEQIN(5,I)=0.5
      IF(NANISO.EQ.2) PEQIN(5,I)=0.0
      IF(EN.EQ.0.0) GO TO 550
      DO 510  J=2,NVIB3
      IF((EN+EIN(6)).LE.XVIB3(J)) GO TO 520
  510 CONTINUE
      J=NVIB3
  520 A=(YVIB3(J)-YVIB3(J-1))/(XVIB3(J)-XVIB3(J-1))
      B=(XVIB3(J-1)*YVIB3(J)-XVIB3(J)*YVIB3(J-1))/(XVIB3(J-1)-XVIB3(J))
      QIN(5,I)=APOPV3*(EN+EIN(6))*(A*(EN+EIN(6))+B)*1.D-16/EN
C VIB STRETCH MODES
  550 CONTINUE
      QIN(6,I)=0.0
      PEQIN(6,I)=0.5
      IF(NANISO.EQ.2) PEQIN(6,I)=0.0
      IF(EN.LE.EIN(6)) GO TO 600
      DO 560 J=2,NVIB3
      IF(EN.LE.XVIB3(J)) GO TO 570
  560 CONTINUE
      J=NVIB3
  570 A=(YVIB3(J)-YVIB3(J-1))/(XVIB3(J)-XVIB3(J-1))
      B=(XVIB3(J-1)*YVIB3(J)-XVIB3(J)*YVIB3(J-1))/(XVIB3(J-1)-XVIB3(J))
      QIN(6,I)=APOPGS*(A*EN+B)*1.D-16
C SUPERELASTIC VIB STRETCH MODES
  600 CONTINUE
      QIN(7,I)=0.0
      PEQIN(7,I)=0.5
      IF(NANISO.EQ.2) PEQIN(7,I)=0.0
      IF(EN.EQ.0.0) GO TO 650
      DO 610  J=2,NVIB4
      IF((EN+EIN(8)).LE.XVIB4(J)) GO TO 620
  610 CONTINUE
      J=NVIB4
  620 A=(YVIB4(J)-YVIB4(J-1))/(XVIB4(J)-XVIB4(J-1))
      B=(XVIB4(J-1)*YVIB4(J)-XVIB4(J)*YVIB4(J-1))/(XVIB4(J-1)-XVIB4(J))
      QIN(7,I)=APOPV4*(EN+EIN(8))*(A*(EN+EIN(8))+B)*1.D-16/EN
C  VIB STRETCH MODES
  650 CONTINUE
      QIN(8,I)=0.0
      PEQIN(8,I)=0.5
      IF(NANISO.EQ.2) PEQIN(8,I)=0.0
      IF(EN.LE.EIN(8)) GO TO 700
      DO 660 J=2,NVIB4
      IF(EN.LE.XVIB4(J)) GO TO 670
  660 CONTINUE
      J=NVIB4
  670 A=(YVIB4(J)-YVIB4(J-1))/(XVIB4(J)-XVIB4(J-1))
      B=(XVIB4(J-1)*YVIB4(J)-XVIB4(J)*YVIB4(J-1))/(XVIB4(J-1)-XVIB4(J))
      QIN(8,I)=APOPGS*(A*EN+B)*1.D-16
C HIGHER VIBRATIONAL MODES
  700 QIN(9,I)=0.0
      PEQIN(9,I)=0.5
      IF(NANISO.EQ.2) PEQIN(9,I)=0.0
      IF(EN.LE.EIN(9)) GO TO 800
      DO 710 J=2,NVIB5
      IF(EN.LE.XVIB5(J)) GO TO 720
  710 CONTINUE
      J=NVIB5
  720 A=(YVIB5(J)-YVIB5(J-1))/(XVIB5(J)-XVIB5(J-1))
      B=(XVIB5(J-1)*YVIB5(J)-XVIB5(J)*YVIB5(J-1))/(XVIB5(J-1)-XVIB5(J))
      QIN(9,I)=(A*EN+B)*1.D-16
C EXCITATION
  800 QIN(10,I)=0.0
      PEQIN(10,I)=0.5
      IF(NANISO.EQ.2) PEQIN(10,I)=0.0
      IF(EN.LE.EIN(10)) GO TO 850
      IF(EN.GT.XEXC1(NEXC1)) GO TO 830
      DO 810 J=2,NEXC1
      IF(EN.LE.XEXC1(J)) GO TO 820
  810 CONTINUE
      J=NEXC1
  820 A=(YEXC1(J)-YEXC1(J-1))/(XEXC1(J)-XEXC1(J-1))
      B=(XEXC1(J-1)*YEXC1(J)-XEXC1(J)*YEXC1(J-1))/(XEXC1(J-1)-XEXC1(J))
      QIN(10,I)=(A*EN+B)*1.D-16
      GO TO 840
C USE BORN BETHE X-SECTION ABOVE XEXC1(NEXC1) EV
  830 QIN(10,I)=CONST*(AM2EXC*X1+CEXC*X2)*0.375
C ANGULAR DISTRIBUTION COPIED FROM ELASTIC OFFSET BY TWICE THE
C LEVEL ENERGY
  840 IF(EN.LE.(2.0*EIN(10))) GO TO 850
      PEQIN(10,I)=PEQEL(2,(I-IOFF10))
C EXCITATION
  850 QIN(11,I)=0.0
      PEQIN(11,I)=0.5
      IF(NANISO.EQ.2) PEQIN(11,I)=0.0
      IF(EN.LE.EIN(11)) GO TO 900
      IF(EN.GT.XEXC2(NEXC2)) GO TO 880
      DO 860 J=2,NEXC2
      IF(EN.LE.XEXC2(J)) GO TO 870
  860 CONTINUE
      J=NEXC2
  870 A=(YEXC2(J)-YEXC2(J-1))/(XEXC2(J)-XEXC2(J-1))
      B=(XEXC2(J-1)*YEXC2(J)-XEXC2(J)*YEXC2(J-1))/(XEXC2(J-1)-XEXC2(J))
      QIN(11,I)=(A*EN+B)*1.D-16
      GO TO 890
C USE BORN BETHE X-SECTION ABOVE XEXC2(NEXC2) EV
  880 QIN(11,I)=CONST*(AM2EXC*X1+CEXC*X2)*0.284
C ANGULAR DISTRIBUTION COPIED FROM ELASTIC OFFSET BY TWICE THE
C LEVEL ENERGY
  890 IF(EN.LE.(2.0*EIN(11))) GO TO 900
      PEQIN(11,I)=PEQEL(2,(I-IOFF11))
C EXCITATION
  900 QIN(12,I)=0.0
      PEQIN(12,I)=0.5
      IF(NANISO.EQ.2) PEQIN(12,I)=0.0
      IF(EN.LE.EIN(12)) GO TO 950
      IF(EN.GT.XEXC3(NEXC3)) GO TO 930
      DO 910 J=2,NEXC3
      IF(EN.LE.XEXC3(J)) GO TO 920
  910 CONTINUE
      J=NEXC3
  920 A=(YEXC3(J)-YEXC3(J-1))/(XEXC3(J)-XEXC3(J-1))
      B=(XEXC3(J-1)*YEXC3(J)-XEXC3(J)*YEXC3(J-1))/(XEXC3(J-1)-XEXC3(J))
      QIN(12,I)=(A*EN+B)*1.D-16
      GO TO 940
C USE BORN BETHE X-SECTION ABOVE XEXC3(NEXC3) EV
  930 QIN(12,I)=CONST*(AM2EXC*X1+CEXC*X2)*0.341
C ANGULAR DISTRIBUTION COPIED FROM ELASTIC OFFSET BY TWICE THE
C LEVEL ENERGY
  940 IF(EN.LE.(2.0*EIN(12))) GO TO 950
      PEQIN(12,I)=PEQEL(2,(I-IOFF12))
  950 CONTINUE
C
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+QIN(1,I)+QIN(2,I)+QIN(3,I)+QIN(4,I)+
     /QIN(5,I)+QIN(6,I)+QIN(7,I)+QIN(8,I)+QIN(9,I)+QIN(10,I)+QIN(11,I)
     /+QIN(12,I)
 1000 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(12)) NIN=11
      IF(EFINAL.LE.EIN(11)) NIN=10
      IF(EFINAL.LE.EIN(10)) NIN=9
      IF(EFINAL.LE.EIN(9)) NIN=8
      RETURN
      END
      SUBROUTINE GAS12(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220),
     /PJ(220)
      DIMENSION XEN(124),YMOM(124),YEL(124),YVBMOM(124),YVBEL(124),
     /YEPS(124),XION(62),YION(62),YINC(62),XATT(74),YATT(74),
     /XV2(23),YV2(23),X2V2(25),Y2V2(25),XV1(32),YV1(32),
     /X3V2(17),Y3V2(17),XV3(17),YV3(17),XVPD3(22),YVPD3(22),
     /XV130(19),YV130(19),XVPD4(20),YVPD4(20),XVPD5(17),YVPD5(17),
     /XVPD6(17),YVPD6(17),XVPD7(17),YVPD7(17),XVPD8(17),YVPD8(17),
     /XVPD9(17),YVPD9(17),XVPDH(15),YVPDH(15),
     /XEXC1(53),YEXC1(53),XEXC2(53),YEXC2(53),XEXC3(51),YEXC3(51),
     /XEXC4(51),YEXC4(51),XEXC5(51),YEXC5(51),XEXC6(51),YEXC6(51)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
C ELASTIC +ROTATIONAL
      DATA XEN/1.D-6,.001,.002,.004,.007,.010,.014,.020,.030,.040,
     /0.05,0.06,0.08,0.10,.125,.150,.175,0.20,0.25,0.30,
     /0.35,0.40,0.50,0.60,0.70,0.85,1.00,1.25,1.50,1.70,
     /1.90,2.10,2.30,2.50,2.80,3.00,3.30,3.60,3.80,4.00,
     /4.50,5.00,5.50,6.00,7.00,8.00,10.0,12.0,15.0,17.0,
     /20.0,25.0,30.0,40.0,50.0,60.0,70.0,80.0,90.0,100.,
     /120.,150.,170.,200.,250.,300.,350.,400.,450.,500.,
     /600.,700.,800.,900.,1000.,1500.,2000.,3000.,4000.,5000.,
     /6000.,8000.,1.0D4,1.25D4,1.5D4,1.75D4,2.0D4,2.5D4,3.0D4,3.5D4,
     /4.0D4,4.5D4,5.0D4,6.0D4,7.0D4,8.0D4,9.0D4,1.0D5,1.25D5,1.5D5,
     /1.75D5,2.0D5,2.5D5,3.0D5,3.5D5,4.0D5,4.5D5,5.0D5,6.0D5,7.0D5,
     /8.0D5,9.0D5,1.0D6,1.25D6,1.5D6,1.75D6,2.0D6,2.5D6,3.0D6,3.5D6,
     /4.0D6,6.0D6,8.0D6,1.0D7/
C GROUND STATE AND BEND MODE ELASTIC + ROTATION.  MOMENTUM TRANSFER
C  AT 293.15 KELVIN
      DATA YMOM/148.,148.,146.,141.,134.,128.,119.,109.,95.0,85.0,
     /76.5,69.5,59.0,52.5,47.5,41.0,36.0,30.0,22.0,16.2,
     /12.8,10.6,8.20,6.45,5.35,4.30,3.90,3.65,3.60,3.65,
     /3.75,3.85,4.00,4.20,4.60,4.90,5.30,5.80,6.00,6.00,
     /5.50,5.10,5.00,5.20,6.10,7.30,8.80,10.0,11.0,11.0,
     /10.8,10.2,9.50,7.40,6.00,4.70,3.85,3.25,2.80,2.45,
     /1.95,1.45,1.22,1.00,0.74,0.59,0.48,0.41,0.35,.305,
     /0.24,0.20,0.17,.145,.125,.0685,.0414,.0216,.0135,.00928,
     /.00686,.00430,.00288,.00192,.00138,.00105,8.23D-4,5.5D-4,3.96D-4,
     /3.0D-4,
     /2.36D-4,1.91D-4,1.59D-4,1.15D-4,8.73D-5,6.90D-5,5.62D-5,4.68D-5,
     /3.19D-5,2.34D-5,
     /1.81D-5,1.45D-5,1.00D-5,7.48D-6,5.86D-6,4.75D-6,3.95D-6,3.36D-6,
     /2.54D-6,2.00D-6,
     /1.63D-6,1.37D-6,1.16D-6,8.32D-7,6.28D-7,4.94D-7,4.00D-7,2.80D-7,
     /2.08D-7,1.62D-7,
     /1.30D-7,6.51D-8,3.95D-8,2.66D-8/
C GROUND STATE AND BEND MODE ELASTIC + ROTATION.  AT 293.15 KELVIN
      DATA YEL/148.,148.,146.,141.,135.,129.,120.,110.,96.0,86.0,
     /77.5,70.5,60.0,53.5,48.5,42.0,37.0,31.5,24.8,20.4,
     /17.4,15.5,13.0,10.7,9.20,7.50,6.30,5.30,4.65,4.46,
     /4.45,4.45,4.60,4.75,5.10,5.55,6.80,7.90,8.50,7.80,
     /6.25,6.15,6.60,7.05,8.10,9.50,11.5,13.1,13.3,13.7,
     /13.8,14.0,13.7,12.1,10.4,9.20,8.20,7.60,7.00,6.45,
     /5.79,4.90,4.48,4.05,3.67,3.33,2.98,2.75,2.50,2.32,
     /2.00,1.78,1.59,1.41,1.28,0.97,0.75,0.55,0.44,.365,
     /.315,.252,.204,.165,.139,.120,.106,.0865,.0731,.0636,
     /.0565,.0509,.0465,.0398,.0350,.0317,.0286,.0264,.0224,.0197,
     /.0178,.0164,.0145,.0132,.0123,.0116,.0111,.0107,.0101,.00967,
     /.00937,.00915,.00897,.00868,.00849,.00837,.00829,.00818,.00812,
     /.00808,
     /.00805,.00799,.00797,.00797/
C ELASTIC FOR BEND MODE VIBRATIONS.   MOMENTUM TRANSFER
      DATA YVBMOM/148.,148.,146.,141.,134.,128.,119.,109.,95.0,85.0,
     /76.5,69.5,59.0,53.5,50.0,46.5,45.5,45.0,43.0,37.0,
     /28.5,22.5,16.0,11.5,8.95,6.80,5.80,5.05,4.80,4.65,
     /4.65,4.70,4.80,5.00,5.35,5.65,6.00,6.20,6.20,6.10,
     /5.50,5.10,5.00,5.20,6.10,7.30,8.80,10.0,11.0,11.0,
     /10.8,10.2,9.50,7.40,6.00,4.70,3.85,3.25,2.80,2.45,
     /1.95,1.45,1.22,1.00,0.74,0.59,0.48,0.41,0.35,.305,
     /0.24,0.20,0.17,.145,.125,.0685,.0414,.0216,.0135,.00928,
     /.00686,.00430,.00288,.00192,.00138,.00105,8.23D-4,5.5D-4,3.96D-4,
     /3.0D-4,
     /2.36D-4,1.91D-4,1.59D-4,1.15D-4,8.73D-5,6.90D-5,5.62D-5,4.68D-5,
     /3.19D-5,2.34D-5,
     /1.81D-5,1.45D-5,1.00D-5,7.48D-6,5.86D-6,4.75D-6,3.95D-6,3.36D-6,
     /2.54D-6,2.00D-6,
     /1.63D-6,1.37D-6,1.16D-6,8.32D-7,6.28D-7,4.94D-7,4.00D-7,2.80D-7,
     /2.08D-7,1.62D-7,
     /1.30D-7,6.51D-8,3.95D-8,2.66D-8/
C ELASTIC FOR BEND MODE VIBRATIONS.
      DATA YVBEL/148.,148.,146.,141.,135.,129.,120.,110.,96.0,86.0,
     /77.5,70.5,60.0,54.5,51.1,47.6,46.8,47.2,48.5,46.6,
     /38.7,32.9,25.4,19.1,15.4,11.9,9.37,7.33,6.20,5.68,
     /5.52,5.43,5.52,5.65,5.93,6.40,7.70,8.44,8.78,7.93,
     /6.25,6.15,6.60,7.05,8.10,9.50,11.5,13.1,13.3,13.7,
     /13.8,14.0,13.7,12.1,10.4,9.20,8.20,7.60,7.00,6.45,
     /5.79,4.90,4.48,4.05,3.67,3.33,2.98,2.75,2.50,2.32,
     /2.00,1.78,1.59,1.41,1.28,0.97,0.75,0.55,0.44,.365,
     /.315,.252,.204,.165,.139,.120,.106,.0865,.0731,.0636,
     /.0565,.0509,.0465,.0398,.0350,.0317,.0286,.0264,.0224,.0197,
     /.0178,.0164,.0145,.0132,.0123,.0116,.0111,.0107,.0101,.00967,
     /.00937,.00915,.00897,.00868,.00849,.00837,.00829,.00818,.00812,
     /.00808,
     /.00805,.00799,.00797,.00797/
C EPSILON FOR ELASTIC ANGULAR DISTRIBUTION
      DATA YEPS/0.0,.00001,.0001,.001,.01111,.01162,.01249,.01363,
     /.01563,.01744,
     /.01935,.02127,.02500,.02803,.03092,.03571,.04053,.07136,
     /.16838,.30302,
     /.38441,.45366,.52155,.55591,.58136,.59099,.53607,.44734,
     /.33109,.26842,
     /.23335,.20060,.19416,.17264,.14643,.17460,.32377,.38639,
     /.42456,.33803,
     /.17884,.25277,.35423,.38173,.36044,.33916,.34362,.34620,
     /.25594,.29053,
     /.31927,.39402,.44108,.54525,.58678,.66131,.70472,.74599,
     /.77171,.78971,
     /.82594,.85753,.87452,.89179,.91987,.93361,.94210,.94813,
     /.95253,.95654,
     /.96172,.96505,.96735,.96904,.97115,.98131,.98646,.99126,
     /.99359,.99493,
     /.99581,.99689,.99753,.99804,.998381,.998607,.998791,.999045,
     /.9992083,.9993264,
     /.9994153,.9994836,.9995363,.9996182,.9996776,.9997242,.9997546,
     /.9997818,.9998299,.9998615,
     /.9998838,.9999008,.9999250,.9999398,.9999504,.9999581,.9999642,
     /.9999688,.9999756,.9999803,
     /.9999838,.9999862,.9999883,.9999916,.9999936,.9999950,.9999960,
     /.9999972,.9999980,.9999985,
     /.9999988,.9999994,.9999996,.9999998/
C
C V(010)  BEND MODE  ( ANALYTICAL DIPOLE FUNCTION AT THRESHOLD)
      DATA XV2/.08275,2.00,2.50,3.00,3.50,3.80,4.00,4.50,5.00,6.00,
     /8.00,10.0,15.0,20.0,30.0,50.0,70.0,100.,1000.,10000.,
     /1.0D5,1.0D6,1.0D7/
      DATA YV2/0.00,0.00,0.24,0.48,1.29,1.70,1.70,1.17,0.74,0.42,
     /0.01,0.08,0.05,0.08,0.12,0.07,.001,.0001,.00001,.000001,
     /1.0D-7,1.0D-8,1.0D-9/
C V(020)  BEND MODE HARMONIC  RESONANCE
      DATA X2V2/.15937,0.18,0.50,1.00,2.00,3.00,3.50,3.80,4.00,4.50,
     /5.00,6.00,8.00,10.0,15.0,20.0,30.0,50.0,70.0,100.,
     /1000.,10000.,1.0D5,1.0D6,1.0D7/
      DATA Y2V2/0.00,0.02,0.01,.003,.025,0.09,0.31,0.44,0.56,0.49,
     /0.35,0.17,0.08,0.10,0.02,.008,.015,.008,.001,.0001,
     /.00001,.000001,1.0D-7,1.0D-8,1.0D-9/
C V(100) SYMMETRIC STRETCH
      DATA XV1/.17211,0.18,0.20,0.23,0.25,0.30,0.40,0.50,0.60,1.00,
     /2.00,2.50,3.00,3.50,3.80,4.00,4.50,5.00,6.00,8.00,
     /10.0,15.0,20.0,30.0,50.0,70.0,100.,1000.,10000.,1.0D5,
     /1.0D6,1.0D7/
      DATA YV1/0.00,.475,.790,0.91,0.91,0.82,0.58,0.43,0.34,0.32,
     /0.38,0.66,0.89,1.27,1.32,1.04,0.53,0.18,.084,.075,
     /.077,.030,.009,.030,.008,.001,.0001,.00001,.000001,1.0D-7,
     /1.0D-8,1.0D-9/
C V(030) + V(110)
      DATA X3V2/.251,2.00,2.50,3.00,3.50,3.80,4.00,4.50,5.00,6.00,
     /10.0,100.,1000.,10000.,1.0D5,1.0D6,1.0D7/
      DATA Y3V2/0.00,0.00,0.01,0.17,0.36,0.58,0.58,0.36,0.17,0.01,
     /.001,.0001,.00001,.000001,1.0D-7,1.0D-8,1.0D-9/
C V(001) ASYMMETRIC STRETCH  (ANALYTICAL DIPOLE FUNCTION AT THRESHOLD)
      DATA XV3/.29126,2.00,3.00,3.50,3.80,4.00,4.50,5.00,6.00,8.00,
     /10.0,100.,1000.,10000.,1.0D5,1.0D6,1.0D7/
      DATA YV3/0.00,0.00,.002,.005,.010,.005,.002,.001,.001,.001,
     /.001,.0001,.00001,.000001,1.0D-7,1.0D-8,1.0D-9/
C V(040) + V(120) + V(200)  POLYAD 3
      DATA XVPD3/.335,0.35,0.50,0.80,2.00,2.50,3.00,3.50,3.80,4.00,
     /4.50,5.00,6.00,10.0,20.0,40.0,100.,1000.,10000.,1.0D5,
     /1.0D6,1.0D7/
      DATA YVPD3/0.00,0.09,.035,0.02,0.02,0.02,0.21,0.43,0.70,0.70,
     /0.43,0.21,0.05,.020,0.01,.005,.0001,.00001,.000001,1.0D-7,
     /1.0D-8,1.0D-9/
C  V(130) + V(210)
      DATA XV130/0.422,2.00,2.50,3.00,3.50,3.80,4.00,4.50,5.00,6.00,
     /10.0,20.0,40.0,100.,1000.,10000.,1.0D5,1.0D6,1.0D7/
      DATA YV130/0.00,0.00,.005,0.10,0.22,0.35,0.35,0.22,0.10,.025,
     /.005,.002,.001,.0001,.00001,.000001,1.0D-7,1.0D-8,1.0D-9/
C  POLYAD 4
      DATA XVPD4/0.505,0.55,0.65,1.00,2.00,2.50,3.00,3.50,3.80,4.00,
     /4.50,5.00,6.00,10.0,100.,1000.,10000.,1.0D5,1.0D6,1.0D7/
      DATA YVPD4/0.00,.0017,.0005,.0001,.0001,.005,0.12,0.24,0.40,0.40,
     /0.24,0.13,0.01,.001,.0001,.00001,.000001,1.0D-7,1.0D-8,1.0D-9/
C  POLYAD 5
      DATA XVPD5/0.685,2.00,2.50,3.00,3.50,3.80,4.00,4.50,5.00,6.00,
     /10.0,100.,1000.,10000.,1.0D5,1.0D6,1.0D7/
      DATA YVPD5/0.00,0.00,.003,0.07,0.14,0.24,0.24,0.14,0.08,.006,
     /.001,.0001,.00001,.000001,1.0D-7,1.0D-8,1.0D-9/
C  POLYAD 6
      DATA XVPD6/0.825,2.00,2.50,3.00,3.50,3.80,4.00,4.50,5.00,6.00,
     /10.0,100.,1000.,10000.,1.0D5,1.0D6,1.0D7/
      DATA YVPD6/0.00,0.00,.001,0.05,0.10,0.16,0.16,0.10,0.05,.004,
     /.001,.0001,.00001,.000001,1.0D-7,1.0D-8,1.0D-9/
C  POLYAD 7
      DATA XVPD7/0.995,2.00,2.50,3.00,3.50,3.80,4.00,4.50,5.00,6.00,
     /10.0,100.,1000.,10000.,1.0D5,1.0D6,1.0D7/
      DATA YVPD7/0.00,0.00,.001,0.03,0.06,0.10,0.10,0.06,0.03,.003,
     /.001,.0001,.00001,.000001,1.0D-7,1.0D-8,1.0D-9/
C  POLYAD 8
      DATA XVPD8/1.160,2.00,2.50,3.00,3.50,3.80,4.00,4.50,5.00,6.00,
     /10.0,100.,1000.,10000.,1.0D5,1.0D6,1.0D7/
      DATA YVPD8/0.00,0.00,.001,0.03,0.06,0.10,0.10,0.06,0.03,.003,
     /.001,.0001,.00001,.000001,1.0D-7,1.0D-8,1.0D-9/
C  POLYAD 9
      DATA XVPD9/1.320,2.00,2.50,3.00,3.50,3.80,4.00,4.50,5.00,6.00,
     /10.0,100.,1000.,10000.,1.0D5,1.0D6,1.0D7/
      DATA YVPD9/0.00,0.00,.001,0.03,0.06,0.10,0.10,0.06,0.03,.003,
     /.001,.0001,.00001,.000001,1.0D-7,1.0D-8,1.0D-9/
C  SUM HIGHER POLYADS
      DATA XVPDH/2.50,3.00,3.50,3.80,4.00,4.50,5.00,6.00,10.0,100.,
     /1000.,10000.,1.0D5,1.0D6,1.0D7/
      DATA YVPDH/0.00,0.01,0.36,0.58,0.58,0.36,0.16,.045,.001,.0001,
     /.00001,.000001,1.0D-7,1.0D-8,1.0D-9/
C DATA FROM RAP AND BRIGLIA ( SCALED BY 1.031 FROM INCREASE IN CO2
C                              IONISATION X-SEC)
      DATA XATT/3.30,3.40,3.50,3.60,3.70,3.80,3.90,4.00,4.10,4.20,
     /4.30,4.40,4.50,4.60,4.70,4.80,4.90,5.00,5.10,5.20,
     /5.30,5.40,5.50,5.60,5.70,5.80,5.90,6.00,6.10,6.20,
     /6.30,6.40,6.50,6.60,6.70,6.80,6.90,7.00,7.10,7.20,
     /7.30,7.40,7.50,7.60,7.70,7.80,7.90,8.00,8.10,8.20,
     /8.30,8.40,8.50,8.60,8.70,8.80,8.90,9.00,9.10,9.20,
     /9.30,9.40,9.50,9.60,9.70,9.80,9.90,10.0,15.0,100.,
     /1000.,1.0D5,1.0D6,1.0D7/
      DATA YATT/.0,1.81D-5,6.35D-5,1.45D-4,2.81D-4,5.44D-4,8.43D-4,
     /1.09D-3,1.32D-3,1.45D-3,
     /1.53D-3,1.40D-3,1.25D-3,1.01D-3,7.98D-4,6.17D-4,4.54D-4,2.91D-4,
     /2.00D-4,1.36D-4,
     /9.98D-5,6.35D-5,2.72D-5,1.81D-5,9.07D-6,1.00D-6,9.07D-6,1.81D-5,
     /2.72D-5,4.54D-5,
     /6.35D-5,1.09D-4,1.45D-4,2.08D-4,2.99D-4,3.99D-4,5.44D-4,9.25D-4,
     /9.25D-4,1.18D-3,
     /1.49D-3,1.84D-3,2.23D-3,2.75D-3,3.22D-3,3.68D-3,4.08D-3,4.37D-3,
     /4.41D-3,4.26D-3,
     /3.92D-3,3.46D-3,2.92D-3,2.22D-3,1.77D-3,1.40D-3,1.05D-3,8.07D-4,
     /6.35D-4,4.99D-4,
     /3.80D-4,2.99D-4,2.36D-4,1.81D-4,1.36D-4,1.09D-4,8.17D-5,1.00D-6,
     /1.0D-8,1.0D-9,
     /1.0D-10,1.0D-11,1.0D-12,1.0D-13/
C
      DATA XEXC1/7.90,9.00,10.0,11.0,12.0,13.0,14.0,16.0,18.0,20.0,
     /25.0,30.0,35.0,40.0,50.0,60.0,80.0,100.,120.,150.,
     /200.,250.,300.,400.,500.,600.,750.,1000.,1500.,2000.,
     /2500.,3000.,4000.,6000.,8000.,10000.,20000.,40000.,60000.,80000.,
     /1.0D5,1.5D5,2.0D5,4.0D5,6.0D5,8.0D5,1.0D6,1.5D6,2.0D6,3.0D6,
     /5.0D6,7.0D6,1.0D7/
      DATA YEXC1/0.00,.007,.030,.069,.078,.069,.063,.060,.058,.057,
     /.053,.051,.049,.047,.046,.043,.038,.034,.031,.027,
     /.022,.019,.016,.013,.0110,.0095,.0079,.0062,.0044,.0034,
     /.0028,.0024,.0018,.0013,.00098,.00080,.00042,.00024,.00017,.00014,
     /1.16D-4,8.8D-5,7.4D-5,5.4D-5,4.8D-5,4.6D-5,4.5D-5,4.4D-5,
     /4.3D-5,4.4D-5,
     /4.5D-5,4.6D-5,4.8D-5/
C
      DATA XEXC2/8.90,9.50,10.0,11.0,12.0,13.0,14.0,16.0,18.0,20.0,
     /25.0,30.0,35.0,40.0,50.0,60.0,80.0,100.,120.,150.,
     /200.,250.,300.,400.,500.,600.,750.,1000.,1500.,2000.,
     /2500.,3000.,4000.,6000.,8000.,10000.,20000.,40000.,60000.,80000.,
     /1.0D5,1.5D5,2.0D5,4.0D5,6.0D5,8.0D5,1.0D6,1.5D6,2.0D6,3.0D6,
     /5.0D6,7.0D6,1.0D7/
      DATA YEXC2/0.00,.004,.009,.040,.065,.062,.060,.058,.057,.056,
     /.055,.054,.052,.050,.048,.046,.041,.037,.034,.029,
     /.024,.021,.018,.015,.0123,.0106,.0089,.0070,.0050,.0040,
     /3.37D-3,2.85D-3,2.2D-3,.0015,.00116,.00095,5.1D-4,2.81D-4,
     /2.02D-4,1.62D-4,
     /1.38D-4,1.05D-4,8.9D-5,6.5D-5,5.8D-5,5.5D-5,5.32D-5,5.19D-5,
     /5.18D-5,5.24D-5,
     /5.4D-5,5.53D-5,5.68D-5/
C
      DATA XEXC3/10.5,12.0,13.0,14.0,15.0,17.0,20.0,25.0,30.0,35.0,
     /40.0,50.0,60.0,70.0,80.0,100.,120.,150.,200.,250.,
     /300.,400.,500.,600.,750.,1000.,1500.,2000.,2500.,3000.,
     /4000.,6000.,8000.,10000.,20000.,40000.,60000.,8.0D4,1.0D5,1.5D5,
     /2.0D5,4.0D5,6.0D5,8.0D5,1.0D6,1.5D6,2.0D6,3.0D6,5.0D6,7.0D6,
     /1.0D7/
      DATA YEXC3/0.00,0.56,0.43,0.34,0.31,0.30,0.30,0.31,0.32,0.33,
     /0.35,0.38,0.41,0.43,0.44,.425,0.40,0.36,.325,0.29,
     /.258,.214,.184,.161,.136,.111,.081,.064,.053,.0444,
     /.0342,.024,.0180,.0148,.00795,.00439,.00315,.00253,.00214,.00164,
     /.0014,.00102,.00090,.00085,.00083,.00082,.00080,.00082,.00084,
     /.00086,.00089/
C
      DATA XEXC4/12.2,13.0,14.0,15.0,16.0,17.0,20.0,25.0,30.0,35.0,
     /40.0,50.0,60.0,70.0,80.0,100.,120.,150.,200.,250.,
     /300.,400.,500.,600.,750.,1000.,1500.,2000.,2500.,3000.,
     /4000.,6000.,8000.,10000.,20000.,40000.,60000.,8.0D4,1.0D5,1.5D5,
     /2.0D5,4.0D5,6.0D5,8.0D5,1.0D6,1.5D6,2.0D6,3.0D6,5.0D6,7.0D6,
     /1.0D7/
      DATA YEXC4/0.00,0.23,0.31,0.34,0.38,0.40,0.46,0.54,0.60,0.64,
     /0.67,0.74,0.80,0.82,0.82,0.79,0.75,0.68,0.59,0.51,
     /0.46,0.38,0.33,0.29,.233,.188,.133,.1016,.0829,.070,
     /.054,.038,.029,.0234,.0125,.0069,.0050,.0040,.00339,.00258,
     /.00218,.00160,.00143,.00135,.00131,.00128,.00128,.00129,
     /.00133,.00136,.00140/
C
      DATA XEXC5/13.2,14.0,15.0,16.0,17.0,18.0,20.0,25.0,30.0,35.0,
     /40.0,50.0,60.0,70.0,80.0,100.,120.,150.,200.,250.,
     /300.,400.,500.,600.,750.,1000.,1500.,2000.,2500.,3000.,
     /4000.,6000.,8000.,10000.,20000.,40000.,60000.,8.0D4,1.0D5,1.5D5,
     /2.0D5,4.0D5,6.0D5,8.0D5,1.0D6,1.5D6,2.0D6,3.0D6,5.0D6,7.0D6,
     /1.0D7/
      DATA YEXC5/0.00,0.37,0.48,0.61,0.69,0.76,0.89,1.11,1.24,1.33,
     /1.39,1.55,1.68,1.78,1.85,1.81,1.71,1.59,1.39,1.25,
     /1.14,0.95,0.83,0.73,0.61,0.50,0.38,0.30,0.26,.225,
     /.175,.128,.099,.083,.045,.025,.0176,.0141,.01204,.00918,
     /.00775,.00566,.00505,.00478,.00465,.00454,.00453,.00458,
     /.00472,.00484,.00496/
C
      DATA XEXC6/15.0,16.0,17.0,18.0,19.0,20.0,21.0,25.0,30.0,35.0,
     /40.0,50.0,60.0,70.0,80.0,100.,120.,150.,200.,250.,
     /300.,400.,500.,600.,750.,1000.,1500.,2000.,2500.,3000.,
     /4000.,6000.,8000.,10000.,20000.,40000.,60000.,8.0D4,1.0D5,1.5D5,
     /2.0D5,4.0D5,6.0D5,8.0D5,1.0D6,1.5D6,2.0D6,3.0D6,5.0D6,7.0D6,
     /1.0D7/
      DATA YEXC6/0.0,.0005,.003,.006,.009,.013,.016,.025,.031,.034,
     /.037,.041,.046,.048,.048,.046,.044,.040,.035,.031,
     /.028,.024,.020,.018,.015,.013,.0090,.0078,.0064,.0056,
     /.0048,.0035,.0028,.00234,.00126,.0008,.0005,.00040,.00034,.000258,
     /.000218,.000160,.000143,.000135,.000131,.000128,.000128,.000129,
     /.000133,.000136,.000140/
C IONISATION VALUES ABOVE 1KEV GENERATED BY BORN BETHE IN SUB)
C DATA FROM RAPP, LINDSAY AND RIEKE ALSO BB THEORY
      DATA XION/13.777,14.5,15.0,15.5,16.0,16.5,17.0,17.5,18.0,18.5,
     /19.0,19.5,21.0,21.5,22.0,22.5,23.0,23.5,24.0,26.0,
     /28.0,30.0,32.0,34.0,36.0,38.0,40.0,45.0,50.0,55.0,
     /60.0,65.0,70.0,75.0,80.0,85.0,90.0,100.,110.,130.,
     /140.,160.,180.,200.,225.,250.,275.,300.,350.,400.,
     /450.,500.,550.,600.,650.,700.,750.,800.,850.,900.,
     /950.,1000./
C GROSS IONISATION
      DATA YION/0.00,.055,.097,.135,.174,.215,.255,.293,.333,.373,
     /.428,.452,.577,.623,.676,.727,.777,.828,.880,1.14,
     /1.37,1.54,1.70,1.84,1.96,2.07,2.19,2.45,2.67,2.84,
     /3.02,3.16,3.27,3.36,3.45,3.51,3.56,3.64,3.66,3.65,
     /3.63,3.52,3.43,3.32,3.21,3.05,2.97,2.82,2.58,2.43,
     /2.23,2.09,1.96,1.85,1.77,1.68,1.61,1.53,1.45,1.41,
     /1.36,1.30/
C COUNTING IONISATION
      DATA YINC/0.00,.055,.097,.135,.174,.215,.255,.293,.333,.373,
     /.428,.452,.577,.623,.676,.727,.777,.828,.880,1.14,
     /1.37,1.54,1.70,1.84,1.96,2.07,2.19,2.45,2.67,2.84,
     /3.01,3.14,3.26,3.33,3.43,3.48,3.54,3.62,3.63,3.62,
     /3.60,3.48,3.40,3.29,3.17,3.02,2.94,2.79,2.55,2.41,
     /2.21,2.08,1.94,1.84,1.75,1.66,1.60,1.51,1.44,1.40,
     /1.35,1.29/
C ---------------------------------------------------------------------
C
C ANGULAR DISTRIBUTION ONLY ALLOWED FOR ELASTIC , IONISATION AND
C EXCITATION ABOVE 10EV.
C IN FUTURE IF  ANGULAR DISTRIBUTION FOR VIBRATIONS ARE INCLUDED THEN
C ELASTIC MOMENTUM TRANSFER X-SECTION WILL ALSO NEED MODIFIED AT THE
C SAME TIME TO GIVE A GOOD QUALITY OF FIT TO THE TRANSPORT PROPERTIES.
C ---------------------------------------------------------------------
      IF(NANISO.EQ.0) THEN
       NAME='CO2 2007 ISOT  '
      ELSE
       NAME='CO2  2007 ANISO'
      ENDIF
C  --------------------------------------------------------------------
C ---------------------------------------------------------------------
C    BORN-BETHE VALUES FOR IONISATION
      CONST=1.873884D-20
      EMASS2=1021997.804
      AM2=5.60
      C=57.91
C
      NIN=85
      DO 1 J=1,6
    1 KEL(J)=NANISO
      DO 2 J=1,NIN
      KIN(J)=NANISO
    2 IF(J.LT.80) KIN(J)=0
C
      NEL=124
      NV2=23
      N2V2=25
      NV1=32
      N3V2=17
      NV3=17
      NPD3=22
      NV130=19
      NPD4=20
      NPD5=17
      NPD6=17
      NPD7=17
      NPD8=17
      NPD9=17
      NPDH=15
      NATT=74
      NEXC1=53
      NEXC2=53
      NEXC3=51
      NEXC4=51
      NEXC5=51
      NEXC6=51
      NION=62
      E(1)=0.0
      E(2)=2.0*EMASS/(44.0095*AMU)
      E(3)=13.777
C  EXCITATION X-SECTION (SUM OF 13.2 AND 15 EV ) AT 1.5MEV
      E(4)=0.00466D-16
C  IONISING X-SECTION AT 1.5 MEV
      E(5)=0.01355D-16
C EOBY FOR MINIMUM IONISING PARTICLE
      E(6)=13.0
C OPAL AND BEATY IONISATION ENERGY SPLITTING
      EOBY=13.8
C OFFSET ENERGY FOR PRIMARY IONISATION ELECTRON ANGULAR DISTRIBUTION
      IOFF=IFIX(SNGL(0.5+E(3)/ESTEP))
C
C DIPOLE TRANSITION STRENGTH FOR VIBRATIONS V010 AND V001
      AMPV2=0.1703
      AMPV3=0.3922
C-----------------------------------------------------------------------
C  B0 IS ROTATIONAL CONSTANT
C  QBQA IS QUADRUPOLE MOMENT
      B0=4.838D-5
      A0=0.5291772083D-8
      QBQA=3.24
      QBK=1.67552*(QBQA*A0)**2
C---------------------------------------------------------------------
C CALC FRACTIONAL POPULATION DENSITY OF ROTATIONAL STATES
      PJ(1)=1.0
      DO 3 L=2,31
      J=(2*L)-2
    3 PJ(L)=(2*J+1)*DEXP(-J*(J+1)*B0/AKT)
      SUM=0.0
      DO 4 L=1,31
    4 SUM=SUM+PJ(L)
      DO 5 L=1,31
    5 PJ(L)=PJ(L)/SUM
C---------------------------------------------------------------------
C CALC ROTATIONAL TRANSITION ENERGIES
      DO 6 K=1,59,2
      EIN(K)=B0*(4*K+2)
    6 EIN(K+1)=-EIN(K)
      EIN(61)  = -0.08275
      EIN(62)  =  0.08275
      EIN(63)  = -0.15937
      EIN(64)  =  0.15937
      EIN(65)  = -0.17211
      EIN(66)  =  0.17211
      EIN(67)  = -0.251
      EIN(68)  =  0.251
      EIN(69)  = -0.29126
      EIN(70)  =  0.29126
      EIN(71)  =  0.335
      EIN(72)  =  0.422
      EIN(73)  =  0.505
      EIN(74)  =  0.685
      EIN(75)  =  0.825
      EIN(76)  =  0.995
      EIN(77)  =  1.160
      EIN(78)  =  1.320
      EIN(79)  =  2.500
      EIN(80)  =  7.90
      EIN(81)  =  8.90
      EIN(82)  = 10.5
      EIN(83)  = 12.2
      EIN(84)  = 13.2
      EIN(85)  = 15.0
C  OFFSET ENERGY FOR EXCITATION LEVELS ANGULAR DISTRIBUTION
      IOFF80=IFIX(SNGL(0.5+EIN(80)/ESTEP))
      IOFF81=IFIX(SNGL(0.5+EIN(81)/ESTEP))
      IOFF82=IFIX(SNGL(0.5+EIN(82)/ESTEP))
      IOFF83=IFIX(SNGL(0.5+EIN(83)/ESTEP))
      IOFF84=IFIX(SNGL(0.5+EIN(84)/ESTEP))
      IOFF85=IFIX(SNGL(0.5+EIN(85)/ESTEP))
C***********************************************************************
C ENTER PENNING TRANSFER FRACTION FOR EACH LEVEL
C FIRST 81 LEVELS UNLIKELY TO HAVE ENOUGH ENERGY
      DO 7 K=1,81
      DO 7 L=1,3
    7 PENFRA(L,K)=0.0
C PENNING TRANSFER FRACTION FOR LEVELS 82(10.5),83(12.2),84(13.2) AND
C  85(15.0EV)
      PENFRA(1,82)=0.0
      PENFRA(1,83)=0.0
      PENFRA(1,84)=0.0
      PENFRA(1,85)=0.0
C PENNING TRANSFER DISTANCE IN MICRONS
      PENFRA(2,82)=1.0
      PENFRA(2,83)=1.0
      PENFRA(2,84)=1.0
      PENFRA(2,85)=1.0
C PENNING TRANSFER TIME IN PICOSECONDS
      PENFRA(3,82)=1.0
      PENFRA(3,83)=1.0
      PENFRA(3,84)=1.0
      PENFRA(3,85)=1.0
      IF(IPEN.EQ.0) GO TO 9
      DO 8 KDUM=82,85
      IF(PENFRA(1,KDUM).EQ.0.0) GO TO 8
      WRITE(6,999) NAME,EIN(KDUM),PENFRA(1,KDUM),PENFRA(2,KDUM),
     /PENFRA(3,KDUM)
 999  FORMAT(' GAS = ',A15,' ENERGY LEVEL = ',F7.4,' EV.',/,' PENNING PR
     /OBABILITY =',F5.3,' ABS.LENGTH =',F7.2,' DECAY TIME =',F7.1,/)
    8 CONTINUE
C***********************************************************************
C
C DEGENERACY OF VIBRATIONAL STATES
    9 DEGV1=1.0
      DEGV2=2.0
      DEGV3=1.0
      DEG2V2=3.0
C 3V2 === SUM (3V2 + V12) =   4+2
      DEG3V2=6.0
C----------------------------------------------------
C CALC POPULATION OF VIBRATIONAL STATES
      SUM=0.0
      APOPV2=DEGV2*DEXP(EIN(61)/AKT)
      APOP2V2=DEG2V2*DEXP(EIN(63)/AKT)
      APOPV1=DEGV1*DEXP(EIN(65)/AKT)
      APOP3V2=DEG3V2*DEXP(EIN(67)/AKT)
      APOPV3=DEGV3*DEXP(EIN(69)/AKT)
      SUM=1.0+APOPV2+APOP2V2+APOPV1+APOP3V2+APOPV3
      APOPGS=1.0/SUM
      APOPV2=APOPV2/SUM
      APOP2V2=APOP2V2/SUM
      APOPV1=APOPV1/SUM
      APOP3V2=APOP3V2/SUM
      APOPV3=APOPV3/SUM
      APBEND=APOPV2+APOP2V2+APOP3V2
C     WRITE(6,865) APOPGS,APOPV2,APOP2V2,APOPV1,APOP3V2,APOPV3,APBEND
C 865 FORMAT(' APOPGS=',F8.6,' APOPV2=',F8.6,' APOP2V2=',F8.6,' APOPV1='
C    /,F8.6,' APOP3V2=',F8.6,' APOPV3=',F8.6,/,' APBEND=',F12.10)
C
C RENORMALISE VIBRATIONAL GROUND STATE POPULATION IN ORDER TO ACCOUNT
C FOR EXCITATION FROM VIBRATIONALLY EXCITED STATES
      APOPGS=1.0
C BEND MODE AND EFFECTIVE GROUND STATE POPULATION AT 293.15 KELVIN
      AEXT20=7.51373753D-2
      AGST20=1.0-AEXT20
C     WRITE(6,866) APOPGS,AEXT20
C 866 FORMAT(' RENORMALISED GS POPULATION=', F6.4,' AEXT20=',F12.10)
C------------------------------------------------------
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC  ANISOTROPIC    CO2  '
      IF(NANISO.EQ.0) THEN
      SCRPT(2)=' ELASTIC   ISOTROPIC     CO2  '
      ENDIF
      SCRPT(3)=' IONISATION    ELOSS= 13.773  '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' ROT  0-2      ELOSS=  0.00029'
      SCRPT(8)=' ROT  2-0      ELOSS= -0.00029'
      SCRPT(9)=' ROT  2-4      ELOSS=  0.00068'
      SCRPT(10)=' ROT  4-2      ELOSS= -0.00068'
      SCRPT(11)=' ROT  4-6      ELOSS=  0.00106'
      SCRPT(12)=' ROT  6-4      ELOSS= -0.00106'
      SCRPT(13)=' ROT  6-8      ELOSS=  0.00145'
      SCRPT(14)=' ROT  8-6      ELOSS= -0.00145'
      SCRPT(15)=' ROT  8-10     ELOSS=  0.00184'
      SCRPT(16)=' ROT 10-8      ELOSS= -0.00184'
      SCRPT(17)=' ROT 10-12     ELOSS=  0.00223'
      SCRPT(18)=' ROT 12-10     ELOSS= -0.00223'
      SCRPT(19)=' ROT 12-14     ELOSS=  0.00261'
      SCRPT(20)=' ROT 14-12     ELOSS= -0.00261'
      SCRPT(21)=' ROT 14-16     ELOSS=  0.00300'
      SCRPT(22)=' ROT 16-14     ELOSS= -0.00300'
      SCRPT(23)=' ROT 16-18     ELOSS=  0.00339'
      SCRPT(24)=' ROT 18-16     ELOSS= -0.00339'
      SCRPT(25)=' ROT 18-20     ELOSS=  0.00377'
      SCRPT(26)=' ROT 20-18     ELOSS= -0.00377'
      SCRPT(27)=' ROT 20-22     ELOSS=  0.00416'
      SCRPT(28)=' ROT 22-20     ELOSS= -0.00416'
      SCRPT(29)=' ROT 22-24     ELOSS=  0.00455'
      SCRPT(30)=' ROT 24-22     ELOSS= -0.00455'
      SCRPT(31)=' ROT 24-26     ELOSS=  0.00493'
      SCRPT(32)=' ROT 26-24     ELOSS= -0.00493'
      SCRPT(33)=' ROT 26-28     ELOSS=  0.00532'
      SCRPT(34)=' ROT 28-26     ELOSS= -0.00532'
      SCRPT(35)=' ROT 28-30     ELOSS=  0.00571'
      SCRPT(36)=' ROT 30-28     ELOSS= -0.00571'
      SCRPT(37)=' ROT 30-32     ELOSS=  0.00610'
      SCRPT(38)=' ROT 32-30     ELOSS= -0.00610'
      SCRPT(39)=' ROT 32-34     ELOSS=  0.00648'
      SCRPT(40)=' ROT 34-32     ELOSS= -0.00648'
      SCRPT(41)=' ROT 34-36     ELOSS=  0.00687'
      SCRPT(42)=' ROT 36-34     ELOSS= -0.00687'
      SCRPT(43)=' ROT 36-38     ELOSS=  0.00726'
      SCRPT(44)=' ROT 38-36     ELOSS= -0.00726'
      SCRPT(45)=' ROT 38-40     ELOSS=  0.00764'
      SCRPT(46)=' ROT 40-38     ELOSS= -0.00764'
      SCRPT(47)=' ROT 40-42     ELOSS=  0.00803'
      SCRPT(48)=' ROT 42-40     ELOSS= -0.00803'
      SCRPT(49)=' ROT 42-44     ELOSS=  0.00842'
      SCRPT(50)=' ROT 44-42     ELOSS= -0.00842'
      SCRPT(51)=' ROT 44-46     ELOSS=  0.00881'
      SCRPT(52)=' ROT 46-44     ELOSS= -0.00881'
      SCRPT(53)=' ROT 46-48     ELOSS=  0.00919'
      SCRPT(54)=' ROT 48-46     ELOSS= -0.00919'
      SCRPT(55)=' ROT 48-50     ELOSS=  0.00958'
      SCRPT(56)=' ROT 50-48     ELOSS= -0.00958'
      SCRPT(57)=' ROT 50-52     ELOSS=  0.00997'
      SCRPT(58)=' ROT 52-50     ELOSS= -0.00997'
      SCRPT(59)=' ROT 52-54     ELOSS=  0.01035'
      SCRPT(60)=' ROT 54-52     ELOSS= -0.01035'
      SCRPT(61)=' ROT 54-56     ELOSS=  0.01074'
      SCRPT(62)=' ROT 56-54     ELOSS= -0.01074'
      SCRPT(63)=' ROT 56-58     ELOSS=  0.01113'
      SCRPT(64)=' ROT 58-56     ELOSS= -0.01113'
      SCRPT(65)=' ROT 58-60     ELOSS=  0.01151'
      SCRPT(66)=' ROT 60-58     ELOSS= -0.01151'
      SCRPT(67)=' V (010)       ELOSS= -0.08275'
      SCRPT(68)=' V (010)       ELOSS=  0.08275'
      SCRPT(69)=' V (020)       ELOSS= -0.15937'
      SCRPT(70)=' V (020)       ELOSS=  0.15937'
      SCRPT(71)=' V (100)       ELOSS= -0.17211'
      SCRPT(72)=' V (100)       ELOSS=  0.17211'
      SCRPT(73)=' V (030)+(110) ELOSS= -0.251  '
      SCRPT(74)=' V (030)+(110) ELOSS=  0.251  '
      SCRPT(75)=' V (001)       ELOSS= -0.29126'
      SCRPT(76)=' V (001)       ELOSS=  0.29126'
      SCRPT(77)=' V POLYAD 3    ELOSS=  0.335  '
      SCRPT(78)=' V (130)+(210) ELOSS=  0.422  '
      SCRPT(79)=' V POLYAD 4    ELOSS=  0.505  '
      SCRPT(80)=' V POLYAD 5    ELOSS=  0.685  '
      SCRPT(81)=' V POLYAD 6    ELOSS=  0.825  '
      SCRPT(82)=' V POLYAD 7    ELOSS=  0.995  '
      SCRPT(83)=' V POLYAD 8    ELOSS=  1.160  '
      SCRPT(84)=' V POLYAD 9    ELOSS=  1.320  '
      SCRPT(85)=' V POLYAD SUM  ELOSS=  2.500  '
      SCRPT(86)=' EXC           ELOSS=  7.900  '
      SCRPT(87)=' EXC           ELOSS=  8.900  '
      SCRPT(88)=' EXC           ELOSS= 10.500  '
      SCRPT(89)=' EXC           ELOSS= 12.200  '
      SCRPT(90)=' EXC           ELOSS= 13.200  '
      SCRPT(91)=' EXC           ELOSS= 15.000  '
      EN=-ESTEP/2.0
      DO 9000 I=1,NSTEP
      EN=EN+ESTEP
C ELASTIC USE LOG INTERPOLATION
      IF(EN.LE.XEN(1)) THEN
       QMOM=YMOM(1)*1.D-16
       QELA=YEL(1)*1.D-16
       QBMOM=QMOM
       QBELA=QELA
       PQ2=0.0
       GO TO 20
      ENDIF
      DO 10 J=2,NEL
      IF(EN.LE.XEN(J)) GO TO 15
   10 CONTINUE
      J=NEL
   15 YXJ=DLOG(YMOM(J))
      YXJ1=DLOG(YMOM(J-1))
      XNJ=DLOG(XEN(J))
      XNJ1=DLOG(XEN(J-1))
      A=(YXJ-YXJ1)/(XNJ-XNJ1)
      B=(XNJ1*YXJ-XNJ*YXJ1)/(XNJ1-XNJ)
      QMOM=DEXP(A*DLOG(EN)+B)*1.D-16
      YXJ=DLOG(YEL(J))
      YXJ1=DLOG(YEL(J-1))
      A=(YXJ-YXJ1)/(XNJ-XNJ1)
      B=(XNJ1*YXJ-XNJ*YXJ1)/(XNJ1-XNJ)
      QELA=DEXP(A*DLOG(EN)+B)*1.D-16
      YXJ=DLOG(YVBMOM(J))
      YXJ1=DLOG(YVBMOM(J-1))
      A=(YXJ-YXJ1)/(XNJ-XNJ1)
      B=(XNJ1*YXJ-XNJ*YXJ1)/(XNJ1-XNJ)
      QBMOM=DEXP(A*DLOG(EN)+B)*1.D-16
      YXJ=DLOG(YVBEL(J))
      YXJ1=DLOG(YVBEL(J-1))
      A=(YXJ-YXJ1)/(XNJ-XNJ1)
      B=(XNJ1*YXJ-XNJ*YXJ1)/(XNJ1-XNJ)
      QBELA=DEXP(A*DLOG(EN)+B)*1.D-16
      YXJ=DLOG(YEPS(J))
      YXJ1=DLOG(YEPS(J-1))
      A=(YXJ-YXJ1)/(XNJ-XNJ1)
      B=(XNJ1*YXJ-XNJ*YXJ1)/(XNJ1-XNJ)
      PQ2=DEXP(A*DLOG(EN)+B)
   20 CONTINUE
C CALC CHANGE IN ELASTIC CROSS SECTION DUE TO CHANGE IN ELASTIC
C SCATTERING FROM BEND MODES ( CHANGE RELATIVE TO X-SECTION AT 293.15K)
C BEND MODE POPULATION AT 293.15K == AEXT20,GROUND STATE POP. == AGST20
C
      QMOM=(1.0-APBEND)*(QMOM-AEXT20*QBMOM)/AGST20+APBEND*QBMOM
      QELA=(1.0-APBEND)*(QELA-AEXT20*QBELA)/AGST20+APBEND*QBELA
      PQ1=0.5+(QELA-QMOM)/QELA
C
      IF(NANISO.EQ.2) THEN
       Q(2,I)=QELA
       PEQEL(2,I)=PQ2
       IF(EN.LT.10.0) PEQEL(2,I)=0.0
       IF(EN.LT.10.0) Q(2,I)=QMOM
      ENDIF
      IF(NANISO.EQ.1) THEN
       Q(2,I)=QELA
       PEQEL(2,I)=PQ1
       IF(EN.LT.10.0) PEQEL(2,I)=0.5
       IF(EN.LT.10.0) Q(2,I)=QMOM
      ENDIF
      IF(NANISO.EQ.0) THEN
       PEQEL(2,I)=0.5
       Q(2,I)=QMOM
      ENDIF
C
C GROSS IONISATION
      Q(3,I)=0.0
      PEQEL(3,I)=0.5
      IF(NANISO.EQ.2) PEQEL(3,I)=0.0
      IF(EN.LE.E(3)) GO TO 30
      IF(EN.GT.XION(NION)) GO TO 23
      DO 21 J=2,NION
      IF(EN.LE.XION(J)) GO TO 22
   21 CONTINUE
      J=NION
   22 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=1.0D-16*(A*EN+B)
      GO TO 24
C USE BORN-BETHE X-SECTION ABOVE XION(NION) EV
   23 GAMMA=(EMASS2+2.0D0*EN)/EMASS2
      BETA=DSQRT(1.0D0-1.0D0/(GAMMA*GAMMA))
      BETA2=BETA*BETA
      X2=1.0D0/BETA2
      X1=X2*DLOG(BETA2/(1.0D0-BETA2))-1.0D0
      Q(3,I)=CONST*(AM2*X1+C*X2)/0.9921
   24 CONTINUE
C USE ANISOTROPIC SCATTERING FOR PRIMARY IONISATION ELECTRON FOR
C ENERGIES ABOVE 2 * IONISATION ENERGY
C ANISOTROPIC ANGULAR DISTRIBUTION SAME AS ELASTIC AT ENERGY OFFSET BY
C IONISATION ENERGY
      IF(EN.LE.(2.0*E(3))) GO TO 30
      PEQEL(3,I)=PEQEL(2,(I-IOFF))
C
C ATTACHMENT
   30 Q(4,I)=0.0
      IF(EN.LE.XATT(1)) GO TO 40
      DO 31  J=2,NATT
      IF(EN.LE.XATT(J)) GO TO 32
   31 CONTINUE
      J=NATT
   32 A=(YATT(J)-YATT(J-1))/(XATT(J)-XATT(J-1))
      B=(XATT(J-1)*YATT(J)-XATT(J)*YATT(J-1))/(XATT(J-1)-XATT(J))
      Q(4,I)=1.0D-16*(A*EN+B)
C COUNTING IONISATION
   40 Q(5,I)=0.0
      PEQEL(5,I)=0.5
      IF(NANISO.EQ.2) PEQEL(5,I)=0.0
      IF(EN.LE.E(3)) GO TO 45
      IF(EN.GT.XION(NION)) GO TO 43
      DO 41 J=2,NION
      IF(EN.LE.XION(J)) GO TO 42
   41 CONTINUE
      J=NION
   42 A=(YINC(J)-YINC(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YINC(J)-XION(J)*YINC(J-1))/(XION(J-1)-XION(J))
      Q(5,I)=(A*EN+B)*1.0D-16
      GO TO 44
C USE BORN-BETHE X-SECTION ABOVE XION(NION) EV
   43 Q(5,I)=CONST*(AM2*X1+C*X2)
   44 CONTINUE
C USE ANISOTROPIC SCATTERING FOR PRIMARY IONISATION ELECTRON FOR
C ENERGIES ABOVE 2 * IONISATION ENERGY
C ANISOTROPIC ANGULAR DISTRIBUTION SAME AS ELASTIC AT ENERGY OFFSET BY
C IONISATION ENERGY
      IF(EN.LE.(2.0*E(3))) GO TO 45
      PEQEL(5,I)=PEQEL(2,(I-IOFF))
   45 CONTINUE
      Q(6,I)=0.0
C ----------------------------------------------------------------------
C  QUADRUPOLE BORN ROTATIONAL STATES (GERJUOY AND STEIN)
C ----------------------------------------------------------------------
C SUPERELASTIC ROTATION
      DO 51 K=2,60,2
      AJ=DFLOAT(K)
      L=(K/2)+1
      PEQIN(K,I)=0.5
      IF(NANISO.EQ.2) PEQIN(K,I)=0.0
   51 QIN(K,I)=PJ(L)*QBK*DSQRT(1.0-EIN(K)/EN)*AJ*(AJ-1.0)/((2.0*AJ+1.0)*
     /(2.0*AJ-1.0))
C ROTATION
      DO 52 K=1,59,2
      QIN(K,I)=0.0
      PEQIN(K,I)=0.5
      IF(NANISO.EQ.2) PEQIN(K,I)=0.0
      IF(EN.LE.EIN(K)) GO TO 52
      AJ=DFLOAT(K-1)
      L=(K+1)/2
      QIN(K,I)=PJ(L)*QBK*DSQRT(1.0-EIN(K)/EN)*(AJ+2.0)*(AJ+1.0)/((2.0*AJ
     /+3.0)*(2.0*AJ+1.0))
   52 CONTINUE
C BORN (1/E) FALL OFF IN ROTATONAL X-SEC ABOVE 6.0 EV
C AND SET TO EFFECTIVE ZERO ABOVE 1KEV.
      IF(EN.LT.6.0) GO TO 80
      DO 70 K=1,60
      QIN(K,I)=QIN(K,I)*6.0/EN
   70 IF(EN.GT.1000.0) QIN(K,I)=1.0D-30
   80 CONTINUE
C
C  SUPERELASTIC V2  BEND MODE
      QIN(61,I)=0.0
      IF(EN.LE.0.0) GO TO 150
      EFAC=DSQRT(1.0-(EIN(61)/EN))
      QIN(61,I)=AMPV2*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      DO 110 J=2,NV2
      IF((EN+EIN(62)).LE.XV2(J)) GOTO 120
  110 CONTINUE
      J=NV2
  120 A=(YV2(J)-YV2(J-1))/(XV2(J)-XV2(J-1))
      B=(XV2(J-1)*YV2(J)-XV2(J)*YV2(J-1))/(XV2(J-1)-XV2(J))
      QIN(61,I)=QIN(61,I)+(EN+EIN(62))*(A*(EN+EIN(62))+B)/EN
      QIN(61,I)=QIN(61,I)*APOPV2/DEGV2*1.D-16
C V2  BEND MODE
  150 QIN(62,I)=0.0
      IF(EN.LE.EIN(62)) GO TO 200
      EFAC=DSQRT(1.0-(EIN(62)/EN))
      QIN(62,I)=AMPV2*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      DO 160 J=2,NV2
      IF(EN.LE.XV2(J)) GO TO 170
  160 CONTINUE
      J=NV2
  170 A=(YV2(J)-YV2(J-1))/(XV2(J)-XV2(J-1))
      B=(XV2(J-1)*YV2(J)-XV2(J)*YV2(J-1))/(XV2(J-1)-XV2(J))
      QIN(62,I)=QIN(62,I)+(A*EN+B)
      QIN(62,I)=QIN(62,I)*APOPGS*1.D-16
C
C  SUPERELASTIC 2V2 BEND MODE HARMONIC
  200 CONTINUE
      QIN(63,I)=0.0
      IF(EN.LE.0.0) GO TO 250
      DO 210 J=2,N2V2
      IF((EN+EIN(64)).LE.X2V2(J)) GOTO 220
  210 CONTINUE
      J=N2V2
  220 A=(Y2V2(J)-Y2V2(J-1))/(X2V2(J)-X2V2(J-1))
      B=(X2V2(J-1)*Y2V2(J)-X2V2(J)*Y2V2(J-1))/(X2V2(J-1)-X2V2(J))
      QIN(63,I)=(EN+EIN(64))*(A*(EN+EIN(64))+B)/EN
      QIN(63,I)=QIN(63,I)*APOP2V2/DEG2V2*1.D-16
C  2V2 BEND MODE HARMONIC
  250 CONTINUE
      QIN(64,I)=0.0
      IF(EN.LE.EIN(64)) GO TO 300
      DO 260 J=2,N2V2
      IF(EN.LE.X2V2(J)) GOTO 270
  260 CONTINUE
      J=N2V2
  270 A=(Y2V2(J)-Y2V2(J-1))/(X2V2(J)-X2V2(J-1))
      B=(X2V2(J-1)*Y2V2(J)-X2V2(J)*Y2V2(J-1))/(X2V2(J-1)-X2V2(J))
      QIN(64,I)=(A*EN+B)*APOPGS*1.D-16
C
C SUPERELASTIC V1 SYMMETRIC STRETCH
  300 CONTINUE
      QIN(65,I)=0.0
      IF(EN.LE.0.0) GO TO 350
      DO 310 J=2,NV1
      IF((EN+EIN(66)).LE.XV1(J)) GOTO 320
  310 CONTINUE
      J=NV1
  320 A=(YV1(J)-YV1(J-1))/(XV1(J)-XV1(J-1))
      B=(XV1(J-1)*YV1(J)-XV1(J)*YV1(J-1))/(XV1(J-1)-XV1(J))
      QIN(65,I)=(EN+EIN(66))*(A*(EN+EIN(66))+B)/EN
      QIN(65,I)=QIN(65,I)*APOPV1/DEGV1*1.D-16
C V1 SYMMETRIC STRETCH
  350 CONTINUE
      QIN(66,I)=0.0
      IF(EN.LE.EIN(66)) GO TO 400
      DO 360 J=2,NV1
      IF(EN.LE.XV1(J)) GOTO 370
  360 CONTINUE
      J=NV1
  370 A=(YV1(J)-YV1(J-1))/(XV1(J)-XV1(J-1))
      B=(XV1(J-1)*YV1(J)-XV1(J)*YV1(J-1))/(XV1(J-1)-XV1(J))
      QIN(66,I)=(A*EN+B)*APOPGS*1.D-16
C
C SUPERELASTIC 3V2 + V12
  400 CONTINUE
      QIN(67,I)=0.0
      IF(EN.LE.0.0) GO TO 450
      DO 410 J=2,N3V2
      IF((EN+EIN(68)).LE.X3V2(J)) GOTO 420
  410 CONTINUE
      J=N3V2
  420 A=(Y3V2(J)-Y3V2(J-1))/(X3V2(J)-X3V2(J-1))
      B=(X3V2(J-1)*Y3V2(J)-X3V2(J)*Y3V2(J-1))/(X3V2(J-1)-X3V2(J))
      QIN(67,I)=(EN+EIN(68))*(A*(EN+EIN(68))+B)/EN
      QIN(67,I)=QIN(67,I)*APOP3V2/DEG3V2*1.D-16
C 3V2 + V12
  450 CONTINUE
      QIN(68,I)=0.0
      IF(EN.LE.EIN(68)) GO TO 500
      DO 460 J=2,N3V2
      IF(EN.LE.X3V2(J)) GOTO 470
  460 CONTINUE
      J=N3V2
  470 A=(Y3V2(J)-Y3V2(J-1))/(X3V2(J)-X3V2(J-1))
      B=(X3V2(J-1)*Y3V2(J)-X3V2(J)*Y3V2(J-1))/(X3V2(J-1)-X3V2(J))
      QIN(68,I)=(A*EN+B)*APOPGS*1.D-16
C
C  SUPERELASTIC V3 ASYMMETRIC STRETCH
  500 QIN(69,I)=0.0
      IF(EN.LE.0.0) GO TO 550
      EFAC=DSQRT(1.0-(EIN(69)/EN))
      QIN(69,I)=AMPV3*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      DO 510 J=2,NV3
      IF((EN+EIN(70)).LE.XV3(J)) GOTO 520
  510 CONTINUE
      J=NV3
  520 A=(YV3(J)-YV3(J-1))/(XV3(J)-XV3(J-1))
      B=(XV3(J-1)*YV3(J)-XV3(J)*YV3(J-1))/(XV3(J-1)-XV3(J))
      QIN(69,I)=QIN(69,I)+(EN+EIN(70))*(A*(EN+EIN(70))+B)/EN
      QIN(69,I)=QIN(69,I)*APOPV3/DEGV3*1.D-16
C V3  ASYMMETRIC STRETCH
  550 QIN(70,I)=0.0
      IF(EN.LE.EIN(70)) GO TO 600
      EFAC=DSQRT(1.0-(EIN(70)/EN))
      QIN(70,I)=AMPV3*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      DO 560 J=2,NV3
      IF(EN.LE.XV3(J)) GO TO 570
  560 CONTINUE
      J=NV3
  570 A=(YV3(J)-YV3(J-1))/(XV3(J)-XV3(J-1))
      B=(XV3(J-1)*YV3(J)-XV3(J)*YV3(J-1))/(XV3(J-1)-XV3(J))
      QIN(70,I)=QIN(70,I)+(A*EN+B)
      QIN(70,I)=QIN(70,I)*APOPGS*1.D-16
C
C  4V2 + 2V1 + V12V2  POLYAD 3
  600 CONTINUE
      QIN(71,I)=0.0
      IF(EN.LE.EIN(71)) GO TO 650
      DO 610 J=2,NPD3
      IF(EN.LE.XVPD3(J)) GOTO 620
  610 CONTINUE
      J=NPD3
  620 A=(YVPD3(J)-YVPD3(J-1))/(XVPD3(J)-XVPD3(J-1))
      B=(XVPD3(J-1)*YVPD3(J)-XVPD3(J)*YVPD3(J-1))/(XVPD3(J-1)-XVPD3(J))
      QIN(71,I)=(A*EN+B)*1.D-16
C
C       3V2V1  + 2V1V2
  650 CONTINUE
      QIN(72,I)=0.0
      IF(EN.LE.EIN(72)) GO TO 700
      DO 660 J=2,NV130
      IF(EN.LE.XV130(J)) GOTO 670
  660 CONTINUE
      J=NV130
  670 A=(YV130(J)-YV130(J-1))/(XV130(J)-XV130(J-1))
      B=(XV130(J-1)*YV130(J)-XV130(J)*YV130(J-1))/(XV130(J-1)-XV130(J))
      QIN(72,I)=(A*EN+B)*1.D-16
C
C   POLYAD 4
  700 CONTINUE
      QIN(73,I)=0.0
      IF(EN.LE.EIN(73)) GO TO 750
      DO 710 J=2,NPD4
      IF(EN.LE.XVPD4(J)) GOTO 720
  710 CONTINUE
      J=NPD4
  720 A=(YVPD4(J)-YVPD4(J-1))/(XVPD4(J)-XVPD4(J-1))
      B=(XVPD4(J-1)*YVPD4(J)-XVPD4(J)*YVPD4(J-1))/(XVPD4(J-1)-XVPD4(J))
      QIN(73,I)=(A*EN+B)*1.D-16
C
C  PLOYAD 5
  750 CONTINUE
      QIN(74,I)=0.0
      IF(EN.LE.EIN(74)) GO TO 800
      DO 760 J=2,NPD5
      IF(EN.LE.XVPD5(J)) GOTO 770
  760 CONTINUE
      J=NPD5
  770 A=(YVPD5(J)-YVPD5(J-1))/(XVPD5(J)-XVPD5(J-1))
      B=(XVPD5(J-1)*YVPD5(J)-XVPD5(J)*YVPD5(J-1))/(XVPD5(J-1)-XVPD5(J))
      QIN(74,I)=(A*EN+B)*1.D-16
C
C   POLYAD 6
  800 CONTINUE
      QIN(75,I)=0.0
      IF(EN.LE.EIN(75)) GO TO 850
      DO 810 J=2,NPD6
      IF(EN.LE.XVPD6(J)) GOTO 820
  810 CONTINUE
      J=NPD6
  820 A=(YVPD6(J)-YVPD6(J-1))/(XVPD6(J)-XVPD6(J-1))
      B=(XVPD6(J-1)*YVPD6(J)-XVPD6(J)*YVPD6(J-1))/(XVPD6(J-1)-XVPD6(J))
      QIN(75,I)=(A*EN+B)*1.D-16
C
C   POLYAD 7
  850 CONTINUE
      QIN(76,I)=0.0
      IF(EN.LE.EIN(76)) GO TO 900
      DO 860 J=2,NPD7
      IF(EN.LE.XVPD7(J)) GOTO 870
  860 CONTINUE
      J=NPD7
  870 A=(YVPD7(J)-YVPD7(J-1))/(XVPD7(J)-XVPD7(J-1))
      B=(XVPD7(J-1)*YVPD7(J)-XVPD7(J)*YVPD7(J-1))/(XVPD7(J-1)-XVPD7(J))
      QIN(76,I)=(A*EN+B)*1.D-16
C
C   POLYAD 8
  900 CONTINUE
      QIN(77,I)=0.0
      IF(EN.LE.EIN(77)) GO TO 950
      DO 910 J=2,NPD8
      IF(EN.LE.XVPD8(J)) GOTO 920
  910 CONTINUE
      J=NPD8
  920 A=(YVPD8(J)-YVPD8(J-1))/(XVPD8(J)-XVPD8(J-1))
      B=(XVPD8(J-1)*YVPD8(J)-XVPD8(J)*YVPD8(J-1))/(XVPD8(J-1)-XVPD8(J))
      QIN(77,I)=(A*EN+B)*1.D-16
C
C   POLYAD 9
  950 CONTINUE
      QIN(78,I)=0.0
      IF(EN.LE.EIN(78)) GO TO 1000
      DO 960 J=2,NPD9
      IF(EN.LE.XVPD9(J)) GOTO 970
  960 CONTINUE
      J=NPD9
  970 A=(YVPD9(J)-YVPD9(J-1))/(XVPD9(J)-XVPD9(J-1))
      B=(XVPD9(J-1)*YVPD9(J)-XVPD9(J)*YVPD9(J-1))/(XVPD9(J-1)-XVPD9(J))
      QIN(78,I)=(A*EN+B)*1.D-16
C
C   SUM OF HIGHER POLYADS
 1000 CONTINUE
      QIN(79,I)=0.0
      IF(EN.LE.EIN(79)) GO TO 1050
      DO 1010 J=2,NPDH
      IF(EN.LE.XVPDH(J)) GOTO 1020
 1010 CONTINUE
      J=NPDH
 1020 A=(YVPDH(J)-YVPDH(J-1))/(XVPDH(J)-XVPDH(J-1))
      B=(XVPDH(J-1)*YVPDH(J)-XVPDH(J)*YVPDH(J-1))/(XVPDH(J-1)-XVPDH(J))
      QIN(79,I)=(A*EN+B)*1.D-16
C SET  FLAT ANGULAR DISTRIBUTIONS FOR VIBRATIONS
      DO 1030 KDUM=61,79
      PEQIN(KDUM,I)=0.5
      IF(NANISO.EQ.2) PEQIN(KDUM,I)=0.0
 1030 CONTINUE
C
 1050 CONTINUE
      QIN(80,I)=0.0
      PEQIN(80,I)=0.5
      IF(NANISO.EQ.2) PEQIN(80,I)=0.0
      IF(EN.LE.EIN(80)) GO TO 1100
      DO 1060 J=2,NEXC1
      IF(EN.LE.XEXC1(J)) GOTO 1070
 1060 CONTINUE
      J=NEXC1
 1070 A=(YEXC1(J)-YEXC1(J-1))/(XEXC1(J)-XEXC1(J-1))
      B=(XEXC1(J-1)*YEXC1(J)-XEXC1(J)*YEXC1(J-1))/(XEXC1(J-1)-XEXC1(J))
      QIN(80,I)=(A*EN+B)*1.D-16
      IF(EN.LE.(2.0*EIN(80))) GO TO 1100
      PEQIN(80,I)=PEQEL(2,(I-IOFF80))
C
 1100 CONTINUE
      QIN(81,I)=0.0
      PEQIN(81,I)=0.5
      IF(NANISO.EQ.2) PEQIN(81,I)=0.0
      IF(EN.LE.EIN(81)) GO TO 1150
      DO 1110 J=2,NEXC2
      IF(EN.LE.XEXC2(J)) GOTO 1120
 1110 CONTINUE
      J=NEXC2
 1120 A=(YEXC2(J)-YEXC2(J-1))/(XEXC2(J)-XEXC2(J-1))
      B=(XEXC2(J-1)*YEXC2(J)-XEXC2(J)*YEXC2(J-1))/(XEXC2(J-1)-XEXC2(J))
      QIN(81,I)=(A*EN+B)*1.D-16
      IF(EN.LE.(2.0*EIN(81))) GO TO 1150
      PEQIN(81,I)=PEQEL(2,(I-IOFF81))
C
 1150 CONTINUE
      QIN(82,I)=0.0
      PEQIN(82,I)=0.5
      IF(NANISO.EQ.2) PEQIN(82,I)=0.0
      IF(EN.LE.EIN(82)) GO TO 1200
      DO 1160  J=2,NEXC3
      IF(EN.LE.XEXC3(J)) GOTO 1170
 1160 CONTINUE
      J=NEXC3
 1170 A=(YEXC3(J)-YEXC3(J-1))/(XEXC3(J)-XEXC3(J-1))
      B=(XEXC3(J-1)*YEXC3(J)-XEXC3(J)*YEXC3(J-1))/(XEXC3(J-1)-XEXC3(J))
      QIN(82,I)=(A*EN+B)*1.D-16
      IF(EN.LE.(2.0*EIN(82))) GO TO 1200
      PEQIN(82,I)=PEQEL(2,(I-IOFF82))
C
 1200 CONTINUE
      QIN(83,I)=0.0
      PEQIN(83,I)=0.5
      IF(NANISO.EQ.2) PEQIN(83,I)=0.0
      IF(EN.LE.EIN(83)) GO TO 1250
      DO 1210 J=2,NEXC4
      IF(EN.LE.XEXC4(J)) GOTO 1220
 1210 CONTINUE
      J=NEXC4
 1220 A=(YEXC4(J)-YEXC4(J-1))/(XEXC4(J)-XEXC4(J-1))
      B=(XEXC4(J-1)*YEXC4(J)-XEXC4(J)*YEXC4(J-1))/(XEXC4(J-1)-XEXC4(J))
      QIN(83,I)=(A*EN+B)*1.D-16
      IF(EN.LE.(2.0*EIN(83))) GO TO 1250
      PEQIN(83,I)=PEQEL(2,(I-IOFF83))
C
 1250 CONTINUE
      QIN(84,I)=0.0
      PEQIN(84,I)=0.5
      IF(NANISO.EQ.2) PEQIN(84,I)=0.0
      IF(EN.LE.EIN(84)) GO TO 1300
      DO 1260  J=2,NEXC5
      IF(EN.LE.XEXC5(J)) GOTO 1270
 1260 CONTINUE
      J=NEXC5
 1270 A=(YEXC5(J)-YEXC5(J-1))/(XEXC5(J)-XEXC5(J-1))
      B=(XEXC5(J-1)*YEXC5(J)-XEXC5(J)*YEXC5(J-1))/(XEXC5(J-1)-XEXC5(J))
      QIN(84,I)=(A*EN+B)*1.D-16
      IF(EN.LE.(2.0*EIN(84))) GO TO 1300
      PEQIN(84,I)=PEQEL(2,(I-IOFF84))
C
 1300 CONTINUE
      QIN(85,I)=0.0
      PEQIN(85,I)=0.5
      IF(NANISO.EQ.2) PEQIN(85,I)=0.0
      IF(EN.LE.EIN(85)) GO TO 1400
      DO 1310  J=2,NEXC6
      IF(EN.LE.XEXC6(J)) GOTO 1320
 1310 CONTINUE
      J=NEXC6
 1320 A=(YEXC6(J)-YEXC6(J-1))/(XEXC6(J)-XEXC6(J-1))
      B=(XEXC6(J-1)*YEXC6(J)-XEXC6(J)*YEXC6(J-1))/(XEXC6(J-1)-XEXC6(J))
      QIN(85,I)=(A*EN+B)*1.D-16
      IF(EN.LE.(2.0*EIN(85))) GO TO 1400
      PEQIN(85,I)=PEQEL(2,(I-IOFF85))
 1400 CONTINUE
C SUM ROTATION
      SUMR=0.0
      DO 1450 K=1,60
      SUMR=SUMR+QIN(K,I)
 1450 CONTINUE
C SUM VIBRATION
      SUMV=0.0
      DO 1455 K=61,79
      SUMV=SUMV+QIN(K,I)
 1455 CONTINUE
C SUM EXCITATION
      SUME=0.0
      DO 1460 K=80,85
      SUME=SUME+QIN(K,I)
 1460 CONTINUE
C GET CORRECT ELASTIC X-SECTION
      Q(2,I)=Q(2,I)-SUMR
C Q(1,I) TOTAL USED FOR INFORMATION ONLY
      Q(1,I)=QELA+Q(5,I)+Q(4,I)+SUMV+SUME
 9000 CONTINUE
C
C     SAVE ON COMPUTING TIME
C
      DO 2000 K=1,15
      J=86-K
      IF(EFINAL.LE.EIN(J)) NIN=J-1
 2000 CONTINUE
C
      RETURN
      END
      SUBROUTINE GAS13(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      DIMENSION XEN(62),YXSEC(62),XION(46),YION(46),XATT(16),YATT(16),
     /XVIB1(34),YVIB1(34),XVIB2(28),YVIB2(28),XVIB3(28),YVIB3(28),
     /XVIB4(25),YVIB4(25),XVIB5(19),YVIB5(19),XEXC1(25),YEXC1(25),
     /XEXC2(23),YEXC2(23),XEXC3(19),YEXC3(19)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      DATA XEN/0.00,.001,.002,.003,.004,.005,.007,0.01,0.014,0.02,
     /0.03,0.04,0.05,0.06,0.07,0.08,0.09,0.10,0.11,0.12,
     /0.13,0.14,0.16,0.18,0.20,0.23,0.26,0.30,0.35,0.40,
     /0.50,0.60,0.80,1.00,1.40,2.00,3.00,4.00,5.00,6.00,
     /7.00,8.00,9.00,10.0,15.0,20.0,30.0,40.0,70.0,100.,
     /140.,200.,250.,300.,500.,1000.,1500.,3000.,6000.,10000.,
     /20000.,100000./
      DATA YXSEC/94.0,93.5,93.0,92.5,92.0,91.5,91.0,90.0,88.0,85.0,
     /74.0,63.0,53.0,45.0,39.0,33.5,29.0,25.0,21.0,17.0,
     /13.5,10.8,6.50,4.50,3.60,3.30,3.40,4.20,6.00,7.80,
     /12.5,16.7,21.8,25.0,27.5,30.0,34.0,37.0,40.0,43.0,
     /44.0,44.0,42.0,39.0,28.0,22.0,15.0,11.5,6.80,4.90,
     /2.90,1.78,1.28,1.06,0.60,0.26,0.17,0.08,.034,.021,
     /.0085,.0017/
      DATA XION/10.35,11.0,12.5,13.5,14.5,17.0,20.0,25.0,30.0,35.0,
     /40.0,45.0,50.0,60.0,70.0,80.0,90.0,100.,125.,150.,
     /175.,200.,250.,300.,350.,400.,450.,500.,600.,700.,
     /800.,900.,1000.,1250.,1500.,1750.,2000.,2500.,3000.,5000.,
     /7000.,10000.,15000.,30000.,60000.,100000./
      DATA YION/0.00,0.33,0.75,1.22,1.82,3.69,5.29,8.33,10.3,11.8,
     /12.8,13.7,14.8,15.6,16.1,16.4,16.4,16.4,15.9,15.0,
     /14.1,13.4,12.4,10.9,9.99,9.24,8.41,7.88,6.92,6.38,
     /5.87,5.23,4.88,4.22,3.63,3.30,3.00,2.60,2.23,1.48,
     /1.11,0.81,0.58,0.31,.167,.106/
      DATA XATT/6.85,7.00,7.20,7.50,8.00,8.50,9.00,9.50,10.0,10.5,
     /11.0,11.5,12.0,12.5,13.0,13.2/
      DATA YATT/0.00,1.41,2.36,3.57,6.03,9.50,14.3,22.3,31.6,26.6,
     /20.9,13.4,7.55,2.83,1.07,0.00/
      DATA XVIB1/.052,.055,.060,.065,.070,.075,0.08,0.10,0.12,0.14,
     /0.20,0.25,0.30,0.40,0.50,0.70,1.00,1.50,2.00,3.00,
     /4.00,5.00,6.00,7.50,8.50,10.0,15.0,20.0,30.0,40.0,
     /100.,1000.,10000.,100000./
      DATA YVIB1/0.00,.017,.026,.030,.032,.033,.034,.034,.033,.031,
     /.026,.022,.020,.017,.015,.011,.010,.015,.018,.030,
     /.044,.058,.074,.097,.097,.080,.055,.031,.017,.010,
     /.003,.0003,.00003,.00003/
      DATA XVIB2/.108,.125,0.15,0.20,0.23,0.25,0.30,0.40,0.50,0.70,
     /1.00,1.50,2.00,3.00,4.00,5.00,6.00,7.50,8.50,10.0,
     /15.0,20.0,30.0,40.0,100.,1000.,10000.,100000./
      DATA YVIB2/0.00,0.33,0.64,0.87,0.90,0.90,0.81,0.69,0.60,0.50,
     /0.39,0.39,0.48,0.77,1.14,1.50,1.93,2.53,2.53,2.08,
     /1.44,0.81,0.43,0.27,0.06,.006,.0006,.00006/
      DATA XVIB3/.173,0.18,0.19,0.20,0.23,0.25,0.30,0.40,0.50,0.70,
     /1.00,1.50,2.00,3.00,4.00,5.00,6.00,7.50,8.50,10.0,
     /15.0,20.0,30.0,40.0,100.,1000.,10000.,100000./
      DATA YVIB3/0.00,0.16,0.33,0.47,0.60,0.65,0.69,0.65,0.60,0.52,
     /0.42,0.38,0.41,0.59,0.89,1.16,1.49,1.96,1.96,1.60,
     /1.11,0.63,0.33,0.21,0.05,.005,.0005,.00005/
      DATA XVIB4/.363,0.40,0.45,0.50,0.60,0.70,0.80,1.00,1.50,2.00,
     /3.00,4.00,5.00,6.00,7.50,8.50,10.0,15.0,20.0,30.0,
     /40.0,100.,1000.,10000.,100000./
      DATA YVIB4/0.00,0.58,0.77,0.86,0.91,0.91,0.86,0.81,0.77,0.85,
     /1.23,1.76,2.29,2.95,3.26,2.82,2.08,1.19,0.53,0.30,
     /0.17,0.04,.004,.0004,.00004/
      DATA XVIB5/.519,1.00,1.50,2.00,3.00,4.00,5.00,6.00,7.50,8.50,
     /10.0,15.0,20.0,30.0,40.0,100.,1000.,10000.,100000./
      DATA YVIB5/0.00,.001,0.01,.041,.105,0.20,0.25,0.33,0.37,0.31,
     /.237,.138,.058,.033,.021,.004,.0004,.00004,.000004/
      DATA XEXC1/7.20,8.50,9.50,11.0,12.0,14.0,16.0,20.0,25.0,30.0,
     /40.0,60.0,80.0,100.,150.,200.,300.,400.,600.,1000.,
     /2000.,4000.,10000.,20000.,100000./
      DATA YEXC1/0.00,1.60,2.32,2.48,2.56,2.64,2.64,2.64,2.64,2.64,
     /2.72,2.72,2.64,2.48,2.08,1.92,1.60,1.50,1.28,0.84,
     /0.41,0.21,0.07,.042,.009/
      DATA XEXC2/9.50,10.5,11.5,14.0,16.0,20.0,25.0,30.0,
     /40.0,60.0,80.0,100.,150.,200.,300.,400.,600.,1000.,
     /2000.,4000.,10000.,20000.,100000./
      DATA YEXC2/0.00,0.23,0.49,0.92,1.43,1.92,2.24,2.44,
     /2.65,2.72,2.65,2.48,2.08,1.92,1.60,1.50,1.28,0.84,
     /0.39,0.21,0.07,.042,.007/
      DATA XEXC3/17.0,20.0,25.0,30.0,40.0,60.0,80.0,100.,150.,200.,
     /300.,400.,600.,1000.,2000.,4000.,10000.,20000.,100000./
      DATA YEXC3/0.00,0.53,1.16,1.60,2.24,2.64,2.64,2.48,2.08,1.92,
     /1.60,1.50,1.28,0.84,0.41,0.21,0.09,.042,.007/
C ----------------------------------------------------------------------
C  NO DIFFUSION EXPERIMENTAL DATA AVAILABLE,USED INELASTICS FROM SCALING
C  ISOBUTANE INELASTIC X-SECT. ELASTIC DETERMINED FROM DRIFT VELOCITY.
C HENCE DIFFUSION ACCURATE TO ONLY 10% , DRIFT VELOCITY TO 3% BELOW
C 10KV/CM.
C MODIFICATION OF NEO-PENTANE (1995) TO INCLUDE SUPERELASTIC SCATTERING
C FIT TO DRIFT VELOCITY OF FLORIANO GEE AND FREEMAN
C ----------------------------------------------------------------------
      NAME='NEO-PENTANE 03 '
C
      NIN=11
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      NDATA=62
      NION=46
      NATT=16
      NVIB1=34
      NVIB2=28
      NVIB3=28
      NVIB4=25
      NVIB5=19
      NEXC1=25
      NEXC2=23
      NEXC3=19
      E(1)=0.0
      E(2)=2.0*EMASS/(72.1503*AMU)
      E(3)=10.35
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=10.35
      EIN(1)=-.052
      EIN(2)=0.052
      EIN(3)=-.108
      EIN(4)=0.108
      EIN(5)=-.173
      EIN(6)=0.173
      EIN(7)=0.363
      EIN(8)=0.519
      EIN(9)=7.2
      EIN(10)=9.50
      EIN(11)=17.0
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       NEO-PENTANE    '
      SCRPT(3)=' IONISATION    ELOSS= 10.35   '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' VIB           ELOSS= -0.052  '
      SCRPT(8)=' VIB           ELOSS=  0.052  '
      SCRPT(9)=' VIB           ELOSS= -0.108  '
      SCRPT(10)=' VIB           ELOSS=  0.108  '
      SCRPT(11)=' VIB           ELOSS= -0.173  '
      SCRPT(12)=' VIB           ELOSS=  0.173  '
      SCRPT(13)=' VIB           ELOSS=  0.363  '
      SCRPT(14)=' VIB           ELOSS=  0.519  '
      SCRPT(15)=' EXC           ELOSS=  7.20   '
      SCRPT(16)=' EXC           ELOSS=  9.50   '
      SCRPT(17)=' EXC           ELOSS= 17.0    '
      APOP1=DEXP(EIN(1)/AKT)
      APOP2=DEXP(EIN(3)/AKT)
      APOP3=DEXP(EIN(5)/AKT)
      EN=-ESTEP/2.0
      DO 1000 I=1,NSTEP
      EN=EN+ESTEP
      IF(EN.LE.XEN(2)) THEN
       Q(2,I)=YXSEC(2)*1.D-16
       GO TO 21
      ENDIF
      DO 10 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 20
   10 CONTINUE
      J=NDATA
   20 YXJ=DLOG(YXSEC(J))
      YXJ1=DLOG(YXSEC(J-1))
      XNJ=DLOG(XEN(J))
      XNJ1=DLOG(XEN(J-1))
      A=(YXJ-YXJ1)/(XNJ-XNJ1)
      B=(XNJ1*YXJ-XNJ*YXJ1)/(XNJ1-XNJ)
      Q(2,I)=DEXP(A*DLOG(EN)+B)*1.D-16
   21 CONTINUE
      Q(3,I)=0.0
      IF(EN.LT.E(3)) GO TO 30
      DO 22 J=2,NION
      IF(EN.LE.XION(J)) GO TO 23
   22 CONTINUE
      J=NION
   23 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
   30 Q(4,I)=0.0
      IF(EN.LT.XATT(1)) GO TO 40
      IF(EN.GT.XATT(NATT)) GO TO 40
      DO 31 J=2,NATT
      IF(EN.LE.XATT(J)) GO TO 32
   31 CONTINUE
      J=NATT
   32 A=(YATT(J)-YATT(J-1))/(XATT(J)-XATT(J-1))
      B=(XATT(J-1)*YATT(J)-XATT(J)*YATT(J-1))/(XATT(J-1)-XATT(J))
      Q(4,I)=(A*EN+B)*1.D-21
   40 Q(5,I)=0.0
      Q(6,I)=0.0
C
C SUPERELASTIC VIB1
      QIN(1,I)=0.0
      IF(EN.LE.0.0) GO TO 150
      DO 110 J=2,NVIB1
      IF((EN+EIN(2)).LE.XVIB1(J)) GO TO 120
  110 CONTINUE
      J=NVIB1
  120 A=(YVIB1(J)-YVIB1(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB1(J)-XVIB1(J)*YVIB1(J-1))/(XVIB1(J-1)-XVIB1(J))
      QIN(1,I)=(EN+EIN(2))*(A*(EN+EIN(2))+B)/EN
      QIN(1,I)=QIN(1,I)*APOP1/(1.0+APOP1)*1.D-16
C  VIB1
  150 QIN(2,I)=0.0
      IF(EN.LE.EIN(2)) GO TO 200
      DO 160  J=2,NVIB1
      IF(EN.LE.XVIB1(J)) GO TO 170
  160 CONTINUE
      J=NVIB1
  170 A=(YVIB1(J)-YVIB1(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB1(J)-XVIB1(J)*YVIB1(J-1))/(XVIB1(J-1)-XVIB1(J))
      QIN(2,I)=(A*EN+B)/(1.0+APOP1)*1.D-16
  200 CONTINUE
C
C SUPERELASTIC VIB2
      QIN(3,I)=0.0
      IF(EN.LE.0.0) GO TO 250
      DO 210 J=2,NVIB2
      IF((EN+EIN(4)).LE.XVIB2(J)) GO TO 220
  210 CONTINUE
      J=NVIB2
  220 A=(YVIB2(J)-YVIB2(J-1))/(XVIB2(J)-XVIB2(J-1))
      B=(XVIB2(J-1)*YVIB2(J)-XVIB2(J)*YVIB2(J-1))/(XVIB2(J-1)-XVIB2(J))
      QIN(3,I)=(EN+EIN(4))*(A*(EN+EIN(4))+B)/EN
      QIN(3,I)=QIN(3,I)*APOP2/(1.0+APOP2)*1.D-16
C  VIB2
  250 QIN(4,I)=0.0
      IF(EN.LE.EIN(4)) GO TO 300
      DO 260 J=2,NVIB2
      IF(EN.LE.XVIB2(J)) GO TO 270
  260 CONTINUE
      J=NVIB2
  270 A=(YVIB2(J)-YVIB2(J-1))/(XVIB2(J)-XVIB2(J-1))
      B=(XVIB2(J-1)*YVIB2(J)-XVIB2(J)*YVIB2(J-1))/(XVIB2(J-1)-XVIB2(J))
      QIN(4,I)=(A*EN+B)/(1.0+APOP2)*1.D-16
  300 CONTINUE
C
C SUPERELASTIC VIB3
      QIN(5,I)=0.0
      IF(EN.LE.0.0) GO TO 350
      DO 310 J=2,NVIB3
      IF((EN+EIN(6)).LE.XVIB3(J)) GO TO 320
  310 CONTINUE
      J=NVIB3
  320 A=(YVIB3(J)-YVIB3(J-1))/(XVIB3(J)-XVIB3(J-1))
      B=(XVIB3(J-1)*YVIB3(J)-XVIB3(J)*YVIB3(J-1))/(XVIB3(J-1)-XVIB3(J))
      QIN(5,I)=(EN+EIN(6))*(A*(EN+EIN(6))+B)/EN
      QIN(5,I)=QIN(5,I)*APOP3/(1.0+APOP3)*1.D-16
C  VIB3
  350 QIN(6,I)=0.0
      IF(EN.LE.EIN(6)) GO TO 400
      DO 360 J=2,NVIB3
      IF(EN.LE.XVIB3(J)) GO TO 370
  360 CONTINUE
      J=NVIB3
  370 A=(YVIB3(J)-YVIB3(J-1))/(XVIB3(J)-XVIB3(J-1))
      B=(XVIB3(J-1)*YVIB3(J)-XVIB3(J)*YVIB3(J-1))/(XVIB3(J-1)-XVIB3(J))
      QIN(6,I)=(A*EN+B)/(1.0+APOP3)*1.D-16
  400 CONTINUE
C VIB4
      QIN(7,I)=0.0
      IF(EN.LE.EIN(7)) GO TO 500
      DO 410 J=2,NVIB4
      IF(EN.LE.XVIB4(J)) GO TO 420
  410 CONTINUE
      J=NVIB4
  420 A=(YVIB4(J)-YVIB4(J-1))/(XVIB4(J)-XVIB4(J-1))
      B=(XVIB4(J-1)*YVIB4(J)-XVIB4(J)*YVIB4(J-1))/(XVIB4(J-1)-XVIB4(J))
      QIN(7,I)=(A*EN+B)*1.D-16
  500 CONTINUE
C VIB5
      QIN(8,I)=0.0
      IF(EN.LE.EIN(8)) GO TO 600
      DO 510 J=2,NVIB5
      IF(EN.LE.XVIB5(J)) GO TO 520
  510 CONTINUE
      J=NVIB5
  520 A=(YVIB5(J)-YVIB5(J-1))/(XVIB5(J)-XVIB5(J-1))
      B=(XVIB5(J-1)*YVIB5(J)-XVIB5(J)*YVIB5(J-1))/(XVIB5(J-1)-XVIB5(J))
      QIN(8,I)=(A*EN+B)*1.D-16
  600 CONTINUE
C EXC1
      QIN(9,I)=0.0
      IF(EN.LE.EIN(9)) GO TO 700
      DO 610 J=2,NEXC1
      IF(EN.LE.XEXC1(J)) GO TO 620
  610 CONTINUE
      J=NEXC1
  620 A=(YEXC1(J)-YEXC1(J-1))/(XEXC1(J)-XEXC1(J-1))
      B=(XEXC1(J-1)*YEXC1(J)-XEXC1(J)*YEXC1(J-1))/(XEXC1(J-1)-XEXC1(J))
      QIN(9,I)=(A*EN+B)*1.D-16
  700 CONTINUE
C EXC2
      QIN(10,I)=0.0
      IF(EN.LE.EIN(10)) GO TO 800
      DO 710 J=2,NEXC2
      IF(EN.LE.XEXC2(J)) GO TO 720
  710 CONTINUE
      J=NEXC2
  720 A=(YEXC2(J)-YEXC2(J-1))/(XEXC2(J)-XEXC2(J-1))
      B=(XEXC2(J-1)*YEXC2(J)-XEXC2(J)*YEXC2(J-1))/(XEXC2(J-1)-XEXC2(J))
      QIN(10,I)=(A*EN+B)*1.D-16
  800 CONTINUE
C EXC3
      QIN(11,I)=0.0
      IF(EN.LE.EIN(11)) GO TO 900
      DO 810 J=2,NEXC3
      IF(EN.LE.XEXC3(J)) GO TO 820
  810 CONTINUE
      J=NEXC3
  820 A=(YEXC3(J)-YEXC3(J-1))/(XEXC3(J)-XEXC3(J-1))
      B=(XEXC3(J-1)*YEXC3(J)-XEXC3(J)*YEXC3(J-1))/(XEXC3(J-1)-XEXC3(J))
      QIN(11,I)=(A*EN+B)*1.D-16
  900 CONTINUE
C
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+QIN(1,I)+QIN(2,I)+QIN(3,I)+QIN(4,I)+
     /QIN(5,I)+QIN(6,I)+QIN(7,I)+QIN(8,I)+QIN(9,I)+QIN(10,I)+QIN(11,I)
 1000 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(11)) NIN=10
      IF(EFINAL.LE.EIN(10)) NIN=9
      IF(EFINAL.LE.EIN(9)) NIN=8
      IF(EFINAL.LE.EIN(8)) NIN=7
      IF(EFINAL.LE.EIN(7)) NIN=6
      IF(EFINAL.LE.EIN(6)) NIN=5
      RETURN
      END
      SUBROUTINE GAS14(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      DIMENSION ELEV(100),AJL(100),PJ(100)
      DIMENSION SALPHA(105),EROT(105),AJIN(210),IMAP(210)
      DIMENSION XEL(24),YEL(24),XVIB1(26),YVIB1(26),XVIB2(27),YVIB2(27),
     /XION(46),YION(46),XATT(20),YATT(20),XEXC(9),YEXC(9),XEXC1(17),
     /YEXC1(17),XEXC2(15),YEXC2(15)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
C ENERGY LEVELS OF WATER ( UP TO J=9) IN MILLIVOLTS
      DATA ELEV/0.0,2.950,4.604,5.253,8.690,9.856,11.800,16.726,16.882,
     /16.956,17.640,21.946,25.578,26.304,35.363,35.387,27.531,27.876,
     /34.157,37.240,39.152,47.426,47.590,60.518,60.521,40.338,40.496,
     /49.526,51.603,55.360,62.484,63.085,75.645,75.673,92.005,92.006,
     /55.383,55.452,67.312,68.552,74.734,80.463,82.022,93.822,93.953,
     /110.172,110.176,129.571,129.571,72.685,72.714,87.311,87.98,97.006,
     /101.26,104.44,115.03,115.46,131.38,131.40,150.79,150.79,172.94,
     /172.94,92.252,92.264,109.46,109.80,121.87,124.74,130.20,139.20,
     /140.32,155.62,155.71,175.02,175.02,197.22,197.22,221.81,221.81,
     /114.09,114.09,133.79,133.95,149.02,150.79,159.06,166.25,168.65,
     /182.87,183.16,202.25,202.27,224.48,224.48,249.18,249.18,275.92,
     /275.92/
C  J VALUE OF WATER LEVELS
      DATA AJL/0.0,1.0,1.0,1.0,2.0,2.0,2.0,2.0,2.0,
     /3.0,3.0,3.0,3.0,3.0,3.0,3.0,4.0,4.0,
     /4.0,4.0,4.0,4.0,4.0,4.0,4.0,5.0,5.0,
     /5.0,5.0,5.0,5.0,5.0,5.0,5.0,5.0,5.0,
     /6.0,6.0,6.0,6.0,6.0,6.0,6.0,6.0,6.0,
     /6.0,6.0,6.0,6.0,7.0,7.0,7.0,7.0,7.0,
     /7.0,7.0,7.0,7.0,7.0,7.0,7.0,7.0,7.0,
     /7.0,8.0,8.0,8.0,8.0,8.0,8.0,8.0,8.0,
     /8.0,8.0,8.0,8.0,8.0,8.0,8.0,8.0,8.0,
     /9.0,9.0,9.0,9.0,9.0,9.0,9.0,9.0,9.0,
     /9.0,9.0,9.0,9.0,9.0,9.0,9.0,9.0,9.0,
     /9.0/
C  TRANSITION AMPLITUDES FOR 210 TRANSITIONS
      DATA SALPHA/1.50,1.259,1.092,1.088,1.101,2.074,2.543,2.166,2.066,
     /2.181,
     /3.655,3.446,2.037,4.224,1.899,4.218,5.660,1.841,4.140,1.850,
     /.8333,1.036,1.083,1.297,1.850,2.025,2.085,1.566,2.494,2.881,
     /1.709,2.965,1.778,1.860,1.000,1.500,2.157,3.007,3.977,4.984,
     /5.970,6.980,7.990,1.500,1.667,1.971,2.445,3.131,3.970,4.940,
     /2.395,2.319,2.322,2.449,2.800,3.290,3.393,3.270,3.153,3.090,
     /3.100,4.397,4.267,4.120,4.000,5.400,5.250,5.120,1.244,2.336,
     /3.390,4.397,5.400,6.400,.9225,2.165,3.251,4.265,5.250,.6050,
     /1.840,3.068,4.090,.3804,1.402,2.750,.2494,1.090,0.197,.7557,
     /1.744,2.837,3.918,4.965,5.960,6.980,7.990,.3003,.8347,1.641,
     /2.681,3.710,4.820,5.900,1.550/
C TRANSITION J(INITIAL) VALUES FOR 210 TRANSITIONS
      DATA AJIN/1.0,1.0,2.0,2.0,3.0,3.0,4.0,4.0,5.0,5.0,
     /2.0,2.0,3.0,3.0,4.0,4.0,5.0,5.0,3.0,3.0,
     /4.0,4.0,5.0,5.0,4.0,4.0,5.0,5.0,5.0,5.0,
     /6.0,6.0,7.0,7.0,6.0,6.0,7.0,7.0,7.0,7.0,
     /2.0,2.0,3.0,3.0,4.0,4.0,3.0,3.0,4.0,4.0,
     /5.0,5.0,6.0,6.0,4.0,4.0,5.0,5.0,6.0,6.0,
     /5.0,5.0,6.0,6.0,6.0,6.0,6.0,6.0,0.0,1.0,
     /1.0,2.0,2.0,3.0,3.0,4.0,4.0,5.0,5.0,6.0,
     /6.0,7.0,7.0,8.0,8.0,9.0,1.0,2.0,2.0,3.0,
     /3.0,4.0,4.0,5.0,5.0,6.0,6.0,7.0,7.0,8.0,
     /2.0,3.0,3.0,4.0,4.0,5.0,5.0,6.0,6.0,7.0,
     /7.0,8.0,3.0,4.0,4.0,5.0,5.0,6.0,6.0,7.0,
     /7.0,8.0,4.0,5.0,5.0,6.0,6.0,7.0,7.0,8.0,
     /5.0,6.0,6.0,7.0,7.0,8.0,1.0,2.0,2.0,3.0,
     /3.0,4.0,4.0,5.0,5.0,6.0,6.0,7.0,2.0,3.0,
     /3.0,4.0,4.0,5.0,5.0,6.0,6.0,7.0,3.0,4.0,
     /4.0,5.0,5.0,6.0,6.0,7.0,4.0,5.0,5.0,6.0,
     /6.0,7.0,5.0,6.0,6.0,7.0,6.0,7.0,1.0,2.0,
     /2.0,3.0,3.0,4.0,4.0,5.0,5.0,6.0,6.0,7.0,
     /7.0,8.0,8.0,9.0,2.0,3.0,3.0,4.0,4.0,5.0,
     /5.0,6.0,6.0,7.0,7.0,8.0,8.0,9.0,6.0,7.0/
C TRANSITION ENERGIES FOR 210 TRANSITIONS IN MILIVOLTS
      DATA EROT/2.303,5.082,9.083,12.93,16.33,3.110,4.809,8.439,12.59,
     /4.538,
     /4.994,7.724,6.626,5.834,9.188,7.423,7.433,11.93,9.695,14.63,
     /6.869,9.785,13.09,7.938,10.19,13.16,16.35,9.364,10.88,13.36,
     /11.11,11.91,13.10,17.54,4.604,6.906,8.950,10.92,12.97,15.11,
     /17.33,19.58,21.84,11.47,13.78,15.75,17.45,19.03,20.67,22.49,
     /18.48,21.12,23.33,25.10,26.52,27.74,25.13,28.05,30.74,33.00,
     /34.76,31.48,34.50,37.43,40.16,37.56,40.61,43.62,12.28,18.66,
     /25.16,31.49,37.57,43.36,16.45,22.01,28.25,34.53,40.62,21.51,
     /25.84,31.47,37.58,27.48,30.42,35.00,34.24,35.89,41.55,4.086,
     /7.100,9.891,12.46,14.89,17.23,19.54,21.82,4.769,8.579,12.29,
     /15.71,18.76,21.48,23.99,16.54/
C MAP OF TRANSITION NO TO LEVEL POPULATION
      DATA IMAP/2,4,7,9,14,16,23,25,34,36,5,7,12,14,21,23,32,34,10,12,
     /19,21,30,32,17,19,28,30,26,28,39,41,54,56,37,39,52,54,50,52,
     /6,8,13,15,22,24,11,13,20,22,31,33,44,46,18,20,29,31,42,44,
     /27,29,40,42,38,40,66,68,1,3,2,6,5,11,10,18,17,27,26,38,
     /37,51,50,66,65,83,4,8,7,13,12,20,19,29,28,40,39,53,52,68,
     /9,15,14,22,21,31,30,42,41,55,54,70,16,24,23,33,32,44,43,57,
     /56,72,25,35,34,46,45,59,58,74,36,48,47,61,60,76,3,9,8,16,
     /15,25,24,36,35,49,48,64,6,14,13,23,22,34,33,47,46,62,11,21,
     /20,32,31,45,44,60,18,30,29,43,42,58,27,41,40,56,38,54,3,5,
     /6,10,11,17,18,26,27,37,38,50,51,65,66,82,8,12,13,19,20,28,
     /29,39,40,52,53,67,68,84,42,54/
C ELASTIC MOMENTUM TRANSFER ( NO ROTATION )
      DATA XEL/.0001,.001,0.01,0.02,0.10,0.20,0.40,1.00,2.00,4.00,
     /6.00,8.00,10.0,12.0,16.0,20.0,30.0,60.0,100.,200.,
     /500.0,1000.0,10000.,100000./
      DATA YEL/384000.,37900.,3590.,1747.,179.,56.5,13.1,1.72,.707,1.21,
     /2.22,3.23,4.34,4.34,4.24,3.74,3.03,1.89,1.23,.575,
     /.200,.065,.006,.0006/
C VIBRATION
      DATA XVIB1/.198,.214,.216,.218,.219,0.23,0.25,0.28,0.32,0.35,
     /0.40,0.50,0.60,0.80,1.00,1.60,2.50,4.00,7.00,10.0,
     /15.0,20.0,100.0,1000.0,10000.,100000./
      DATA YVIB1/0.00,.001,0.01,0.10,1.00,1.39,1.62,1.74,1.82,1.78,
     /1.58,1.20,0.74,0.47,0.35,0.24,0.17,0.15,0.18,0.17,
     /0.15,0.12,0.03,0.003,.0003,.00003/
      DATA XVIB2/.453,.463,.470,.473,0.48,0.49,0.55,0.64,0.70,0.75,
     /0.80,0.90,1.00,1.40,2.00,2.50,4.00,6.00,8.00,10.0,
     /15.0,20.0,40.0,100.0,1000.0,10000.,100000./
      DATA YVIB2/0.00,0.01,0.10,1.00,3.14,3.51,3.72,3.26,2.81,2.17,
     /1.00,0.68,0.53,0.36,0.31,0.31,0.36,0.47,0.50,0.39,
     /0.19,0.12,0.10,0.03,0.003,.0003,.00003/
      DATA XION/12.61,13.5,14.0,15.0,16.0,17.0,18.0,20.0,22.5,25.0,
     /30.0,35.0,40.0,45.0,50.0,60.0,70.0,80.0,90.0,100.,
     /110.,125.,150.,175.,200.,250.,300.,400.,500.,600.,
     /700.,800.,900.,1000.,1200.,1500.,2000.,3000.,4000.,7000.,
     /10000.,14000.,20000.,40000.,60000.,100000./
      DATA YION/0.00,.036,.066,.120,.178,.256,.333,.465,.648,.825,
     /1.11,1.35,1.55,1.72,1.84,2.02,2.12,2.21,2.24,2.26,
     /2.26,2.23,2.15,2.08,2.01,1.82,1.65,1.42,1.21,1.06,
     /.933,.848,.777,.708,.620,.523,.417,.300,.236,.147,
     /.108,.080,.059,.032,.022,.0135/
      DATA XATT/4.50,5.50,5.75,6.00,6.25,6.40,6.60,7.00,7.50,8.00,
     /8.50,9.00,9.50,10.0,11.0,13.0,14.0,1000.,10000.,100000./
      DATA YATT/0.00,.0008,.003,.019,.060,.064,.060,.035,.011,.010,
     /.011,.0085,.006,.003,.0058,.001,.0001,.00001,.000001,.0000001/
      DATA XEXC/4.20,4.50,5.00,6.00,10.0,100.,1000.0,10000.,100000./
      DATA YEXC/0.00,.032,.064,.080,.064,0.004,0.0004,.00004,.000004/
      DATA XEXC1/7.40,7.60,8.25,9.10,10.0,12.0,15.0,20.0,30.0,40.0,
     /50.0,80.0,100.0,200.0,1000.,10000.,100000./
      DATA YEXC1/0.00,.027,.158,.264,.394,.607,0.87,1.11,1.24,1.16,
     /1.09,0.87,0.80,0.51,0.16,.0158,.00158/
      DATA XEXC2/13.1,14.1,15.0,17.0,19.0,21.0,25.0,35.0,50.0,70.0,
     /100.0,200.0,1000.0,10000.,100000./
      DATA YEXC2/0.00,.016,.067,0.17,0.22,0.29,0.36,0.50,0.66,0.69,
     /0.66,0.49,0.16,.016,.0016/
      NAME='H2O       2004 '
C --------------------------------------------------------------------
C  EXPERIMENTAL DATA NOT ACCURATE IN WATER VAPOUR. ELECTRON SCATTERING
C  DATA USED IN ANALYSIS REPRODUCES DRIFT VELOCITY AND DIFFUSION
C  COEFFICIENTS TO AN  ACCURACY OF  2%.
C ---------------------------------------------------------------------
      NIN=215
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
      KIN(J)=0
    2 IF(J.LE.210) KIN(J)=1
      NEL=24
      NVIB1=26
      NVIB2=27
      NION=46
      NATT=20
      NEXC=9
      NEXC1=17
      NEXC2=15
      E(1)=0.0
      E(2)=2.0*EMASS/(18.01528*AMU)
      E(3)=12.61
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=12.61
C-----------------------------------------------------------------
C DBA IS DIPOLE MOMENT
C DRAT IS RATIO OF MOMENTUM TRANSFER TO TOTAL X-SECTION FOR DIPOLE
C -----------------------------------------------------------------
      GPARA=1.0
      GORTHO=3.0
      DBA=0.728
      DRAT=0.07
      A0=0.5291772083D-8
      RY=13.60569172
      DBK=8.37758*RY*(DBA*A0)**2
C------------------------------------------------------------------
C CALCULATE POPULATION DENSITIES OF ROTATIONAL LEVELS
      DO 3 J=1,99,2
    3 PJ(J)=GPARA*(2.0*AJL(J)+1.0)*DEXP(-ELEV(J)*1.D-3/AKT)
      DO 4 J=2,100,2
    4 PJ(J)=GORTHO*(2.0*AJL(J)+1.0)*DEXP(-ELEV(J)*1.D-3/AKT)
      SUM=0.0
      DO 5 J=1,100
    5 SUM=SUM+PJ(J)
      DO 6 J=1,100
    6 PJ(J)=PJ(J)/SUM
      DO 7 J=1,105
      EIN(2*J-1)=EROT(J)*1.D-3
    7 EIN(2*J)=-EROT(J)*1.D-3
C
      EIN(211)=0.198
      EIN(212)=0.453
      EIN(213)=4.20
      EIN(214)=7.40
      EIN(215)=13.1
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       WATER          '
      SCRPT(3)=' IONISATION    ELOSS= 12.61   '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' ROT 101--110  ELOSS= 0.002303'
      SCRPT(8)=' ROT 110--101  ELOSS=-0.002303'
      SCRPT(9)=' ROT 211--220  ELOSS= 0.005082'
      SCRPT(10)=' ROT 220--211  ELOSS=-0.005082'
      SCRPT(11)=' ROT 321--330  ELOSS= 0.009083'
      SCRPT(12)=' ROT 330--321  ELOSS=-0.009083'
      SCRPT(13)=' ROT 431--440  ELOSS= 0.01293 '
      SCRPT(14)=' ROT 440--431  ELOSS=-0.01293 '
      SCRPT(15)=' ROT 541--550  ELOSS= 0.01633 '
      SCRPT(16)=' ROT 550--541  ELOSS=-0.01633 '
      SCRPT(17)=' ROT 202--211  ELOSS= 0.00311 '
      SCRPT(18)=' ROT 211--202  ELOSS=-0.00311 '
      SCRPT(19)=' ROT 312--321  ELOSS= 0.004809'
      SCRPT(20)=' ROT 321--312  ELOSS=-0.004809'
      SCRPT(21)=' ROT 422--431  ELOSS= 0.008439'
      SCRPT(22)=' ROT 431--422  ELOSS=-0.008439'
      SCRPT(23)=' ROT 532--541  ELOSS= 0.01259 '
      SCRPT(24)=' ROT 541--532  ELOSS=-0.01259 '
      SCRPT(25)=' ROT 303--312  ELOSS= 0.004538'
      SCRPT(26)=' ROT 312--303  ELOSS=-0.004538'
      SCRPT(27)=' ROT 413--422  ELOSS= 0.004994'
      SCRPT(28)=' ROT 422--413  ELOSS=-0.004994'
      SCRPT(29)=' ROT 523--532  ELOSS= 0.007724'
      SCRPT(30)=' ROT 532--523  ELOSS=-0.007724'
      SCRPT(31)=' ROT 404--413  ELOSS= 0.006626'
      SCRPT(32)=' ROT 413--404  ELOSS=-0.006626'
      SCRPT(33)=' ROT 514--523  ELOSS= 0.005834'
      SCRPT(34)=' ROT 523--514  ELOSS=-0.005834'
      SCRPT(35)=' ROT 505--514  ELOSS= 0.009188'
      SCRPT(36)=' ROT 514--505  ELOSS=-0.009188'
      SCRPT(37)=' ROT 615--624  ELOSS= 0.007423'
      SCRPT(38)=' ROT 624--615  ELOSS=-0.007423'
      SCRPT(39)=' ROT 725--734  ELOSS= 0.007433'
      SCRPT(40)=' ROT 734--725  ELOSS=-0.007433'
      SCRPT(41)=' ROT 606--615  ELOSS= 0.01193 '
      SCRPT(42)=' ROT 615--606  ELOSS=-0.01193 '
      SCRPT(43)=' ROT 716--725  ELOSS= 0.009695'
      SCRPT(44)=' ROT 725--716  ELOSS=-0.009695'
      SCRPT(45)=' ROT 707--716  ELOSS= 0.01463 '
      SCRPT(46)=' ROT 716--707  ELOSS=-0.01463 '
      SCRPT(47)=' ROT 212--221  ELOSS= 0.006869'
      SCRPT(48)=' ROT 221--212  ELOSS=-0.006869'
      SCRPT(49)=' ROT 322--331  ELOSS= 0.009785'
      SCRPT(50)=' ROT 331--322  ELOSS=-0.009785'
      SCRPT(51)=' ROT 432--441  ELOSS= 0.01309 '
      SCRPT(52)=' ROT 441--432  ELOSS=-0.01309 '
      SCRPT(53)=' ROT 313--322  ELOSS= 0.007938'
      SCRPT(54)=' ROT 322--313  ELOSS=-0.007938'
      SCRPT(55)=' ROT 423--432  ELOSS= 0.01019 '
      SCRPT(56)=' ROT 432--423  ELOSS=-0.01019 '
      SCRPT(57)=' ROT 533--542  ELOSS= 0.01316 '
      SCRPT(58)=' ROT 542--533  ELOSS=-0.01316 '
      SCRPT(59)=' ROT 643--652  ELOSS= 0.01635 '
      SCRPT(60)=' ROT 652--643  ELOSS=-0.01635 '
      SCRPT(61)=' ROT 414--423  ELOSS= 0.009364'
      SCRPT(62)=' ROT 423--414  ELOSS=-0.009364'
      SCRPT(63)=' ROT 524--533  ELOSS= 0.01088 '
      SCRPT(64)=' ROT 533--524  ELOSS=-0.01088 '
      SCRPT(65)=' ROT 634--643  ELOSS= 0.01336 '
      SCRPT(66)=' ROT 643--634  ELOSS=-0.01336 '
      SCRPT(67)=' ROT 515--524  ELOSS= 0.01111 '
      SCRPT(68)=' ROT 524--515  ELOSS=-0.01111 '
      SCRPT(69)=' ROT 625--634  ELOSS= 0.01191 '
      SCRPT(70)=' ROT 634--625  ELOSS=-0.01191 '
      SCRPT(71)=' ROT 616--625  ELOSS= 0.01310 '
      SCRPT(72)=' ROT 625--616  ELOSS=-0.01310 '
      SCRPT(73)=' ROT 818--827  ELOSS= 0.01754 '
      SCRPT(74)=' ROT 827--818  ELOSS=-0.01754 '
      SCRPT(75)=' ROT 000--111  ELOSS= 0.004604'
      SCRPT(76)=' ROT 111--000  ELOSS=-0.004604'
      SCRPT(77)=' ROT 101--212  ELOSS= 0.006906'
      SCRPT(78)=' ROT 212--101  ELOSS=-0.006906'
      SCRPT(79)=' ROT 202--313  ELOSS= 0.008950'
      SCRPT(80)=' ROT 313--202  ELOSS=-0.008950'
      SCRPT(81)=' ROT 303--414  ELOSS= 0.01092 '
      SCRPT(82)=' ROT 414--303  ELOSS=-0.01092 '
      SCRPT(83)=' ROT 404--515  ELOSS= 0.01297 '
      SCRPT(84)=' ROT 515--404  ELOSS=-0.01297 '
      SCRPT(85)=' ROT 505--616  ELOSS= 0.01511 '
      SCRPT(86)=' ROT 616--505  ELOSS=-0.01511 '
      SCRPT(87)=' ROT 606--717  ELOSS= 0.01733 '
      SCRPT(88)=' ROT 717--606  ELOSS=-0.01733 '
      SCRPT(89)=' ROT 707--818  ELOSS= 0.01958 '
      SCRPT(90)=' ROT 818--707  ELOSS=-0.01958 '
      SCRPT(91)=' ROT 808--919  ELOSS= 0.02184 '
      SCRPT(92)=' ROT 919--808  ELOSS=-0.02184 '
      SCRPT(93)=' ROT 110--221  ELOSS= 0.01147 '
      SCRPT(94)=' ROT 221--110  ELOSS=-0.01147 '
      SCRPT(95)=' ROT 211--322  ELOSS= 0.01378 '
      SCRPT(96)=' ROT 322--211  ELOSS=-0.01378 '
      SCRPT(97)=' ROT 312--423  ELOSS= 0.01575 '
      SCRPT(98)=' ROT 423--312  ELOSS=-0.01575 '
      SCRPT(99)=' ROT 413--524  ELOSS= 0.01745 '
      SCRPT(100)=' ROT 524--413  ELOSS=-0.01745 '
      SCRPT(101)=' ROT 514--625  ELOSS= 0.01903 '
      SCRPT(102)=' ROT 625--514  ELOSS=-0.01903 '
      SCRPT(103)=' ROT 615--726  ELOSS= 0.02067 '
      SCRPT(104)=' ROT 726--615  ELOSS=-0.02067 '
      SCRPT(105)=' ROT 716--827  ELOSS= 0.02249 '
      SCRPT(106)=' ROT 827--716  ELOSS=-0.02249 '
      SCRPT(107)=' ROT 220--331  ELOSS= 0.01848 '
      SCRPT(108)=' ROT 331--220  ELOSS=-0.01848 '
      SCRPT(109)=' ROT 321--432  ELOSS= 0.02112 '
      SCRPT(110)=' ROT 432--321  ELOSS=-0.02112 '
      SCRPT(111)=' ROT 422--533  ELOSS= 0.02333 '
      SCRPT(112)=' ROT 533--422  ELOSS=-0.02333 '
      SCRPT(113)=' ROT 523--634  ELOSS= 0.02510 '
      SCRPT(114)=' ROT 634--523  ELOSS=-0.02510 '
      SCRPT(115)=' ROT 624--735  ELOSS= 0.02652 '
      SCRPT(116)=' ROT 735--624  ELOSS=-0.02652 '
      SCRPT(117)=' ROT 725--836  ELOSS= 0.02774 '
      SCRPT(118)=' ROT 836--725  ELOSS=-0.02774 '
      SCRPT(119)=' ROT 330--441  ELOSS= 0.02513 '
      SCRPT(120)=' ROT 441--330  ELOSS=-0.02513 '
      SCRPT(121)=' ROT 431--542  ELOSS= 0.02805 '
      SCRPT(122)=' ROT 542--431  ELOSS=-0.02805 '
      SCRPT(123)=' ROT 532--643  ELOSS= 0.03074 '
      SCRPT(124)=' ROT 643--532  ELOSS=-0.03074 '
      SCRPT(125)=' ROT 633--744  ELOSS= 0.03300 '
      SCRPT(126)=' ROT 744--633  ELOSS=-0.03300 '
      SCRPT(127)=' ROT 734--845  ELOSS= 0.03476 '
      SCRPT(128)=' ROT 845--734  ELOSS=-0.03476 '
      SCRPT(129)=' ROT 440--551  ELOSS= 0.03148 '
      SCRPT(130)=' ROT 551--440  ELOSS=-0.03148 '
      SCRPT(131)=' ROT 541--652  ELOSS= 0.03450 '
      SCRPT(132)=' ROT 652--541  ELOSS=-0.03450 '
      SCRPT(133)=' ROT 642--753  ELOSS= 0.03743 '
      SCRPT(134)=' ROT 753--642  ELOSS=-0.03743 '
      SCRPT(135)=' ROT 743--854  ELOSS= 0.04016 '
      SCRPT(136)=' ROT 854--743  ELOSS=-0.04016 '
      SCRPT(137)=' ROT 550--661  ELOSS= 0.03757 '
      SCRPT(138)=' ROT 661--550  ELOSS=-0.03757 '
      SCRPT(139)=' ROT 651--762  ELOSS= 0.04061 '
      SCRPT(140)=' ROT 762--651  ELOSS=-0.04061 '
      SCRPT(141)=' ROT 752--863  ELOSS= 0.04361 '
      SCRPT(142)=' ROT 863--752  ELOSS=-0.04361 '
      SCRPT(143)=' ROT 111--220  ELOSS= 0.01228 '
      SCRPT(144)=' ROT 220--111  ELOSS=-0.01228 '
      SCRPT(145)=' ROT 221--330  ELOSS= 0.01866 '
      SCRPT(146)=' ROT 330--221  ELOSS=-0.01866 '
      SCRPT(147)=' ROT 331--440  ELOSS= 0.02516 '
      SCRPT(148)=' ROT 440--331  ELOSS=-0.02516 '
      SCRPT(149)=' ROT 441--550  ELOSS= 0.03149 '
      SCRPT(150)=' ROT 550--441  ELOSS=-0.03149 '
      SCRPT(151)=' ROT 551--660  ELOSS= 0.03757 '
      SCRPT(152)=' ROT 660--551  ELOSS=-0.03757 '
      SCRPT(153)=' ROT 661--770  ELOSS= 0.04336 '
      SCRPT(154)=' ROT 770--661  ELOSS=-0.04336 '
      SCRPT(155)=' ROT 212--321  ELOSS= 0.01645 '
      SCRPT(156)=' ROT 321--212  ELOSS=-0.01645 '
      SCRPT(157)=' ROT 322--431  ELOSS= 0.02201 '
      SCRPT(158)=' ROT 431--322  ELOSS=-0.02201 '
      SCRPT(159)=' ROT 432--541  ELOSS= 0.02825 '
      SCRPT(160)=' ROT 541--432  ELOSS=-0.02825 '
      SCRPT(161)=' ROT 542--651  ELOSS= 0.03453 '
      SCRPT(162)=' ROT 651--542  ELOSS=-0.03453 '
      SCRPT(163)=' ROT 652--761  ELOSS= 0.04062 '
      SCRPT(164)=' ROT 761--652  ELOSS=-0.04062 '
      SCRPT(165)=' ROT 313--422  ELOSS= 0.02151 '
      SCRPT(166)=' ROT 422--313  ELOSS=-0.02151 '
      SCRPT(167)=' ROT 423--532  ELOSS= 0.02584 '
      SCRPT(168)=' ROT 532--423  ELOSS=-0.02584 '
      SCRPT(169)=' ROT 533--642  ELOSS= 0.03147 '
      SCRPT(170)=' ROT 642--533  ELOSS=-0.03147 '
      SCRPT(171)=' ROT 643--752  ELOSS= 0.03758 '
      SCRPT(172)=' ROT 752--643  ELOSS=-0.03758 '
      SCRPT(173)=' ROT 414--523  ELOSS= 0.02748 '
      SCRPT(174)=' ROT 523--414  ELOSS=-0.02748 '
      SCRPT(175)=' ROT 524--633  ELOSS= 0.03042 '
      SCRPT(176)=' ROT 633--524  ELOSS=-0.03042 '
      SCRPT(177)=' ROT 634--743  ELOSS= 0.03500 '
      SCRPT(178)=' ROT 743--634  ELOSS=-0.03500 '
      SCRPT(179)=' ROT 515--624  ELOSS= 0.03424 '
      SCRPT(180)=' ROT 624--515  ELOSS=-0.03424 '
      SCRPT(181)=' ROT 625--734  ELOSS= 0.03589 '
      SCRPT(182)=' ROT 734--625  ELOSS=-0.03589 '
      SCRPT(183)=' ROT 616--725  ELOSS= 0.04155 '
      SCRPT(184)=' ROT 725--616  ELOSS=-0.04155 '
      SCRPT(185)=' ROT 111--202  ELOSS= 0.004086'
      SCRPT(186)=' ROT 202--111  ELOSS=-0.004086'
      SCRPT(187)=' ROT 212--303  ELOSS= 0.007100'
      SCRPT(188)=' ROT 303--212  ELOSS=-0.007100'
      SCRPT(189)=' ROT 313--404  ELOSS= 0.009891'
      SCRPT(190)=' ROT 404--313  ELOSS=-0.009891'
      SCRPT(191)=' ROT 414--505  ELOSS= 0.01246 '
      SCRPT(192)=' ROT 505--414  ELOSS=-0.01246 '
      SCRPT(193)=' ROT 515--606  ELOSS= 0.01489 '
      SCRPT(194)=' ROT 606--515  ELOSS=-0.01489 '
      SCRPT(195)=' ROT 616--707  ELOSS= 0.01723 '
      SCRPT(196)=' ROT 707--616  ELOSS=-0.01723 '
      SCRPT(197)=' ROT 717--808  ELOSS= 0.01954 '
      SCRPT(198)=' ROT 808--717  ELOSS=-0.01954 '
      SCRPT(199)=' ROT 818--909  ELOSS= 0.02182 '
      SCRPT(200)=' ROT 909--818  ELOSS=-0.02182 '
      SCRPT(201)=' ROT 221--312  ELOSS= 0.004769'
      SCRPT(202)=' ROT 312--221  ELOSS=-0.004769'
      SCRPT(203)=' ROT 322--413  ELOSS= 0.008579'
      SCRPT(204)=' ROT 413--322  ELOSS=-0.008579'
      SCRPT(205)=' ROT 423--514  ELOSS= 0.01229 '
      SCRPT(206)=' ROT 514--423  ELOSS=-0.01229 '
      SCRPT(207)=' ROT 524--615  ELOSS= 0.01571 '
      SCRPT(208)=' ROT 615--524  ELOSS=-0.01571 '
      SCRPT(209)=' ROT 625--716  ELOSS= 0.01876 '
      SCRPT(210)=' ROT 716--625  ELOSS=-0.01876 '
      SCRPT(211)=' ROT 726--817  ELOSS= 0.02148 '
      SCRPT(212)=' ROT 817--726  ELOSS=-0.02148 '
      SCRPT(213)=' ROT 827--918  ELOSS= 0.02399 '
      SCRPT(214)=' ROT 918--827  ELOSS=-0.02399 '
      SCRPT(215)=' ROT 634--725  ELOSS= 0.01654 '
      SCRPT(216)=' ROT 725--634  ELOSS=-0.01654 '
      SCRPT(217)=' VIB V2        ELOSS=  0.198  '
      SCRPT(218)=' VIB V1+V3     ELOSS=  0.453  '
      SCRPT(219)=' EXC           ELOSS=  4.20   '
      SCRPT(220)=' EXC           ELOSS=  7.40   '
      SCRPT(221)=' EXC           ELOSS= 13.1    '
      EN=-ESTEP/2.0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      IF(EN.LE.XEL(1)) THEN
       Q(2,I)=YEL(1)*1.D-16
       GO TO 25
      ENDIF
      DO 10 J=2,NEL
      IF(EN.LE.XEL(J)) GO TO 20
   10 CONTINUE
      J=NEL
   20 Y1=DLOG(YEL(J))
      Y2=DLOG(YEL(J-1))
      X1=DLOG(XEL(J))
      X2=DLOG(XEL(J-1))
      A=(Y1-Y2)/(X1-X2)
      B=(X2*Y1-X1*Y2)/(X2-X1)
      Q(2,I)=DEXP(A*DLOG(EN)+B)*1.0D-16
C
   25 Q(3,I)=0.0
      IF(EN.LT.E(3)) GO TO 50
      DO 30  J=2,NION
      IF(EN.LE.XION(J)) GO TO 40
   30 CONTINUE
      J=NION
   40 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
C
   50 Q(4,I)=0.0
      IF(EN.LT.XATT(1)) GO TO 55
      DO 51  J=2,NATT
      IF(EN.LE.XATT(J)) GO TO 52
   51 CONTINUE
      J=NATT
   52 A=(YATT(J)-YATT(J-1))/(XATT(J)-XATT(J-1))
      B=(XATT(J-1)*YATT(J)-XATT(J)*YATT(J-1))/(XATT(J-1)-XATT(J))
      Q(4,I)=(A*EN+B)*1.D-16
C
   55 Q(5,I)=0.0
      Q(6,I)=0.0
C ----------------------------------------------------------------
C  DIPOLE BORN ROTATIONAL STATES
C----------------------------------------------------------------
      ENRT=DSQRT(EN)
C
C  SUPER ELASTIC ROTATIONAL COLLISIONS
      DO 100 L=2,210,2
      AL=AJIN(L)
      L2=L/2
      QIN(L,I)=DBK*SALPHA(L2)*PJ(IMAP(L))*DLOG((ENRT+DSQRT(EN-EIN(L)))/
     /(DSQRT(EN-EIN(L))-ENRT))/((2.0*AL+1.0)*EN)
  100 PEQIN(L,I)=0.5+(QIN(L,I)-DRAT*QIN(L,I))/QIN(L,I)
C
C ROTATIONAL COLLISIONS
      DO 150 L=1,209,2
      QIN(L,I)=0.0
      PEQIN(L,I)=0.5
      IF(EN.LE.EIN(L)) GO TO 150
      AL=AJIN(L)
      L2=(L+1)/2
      QIN(L,I)=DBK*SALPHA(L2)*PJ(IMAP(L))*DLOG((ENRT+DSQRT(EN-EIN(L)))/
     /(ENRT-DSQRT(EN-EIN(L))))/((2.0*AL+1.0)*EN)
      PEQIN(L,I)=0.5+(QIN(L,I)-DRAT*QIN(L,I))/QIN(L,I)
  150 CONTINUE
C
C  VIBRATION
      QIN(211,I)=0.0
      IF(EN.LE.EIN(211)) GO TO 400
      DO 310 J=2,NVIB1
      IF(EN.LE.XVIB1(J)) GO TO 320
  310 CONTINUE
      J=NVIB1
  320 A=(YVIB1(J)-YVIB1(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB1(J)-XVIB1(J)*YVIB1(J-1))/(XVIB1(J-1)-XVIB1(J))
      QIN(211,I)=(A*EN+B)*1.D-16
  400 CONTINUE
C
      QIN(212,I)=0.0
      IF(EN.LE.EIN(212)) GO TO 500
      DO 410 J=2,NVIB2
      IF(EN.LE.XVIB2(J)) GO TO 420
  410 CONTINUE
      J=NVIB2
  420 A=(YVIB2(J)-YVIB2(J-1))/(XVIB2(J)-XVIB2(J-1))
      B=(XVIB2(J-1)*YVIB2(J)-XVIB2(J)*YVIB2(J-1))/(XVIB2(J-1)-XVIB2(J))
      QIN(212,I)=(A*EN+B)*1.D-16
  500 CONTINUE
C
      QIN(213,I)=0.0
      IF(EN.LE.EIN(213)) GO TO 600
      DO 510 J=2,NEXC
      IF(EN.LE.XEXC(J)) GO TO 520
  510 CONTINUE
      J=NEXC
  520 A=(YEXC(J)-YEXC(J-1))/(XEXC(J)-XEXC(J-1))
      B=(XEXC(J-1)*YEXC(J)-XEXC(J)*YEXC(J-1))/(XEXC(J-1)-XEXC(J))
      QIN(213,I)=(A*EN+B)*1.D-16
  600 CONTINUE
C
      QIN(214,I)=0.0
      IF(EN.LE.EIN(214)) GO TO 700
      DO 610 J=2,NEXC1
      IF(EN.LE.XEXC1(J)) GO TO 620
  610 CONTINUE
      J=NEXC1
  620 A=(YEXC1(J)-YEXC1(J-1))/(XEXC1(J)-XEXC1(J-1))
      B=(XEXC1(J-1)*YEXC1(J)-XEXC1(J)*YEXC1(J-1))/(XEXC1(J-1)-XEXC1(J))
      QIN(214,I)=(A*EN+B)*1.D-16
  700 CONTINUE
C
      QIN(215,I)=0.0
      IF(EN.LE.EIN(215)) GO TO 800
      DO 710 J=2,NEXC2
      IF(EN.LE.XEXC2(J)) GO TO 720
  710 CONTINUE
      J=NEXC2
  720 A=(YEXC2(J)-YEXC2(J-1))/(XEXC2(J)-XEXC2(J-1))
      B=(XEXC2(J-1)*YEXC2(J)-XEXC2(J)*YEXC2(J-1))/(XEXC2(J-1)-XEXC2(J))
      QIN(215,I)=(A*EN+B)*1.D-16
  800 CONTINUE
      SUM=0.0
      DO 850 K=1,210
      SUM=SUM+QIN(K,I)
  850 CONTINUE
C---------------------------------------------------------------------
C  SUM OF ELASTIC (MT), ROT (MT) AND INELASTIC
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+QIN(211,I)+QIN(212,I)+QIN(213,I)+
     /QIN(214,I)+QIN(215,I)+SUM*DRAT
C
  900 CONTINUE
C  SAVE COMPUTE TIME
      DO 1000 K=1,5
      J=216-K
      IF(EFINAL.LE.EIN(J)) NIN=J-1
 1000 CONTINUE
C
      RETURN
      END
      SUBROUTINE GAS15(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      DIMENSION XEN(48),YXSEC(48),XVIB1(64),YVIB1(64),YVIB2(64),YVIB3(64
     /),YVIB4(64),XION(60),YION(60),X3ATT(30),Y3ATT(30),XATT(33),YATT(33
     /),XEXC1(21),YEXC1(21),XEXC2(15),YEXC2(15),XEXC3(18),YEXC3(18),
     /XEXC4(13),YEXC4(13),XEXC5(25),YEXC5(25),XEXC6(22),YEXC6(22),
     /XROT(34),YROT(34)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      DATA XEN/0.00,.001,.003,.005,.007,.0085,0.01,.015,0.02,0.03,
     /0.04,0.06,0.08,0.10,0.12,0.15,0.20,0.30,0.40,0.50,
     /0.60,0.80,1.00,1.20,1.50,2.00,2.50,3.00,4.00,5.00,
     /6.00,8.00,10.0,12.0,15.0,20.0,25.0,30.0,40.0,50.0,
     /60.0,80.0,100.,200.,300.,500.,1000.,100000./
      DATA YXSEC/0.35,0.35,0.40,0.50,0.58,0.64,0.70,0.87,0.99,1.25,
     /1.50,1.85,2.65,3.85,4.80,5.60,5.70,5.80,5.90,5.95,
     /6.00,6.80,7.40,7.80,7.70,6.80,6.55,6.30,6.10,6.00,
     /5.90,5.85,5.80,5.70,5.60,5.45,5.10,4.70,3.75,3.12,
     /2.67,2.07,1.71,0.93,0.67,0.33,0.10,.001/
      DATA XVIB1/.193,0.20,0.21,0.23,0.32,0.33,0.35,0.44,0.45,0.47,
     /0.56,0.57,0.59,0.68,0.69,0.71,0.79,0.80,0.82,0.90,
     /0.91,0.93,1.02,1.03,1.05,1.13,1.14,1.16,1.23,1.24,
     /1.26,1.34,1.35,1.37,1.44,1.45,1.47,1.54,1.55,1.57,
     /1.63,1.65,1.67,4.00,5.00,6.00,7.00,8.00,8.50,9.00,
     /9.50,10.0,11.0,12.0,13.0,14.0,15.0,17.0,20.0,45.0,
     /100.,1000.,10000.,100000./
      DATA YVIB1/0.00,0.11,0.11,0.00,0.00,0.94,0.00,0.00,1.10,0.00,
     /0.00,1.40,0.00,0.00,1.30,0.00,0.00,1.00,0.00,0.00,
     /0.60,0.00,0.00,.285,0.00,0.00,.113,0.00,0.00,.048,
     /0.00,0.00,.017,0.00,0.00,.0055,0.00,0.00,.0019,0.00,
     /0.00,.0006,0.00,.001,.042,.100,.176,.231,.245,.247,
     /.245,.234,.186,.143,.102,.071,.040,.020,.010,.001,
     /0.00,0.00,0.00,0.00/
      DATA YVIB2/0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,
     /0.00,0.14,0.00,0.00,.415,0.00,0.00,.535,0.00,0.00,
     /.465,0.00,0.00,.315,0.00,0.00,0.20,0.00,0.00,.095,
     /0.00,0.00,0.04,0.00,0.00,.018,0.00,0.00,.008,0.00,
     /0.00,.003,0.00,.001,.028,.040,.073,.094,.105,.110,
     /.109,.109,.093,.073,.051,.028,.013,.008,.005,.001,
     /0.00,0.00,0.00,0.00/
      DATA YVIB3/0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,
     /0.00,0.00,0.00,0.00,.0037,0.00,0.00,.0215,0.0,0.0,
     /0.09,0.00,0.00,0.12,0.00,0.00,.115,0.00,0.00,.095,
     /0.00,0.00,.055,0.00,0.00,.030,0.00,0.00,.0165,0.00,
     /0.00,.008,0.00,0.00,0.00,.012,.036,.059,.067,.075,
     /.072,.068,.056,.048,.030,.017,.009,.002,.001,0.00,
     /0.00,0.00,0.00,0.00/
      DATA YVIB4/0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,
     /0.00,0.00,0.00,0.00,0.00,0.00,0.00,.0015,0.00,0.0,
     /.0055,0.00,0.0,.0095,0.00,0.0,.0165,0.00,0.0,.0315,
     /0.00,0.00,.0335,0.0,0.00,.0285,0.00,0.0,.0215,0.00,
     /0.00,.0165,0.00,0.0,0.00,.001,.027,.035,.038,.041,
     /.043,.046,.031,.025,.018,.009,.001,0.00,0.00,0.00,
     /0.00,0.00,0.00,0.00/
C
      DATA XION/12.072,12.5,13.0,13.5,14.0,14.5,15.0,15.5,16.0,16.5,
     /17.0,17.5,18.0,18.5,19.0,19.5,20.0,20.5,21.0,21.5,
     /22.0,24.0,26.0,28.0,30.0,32.0,34.0,36.0,40.0,45.0,
     /50.0,55.0,60.0,70.0,80.0,90.0,100.,110.,120.,130.,
     /140.,150.,160.,180.,200.,250.,300.,400.,500.,600.,
     /700.,800.,900.,1000.,2000.,4000.,6000.,10000.,20000.,100000./
      DATA YION/0.00,.0105,.023,.041,.054,.069,.085,.098,.114,.136,
     /.158,.180,.203,.229,.253,.279,.307,.333,.360,.387,
     /.416,.535,.654,.770,.897,1.03,1.15,1.27,1.47,1.70,
     /1.88,2.03,2.17,2.38,2.52,2.62,2.67,2.71,2.72,2.72,
     /2.71,2.69,2.67,2.62,2.53,2.36,2.18,1.88,1.67,1.49,
     /1.35,1.23,1.13,1.06,0.60,0.34,0.24,.155,.084,.020/
C  THREE BODY ATTACHMENT
      DATA X3ATT/0.035,0.04,.045,0.05,.055,.056,.058,0.06,.065,0.07,
     /.075,0.08,.081,.085,0.09,.095,0.10,.101,.105,0.11,
     /.115,0.20,0.30,0.40,0.50,0.80,1.00,2.00,1000.,100000./
      DATA Y3ATT/0.00,.00063,.00137,.00281,.00562,.00624,.00781,.01062,
     /.0206,.0375,
     /.0718,.137,.140,.0718,.0312,.0562,.112,.122,.0624,.0125,
     /0.016,.024,.017,.013,.010,.004,.002,.0001,.0000001,0.0/
C  DISSOCIATIVE ATTACHMENT
      DATA XATT/4.20,4.40,4.60,4.80,5.00,5.20,5.40,5.60,5.80,6.00,
     /6.20,6.30,6.40,6.50,6.60,6.70,6.80,7.00,7.20,7.40,
     /7.60,7.80,8.00,8.20,8.40,8.60,8.80,9.00,9.40,10.0,
     /12.0,100.,100000./
      DATA YATT/0.00,.00026,.00070,.00132,.00220,.00360,.00536,.00747,
     /.00958,.0114,
     /.0131,.0136,.0140,.0141,.0140,.0137,.0134,.0120,.0106,.00897,
     /.00738,.00571,.00448,.00334,.00237,.00167,.00123,.00088,.00053,
     /.00028,.0001,.000001,.000000001/
C  EXCITATION TO A1 DELTA G
      DATA XEXC1/.977,.982,2.00,3.00,4.00,5.00,6.00,7.00,8.00,9.00,
     /10.0,15.0,20.0,30.0,40.0,50.0,60.0,80.0,100.,1000.,100000./
      DATA YEXC1/0.00,.001,.0165,.037,.055,.068,.075,.0782,.079,.0773,
     /.075,.0575,.0435,.026,.0182,.0137,.0108,.0073,.0054,.0001,.000001/
C  EXCITATION TO B1 SIGMA G+
      DATA XEXC2/1.627,1.64,2.00,3.00,4.00,5.00,6.00,8.00,10.0,15.0,
     /20.0,40.0,100.,1000.,100000./
      DATA YEXC2/0.00,.001,.003,.010,.015,.018,.020,.020,.016,.014,
     /.013,.005,.002,.0002,.00002/
C  EXCITATION SUM OF C1 SIGMA U- AND C3 DELTA U
      DATA XEXC3/4.50,4.80,5.00,5.50,6.00,6.50,7.00,7.50,8.00,9.00,
     /10.0,12.0,15.0,20.0,50.0,100.,1000.,100000./
      DATA YEXC3/0.00,.003,.009,.030,.065,.085,.095,.100,.100,.085,
     /.070,.045,.020,.010,.005,.002,.001,.00001/
C  EXCITATION TO A3 SIGMA U+     (MOLECULAR DISSOCIATION)
      DATA XEXC4/6.10,7.00,7.80,9.00,10.0,12.0,15.0,17.0,20.0,45.0,
     /100.,1000.,100000./
      DATA YEXC4/0.00,.150,.250,.232,.210,.165,.105,.065,.048,.019,
     /.0096,.001,.00001/
C  EXCITATION TO B3 SIGMA U-     (MOLECULAR DISSOCIATION)
      DATA XEXC5/8.40,9.00,10.0,12.0,15.0,18.0,20.0,22.0,25.0,30.0,
     /40.0,50.0,60.0,80.0,100.,150.,200.,300.,400.,500.,
     /600.,800.,1000.,10000.,100000./
      DATA YEXC5/0.00,.129,.329,.772,1.15,1.31,1.34,1.35,1.34,1.27,
     /1.11,1.00,0.90,0.74,0.64,0.45,0.35,0.24,0.19,0.15,
     /0.13,.102,.086,.013,.0011/
C  EXCITATION TO HIGHER STATES SUMMED CROSS SECTION
      DATA XEXC6/9.30,10.0,12.0,15.0,18.0,20.0,25.0,30.0,35.0,40.0,
     /50.0,60.0,80.0,100.,150.,200.,300.,400.,500.,600.,
     /1000.,100000./
      DATA YEXC6/0.00,.014,.079,.133,.162,.171,.176,.173,.166,.155,
     /.138,.123,.102,.084,.055,.041,.025,.019,.014,.012,
     /.0055,.000055/
C     DATA XROT/0.002,.020,0.025,1000./
C     DATA YROT/0.00,0.00,0.15,0.15/
      DATA XROT/.020,.021,.025,0.07,0.08,0.10,0.20,0.21,0.22,0.32,
     /0.33,0.35,0.44,0.45,0.47,0.56,0.57,0.59,0.68,0.69,
     /0.71,0.79,0.80,0.81,0.90,0.91,0.93,1.02,1.03,1.05,
     /100.,1000., 10000.,100000./
      DATA YROT/0.00,0.01,0.01,0.01,.0154,.01,0.01,.0316,.01,.010,
     /.0484,.01,0.01,.064,0.01,0.01,.077,0.01,0.01,0.09,
     /0.01,0.01,0.10,0.01,0.01,0.09,0.01,0.01,0.08,0.06,
     /0.02,.015,.0015,.00015/
C ----------------------------------------------------------------------
C  X-SECTIONS DERIVED FROM LAWTON AND PHELPS : J.CHEM.PHYS. 69(1978)1055
C  VIBRATIONAL X-SECTION ADJUSTED TO FIT ARGON MIXTURE DATA OF:
C  JEON AND NAKAMURA  J.APPL.PHYS D 31(1998) 2145-2150
C  ELASTIC X-SECTION DERIVED FROM FIT TO PURE OXYGEN DATA OF:
C  JEON AND NAKAMURA  (AS ABOVE)  AT HIGH FIELD ,
C  AND THE DATA AT LOW FIELD OF :
C  CROMPTON AND ELFORD AUST. J. PHYS. 26(1973)771-782
C  REID AND CROMPTON   AUST. J. PHYS. 33(1980)215-216
C  N.B THE 3-BODY ATTACHMENT X-SECTION IS INCLUDED IN THE SUBROUTINE.
C  THE FIT TO THE DRIFT VELOCITY AND DIFFUSION MEASURED BY THE ABOVE
C  REFERENCES IS WITHIN THE EXPERIMENTAL ERRORS .
C ----------------------------------------------------------------------
C
      NAME=' OXYGEN  2003  '
C
      NIN=12
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      NROT=34
      NDATA=48
      NVIB1=64
      NVIB2=64
      NVIB3=64
      NVIB4=64
      NION=60
      NATT=33
      N3ATT=30
      NEXC1=21
      NEXC2=15
      NEXC3=18
      NEXC4=13
      NEXC5=25
      NEXC6=22
      E(1)=0.0
      E(2)=2.0*EMASS/(31.9988*AMU)
      E(3)=12.072
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=17.4
      EIN(1)=-0.020
      EIN(2)=0.020
      EIN(3)=0.193
      EIN(4)=0.386
      EIN(5)=0.579
      EIN(6)=0.772
      EIN(7)=0.977
      EIN(8)=1.627
      EIN(9)=4.50
      EIN(10)=6.10
      EIN(11)=8.40
      EIN(12)=9.30
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       OXYGEN         '
      SCRPT(3)=' IONISATION    ELOSS= 12.072  '
      SCRPT(4)=' ATTACHMENT 2+3 BODY          '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' ROT           ELOSS= -0.020  '
      SCRPT(8)=' ROT           ELOSS=  0.020  '
      SCRPT(9)=' VIB V1        ELOSS=  0.193  '
      SCRPT(10)=' VIB 2V1       ELOSS=  0.386  '
      SCRPT(11)=' VIB 3V1       ELOSS=  0.579  '
      SCRPT(12)=' VIB 4V1       ELOSS=  0.772  '
      SCRPT(13)=' EXC A1(DEL)G  ELOSS=  0.977  '
      SCRPT(14)=' EXC B1(SIG)G  ELOSS=  1.627  '
      SCRPT(15)=' EXC C1+C3     ELOSS=  4.50   '
      SCRPT(16)=' EXC A3 DISOC  ELOSS=  6.10   '
      SCRPT(17)=' EXC B3 DISOC  ELOSS=  8.40   '
      SCRPT(18)=' EXC           ELOSS=  9.30   '
C CALCULATE DENSITY CORRECTION FOR THREE BODY ATTACHMENT CROSS-SECTION
      FAC=273.15*TORR/((TEMPC+273.15)*760.0)
C
      APOP1=DEXP(EIN(1)/AKT)
      EN=-ESTEP/2.0
      DO 9900 I=1,NSTEP
      EN=EN+ESTEP
      DO 10 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 20
   10 CONTINUE
      J=NDATA
   20 A=(YXSEC(J)-YXSEC(J-1))/(XEN(J)-XEN(J-1))
      B=(XEN(J-1)*YXSEC(J)-XEN(J)*YXSEC(J-1))/(XEN(J-1)-XEN(J))
      Q(2,I)=(A*EN+B)*1.0D-16
C
      Q(3,I)=0.0
      IF(EN.LT.E(3)) GO TO 200
      DO 110 J=2,NION
      IF(EN.LE.XION(J)) GO TO 120
  110 CONTINUE
      J=NION
  120 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
C
  200 SINGLE=0.0
      IF(EN.LT.XATT(1)) GO TO 250
      IF(EN.GT.XATT(NATT)) GO TO 250
      DO 210 J=2,NATT
      IF(EN.LE.XATT(J)) GO TO 220
  210 CONTINUE
      J=NATT
  220 A=(YATT(J)-YATT(J-1))/(XATT(J)-XATT(J-1))
      B=(XATT(J-1)*YATT(J)-XATT(J)*YATT(J-1))/(XATT(J-1)-XATT(J))
      SINGLE=(A*EN+B)*1.D-16
C
  250 THREEB=0.0
      IF(EN.LT.X3ATT(1)) GO TO 300
      IF(EN.GT.X3ATT(N3ATT)) GO TO 300
      DO 260 J=2,N3ATT
      IF(EN.LE.X3ATT(J)) GO TO 270
  260 CONTINUE
      J=N3ATT
  270 A=(Y3ATT(J)-Y3ATT(J-1))/(X3ATT(J)-X3ATT(J-1))
      B=(X3ATT(J-1)*Y3ATT(J)-X3ATT(J)*Y3ATT(J-1))/(X3ATT(J-1)-X3ATT(J))
      THREEB=FAC*(A*EN+B)*1.D-16
  300 Q(4,I)=SINGLE+THREEB
      Q(5,I)=0.0
      Q(6,I)=0.0
C SUPERELASTIC ROTATION
      QIN(1,I)=0.0
      IF(EN.EQ.0.0) GO TO 350
      DO 330 J=2,NROT
      IF((EN+EIN(2)).LE.XROT(J)) GO TO 340
  330 CONTINUE
      J=NROT
  340 A=(YROT(J)-YROT(J-1))/(XROT(J)-XROT(J-1))
      B=(XROT(J-1)*YROT(J)-XROT(J)*YROT(J-1))/(XROT(J-1)-XROT(J))
      QIN(1,I)=(A*(EN+EIN(2))+B)*(EN+EIN(2))/EN
      QIN(1,I)=QIN(1,I)*APOP1/(1.0+APOP1)*1.D-16
  350 CONTINUE
C
      QIN(2,I)=0.0
      IF(EN.LE.EIN(2)) GO TO 400
      DO 360 J=2,NROT
      IF(EN.LE.XROT(J)) GO TO 370
  360 CONTINUE
      J=NROT
  370 A=(YROT(J)-YROT(J-1))/(XROT(J)-XROT(J-1))
      B=(XROT(J-1)*YROT(J)-XROT(J)*YROT(J-1))/(XROT(J-1)-XROT(J))
      QIN(2,I)=(A*EN+B)/(1.0+APOP1)*1.D-16
  400 CONTINUE
C
      QIN(3,I)=0.0
      IF(EN.LE.EIN(3)) GO TO 500
      DO 410 J=2,NVIB1
      IF(EN.LE.XVIB1(J)) GO TO 420
  410 CONTINUE
      J=NVIB1
  420 A=(YVIB1(J)-YVIB1(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB1(J)-XVIB1(J)*YVIB1(J-1))/(XVIB1(J-1)-XVIB1(J))
      QIN(3,I)=(A*EN+B)*1.D-16
  500 CONTINUE
C
      QIN(4,I)=0.0
      IF(EN.LE.EIN(4)) GO TO 600
      DO 510 J=2,NVIB2
      IF(EN.LE.XVIB1(J)) GO TO 520
  510 CONTINUE
      J=NVIB2
  520 A=(YVIB2(J)-YVIB2(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB2(J)-XVIB1(J)*YVIB2(J-1))/(XVIB1(J-1)-XVIB1(J))
      QIN(4,I)=(A*EN+B)*1.D-16
  600 CONTINUE
C
      QIN(5,I)=0.0
      IF(EN.LE.EIN(5)) GO TO 700
      DO 610 J=2,NVIB3
      IF(EN.LE.XVIB1(J)) GO TO 620
  610 CONTINUE
      J=NVIB3
  620 A=(YVIB3(J)-YVIB3(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB3(J)-XVIB1(J)*YVIB3(J-1))/(XVIB1(J-1)-XVIB1(J))
      QIN(5,I)=(A*EN+B)*1.D-16
  700 CONTINUE
C
      QIN(6,I)=0.0
      IF(EN.LE.EIN(6)) GO TO 800
      DO 710 J=2,NVIB4
      IF(EN.LE.XVIB1(J)) GO TO 720
  710 CONTINUE
      J=NVIB4
  720 A=(YVIB4(J)-YVIB4(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB4(J)-XVIB1(J)*YVIB4(J-1))/(XVIB1(J-1)-XVIB1(J))
      QIN(6,I)=(A*EN+B)*1.D-16
  800 CONTINUE
C
      QIN(7,I)=0.0
      IF(EN.LE.EIN(7)) GO TO 900
      DO 810 J=2,NEXC1
      IF(EN.LE.XEXC1(J)) GO TO 820
  810 CONTINUE
      J=NEXC1
  820 A=(YEXC1(J)-YEXC1(J-1))/(XEXC1(J)-XEXC1(J-1))
      B=(XEXC1(J-1)*YEXC1(J)-XEXC1(J)*YEXC1(J-1))/(XEXC1(J-1)-XEXC1(J))
      QIN(7,I)=(A*EN+B)*1.D-16
  900 CONTINUE
C
      QIN(8,I)=0.0
      IF(EN.LE.EIN(8)) GO TO 1000
      DO 910 J=2,NEXC2
      IF(EN.LE.XEXC2(J)) GO TO 920
  910 CONTINUE
      J=NEXC2
  920 A=(YEXC2(J)-YEXC2(J-1))/(XEXC2(J)-XEXC2(J-1))
      B=(XEXC2(J-1)*YEXC2(J)-XEXC2(J)*YEXC2(J-1))/(XEXC2(J-1)-XEXC2(J))
      QIN(8,I)=(A*EN+B)*1.D-16
 1000 CONTINUE
C
      QIN(9,I)=0.0
      IF(EN.LE.EIN(9)) GO TO 1100
      DO 1010 J=2,NEXC3
      IF(EN.LE.XEXC3(J)) GO TO 1020
 1010 CONTINUE
      J=NEXC3
 1020 A=(YEXC3(J)-YEXC3(J-1))/(XEXC3(J)-XEXC3(J-1))
      B=(XEXC3(J-1)*YEXC3(J)-XEXC3(J)*YEXC3(J-1))/(XEXC3(J-1)-XEXC3(J))
      QIN(9,I)=(A*EN+B)*1.D-16
 1100 CONTINUE
C
      QIN(10,I)=0.0
      IF(EN.LE.EIN(10)) GO TO 1200
      DO 1110 J=2,NEXC4
      IF(EN.LE.XEXC4(J)) GO TO 1120
 1110 CONTINUE
      J=NEXC4
 1120 A=(YEXC4(J)-YEXC4(J-1))/(XEXC4(J)-XEXC4(J-1))
      B=(XEXC4(J-1)*YEXC4(J)-XEXC4(J)*YEXC4(J-1))/(XEXC4(J-1)-XEXC4(J))
      QIN(10,I)=(A*EN+B)*1.D-16
 1200 CONTINUE
C
      QIN(11,I)=0.0
      IF(EN.LE.EIN(11)) GO TO 1300
      DO 1210 J=2,NEXC5
      IF(EN.LE.XEXC5(J)) GO TO 1220
 1210 CONTINUE
      J=NEXC5
 1220 A=(YEXC5(J)-YEXC5(J-1))/(XEXC5(J)-XEXC5(J-1))
      B=(XEXC5(J-1)*YEXC5(J)-XEXC5(J)*YEXC5(J-1))/(XEXC5(J-1)-XEXC5(J))
      QIN(11,I)=(A*EN+B)*1.D-16
 1300 CONTINUE
C
      QIN(12,I)=0.0
      IF(EN.LE.EIN(12)) GO TO 1400
      DO 1310 J=2,NEXC6
      IF(EN.LE.XEXC6(J)) GO TO 1320
 1310 CONTINUE
      J=NEXC6
 1320 A=(YEXC6(J)-YEXC6(J-1))/(XEXC6(J)-XEXC6(J-1))
      B=(XEXC6(J-1)*YEXC6(J)-XEXC6(J)*YEXC6(J-1))/(XEXC6(J-1)-XEXC6(J))
      QIN(12,I)=(A*EN+B)*1.D-16
 1400 CONTINUE
C
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+QIN(3,I)+QIN(4,I)+QIN(5,I)+QIN(6,I)+
     /QIN(7,I)+QIN(8,I)+QIN(9,I)+QIN(10,I)+QIN(11,I)+QIN(12,I)
 9900 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(12)) NIN=11
      IF(EFINAL.LE.EIN(11)) NIN=10
      IF(EFINAL.LE.EIN(10)) NIN=9
      IF(EFINAL.LE.EIN(9)) NIN=8
      IF(EFINAL.LE.EIN(8)) NIN=7
      IF(EFINAL.LE.EIN(7)) NIN=6
      IF(EFINAL.LE.EIN(6)) NIN=5
      IF(EFINAL.LE.EIN(5)) NIN=4
      IF(EFINAL.LE.EIN(4)) NIN=3
      IF(EFINAL.LE.EIN(3)) NIN=2
      IF(EFINAL.LE.EIN(2)) NIN=1
      IF(EFINAL.LE.EIN(1)) NIN=0
C
      RETURN
      END
      SUBROUTINE GAS16(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220),
     /PJ(220)
      DIMENSION XELA(184),YELA(184),YMOM(184),YEPS(184),
     /XROT(70),YROT(70),
     /XVB1(91),YVB1(91),XVB2(73),YVB2(73),XVB3(74),YVB3(74),
     /XVB4(54),YVB4(54),XVB5(44),YVB5(44),XVB6(45),YVB6(45),
     /XVB7(46),YVB7(46),XVB8(44),YVB8(44),XVB9(39),YVB9(39),
     /XVB10(39),YVB10(39),XVB11(39),YVB11(39),XVB12(37),YVB12(37),
     /XVB13(35),YVB13(35),XVB14(32),YVB14(32),XVB15(36),YVB15(36),
     /XTRP1(30),YTRP1(30),YTP1M(30),XTRP2(30),YTRP2(30),YTP2M(30),
     /XTRP3(28),YTRP3(28),YTP3M(28),XTRP4(29),YTRP4(29),YTP4M(29),
     /XTRP5(30),YTRP5(30),YTP5M(30),XTRP6(28),YTRP6(28),YTP6M(28),
     /XTRP7(28),YTRP7(28),YTP7M(28),XTRP8(28),YTRP8(28),YTP8M(28),
     /XTRP9(27),YTRP9(27),YTP9M(27),XTRP10(27),YTRP10(27),YTP10M(27),
     /XTRP11(26),YTRP11(26),YTP11M(26),XTRP12(29),YTRP12(29),YTP12M(29),
     /XTRP13(17),YTRP13(17),YTP13M(17),XTRP14(17),YTRP14(17),YTP14M(17),
     /XSNG1(33),YSNG1(33),YSG1M(33),XSNG2(24),YSNG2(24),YSG2M(24),
     /XSNG3(24),YSNG3(24),YSG3M(24),XSNG4(33),YSNG4(33),YSG4M(33),
     /XSNG5(24),YSNG5(24),YSG5M(24),XSNG6(23),YSNG6(23),YSG6M(23),
     /XSNG7(19),YSNG7(19),YSG7M(19),XSNG8(54),YSNG8(54),YSG8M(54),
     /XSNG9(54),YSNG9(54),YSG9M(54),XSNG10(54),YSNG10(54),YSG10M(54),
     /XSNG11(54),YSNG11(54),YSG11M(54),XSNG12(54),YSNG12(54),YSG12M(54),
     /XSNG13(54),YSNG13(54),YSG13M(54),XSNG14(54),YSNG14(54),YSG14M(54),
     /XSNG15(28),YSNG15(28),YSG15M(28),
     /XION(87),YION(87),YINC(87)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      DATA XELA/0.00,.001,.0015,.0018,.002,.0025,.003,.004,.005,.006,
     /.007,.008,.009,.010,.012,.015,.018,.020,.025,.030,
     /0.04,0.05,0.06,0.07,0.08,0.09,0.10,0.12,0.15,0.18,
     /0.20,0.25,0.30,0.40,0.50,0.60,0.70,0.80,0.90,1.00,
     /1.10,1.20,1.30,1.40,1.50,1.60,1.70,1.80,1.85,1.90,
     /1.95,2.00,2.05,2.10,2.15,2.20,2.25,2.30,2.35,2.40,
     /2.45,2.50,2.55,2.60,2.65,2.70,2.75,2.80,2.85,2.90,
     /2.95,3.00,3.05,3.10,3.15,3.20,3.25,3.30,3.35,3.40,
     /3.45,3.50,3.60,3.70,3.80,3.90,4.00,4.50,5.00,5.50,
     /6.00,6.50,7.00,8.00,9.00,10.0,12.0,15.0,17.0,20.0,
     /25.0,30.0,35.0,40.0,45.0,50.0,60.0,70.0,80.0,90.0,
     /100.,125.,150.,175.,200.,250.,300.,350.,400.,450.,
     /500.,600.,700.,800.,900.,1000.,1250.,1500.,1750.,2000.,
     /2500.,3000.,3500.,4000.,4500.,5000.,6000.,7000.,8000.,9000.,
     /10000.,1.25D4,1.5D4,1.75D4,2.0D4,2.5D4,3.0D4,3.5D4,4.0D4,4.5D4,
     /5.0D4,6.0D4,7.0D4,8.0D4,9.0D4,1.0D5,1.25D5,1.5D5,1.75D5,2.0D5,
     /2.5D5,3.0D5,3.5D5,4.0D5,4.5D5,5.0D5,6.0D5,7.0D5,8.0D5,9.0D5,
     /1.0D6,1.25D6,1.50D6,1.75D6,2.0D6,2.5D6,3.0D6,4.0D6,5.0D6,6.0D6,
     /8.0D6,1.0D7,1.5D7,2.0D7/
C ELASTIC +ROTATION X-SECTION
      DATA YELA/1.12,1.377,1.446,1.484,1.510,1.570,1.640,1.738,1.830,
     /1.928,
     /2.020,2.082,2.151,2.210,2.362,2.570,2.780,2.900,3.170,3.430,
     /3.850,4.170,4.480,4.750,5.000,5.250,5.450,5.850,6.300,6.800,
     /7.000,7.600,8.000,8.600,9.000,9.200,9.300,9.450,9.650,9.840,
     /10.00,10.24,10.48,10.67,11.05,11.71,12.90,14.90,16.10,17.60,
     /17.40,17.10,16.30,17.10,20.30,24.10,21.70,18.80,17.90,22.20,
     /24.90,21.70,18.00,16.80,20.90,22.45,20.30,17.00,16.80,18.70,
     /18.70,16.50,15.30,15.70,16.00,15.40,14.60,14.50,14.70,14.30,
     /13.50,13.80,13.60,13.30,13.15,13.00,12.90,11.90,11.60,11.40,
     /11.20,11.10,11.10,10.90,10.80,11.20,11.40,11.80,11.80,11.30,
     /10.70,9.660,8.740,8.090,7.530,7.130,6.380,5.840,5.330,4.940,
     /4.650,4.100,3.600,3.300,2.990,2.620,2.320,2.100,1.930,1.780,
     /1.660,1.470,1.300,1.200,1.110,1.030,0.870,0.765,0.670,0.600,
     /0.496,0.420,0.364,0.321,0.288,0.261,0.219,0.189,0.167,0.149,
     /0.135,0.109,.0919,.0795,.0702,.0570,.0483,.0420,.0372,.0336,
     /.0306,.0262,.0231,.0207,.0189,.0174,.0148,.0130,.0118,.0108,
     /.00953,.00868,.00808,.00764,.00730,.00703,.00664,.00637,.00617,
     /.00602,
     /.00591,.00572,.00560,.00552,.00546,.00539,.00535,.00530,.00528,
     /.00527,
     /.00525,.00525,.00524,.00524/
C ELASTIC+ROTATION MOMENTUM TRANSFER X-SECTION
      DATA YMOM/1.12,1.377,1.446,1.484,1.510,1.570,1.640,1.738,1.830,
     /1.928,
     /2.020,2.082,2.151,2.210,2.362,2.570,2.780,2.900,3.170,3.430,
     /3.900,4.350,4.750,5.100,5.410,5.690,5.950,6.450,7.100,7.590,
     /7.900,8.500,9.000,9.700,10.30,10.90,11.25,11.40,11.30,11.10,
     /10.90,10.65,10.45,10.65,10.80,11.85,13.60,16.00,17.40,19.00,
     /18.80,18.60,17.80,18.50,21.70,25.50,23.10,20.20,19.30,23.50,
     /26.20,23.00,19.30,18.10,22.20,23.70,21.50,18.10,17.80,19.60,
     /19.40,17.10,15.70,15.90,15.90,15.10,14.00,13.50,13.30,12.50,
     /11.40,11.40,11.00,10.60,10.20,10.00,9.900,9.100,8.900,8.700,
     /8.500,8.400,8.300,8.200,8.200,8.300,8.400,8.500,8.500,8.300,
     /7.800,7.200,6.700,6.310,5.950,5.600,4.700,4.000,3.500,3.000,
     /2.650,2.100,1.650,1.370,1.179,0.861,0.662,0.527,0.431,0.360,
     /0.306,0.230,0.179,0.144,0.119,0.100,.0687,.0504,.0387,.0307,
     /.0208,.0151,.0115,.00904,.00733,.00607,.00438,.00332,.00261,
     /.00211,
     /.00174,.00116,8.37D-4,6.33D-4,4.97D-4,3.32D-4,2.39D-4,1.81D-4,
     /1.43D-4,1.15D-4,
     /9.56D-5,6.91D-5,5.26D-5,4.16D-5,3.39D-5,2.82D-5,1.92D-5,1.41D-5,
     /1.09D-5,8.71D-6,
     /6.04D-6,4.50D-6,3.52D-6,2.86D-6,2.38D-6,2.02D-6,1.52D-6,1.20D-6,
     /9.83D-7,8.21D-7,
     /6.99D-7,5.00D-7,3.77D-7,2.97D-7,2.40D-7,1.68D-7,1.25D-7,7.78D-8,
     /5.34D-8,3.91D-8,
     /2.37D-8,1.60D-8,7.73D-9,4.58D-9/
C ELASTIC ANISOTROPY FUNCTION
      DATA YEPS/20*0.00,
     /-.01974,-.06500,-.09085,-.11025,-.12263,-.12532,-.13709,-.15311,
     /-.18909,-.17321,
     /-.19143,-.17651,-.18619,-.19046,-.21464,-.27297,-.30840,-.30369,
     /-.25314,-.19066,
     /-.13451,-.06001,0.00429,0.00281,0.03393,-.01794,-.08128,-.11047,
     /-.12077,-.11898,
     /-.12034,-.13112,-.13750,-.12243,-.10323,-.08700,-.09660,-.11142,
     /-.11699,-.08770,
     /-.07822,-.08972,-.10807,-.11576,-.09314,-.08340,-.08852,-.09688,
     /-.08914,-.07212,
     /-.05611,-.05451,-.03920,-.01911,0.00937,0.02922,0.06160,0.10323,
     /0.14228,0.18747,
     /0.23082,0.25736,0.28211,0.29895,0.32902,0.33802,0.34052,0.34433,
     /0.34080,0.34648,
     /0.35236,0.35537,0.36780,0.36154,0.35190,0.37697,0.38275,0.40516,
     /0.40516,0.38593,
     /0.39347,0.37111,0.34171,0.32298,0.30861,0.31533,0.38298,0.45227,
     /0.48887,0.55047,
     /0.59500,0.65988,0.71600,0.75776,0.77685,0.83247,0.86526,0.88911,
     /0.90685,0.91951,
     /0.92969,0.94445,0.95363,0.96172,0.96723,0.97137,0.97832,0.98295,
     /0.98564,0.98773,
     /0.99049,0.99218,0.99335,0.99424,0.99492,0.99546,0.99623,0.99678,
     /0.99721,0.99752,
     /.997788,.998241,.998539,.998754,.998916,.999138,.999288,.999393,
     /.999469,.999536,
     /.999582,.999656,.999709,.999748,.999779,.999803,.999847,.9998751,
     /.9998958,.9999105,
     /.9999317,.9999455,.9999551,.9999621,.9999675,.9999717,.9999780,
     /.9999823,.9999853,.9999876,
     /.9999894,.9999924,.9999943,.9999955,.9999964,.9999975,.9999982,
     /.9999989,.9999992,.9999995,
     /.9999997,.9999998,.9999999,.9999999/
C ROTATIONAL RESONANCE FUNCTION
      DATA XROT/0.00,1.00,1.10,1.20,1.30,1.40,1.50,1.60,1.70,1.80,
     /1.85,1.90,1.95,1.98,2.00,2.05,2.10,2.15,2.20,2.25,
     /2.30,2.35,2.40,2.45,2.50,2.55,2.60,2.65,2.69,2.70,
     /2.75,2.80,2.85,2.90,2.95,3.00,3.05,3.10,3.15,3.20,
     /3.25,3.30,3.35,3.40,3.45,3.50,3.60,3.70,3.80,3.90,
     /4.00,4.10,4.20,4.30,4.40,4.50,4.60,4.70,4.80,4.90,
     /5.00,5.10,5.20,5.30,5.40,5.50,5.60,5.70,5.80,5.90/
      DATA YROT/0.00,0.00,0.00,0.10,0.20,0.30,0.40,1.10,2.30,4.30,
     /5.50,7.00,6.80,7.10,6.50,5.70,6.50,9.70,13.5,11.1,
     /8.20,7.30,11.6,14.3,11.1,7.40,6.20,10.2,12.0,11.8,
     /9.60,6.30,6.10,8.00,8.00,5.80,4.60,5.00,5.30,4.70,
     /3.90,3.80,4.00,3.50,2.70,3.00,2.80,2.50,2.40,2.20,
     /2.10,1.90,1.70,1.50,1.20,1.00,0.80,0.70,0.60,0.50,
     /0.40,0.30,0.20,0.10,0.00,0.00,0.00,0.00,0.00,0.00/
C ALLAN AND VICIC  FROM 1.6 EV TO 4.5 EV FOR VIBRATIONS
      DATA XVB1/.2889,.289,.290,.292,.293,.295,.300,.310,.320,.330,
     /.340,.360,.380,0.40,0.50,0.60,0.70,0.80,0.90,1.00,
     /1.10,1.20,1.30,1.35,1.40,1.45,1.50,1.55,1.60,1.65,
     /1.70,1.75,1.80,1.85,1.90,1.95,2.00,2.05,2.10,2.15,
     /2.20,2.25,2.30,2.35,2.40,2.45,2.50,2.55,2.60,2.65,
     /2.70,2.75,2.80,2.85,2.90,2.95,3.00,3.05,3.10,3.15,
     /3.20,3.25,3.30,3.35,3.40,3.45,3.50,3.55,3.60,3.65,
     /3.70,3.75,3.80,3.90,4.00,4.50,5.00,7.50,10.0,15.0,
     /18.0,20.0,22.5,25.0,30.0,50.0,80.0,160.,1000.,1.D6,
     /1.D7/
C V1
      DATA YVB1/.00,.00018,.00045,.00072,.00082,.00099,.00131,
     /.00174,.00203,.00225,
     /.00242,.00267,.00283,.00294,.00340,.00360,.0039,.0044,.0054,.0066,
     /.0086,.0125,.0182,.0230,.0295,.0370,.0475,.0580,.0750,.103,
     /.178,.320,.600,1.20,2.40,4.35,4.40,2.71,1.67,2.40,
     /3.62,4.90,4.46,3.31,2.26,1.74,2.90,4.15,4.25,2.95,
     /1.61,1.97,2.95,3.43,2.30,1.41,1.63,2.30,2.01,1.54,
     /1.12,1.27,1.37,1.27,0.96,0.84,.820,.768,.648,.600,
     /.624,.528,.432,.390,.330,.230,.075,.025,.012,.031,
     /.061,.156,.101,.066,.022,.012,.006,.003,0.00,0.00,
     /0.00/
C V2
      DATA XVB2/.5742,.600,.700,.800,.900,1.00,1.10,1.20,1.30,1.40,
     /1.50,1.55,1.60,1.65,1.70,1.75,1.80,1.85,1.90,1.95,
     /2.00,2.05,2.10,2.15,2.20,2.25,2.30,2.35,2.40,2.45,
     /2.50,2.55,2.60,2.65,2.70,2.75,2.80,2.85,2.90,2.95,
     /3.00,3.05,3.10,3.15,3.20,3.25,3.30,3.35,3.40,3.45,
     /3.50,3.55,3.60,3.70,3.80,3.90,4.00,4.50,5.00,7.50,
     /10.0,15.0,18.0,20.0,22.5,25.0,30.0,50.0,80.0,160.,
     /1000.,1.D6,1.D7/
      DATA YVB2/.0,1.D-5,4.D-5,9.D-5,1.5D-4,2.0D-4,2.8D-4,3.2D-4,5.D-4,
     /8.1D-4,
     /.0026,.0059,.0115,.026,.051,.123,.236,.491,0.94,2.26,
     /2.90,2.55,2.20,1.45,.856,.682,1.33,2.40,3.05,2.78,
     /1.70,.672,.800,1.48,1.61,1.25,.805,.501,.670,.890,
     /.890,.650,.444,.428,.539,.491,.364,.225,.285,.238,
     /.200,.168,.156,.127,.101,.085,.072,.042,.014,.004,
     /.002,.006,.012,.030,.020,.012,.004,.002,.001,.0005,
     /0.00,0.00,0.00/
C V3
      DATA XVB3/.8559,.900,1.00,1.10,1.20,1.30,1.40,1.50,1.60,1.65,
     /1.70,1.75,1.80,1.85,1.90,1.95,2.00,2.05,2.10,2.15,
     /2.16,2.20,2.25,2.30,2.35,2.40,2.45,2.50,2.55,2.60,
     /2.65,2.70,2.75,2.80,2.85,2.90,2.95,3.00,3.05,3.10,
     /3.15,3.20,3.25,3.30,3.35,3.40,3.45,3.50,3.55,3.60,
     /3.65,3.70,3.75,3.80,3.85,3.90,3.95,4.00,4.50,5.00,
     /7.50,10.0,15.0,18.0,20.0,22.5,25.0,30.0,50.0,80.0,
     /160.,1000.,1.D6,1.D7/
      DATA YVB3/.0,1.D-5,3.7D-5,7.D-5,9.8D-5,1.3D-4,1.8D-4,4.1D-4,
     /.0021,.0050,
     /.012,.028,.071,.160,.300,.807,1.30,1.87,2.11,2.55,
     /2.57,2.35,1.52,.617,.438,.656,1.46,1.75,1.81,1.38,
     /.630,.250,.409,.747,1.00,.682,.309,.144,.263,.412,
     /.360,.212,.131,.148,.183,.200,.157,.114,.079,.101,
     /.101,.079,.057,.053,.058,.053,.044,.035,.023,.008,
     /.0023,.001,.003,.007,.017,.011,.006,.002,.001,.0005,
     /.00025,0.00,0.00,0.00/
C V4
      DATA XVB4/1.1342,1.80,1.85,1.90,1.95,2.00,2.05,2.10,2.15,2.20,
     /2.22,2.25,2.30,2.35,2.40,2.45,2.50,2.55,2.60,2.65,
     /2.70,2.75,2.80,2.85,2.90,2.95,3.00,3.05,3.10,3.15,
     /3.20,3.25,3.30,3.35,3.40,3.50,3.60,3.80,4.00,4.50,
     /5.00,7.50,10.0,15.0,18.0,20.0,22.5,30.0,50.0,80.0,
     /160.,1000.,1.D6,1.D7/
      DATA YVB4/0.0,0.00,9.D-5,.064,.170,.269,.465,.743,1.29,1.76,
     /1.79,1.72,1.41,1.04,.600,.234,.168,.439,.797,.994,
     /.806,.474,.215,.104,.197,.385,.394,.260,.198,.063,
     /.098,.151,.205,.089,.070,.078,.061,.044,.035,.026,
     /.009,.0026,.00105,.0016,.003,.008,.005,.003,.001,.0005,
     /.00025,0.00,0.00,0.00/
C V5
      DATA XVB5/1.4088,1.90,1.95,2.00,2.05,2.10,2.15,2.20,2.25,2.30,
     /2.35,2.40,2.45,2.50,2.55,2.60,2.65,2.70,2.75,2.80,
     /2.85,2.90,2.95,3.00,3.05,3.10,3.15,3.20,3.25,3.30,
     /3.35,3.40,3.45,3.50,4.00,4.50,5.00,7.50,10.0,20.0,
     /100.,1000.,1.D6,1.D7/
      DATA YVB5/0.00,0.00,.0009,.0118,.0531,.136,.313,.490,.655,.791,
     /1.04,1.18,1.01,.631,.295,.101,.068,.195,.395,.502,
     /.519,.313,.106,.024,.101,.195,.183,.112,.068,.018,
     /.035,.065,.065,.024,.014,.0096,.0032,.00096,.00024,.00012,
     /.00001,0.00,0.00,0.00/
C V6
      DATA XVB6/1.6801,2.05,2.10,2.15,2.20,2.25,2.30,2.35,2.40,2.45,
     /2.50,2.55,2.60,2.65,2.70,2.75,2.80,2.85,2.90,2.95,
     /3.00,3.05,3.10,3.15,3.20,3.25,3.30,3.35,3.40,3.45,
     /3.50,3.55,3.60,3.65,3.70,4.00,4.50,5.00,7.50,10.0,
     /20.0,100.,1000.,1.D6,1.D7/
      DATA YVB6/0.00,0.00,9.D-5,.0117,.0463,.124,.192,.344,.487,.602,
     /.615,.602,.577,.527,.307,.124,.050,.103,.193,.270,
     /.270,.180,.084,.0372,.0527,.103,.128,.096,.062,.0248,
     /.0186,.0312,.0372,.0372,.0155,.010,.052,.017,.0052,.0021,
     /.00105,.00001,0.00,0.00,0.00/
C V7
      DATA XVB7/1.9475,2.25,2.30,2.35,2.40,2.45,2.50,2.55,2.60,2.65,
     /2.68,2.70,2.75,2.80,2.85,2.90,2.95,3.00,3.05,3.10,
     /3.15,3.20,3.25,3.30,3.35,3.40,3.45,3.50,3.55,3.60,
     /3.65,3.70,3.75,3.80,3.85,3.90,4.00,4.50,5.00,7.50,
     /10.0,20.0,100.,1000.,1.D6,1.D7/
      DATA YVB7/0.00,0.00,.0009,.0255,.0526,.089,.133,.178,.232,.303,
     /.318,.304,.231,.159,.119,.0542,.0239,.0255,.0796,.113,
     /.108,.0812,.0413,.0112,.0064,.0207,.0334,.0366,.0224,.0128,
     /.0128,.0157,.0183,.0166,.0096,.0074,.0057,.0039,.0013,.00039,
     /.00015,.00008,.000008,0.00,0.00,0.00/
C V8
      DATA XVB8/2.2115,2.40,2.45,2.50,2.55,2.60,2.65,2.70,2.75,2.80,
     /2.85,2.88,2.90,2.95,3.00,3.05,3.10,3.15,3.20,3.25,
     /3.30,3.35,3.40,3.45,3.50,3.55,3.60,3.65,3.70,3.75,
     /3.80,3.85,3.90,3.95,4.00,4.50,5.00,7.50,10.0,20.0,
     /100.,1000.,1.D6,1.D7/
      DATA YVB8/0.00,0.00,9.D-6,.003,.011,.017,.042,.0656,.0739,.098,
     /.135,.140,.128,.084,.035,.014,.003,.007,.028,.0460,
     /.0460,.028,.011,.003,.0018,.011,.0123,.0140,.0084,.0035,
     /.0018,.0018,.0026,.0029,.0014,.0010,.0003,.00010,.000040,.000020,
     /.0000020,0.00,0.00,0.00/
C V9
      DATA XVB9/2.4718,2.65,2.70,2.75,2.80,2.85,2.90,2.95,3.00,3.05,
     /3.07,3.10,3.15,3.20,3.25,3.30,3.35,3.40,3.45,3.50,
     /3.55,3.60,3.65,3.70,3.75,3.80,3.85,3.90,3.95,4.00,
     /4.50,5.00,7.50,10.0,20.0,100.,1000.,1.D6,1.D7/
      DATA YVB9/0.00,.0011,.0028,.0069,.0132,.0264,.0412,.0474,.0438,
     /.0496,
     /.0528,.0438,.0247,.0739,.00295,.00581,.0159,.0232,.0264,.0206,
     /.0116,.00296,.00296,.00581,.00739,.00739,.00528,.00295,.00147,
     /.00070,
     /.00039,.00013,.000039,.0000157,.0000079,7.9D-7,0.00,0.00,0.00/
C V10
      DATA XVB10/2.7284,2.90,2.95,3.00,3.05,3.10,3.15,3.20,3.25,3.30,
     /3.35,3.40,3.45,3.50,3.55,3.60,3.65,3.70,3.75,3.80,
     /3.85,3.90,3.95,4.00,4.05,4.10,4.15,4.20,4.25,4.30,
     /4.50,5.00,7.50,10.0,20.0,100.,1000.,1.D6,1.D7/
      DATA YVB10/0.00,.000040,.00170,.00554,.0103,.0154,.0205,.0201,
     /.0147,.0103,
     /.00677,.00225,.00137,.00452,.00800,.0116,.0119,.00800,.00390,
     /.00137,
     /.00205,.00390,.00573,.00573,.00452,.00349,.00225,.00116,.00042,
     /.00026,
     /.00017,5.8D-5,1.7D-5,7.0D-6,3.5D-6,3.5D-7,0.00,0.00,0.00/
C V11
      DATA XVB11/2.9815,3.10,3.15,3.20,3.25,3.30,3.35,3.40,3.45,3.50,
     /3.55,3.60,3.65,3.70,3.75,3.80,3.85,3.90,3.95,4.00,
     /4.05,4.10,4.15,4.20,4.25,4.30,4.35,4.40,4.45,4.50,
     /4.60,5.00,7.50,10.0,20.0,100.,1000.,1.D6,1.D7/
      DATA YVB11/0.00,3.29D-4,.00170,.00291,.00445,.00550,.00462,
     /.00291,.00170,6.04D-4,
     /2.20D-4,.00105,.00275,.00344,.00303,.00198,7.70D-4,1.65D-4,
     /2.75D-4,4.40D-4,
     /.00116,.00110,3.85D-4,5.50D-5,5.50D-5,3.30D-4,3.85D-4,3.30D-4,
     /1.65D-4,8.70D-5,
     /2.88D-5,9.60D-6,2.88D-6,1.16D-6,5.8D-7,5.8D-8,0.00,0.00,0.00/
C V12
      DATA XVB12/3.2310,3.30,3.35,3.40,3.45,3.50,3.55,3.60,3.65,3.70,
     /3.75,3.80,3.85,3.90,3.95,4.00,4.05,4.10,4.15,4.20,
     /4.25,4.30,4.35,4.40,4.45,4.50,4.55,4.60,4.65,5.00,
     /7.50,10.0,20.0,100.,1000.,1.D6,1.D7/
      DATA YVB12/0.00,3.66D-5,3.78D-4,6.22D-4,.00107,.00119,.00092,
     /4.40D-4,1.59D-4,1.10D-4,
     /4.52D-4,8.06D-4,.00122,.00107,6.96D-4,3.17D-4,7.32D-5,8.55D-5,
     /3.05D-4,3.78D-4,
     /3.05D-4,1.53D-4,7.33D-5,1.22D-5,7.33D-5,1.46D-4,8.55D-5,1.22D-5,
     /6.10D-6,2.04D-6,
     /6.10D-7,2.44D-7,1.22D-7,1.22D-8,0.00,0.00,0.00/
C V13
      DATA XVB13/3.4769,3.55,3.60,3.65,3.70,3.75,3.80,3.85,3.90,3.95,
     /4.00,4.05,4.10,4.15,4.20,4.25,4.30,4.35,4.40,4.45,
     /4.50,4.55,4.60,4.65,4.70,4.75,4.80,5.00,7.50,10.0,
     /20.0,100.,1000.,1.D6,1.D7/
      DATA YVB13/0.00,4.90D-5,1.02D-4,1.96D-4,2.16D-4,1.18D-4,3.92D-5,
     /3.92D-5,1.46D-4,2.94D-4,
     /3.68D-4,3.92D-4,2.72D-4,1.22D-4,2.75D-5,6.28D-5,9.77D-5,1.49D-4,
     /1.18D-4,6.28D-5,
     /1.57D-5,1.57D-5,2.35D-5,4.71D-5,3.14D-5,1.96D-5,3.93D-6,1.31D-6,
     /3.93D-7,1.57D-7,
     /7.8D-8,7.8D-9,0.00,0.00,0.00/
C V14
      DATA XVB14/3.7191,3.80,3.85,3.90,3.95,4.00,4.05,4.10,4.15,4.20,
     /4.25,4.30,4.35,4.40,4.45,4.50,4.55,4.60,4.65,4.70,
     /4.75,4.80,4.85,4.90,4.95,7.50,10.0,20.0,100.,1000.,
     /1.D6,1.D7/
      DATA YVB14/0.00,9.07D-6,1.70D-5,1.70D-5,6.80D-6,7.94D-6,3.51D-5,
     /7.83D-5,1.14D-4,1.09D-4,
     /7.14D-5,3.51D-5,6.80D-6,9.07D-6,4.31D-5,5.44D-5,3.51D-5,1.70D-5,
     /4.54D-6,6.80D-6,
     /1.02D-5,1.70D-5,9.07D-6,5.67D-6,1.75D-6,1.75D-7,6.98D-8,3.5D-8,
     /3.5D-9,0.00,
     /0.00,0.00/
C V15
      DATA XVB15/3.9576,4.05,4.10,4.15,4.20,4.25,4.30,4.35,4.40,4.45,
     /4.50,4.55,4.60,4.65,4.70,4.75,4.80,4.85,4.90,4.95,
     /5.00,5.05,5.10,5.15,5.20,5.25,5.30,5.40,5.50,7.50,
     /10.0,20.0,100.,1000.,1.D6,1.D7/
      DATA YVB15/0.00,9.42D-7,1.25D-6,2.51D-6,5.34D-6,1.94D-5,2.89D-5,
     /3.14D-5,2.16D-5,1.10D-5,
     /4.40D-6,5.96D-6,1.20D-5,1.98D-5,1.64D-5,9.07D-6,3.77D-6,3.77D-6,
     /7.22D-6,7.22D-6,
     /6.28D-6,3.77D-6,3.46D-6,4.39D-6,4.71D-6,4.71D-6,3.77D-6,2.18D-6,
     /1.09D-6,1.09D-7,
     /4.36D-8,2.2D-8,2.2D-9,0.00,0.00,0.00/
C A3SIG(V=0-4) (V=0 ENERGY=6.169 EV)  AVERAGE ENERGY LOSS =6.725 EV
      DATA XTRP1/6.725,7.00,7.80,8.50,9.00,10.0,11.0,12.0,13.0,14.0,
     /16.0,17.0,18.0,20.0,22.0,24.0,26.0,30.0,34.0,40.0,
     /50.0,70.0,100.,200.,400.,1000.,10000.,1.D5,1.D6,1.D7/
      DATA YTRP1/0.00,.0035,.0100,.0440,.0280,.0240,.022,.021,.020,.019,
     /.016,.015,.014,.013,.0108,.0099,.0087,.0069,.0057,.0046,
     /.0033,.0019,.00094,.0003,.0001,2.5D-5,2.5D-6,0.00,0.00,0.00/
      DATA YTP1M/0.92,0.92,0.92,0.92,0.92,0.92,0.93,0.94,0.94,0.95,
     /0.97,1.01,1.07,1.12,1.14,1.16,1.18,1.22,1.21,1.20,
     /1.18,1.00,0.92,0.72,0.42,0.22,0.03,.003,0.00,0.00/
C A3SIG(V=5-9) (V=5 ENERGY=7.023 EV) AVERAGE ENERGY LOSS =7.360 EV
      DATA XTRP2/7.360,7.50,7.80,8.50,9.00,10.0,11.0,12.0,13.0,14.0,
     /16.0,17.0,18.0,20.0,22.0,24.0,26.0,30.0,34.0,40.0,
     /50.0,70.0,100.,200.,400.,1000.,10000.,1.D5,1.D6,1.D7/
      DATA YTRP2/0.00,.0071,.0180,.072,.108,.096,.094,.092,.085,.081,
     /.069,.064,.059,.054,.049,.043,.038,.029,.024,.020,
     /.0136,.0076,.0040,.0013,.0004,.0001,1.D-5,0.00,0.00,0.00/
      DATA YTP2M/0.92,0.92,0.92,0.92,0.92,0.92,0.93,0.94,0.94,0.95,
     /0.97,1.01,1.07,1.12,1.14,1.16,1.18,1.22,1.21,1.20,
     /1.18,1.00,0.92,0.72,0.42,0.22,0.03,.003,0.00,0.00/
C B3PI(V=0-3) (V=0 ENERGY=7.353 EV) AVERAGE ENERGY LOSS =7.744 EV
      DATA XTRP3/7.744,8.00,9.00,10.0,11.0,12.0,13.0,14.0,15.0,16.0,
     /17.0,18.0,20.0,22.0,26.0,30.0,34.0,40.0,50.0,70.0,
     /100.,200.,400.,1000.,10000.,1.D5,1.D6,1.D7/
      DATA YTRP3/.0,.018,.132,.194,.188,.173,.161,.150,.138,.128,
     /.116,.108,.089,.077,.063,.053,.047,.035,.026,.0113,
     /.0039,.0013,.0004,.0001,1.D-5,0.00,0.00,0.00/
      DATA YTP3M/1.06,1.06,1.06,1.06,1.12,1.18,1.18,1.16,1.14,1.12,
     /1.10,1.08,1.06,1.08,1.12,1.16,1.16,1.17,1.18,1.06,
     /0.94,0.72,0.42,0.22,0.03,.003,0.00,0.00/
C W3DEL(V=0-5) (V=0 ENERGY=7.362 EV) AVERAGE ENERGY LOSS = 8.050 EV
      DATA XTRP4/8.050,8.50,9.00,10.0,11.0,12.0,14.0,15.0,16.0,17.0,
     /18.0,20.0,22.0,24.0,26.0,28.0,30.0,34.0,40.0,50.0,
     /70.0,100.,200.,400.,1000.,10000.,1.D5,1.D6,1.D7/
      DATA YTRP4/.0,.0010,.007,.016,.023,.030,.044,.050,.053,.053,
     /.052,.047,.039,.032,.027,.023,.020,.015,.0112,.0073,
     /.00366,.00183,6.D-4,2.D-4,5.D-5,5.D-6,0.00,0.00,0.00/
      DATA YTP4M/1.20,1.20,1.20,1.20,1.14,1.08,1.08,1.13,1.16,1.19,
     /1.21,1.22,1.23,1.24,1.25,1.26,1.27,1.26,1.23,1.19,
     /1.11,0.98,0.72,0.42,0.22,0.03,.003,0.00,0.00/
C A3SIG(V=10-21) (V=10 ENERGY=7.790 EV) AVERAGE ENERGY LOSS=8.217 EV
      DATA XTRP5/8.217,8.30,8.50,8.70,9.00,10.0,11.0,12.0,13.0,14.0,
     /16.0,17.0,18.0,20.0,22.0,24.0,26.0,30.0,34.0,40.0,
     /50.0,70.0,100.,200.,400.,1000.,10000.,1.D5,1.D6,1.D7/
      DATA YTRP5/0.0,.0069,.0365,.0450,.055,.096,.100,.097,.091,.086,
     /.073,.066,.060,.055,.050,.044,.038,.031,.024,.020,
     /.0145,.0080,.0043,.0014,.00046,.0001,1.D-5,0.00,0.00,0.00/
      DATA YTP5M/0.92,0.92,0.92,0.92,0.92,0.92,0.93,0.94,0.94,0.95,
     /0.97,1.01,1.07,1.12,1.14,1.16,1.18,1.22,1.21,1.20,
     /1.18,1.00,0.92,0.72,0.42,0.22,0.03,.003,0.00,0.00/
C B3PI(V=4-16) (V=4 ENERGY=8.177 EV) AVERAGE ENERGY LOSS= 8.451 EV
      DATA XTRP6/8.451,8.50,9.00,10.0,11.0,12.0,13.0,14.0,15.0,16.0,
     /17.0,18.0,20.0,22.0,26.0,30.0,34.0,40.0,50.0,70.0,
     /100.,200.,400.,1000.,10000.,1.D5,1.D6,1.D7/
      DATA YTRP6/.0,.011,.090,.133,.129,.119,.110,.102,.094,.088,
     /.079,.074,.061,.053,.044,.037,.032,.023,.017,.0077,
     /.0028,.0010,.0003,1.D-4,1.D-5,0.00,0.00,0.00/
      DATA YTP6M/1.06,1.06,1.06,1.06,1.12,1.18,1.18,1.16,1.14,1.12,
     /1.10,1.08,1.06,1.08,1.12,1.16,1.16,1.17,1.18,1.06,
     /0.94,0.72,0.42,0.22,0.03,.003,0.00,0.00/
C W3DEL(V=6-10) (V=6 ENERGY=8.419 EV) AVERAGE ENERGY LOSS= 8.729 EV
      DATA XTRP7/8.729,9.00,10.0,11.0,12.0,14.0,15.0,16.0,17.0,18.0,
     /20.0,22.0,24.0,26.0,28.0,30.0,34.0,40.0,50.0,70.0,
     /100.,200.,400.,1000.,10000.,1.D5,1.D6,1.D7/
      DATA YTRP7/.0,0.004,.032,.048,.064,.092,.105,.110,.110,
     /.108,
     /.097,.082,.066,.056,.048,.041,.032,.023,.0153,.0076,
     /.0038,.0013,.0004,1.D-4,1.D-5,0.00,0.00,0.00/
      DATA YTP7M/1.20,1.20,1.20,1.14,1.08,1.08,1.13,1.16,1.19,1.21,
     /1.22,1.23,1.24,1.25,1.26,1.27,1.26,1.23,1.19,1.11,
     /0.98,0.72,0.42,0.22,0.03,.003,0.00,0.00/
C A1PI(V=0-3) (V=0 ENERGY=8.549 EV) AVERAGE ENERGY LOSS= 8.950 EV
      DATA XSNG1/8.950,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,
     /19.0,20.0,24.0,27.0,30.0,40.0,50.0,70.0,100.,150.,
     /200.,250.,300.,500.,700.,1000.,2000.,4000.,10000.,20000.,
     /1.D5,1.D6,1.D7/
      DATA YSNG1/.0,.013,.025,.040,.059,.082,.101,.116,.123,.128,
     /.130,.130,.125,.119,.112,.087,.071,.051,.036,.0242,
     /.0182,.0147,.0122,.0074,.0054,.0038,.0019,.0010,.00038,.00019,
     /3.8D-5,3.8D-6,3.8D-7/
      DATA YSG1M/0.80,0.80,0.75,0.70,0.66,0.60,0.55,0.53,0.51,0.50,
     /0.49,0.48,0.50,0.52,0.54,0.48,0.41,0.34,0.24,0.20,
     /0.19,0.18,0.17,0.16,0.12,.091,.051,.028,.013,.007,
     /.0016,.00012,.000010/
C B'3SIG(V=0-6) (V=0 ENERGY=8.165 EV) AVERAGE ENERGY LOSS= 8.974 EV
      DATA XTRP8/8.974,9.50,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,
     /18.0,19.0,20.0,22.0,26.0,30.0,34.0,40.0,50.0,70.0,
     /100.,200.,400.,1000.,10000.,1.D5,1.D6,1.D7/
      DATA YTRP8/.0,.0002,.0010,.0032,.0081,.0136,.0203,.0252,.0274,
     /.0274,
     /.0264,.0250,.0236,.0209,.0151,.0114,.0089,.0064,.0041,.0020,
     /.0010,.0003,.0001,3.D-5,3.D-6,0.00,0.00,0.00/
      DATA YTP8M/0.90,0.90,0.90,0.90,0.90,0.91,0.93,0.97,1.07,1.17,
     /1.22,1.22,1.23,1.26,1.32,1.37,1.35,1.32,1.29,1.20,
     /1.04,0.74,0.42,0.22,0.03,.003,0.00,0.00/
C A'1SIG (V=0-6) (V=0 ENERGY=8.398 EV) AVERAGE ENERGY LOSS= 9.191 EV
      DATA XSNG2/9.191,10.2,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,
     /20.0,24.0,30.0,40.0,50.0,70.0,100.,200.,400.,1000.,
     /10000.,1.D5,1.D6,1.D7/
      DATA YSNG2/.0,.0013,.0071,.0106,.0139,.0146,.0145,.0143,.0139,
     /.0135,
     /.0132,.0105,.0072,.0045,.0031,.0017,.0010,.0003,.0001,3.D-5,
     /3.D-6,0.00,0.00,0.00/
      DATA YSG2M/1.00,1.00,1.00,1.00,1.00,1.00,1.07,1.13,1.14,1.15,
     /1.16,1.21,1.27,1.17,1.07,0.93,0.72,0.66,0.42,0.22,
     /0.03,.003,0.00,0.00/
C W3DEL(V=11-19) (V=11 ENERGY=9.220 EV) AVERAGE ENERGY LOSS= 9.562 EV
      DATA XTRP9/9.562,10.0,11.0,12.0,14.0,15.0,16.0,17.0,18.0,20.0,
     /22.0,24.0,26.0,28.0,30.0,34.0,40.0,50.0,70.0,100.,
     /200.,400.,1000.,10000.,1.D5,1.D6,1.D7/
      DATA YTRP9/.0,.012,.029,.038,.056,.063,.067,.067,.065,
     /.058,
     /.049,.040,.034,.029,.024,.019,.0141,.0092,.00461,.00230,
     /.00076,.00026,6.D-5,6.D-6,0.00,0.00,0.00/
      DATA YTP9M/1.20,1.20,1.14,1.08,1.08,1.13,1.16,1.19,1.21,1.22,
     /1.23,1.24,1.25,1.26,1.27,1.26,1.23,1.19,1.11,0.98,
     /0.72,0.42,0.22,0.03,.003,0.00,0.00/
C W1DEL(V=0-5) (V=0 ENERGY=8.895 EV) AVERAGE ENERGY LOSS= 9.590 EV
      DATA XSNG3/9.590,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,
     /20.0,24.0,30.0,40.0,50.0,70.0,100.,200.,400.,1000.,
     /10000.,1.D5,1.D6,1.D7/
      DATA YSNG3/.0,.0002,.003,.009,.0109,.0144,.0141,.0138,.0134,.013,
     /.012,.0094,.0074,.0054,.0043,.0030,.0020,.0010,.00046,.00018,
     /1.8D-5,0.00,0.00,0.00/
      DATA YSG3M/1.08,1.08,1.08,1.08,1.05,1.00,0.08,0.97,0.96,0.95,
     /0.92,0.90,0.86,0.76,0.66,0.55,0.36,0.28,0.19,.091,
     /.013,.0013,0.00,0.00/
C A1PI(V=4-15) (V=4 ENERGY=9.355 EV) AVERAGE ENERGY LOSS= 9.665 EV
      DATA XSNG4/9.665,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,
     /19.0,20.0,24.0,27.0,30.0,40.0,50.0,70.0,100.,150.,
     /200.,250.,300.,500.,700.,1000.,2000.,4000.,10000.,20000.,
     /1.D5,1.D6,1.D7/
      DATA YSNG4/.0,.009,.023,.039,.057,.077,.097,.109,.117,.121,
     /.123,.124,.119,.112,.106,.083,.067,.048,.034,.0230,
     /.0173,.0139,.0117,.0071,.0052,.0036,.0018,.0010,.00038,.00019,
     /3.7D-5,3.7D-6,3.7D-7/
      DATA YSG4M/0.80,0.80,0.75,0.70,0.66,0.60,0.55,0.53,0.51,0.50,
     /0.49,0.48,0.50,0.52,0.54,0.48,0.41,0.34,0.24,0.20,
     /0.19,0.18,0.17,0.16,0.12,.091,.051,.028,.013,.007,
     /.0016,.00012,.000010/
C B'3SIG(V=7-18) (V=7 ENERGY=9.399 EV) AVERAGE ENERGY LOSS= 9.933 EV
      DATA XTRP10/9.933,10.2,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,
     /19.0,20.0,22.0,26.0,30.0,34.0,40.0,50.0,70.0,100.,
     /200.,400.,1000.,10000.,1.D5,1.D6,1.D7/
      DATA YTRP10/.0,.0010,.0068,.0169,.0284,.0427,.0528,.0575,.0575,
     /.0552,
     /.0524,.0495,.0438,.0316,.0236,.0187,.0133,.0086,.0041,.0020,
     /.0007,.0002,6.D-5,6.D-6,0.00,0.00,0.00/
      DATA YTP10M/0.90,0.90,0.90,0.90,0.90,0.91,0.93,0.97,1.07,1.17,
     /1.22,1.22,1.23,1.26,1.32,1.37,1.35,1.32,1.29,1.20,
     /1.04,0.54,0.22,0.03,.003,0.00,0.00/
C A'1SIG (V=7-19) (V=7 ENERGY=9.645 EV) AVERAGE ENERGY LOSS= 10.174 EV
      DATA XSNG5/10.174,10.5,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,
     /20.0,24.0,30.0,40.0,50.0,70.0,100.,200.,400.,1000.,
     /10000.,1.D5,1.D6,1.D7/
      DATA YSNG5/.0,.0013,.0129,.0194,.0252,.0267,.0265,.0260,.0253,
     /.0247,
     /.0240,.0192,.0133,.0081,.0055,.0032,.0017,.00057,2.D-4,5.D-5,
     /5.D-6,0.00,0.00,0.00/
      DATA YSG5M/1.00,1.00,1.00,1.00,1.00,1.00,1.07,1.13,1.14,1.15,
     /1.16,1.21,1.27,1.17,1.07,0.93,0.72,0.66,0.42,0.22,
     /0.03,.003,0.00,0.00/
C W1DEL(V=6-18) (V=6 ENERGY=9.994 EV) AVERAGE ENERGY LOSS= 10.536 EV
      DATA XSNG6/10.536,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,20.0,
     /24.0,30.0,40.0,50.0,70.0,100.,200.,400.,1000.,10000.,
     /1.D5,1.D6,1.D7/
      DATA YSNG6/.0,.003,.009,.0242,.032,.032,.031,.030,.029,.026,
     /.021,.0164,.0121,.0096,.0066,.0046,.0021,.00102,4.D-4,4.D-5,
     /0.00,0.00,0.00/
      DATA YSG6M/1.08,1.08,1.08,1.05,1.00,0.08,0.97,0.96,0.95,0.92,
     /0.90,0.86,0.76,0.66,0.55,0.36,0.28,0.19,.091,.013,
     /.002,0.00,0.00/
C C3PI(V=0-4) (V=0 ENERGY=11.032 EV) AVERAGE ENERGY LOSS= 11.188 EV
      DATA XTRP11/11.188,12.0,12.5,13.0,13.5,14.0,14.5,15.0,16.0,17.0,
     /18.0,19.0,20.0,24.0,30.0,40.0,50.0,70.0,100.,200.,
     /400.,1000.,10000.,1.D5,1.D6,1.D7/
      DATA YTRP11/.0,.057,.089,.130,.180,.225,.235,.225,.205,.190,
     /.170,.155,.140,.105,.074,.044,.031,.015,.0057,.0019,
     /.0006,2.5D-4,2.5D-5,0.00,0.00,0.00/
      DATA YTP11M/1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.02,1.01,
     /1.00,0.99,0.99,1.06,1.14,1.11,1.09,0.93,0.70,0.42,
     /0.22,.091,.013,.002,0.00,0.00/
C E3SIG  V=0
      DATA XTRP12/11.875,11.9,11.95,12.0,12.5,13.0,14.0,15.0,16.0,17.0,
     /18.0,19.0,20.0,21.0,25.0,30.0,35.0,40.0,45.0,50.0,
     /70.0,100.,200.,400.,1000.,10000.,1.D5,1.D6,1.D7/
      DATA YTRP12/.0,.157,.127,.101,.031,.021,.009,.003,.002,.004,
     /.008,.011,.013,.013,.010,.008,.005,.0037,.0027,.002,
     /.0010,.0004,.0001,.00004,.00001,1.D-6,0.00,0.00,0.00/
      DATA YTP12M/29*1.0/
C A''1SIG(V=0-1) (V=0 ENERGY=12.255 EV)  AVERAGE ENERGY LOSS= 12.289 EV
      DATA XSNG7/12.289,13.0,14.0,15.0,17.5,20.0,24.0,30.0,40.0,50.0,
     /70.0,100.,200.,400.,1000.,10000.,1.D5,1.D6,1.D7/
      DATA YSNG7/.0,.002,.005,.011,.022,.034,.037,.036,.031,.028,
     /.020,.0125,.0049,.0019,4.D-4,4.D-5,0.00,0.00,0.00/
      DATA YSG7M/0.86,0.86,0.86,0.86,0.86,0.91,0.94,0.99,0.94,0.89,
     /0.73,0.50,0.33,0.19,.091,.013,.002,0.00,0.00/
C B1PI (V=0-6) (V=0 ENERGY=12.500 EV) AVERAGE ENERGY LOSS= 12.771 EV
C  USE DIPOLE FALL OFF WITH ENERGY ABOVE 500EV
      DATA XSNG8/12.771,17.5,20.0,30.0,40.0,50.0,70.0,100.,150.,200.,
     /250.,300.,350.,400.,450.,500.,600.,700.,800.,900.,
     /1000.,1200.,1400.,1600.,1800.,2000.,2400.,2800.,3200.,3600.,
     /4000.,4500.,5000.,5500.,6000.,7000.,8000.,9000.,1.0D4,1.2D4,
     /1.4D4,1.6D4,2.0D4,2.5D4,3.0D4,4.0D4,5.0D4,6.0D4,7.0D4,8.0D4,
     /9.0D4,1.0D5,1.0D6,1.0D7/
      DATA YSNG8/0.0,.0357,.0855,.170,.173,.163,.142,.116,.0905,.0763,
     /.0668,.0599,.0551,.0501,.0463,.0440,.0374,.0334,.0299,.0273,
     /.0249,.0214,.0189,.0170,.0154,.0140,.0120,.01056,.00937,.00849,
     /.00775,.00701,.00640,.00587,.00545,.00479,.00425,.00384,.00350,
     /.00299,
     /.00261,.00232,.00191,.00156,.00133,.001024,8.42D-4,7.15D-4,
     /6.22D-4,5.49D-4,
     /4.96D-4,4.48D-4,1.5D-4,1.5D-4/
      DATA YSG8M/0.76,0.76,0.67,0.46,0.34,0.22,0.13,0.05,0.04,0.03,
     /.028,.025,.022,.020,.018,.016,.014,.012,.011,.010,
     /.009,.008,.007,.006,.0055,.005,.0046,.0042,.0038,.0034,
     /.0030,.0028,.0026,.0024,.0022,.0020,.0018,.0016,.0014,.0013,
     /.0012,.0011,.0010,.0009,.0008,.0007,.0006,.0005,.0004,.0003,
     /.0002,.00015,.00002,.000002/
C C'1SIG (V=0-3) (V=0 ENERGY=12.934 EV) AVERAGE ENERGY LOSS= 12.950 EV
C  USE DIPOLE FALL OFF WITH ENERGY ABOVE 500EV
C  SCALED X-SECTION BY 1.212 TO ALLOW FOR HIGHER VIBRATIONS THAN V=3
      DATA XSNG9/12.950,17.5,20.0,30.0,40.0,50.0,70.0,100.,150.,200.,
     /250.,300.,350.,400.,450.,500.,600.,700.,800.,900.,
     /1000.,1200.,1400.,1600.,1800.,2000.,2400.,2800.,3200.,3600.,
     /4000.,4500.,5000.,5500.,6000.,7000.,8000.,9000.,1.0D4,1.2D4,
     /1.4D4,1.6D4,2.0D4,2.5D4,3.0D4,4.0D4,5.0D4,6.0D4,7.0D4,8.0D4,
     /9.0D4,1.0D5,1.0D6,1.0D7/
      DATA YSNG9/0.0,.0103,.0228,.067,.086,.093,.102,.100,.091,.083,
     /.075,.069,.063,.059,.054,.052,.0440,.0392,.0352,.0320,
     /.0293,.0252,.0222,.0198,.0180,.0164,.0141,.0124,.0110,.00999,
     /.00911,.00824,.00752,.00690,.00640,.00563,.00500,.00451,.00411,
     /.00351,
     /.00308,.00273,.00224,.00182,.00156,.00121,9.89D-4,8.40D-4,
     /7.32D-4,6.45D-4,
     /5.83D-4,5.27D-4,1.8D-4,1.8D-4/
      DATA YSG9M/0.72,0.72,0.47,0.41,0.32,0.23,0.13,0.05,0.04,0.03,
     /.028,.025,.022,.020,.018,.016,.014,.012,.011,.010,
     /.009,.008,.007,.006,.0055,.005,.0046,.0042,.0038,.0034,
     /.0030,.0028,.0026,.0024,.0022,.0020,.0018,.0016,.0014,.0013,
     /.0012,.0011,.0010,.0009,.0008,.0007,.0006,.0005,.0004,.0003,
     /.0002,.00015,.00002,.000002/
C G3 PI (V=0-3) (V=0 ENERGY=12.810 EV) AVERAGE ENERGY LOSS=13.001 EV
      DATA XTRP13/13.001,17.5,20.0,23.0,26.0,30.0,40.0,50.0,70.0,100.,
     /200.,400.,1000.,10000.,1.D5,1.D6,1.D7/
      DATA YTRP13/.0,.0133,.0178,.0204,.0207,.0199,.0174,.0152,.0115,
     /.0065,
     /.0021,.0006,.00016,.00002,0.00,0.00,0.00/
      DATA YTP13M/0.74,0.74,0.73,0.72,0.71,0.69,0.61,0.53,0.47,0.40,
     /0.33,0.19,.091,.013,.002,0.00,0.00/
C C3 1PI ( V=0-3) V=0 ENERGY=12.912 AVERAGE ENERGY LOSS= 13.093 EV
C  USE DIPOLE FALL OFF WITH ENERGY ABOVE 500EV
      DATA XSNG10/13.093,17.5,20.0,30.0,40.0,50.0,70.0,100.,150.,200.,
     /250.,300.,350.,400.,450.,500.,600.,700.,800.,900.,
     /1000.,1200.,1400.,1600.,1800.,2000.,2400.,2800.,3200.,3600.,
     /4000.,4500.,5000.,5500.,6000.,7000.,8000.,9000.,1.0D4,1.2D4,
     /1.4D4,1.6D4,2.0D4,2.5D4,3.0D4,4.0D4,5.0D4,6.0D4,7.0D4,8.0D4,
     /9.0D4,1.0D5,1.0D6,1.0D7/
      DATA YSNG10/0.0,.0175,.040,.100,.102,.097,.084,.068,.053,.045,
     /.039,.035,.032,.030,.027,.026,.022,.0196,.0175,.0160,
     /.0146,.0126,.0111,.0100,.0090,.0082,.0070,.0062,.0055,.0050,
     /.0046,.0041,.0038,.0035,.0032,.0029,.0026,.0022,.00206,
     /.00175,
     /.00154,.00136,.00112,9.14D-4,7.79D-4,6.02D-4,4.94D-4,4.20D-4,
     /3.66D-4,3.22D-4,
     /2.92D-4,2.64D-4,9.0D-5,9.0D-5/
      DATA YSG10M/0.69,0.69,0.55,0.40,0.28,0.16,0.11,0.05,0.04,0.03,
     /.028,.025,.022,.020,.018,.016,.014,.012,.011,.010,
     /.009,.008,.007,.006,.0055,.005,.0046,.0042,.0038,.0034,
     /.0030,.0028,.0026,.0024,.0022,.0020,.0018,.0016,.0014,.0013,
     /.0012,.0011,.0010,.0009,.0008,.0007,.0006,.0005,.0004,.0003,
     /.0002,.00015,.000015,.0000015/
C F3 PI (V=0-3) (V=0 ENERGY=12.985 EV) AVERAGE ENERGY LOSS=13.174 EV
      DATA XTRP14/13.174,17.5,20.0,23.0,26.0,30.0,40.0,50.0,70.0,100.,
     /200.,400.,1000.,10000.,1.D5,1.D6,1.D7/
      DATA YTRP14/.0,.0062,.0091,.0129,.0140,.0136,.0119,.0102,.0074,
     /.0040,
     /.0014,.0004,.0001,.00001,0.00,0.00,0.00/
      DATA YTP14M/0.74,0.74,0.76,0.71,0.65,0.63,0.53,0.43,0.40,0.34,
     /0.29,0.19,.091,.013,.002,0.00,0.00/
C B! 1SIG (V=0-10) V=0 ENERGY=12.854 AVERAGE ENERGY LOSS= 13.371 EV
C  USE DIPOLE FALL OFF WITH ENERGY ABOVE 500EV
      DATA XSNG11/13.371,17.5,20.0,30.0,40.0,50.0,70.0,100.,150.,200.,
     /250.,300.,350.,400.,450.,500.,600.,700.,800.,900.,
     /1000.,1200.,1400.,1600.,1800.,2000.,2400.,2800.,3200.,3600.,
     /4000.,4500.,5000.,5500.,6000.,7000.,8000.,9000.,1.0D4,1.2D4,
     /1.4D4,1.6D4,2.0D4,2.5D4,3.0D4,4.0D4,5.0D4,6.0D4,7.0D4,8.0D4,
     /9.0D4,1.0D5,1.0D6,1.0D7/
      DATA YSNG11/0.0,.0156,.027,.037,.046,.048,.048,.046,.039,.035,
     /.031,.029,.027,.024,.0228,.0216,.0185,.0164,.0147,.0135,
     /.0123,.0106,.0093,.0084,.0075,.0069,.0059,.0052,.0047,.0043,
     /.0038,.0035,.0032,.0029,.0027,.0023,.0021,.0019,.00173,
     /.00147,
     /.00128,.00115,9.4D-4,7.6D-4,6.6D-4,5.1D-4,4.1D-4,3.5D-4,
     /3.1D-4,2.70D-4,
     /2.45D-4,2.21D-4,7.0D-5,7.0D-5/
      DATA YSG11M/0.81,0.81,0.71,0.47,0.33,0.20,0.15,0.09,0.05,0.04,
     /.030,.025,.022,.020,.018,.016,.014,.012,.011,.010,
     /.009,.008,.007,.006,.0055,.005,.0046,.0042,.0038,.0034,
     /.0030,.0028,.0026,.0024,.0022,.0020,.0018,.0016,.0014,.0013,
     /.0012,.0011,.0010,.0009,.0008,.0007,.0006,.0005,.0004,.0003,
     /.0002,.00015,.000015,.0000015/
C B1PI (V=7-14) (V=7 ENERGY=13.156 EV) AVERAGE ENERGY LOSS= 13.382 EV
C USE DIPOLE FALL OFF WITH ENERGY ABOVE 500EV
      DATA XSNG12/13.382,17.5,20.0,30.0,40.0,50.0,70.0,100.,150.,200.,
     /250.,300.,350.,400.,450.,500.,600.,700.,800.,900.,
     /1000.,1200.,1400.,1600.,1800.,2000.,2400.,2800.,3200.,3600.,
     /4000.,4500.,5000.,5500.,6000.,7000.,8000.,9000.,1.0D4,1.2D4,
     /1.4D4,1.6D4,2.0D4,2.5D4,3.0D4,4.0D4,5.0D4,6.0D4,7.0D4,8.0D4,
     /9.0D4,1.0D5,1.0D6,1.0D7/
      DATA YSNG12/0.0,.0120,.0288,.0571,.0582,.0550,.0478,.0387,.0304,
     /.0257,
     /.0225,.0201,.0186,.0169,.0156,.0148,.0126,.0112,.01007,.00916,
     /.00839,.00721,.00636,.00569,.00515,.00471,.00404,.00355,.00315,
     /.00286,
     /.00261,.00236,.00215,.00197,.00183,.00161,.00143,.00129,.00118,
     /.001005,
     /.000879,.000780,.000641,.000524,.000446,.000345,.000283,.000241,
     /.000210,.000185,
     /.000168,.000151,5.0D-5,5.0D-5/
      DATA YSG12M/0.76,0.76,0.67,0.46,0.34,0.22,0.13,0.05,0.04,0.03,
     /.028,.025,.022,.020,.018,.016,.014,.012,.011,.010,
     /.009,.008,.007,.006,.0055,.005,.0046,.0042,.0038,.0034,
     /.0030,.0028,.0026,.0024,.0022,.0020,.0018,.0016,.0014,.0013,
     /.0012,.0011,.0010,.0009,.0008,.0007,.0006,.0005,.0004,.0003,
     /.0002,.00015,.000015,.0000015/
C O3 1PI (V=0-3) (V=0 ENERGY=13.103 EV) AVERAGE ENERGY LOSS= 13.564 EV
C USE DIPOLE FALL OFF WITH ENERGY ABOVE 500EV
C SCALED X-SECTION BY 1.096 TO ALLOW FOR VIBRATIONS HIGHER THAN V=3
      DATA XSNG13/13.564,17.5,20.0,30.0,40.0,50.0,70.0,100.,150.,200.,
     /250.,300.,350.,400.,450.,500.,600.,700.,800.,900.,
     /1000.,1200.,1400.,1600.,1800.,2000.,2400.,2800.,3200.,3600.,
     /4000.,4500.,5000.,5500.,6000.,7000.,8000.,9000.,1.0D4,1.2D4,
     /1.4D4,1.6D4,2.0D4,2.5D4,3.0D4,4.0D4,5.0D4,6.0D4,7.0D4,8.0D4,
     /9.0D4,1.0D5,1.0D6,1.0D7/
      DATA YSNG13/0.0,.0140,.028,.055,.056,.053,.046,.037,.030,.024,
     /.021,.019,.018,.017,.015,.0140,.0123,.0108,.0097,.0089,
     /.0081,.0070,.0062,.0055,.0050,.0045,.0038,.0034,.0031,.0027,
     /.00251,.00228,.00210,.00193,.00175,.00157,.00141,.00123,.00114,
     /9.7D-4,
     /8.4D-4,7.5D-4,6.2D-4,5.1D-4,4.3D-4,3.3D-4,2.7D-4,2.3D-4,
     /2.0D-4,1.8D-4,
     /1.6D-4,1.5D-4,5.0D-5,5.0D-5/
      DATA YSG13M/0.86,0.86,0.77,0.60,0.45,0.30,0.19,0.08,0.05,0.04,
     /.030,.025,.022,.020,.018,.016,.014,.012,.011,.010,
     /.009,.008,.007,.006,.0055,.005,.0046,.0042,.0038,.0034,
     /.0030,.0028,.0026,.0024,.0022,.0020,.0018,.0016,.0014,.0013,
     /.0012,.0011,.0010,.0009,.0008,.0007,.0006,.0005,.0004,.0003,
     /.0002,.00015,.000015,.0000015/
C B! 1SIG (V=11-INF) (V=11 ENERGY=13.86 EV) AVERAGE ENERGY LOSS=14.0 EV
C  USE DIPOLE FALL OFF WITH ENERGY ABOVE 500EV
C  USE SCALING ( FRANK CONDON FACTORS) OF 91.75/8.25 FOR TRANSITION
C STRENGTH COMPARED TO THE B! 1SIG (V=0-10) X-SECTION
      DATA XSNG14/14.0,17.5,20.0,30.0,40.0,50.0,70.0,100.,150.,200.,
     /250.,300.,350.,400.,450.,500.,600.,700.,800.,900.,
     /1000.,1200.,1400.,1600.,1800.,2000.,2400.,2800.,3200.,3600.,
     /4000.,4500.,5000.,5500.,6000.,7000.,8000.,9000.,1.0D4,1.2D4,
     /1.4D4,1.6D4,2.0D4,2.5D4,3.0D4,4.0D4,5.0D4,6.0D4,7.0D4,8.0D4,
     /9.0D4,1.0D5,1.0D6,1.0D7/
      DATA YSNG14/0.0,.080,.229,.417,.507,.530,.534,.504,.439,.387,
     /.347,.317,.295,.275,.253,.241,.205,.182,.164,.150,
     /.137,.118,.1035,.0927,.0840,.0765,.0656,.0579,.0513,.0465,
     /.0424,.0385,.0350,.0322,.0298,.0263,.0233,.0210,.0192,
     /.0164,
     /.0143,.0127,.01044,.00852,.00726,.00561,.00461,.00391,.00340,
     /.00301,
     /.00273,.00245,8.0D-4,8.0D-4/
      DATA YSG14M/0.81,0.81,0.71,0.47,0.33,0.20,0.15,0.09,0.05,0.04,
     /.030,.025,.022,.020,.018,.016,.014,.012,.011,.010,
     /.009,.008,.007,.006,.0055,.005,.0046,.0042,.0038,.0034,
     /.0030,.0028,.0026,.0024,.0022,.0020,.0018,.0016,.0014,.0013,
     /.0012,.0011,.0010,.0009,.0008,.0007,.0006,.0005,.0004,.0003,
     /.0002,.00015,.000015,.0000015/
C SUM SINGLET (SUMMED SINGLETS ABOVE 14.2 EV)
      DATA XSNG15/14.2,14.5,15.0,16.0,17.0,18.0,20.0,22.0,25.0,30.0,
     /40.0,60.0,80.0,100.,150.,200.,250.,300.,500.,700.,
     /1000.,2000.,4000.,10000.,20000.,1.D5,1.D6,1.D7/
      DATA YSNG15/0.0,.037,.088,.133,.194,.240,.346,.442,.548,.682,
     /.811,.811,.774,.728,.613,.534,.485,.442,.341,.295,
     /.244,.129,.065,.028,.014,.0055,.0018,.0018/
      DATA YSG15M/0.81,0.81,0.81,0.81,0.81,0.79,0.71,0.65,0.59,0.47,
     /0.33,0.19,0.13,0.09,0.05,0.04,0.03,.025,.016,.012,
     /.009,.005,.003,.0014,.0010,.00015,.000015,.000001/
C RAP UP TO 100 EV THEN LINDSAY TO 1KEV THEN SCHRAM TO 20KEV
C ABOVE 20KEV USE MATRIX ELEMENTS COMPATIBLE WITH RIEKE AND BERKOWITZ
      DATA XION/15.581,16.0,16.5,17.0,17.5,18.0,18.5,19.0,19.5,20.0,
     /20.5,21.0,21.5,22.0,22.5,23.0,23.5,24.0,24.5,25.0,
     /25.5,26.0,28.0,30.0,32.0,34.0,36.0,38.0,40.0,45.0,
     /50.0,55.0,60.0,65.0,70.0,75.0,80.0,85.0,90.0,95.0,
     /100.,110.,120.,140.,160.,180.,200.,225.,250.,275.,
     /300.,350.,400.,450.,500.,550.,600.,650.,700.,750.,
     /800.,850.,900.,950.,1000.,1200.,1400.,1600.,1800.,2000.,
     /2500.,3000.,3500.,4000.,4500.,5000.,5500.,6000.,7000.,8000.,
     /9000.,10000.,12000.,14000.,16000.,18000.,20000./
C GROSS IONISATION
      DATA YION/0.00,.0211,.0466,.0713,.0985,.129,.164,.199,.230,.270,
     /.308,.344,.380,.418,.455,.492,.528,.565,.603,.640,
     /.677,.714,.875,1.03,1.15,1.27,1.38,1.49,1.57,1.78,
     /1.94,2.07,2.18,2.27,2.33,2.39,2.44,2.46,2.49,2.51,
     /2.51,2.50,2.48,2.45,2.36,2.28,2.19,2.08,1.98,1.89,
     /1.82,1.68,1.56,1.45,1.36,1.28,1.20,1.12,1.07,1.01,
     /.971,.936,.907,.879,.847,.728,.649,.585,.534,.491,
     /.408,.351,.310,.280,.255,.233,.217,.200,.178,.159,
     /.144,.132,.113,.0998,.0898,.0824,.0752/
C COUNTING IONISATION
      DATA YINC/0.00,.0211,.0466,.0713,.0985,.129,.164,.199,.230,.270,
     /.308,.344,.380,.418,.455,.492,.528,.565,.603,.640,
     /.677,.714,.875,1.03,1.15,1.27,1.38,1.49,1.57,1.78,
     /1.94,2.07,2.18,2.27,2.33,2.39,2.44,2.46,2.49,2.51,
     /2.51,2.49,2.47,2.44,2.35,2.26,2.17,2.06,1.97,1.88,
     /1.81,1.67,1.55,1.44,1.35,1.27,1.19,1.11,1.06,1.00,
     /.965,.931,.902,.874,.842,.724,.645,.581,.531,.488,
     /.405,.349,.308,.278,.253,.231,.215,.198,.176,.157,
     /.143,.131,.112,.0988,.0889,.0816,.0745/
C  *********************************************************************
C  NITROGEN UPDATE 2008.
C  USED ELECTRON SCATTERING DATA PUBLISHED UP TO DECEMBER 2008.
C  VIBRATIONAL X-SECTIONS MAINLY FROM ALLAN AND ALSO VICIC
C  ALLAN    J.PHYS.B 18(1985) 4511
C  VICIC    J.PHYS.B 29(1996) 1273
C  ELASTIC FROM ALLAN , ITIKAWA(REVIEW) ,SUN AND ALSO MUSE
C  ALLAN     J.PHYS.B 38(2005) 3655
C  ITIKAWA   J.PHYS.CHEM.REF DATA 35(2006)31
C  SUN       PHYS.REV 52A(1995)1229
C  MUSE      J.PHYS.B 41(2008)095203
C EXCITATION FROM ITIKAWA (REVIEW) AND KHAKOO
C  KHAKOO    PHYS.REV A 77(2008)012704
C  KHAKOO    PHYS.REV A 71(2005)062703
C  IONISATION FROM RAP , LINDSAY, SCHRAM, RIEKE AND BERKOWITZ
C  RAP       J.CHEM.PHYS 43(1965)1464
C  LINDSAY   LLANDOLT-BORNSTEIN I/17C
C  SCHRAM    PHYSICA 31(1965)94
C  RIEKE     PHYS REV 6A (1972)1507
C  BERKOWITZ PHOTOABSORPTION ,PHOTOIONISATION SPECTROSCOPY
C
C  ROTATIONAL X-SECTIONS FROM QUADRUPOLE BORN APPROX. WITH TABULATED
C  VALUES FOR THE RESONANCE ENHANCEMENT.
C  INELASTIC X-SECTIONS ARE MAINLY FROM KHAKOO FOR LEVELS BELOW 14.0EV
C USED FRANK-CONDON FACTORS TO WEIGHT THE VIBRATION-EXCITATION LEVELS
C AND ADJUSTED THRESHOLDS TO GIVE CORRECT AVERAGE ENERGY LOSS.
C  THE REMAINING LEVEL STRENGTH IS IN THE EFFECTIVE SINGLET LEVEL
C  AT 14.2EV . THE 14.2 EV LEVEL WAS MADE TO BE CONSISTENT WITH
C  THE TOTAL LEVEL SUM FROM PITCHFORD AND PHELPS AND GIVES ACCURATE
C  FANO FACTORS
C THE TOTAL X-SECTION BELOW 50 EV IS WITHIN 1% OF THE EXPERIMENTAL VALUE
C OF KENNERLEY. ABOVE 50EV IS WITHIN 1% OF REVIEW BY ITIKAWA.
C TOTAL ELASTIC AND ELASTIC MOMENTUM TRANSFER X-SECTION ARE ADJUSTED TO
C FIT DATA IN MIXTURES:
C                    NEON /NITROGEN   VD                 ROBERTSON
C                   ARGON /NITROGEN   VD                 HADDAD
C             PURE  NITROGEN          VD   DT  DL  AND ALPHA
C LOW FIELD NITROGEN DATA  VD AND DT FROM LOWKE AND HUXLEY AND CROMPTON.
C
C   HIGH FIELD NITROGEN DATA VD AND DL FROM HASEGAWA
C  FIT TO DRIFT AND DIFFUSION DATA BETTER THAN 1% ACCURACY.
C
C   TOWNSEND COEFICIENT FROM COMPILATION BY DUTTON.
C
C***********************************************************************
C---------------------------------------------------------------------
      IF(NANISO.EQ.0) THEN
       NAME=' N2 2008   ISO '
      ELSE IF(NANISO.EQ.1) THEN
       NAME='N2 2008 ANISO  '
      ELSE IF(NANISO.EQ.2) THEN
       NAME='N2 2008 ANISO  '
      ENDIF
C    --------------------------------------------------------------
C BORN BETHE VALUES FOR COUNTING IONISATION
      CONST=1.873884D-20
      EMASS2=1021997.804
      AM2=3.35
      C=38.1
C ANGULAR DISTRIBUTIONS OF ELASTIC AND IONISATION CAN BE EITHER
C ISOTROPIC (KEL=0) OR
C CAPITELLI-LONGO (KEL =1)  OR OKHRIMOVSKKY TYPES (KEL=2)
      NIN=121
      DO 1 J=1,6
    1 KEL(J)=NANISO
C USE ISOTROPIC SCATTERING FOR ROTATIONAL AND VIBRATIONAL STATES
      DO 2 J=1,92
    2 KIN(J)=0
C USE ANISOTROPIC SCATTERING FOR EXCITED STATES .
C ANGULAR DISTRIBUTIONS ARE CAPITELLI-LONGO (FORWARD BACKWARD ASYMMETRY)
      DO 20 J=93,121
   20 KIN(J)=1
C
      NELA=184
      NROT=70
      NVIB1=91
      NVIB2=73
      NVIB3=74
      NVIB4=54
      NVIB5=44
      NVIB6=45
      NVIB7=46
      NVIB8=44
      NVIB9=39
      NVIB10=39
      NVIB11=39
      NVIB12=37
      NVIB13=35
      NVIB14=32
      NVIB15=36
      NTRP1=30
      NTRP2=30
      NTRP3=28
      NTRP4=29
      NTRP5=30
      NTRP6=28
      NTRP7=28
      NTRP8=28
      NTRP9=27
      NTRP10=27
      NTRP11=26
      NTRP12=29
      NTRP13=17
      NTRP14=17
      NSNG1=33
      NSNG2=24
      NSNG3=24
      NSNG4=33
      NSNG5=24
      NSNG6=23
      NSNG7=19
      NSNG8=54
      NSNG9=54
      NSNG10=54
      NSNG11=54
      NSNG12=54
      NSNG13=54
      NSNG14=54
      NSNG15=28
      NION=87
      E(1)=0.0
      E(2)=2.0*EMASS/(27.7940*AMU)
      E(3)=15.581
C EXCITATION X-SECTION AT 1.4 MEV
      E(4)=0.0032D-16
C IONISATION X-SECTION AT 1.4MEV
      E(5)=0.008795D-16
C OPAL BEATY IONISATION ENERGY SPLITTING AT 1.4MEV
      E(6)=13.8
C OPAL BEATY IONISATION ENERGY SPLITTING AT LOW ENERGY
      EOBY=13.0
C CALC FRACTIONAL POPULATION DENSITY FOR ROTATIONAL STATES
      B0=2.4668D-4
      A0=0.5291772083D-8
C ROTATIONAL QUADRUPOLE MOMENT
      QBQA=1.045
      QBK=1.67552*(QBQA*A0)**2
      DO 3 K=1,39,2
      AK=DFLOAT(K)
    3 PJ(K)=3.0*(2.0*AK+1.0)*DEXP(-AK*(AK+1.0)*B0/AKT)
      DO 4 K=2,38,2
      AK=DFLOAT(K)
    4 PJ(K)=6.0*(2.0*AK+1.0)*DEXP(-AK*(AK+1.0)*B0/AKT)
      SUM=6.0
      DO 5 K=1,39
    5 SUM=SUM+PJ(K)
      FROT0=6.0/SUM
      DO 6 K=1,39
    6 PJ(K)=PJ(K)/SUM
C CALC ROTATIONAL TRANSITION ENERGIES
      DO 7 K=1,38
      J=K-1
      AJ=DFLOAT(J)
      EIN(K+38)=B0*(4.0*AJ+6.0)
    7 EIN(K)=-EIN(K+38)
      EIN(77)=-0.2889
      EIN(78)=0.2889
      EIN(79)=0.5742
      EIN(80)=0.8559
      EIN(81)=1.1342
      EIN(82)=1.4088
      EIN(83)=1.6801
      EIN(84)=1.9475
      EIN(85)=2.2115
      EIN(86)=2.4718
      EIN(87)=2.7284
      EIN(88)=2.9815
      EIN(89)=3.2310
      EIN(90)=3.4769
      EIN(91)=3.7191
      EIN(92)=3.9576
      EIN(93)=6.725
      EIN(94)=7.360
      EIN(95)=7.744
      EIN(96)=8.050
      EIN(97)=8.217
      EIN(98)=8.451
      EIN(99)=8.729
      EIN(100)=8.950
      EIN(101)=8.974
      EIN(102)=9.191
      EIN(103)=9.562
      EIN(104)=9.590
      EIN(105)=9.665
      EIN(106)=9.933
      EIN(107)=10.174
      EIN(108)=10.536
      EIN(109)=11.188
      EIN(110)=11.875
      EIN(111)=12.289
      EIN(112)=12.771
      EIN(113)=12.950
      EIN(114)=13.001
      EIN(115)=13.093
      EIN(116)=13.174
      EIN(117)=13.371
      EIN(118)=13.382
      EIN(119)=13.564
      EIN(120)=14.0
      EIN(121)=14.2
C OFFSET ENERGY FOR IONISATION ELECTRON ANGULAR DISTRIBUTION
      IOFF=IFIX(SNGL(0.5+E(3)/ESTEP))
C
C**********************************************************************
C ENTER PENNING TRANSFER FRACTION FOR EACH LEVEL
C  SET PENNING TRANSFER FRACTION TO ZERO FOR LOW ENERGY LEVELS
      DO 8 K=1,106
      DO 8 L=1,3
    8 PENFRA(L,K)=0.0
C-----------------------------------------------------------
C PENNING TRANSFER FRACTION FOR LEVELS ABOVE 10 EV
      DO 9 K=107,121
      PENFRA(1,K)=0.0
C PENNING TRANSFER DISTANCE IN MICRONS
      PENFRA(2,K)=1.0
C PENNING TRANSFER TIME IN PICOSECONDS
      PENFRA(3,K)=1.0
      IF(IPEN.EQ.0) GO TO 9
      WRITE(6,999) NAME,EIN(K),PENFRA(1,K),PENFRA(2,K),PENFRA(3,K)
  999 FORMAT(' GAS = ',A15,' ENERGY LEVEL = ',F7.4,' EV.',/,' PENNING PR
     /OBABILITY = ',F5.3,' ABS.LENGTH = ',F7.2,' DECAY TIME = ',F7.1,/)
    9 CONTINUE
C**********************************************************************
      SCRPT(1)='                              '
      IF(NANISO.EQ.0) THEN
       SCRPT(2)=' ELASTIC  ISOTROPIC NITROGEN  '
      ELSE IF(NANISO.EQ.1) THEN
       SCRPT(2)=' ELASTIC ANISOTROPIC CAP/LONGO'
      ELSE
       SCRPT(2)=' ELASTIC ANISOTROPIC NITROGEN '
      ENDIF
      SCRPT(3)=' IONISATION    ELOSS= 15.581  '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' ROT 2-0       ELOSS= -0.00148'
      SCRPT(8)=' ROT 3-1       ELOSS= -0.00247'
      SCRPT(9)=' ROT 4-2       ELOSS= -0.00345'
      SCRPT(10)=' ROT 5-3       ELOSS= -0.00444'
      SCRPT(11)=' ROT 6-4       ELOSS= -0.00543'
      SCRPT(12)=' ROT 7-5       ELOSS= -0.00641'
      SCRPT(13)=' ROT 8-6       ELOSS= -0.00740'
      SCRPT(14)=' ROT 9-7       ELOSS= -0.00839'
      SCRPT(15)=' ROT 10-8      ELOSS= -0.00937'
      SCRPT(16)=' ROT 11-9      ELOSS= -0.0104 '
      SCRPT(17)=' ROT 12-10     ELOSS= -0.0113 '
      SCRPT(18)=' ROT 13-11     ELOSS= -0.0123 '
      SCRPT(19)=' ROT 14-12     ELOSS= -0.0133 '
      SCRPT(20)=' ROT 15-13     ELOSS= -0.0143 '
      SCRPT(21)=' ROT 16-14     ELOSS= -0.0153 '
      SCRPT(22)=' ROT 17-15     ELOSS= -0.0163 '
      SCRPT(23)=' ROT 18-16     ELOSS= -0.0173 '
      SCRPT(24)=' ROT 19-17     ELOSS= -0.0183 '
      SCRPT(25)=' ROT 20-18     ELOSS= -0.0192 '
      SCRPT(26)=' ROT 21-19     ELOSS= -0.0202 '
      SCRPT(27)=' ROT 22-20     ELOSS= -0.0212 '
      SCRPT(28)=' ROT 23-21     ELOSS= -0.0222 '
      SCRPT(29)=' ROT 24-22     ELOSS= -0.0232 '
      SCRPT(30)=' ROT 25-23     ELOSS= -0.0242 '
      SCRPT(31)=' ROT 26-24     ELOSS= -0.0252 '
      SCRPT(32)=' ROT 27-25     ELOSS= -0.0261 '
      SCRPT(33)=' ROT 28-26     ELOSS= -0.0271 '
      SCRPT(34)=' ROT 29-27     ELOSS= -0.0281 '
      SCRPT(35)=' ROT 30-28     ELOSS= -0.0291 '
      SCRPT(36)=' ROT 31-29     ELOSS= -0.0301 '
      SCRPT(37)=' ROT 32-30     ELOSS= -0.0311 '
      SCRPT(38)=' ROT 33-31     ELOSS= -0.0321 '
      SCRPT(39)=' ROT 34-32     ELOSS= -0.0331 '
      SCRPT(40)=' ROT 35-33     ELOSS= -0.0340 '
      SCRPT(41)=' ROT 36-34     ELOSS= -0.0350 '
      SCRPT(42)=' ROT 37-35     ELOSS= -0.0360 '
      SCRPT(43)=' ROT 38-36     ELOSS= -0.0370 '
      SCRPT(44)=' ROT 39-37     ELOSS= -0.0380 '
      SCRPT(45)=' ROT 0-2       ELOSS=  0.00148'
      SCRPT(46)=' ROT 1-3       ELOSS=  0.00247'
      SCRPT(47)=' ROT 2-4       ELOSS=  0.00345'
      SCRPT(48)=' ROT 3-5       ELOSS=  0.00444'
      SCRPT(49)=' ROT 4-6       ELOSS=  0.00543'
      SCRPT(50)=' ROT 5-7       ELOSS=  0.00641'
      SCRPT(51)=' ROT 6-8       ELOSS=  0.00740'
      SCRPT(52)=' ROT 7-9       ELOSS=  0.00839'
      SCRPT(53)=' ROT 8-10      ELOSS=  0.00937'
      SCRPT(54)=' ROT 9-11      ELOSS=  0.0104 '
      SCRPT(55)=' ROT 10-12     ELOSS=  0.0113 '
      SCRPT(56)=' ROT 11-13     ELOSS=  0.0123 '
      SCRPT(57)=' ROT 12-14     ELOSS=  0.0133 '
      SCRPT(58)=' ROT 13-15     ELOSS=  0.0143 '
      SCRPT(59)=' ROT 14-16     ELOSS=  0.0153 '
      SCRPT(60)=' ROT 15-17     ELOSS=  0.0163 '
      SCRPT(61)=' ROT 16-18     ELOSS=  0.0173 '
      SCRPT(62)=' ROT 17-19     ELOSS=  0.0183 '
      SCRPT(63)=' ROT 18-20     ELOSS=  0.0192 '
      SCRPT(64)=' ROT 19-21     ELOSS=  0.0202 '
      SCRPT(65)=' ROT 20-22     ELOSS=  0.0212 '
      SCRPT(66)=' ROT 21-23     ELOSS=  0.0222 '
      SCRPT(67)=' ROT 22-24     ELOSS=  0.0232 '
      SCRPT(68)=' ROT 23-25     ELOSS=  0.0242 '
      SCRPT(69)=' ROT 24-26     ELOSS=  0.0252 '
      SCRPT(70)=' ROT 25-27     ELOSS=  0.0261 '
      SCRPT(71)=' ROT 26-28     ELOSS=  0.0271 '
      SCRPT(72)=' ROT 27-29     ELOSS=  0.0281 '
      SCRPT(73)=' ROT 28-30     ELOSS=  0.0291 '
      SCRPT(74)=' ROT 29-31     ELOSS=  0.0301 '
      SCRPT(75)=' ROT 30-32     ELOSS=  0.0311 '
      SCRPT(76)=' ROT 31-33     ELOSS=  0.0321 '
      SCRPT(77)=' ROT 32-34     ELOSS=  0.0331 '
      SCRPT(78)=' ROT 33-35     ELOSS=  0.0340 '
      SCRPT(79)=' ROT 34-36     ELOSS=  0.0350 '
      SCRPT(80)=' ROT 35-37     ELOSS=  0.0360 '
      SCRPT(81)=' ROT 36-38     ELOSS=  0.0370 '
      SCRPT(82)=' ROT 37-39     ELOSS=  0.0380 '
      SCRPT(83)=' VIB V1        ELOSS= -0.2889 '
      SCRPT(84)=' VIB V1        ELOSS=  0.2889 '
      SCRPT(85)=' VIB 2V1       ELOSS=  0.5742 '
      SCRPT(86)=' VIB 3V1       ELOSS=  0.8559 '
      SCRPT(87)=' VIB 4V1       ELOSS=  1.1342 '
      SCRPT(88)=' VIB 5V1       ELOSS=  1.4088 '
      SCRPT(89)=' VIB 6V1       ELOSS=  1.6801 '
      SCRPT(90)=' VIB 7V1       ELOSS=  1.9475 '
      SCRPT(91)=' VIB 8V1       ELOSS=  2.2115 '
      SCRPT(92)=' VIB 9V1       ELOSS=  2.4718 '
      SCRPT(93)=' VIB 10V1      ELOSS=  2.7284 '
      SCRPT(94)=' VIB 11V1      ELOSS=  2.9815 '
      SCRPT(95)=' VIB 12V1      ELOSS=  3.2310 '
      SCRPT(96)=' VIB 13V1      ELOSS=  3.4769 '
      SCRPT(97)=' VIB 14V1      ELOSS=  3.7191 '
      SCRPT(98)=' VIB 15V1      ELOSS=  3.9576 '
      SCRPT(99)=' A3SIG V=0-4   ELOSS=  6.725  '
      SCRPT(100)=' A3SIG V=5-9   ELOSS=  7.360  '
      SCRPT(101)=' B 3PI V=0-3   ELOSS=  7.744  '
      SCRPT(102)=' W3DEL V=0-5   ELOSS=  8.050  '
      SCRPT(103)=' A3SIG V=10-21 ELOSS=  8.217  '
      SCRPT(104)=' B 3PI V=4-16  ELOSS=  8.451  '
      SCRPT(105)=' W3DEL V=6-10  ELOSS=  8.729  '
      SCRPT(106)=' A 1PI  V=0-3  ELOSS=  8.950  '
      SCRPT(107)=' B!3SIG V=0-6  ELOSS=  8.974  '
      SCRPT(108)=' A!1SIG V=0-6  ELOSS=  9.191  '
      SCRPT(109)=' W3DEL V=11-19 ELOSS=  9.562  '
      SCRPT(110)=' W 1DEL V=0-5  ELOSS=  9.590  '
      SCRPT(111)=' A 1PI  V=4-15 ELOSS=  9.665  '
      SCRPT(112)=' B!3SIG V=7-18 ELOSS=  9.933  '
      SCRPT(113)=' A!1SIG V=7-19 ELOSS= 10.174  '
      SCRPT(114)=' W 1DEL V=6-18 ELOSS= 10.536  '
      SCRPT(115)=' C 3PI V=0-4   ELOSS= 11.188  '
      SCRPT(116)=' E 3SIG        ELOSS= 11.875  '
      SCRPT(117)=' A!!1SIG V=0-1 ELOSS= 12.289  '
      SCRPT(118)=' B 1PI V=0-6   ELOSS= 12.771  '
      SCRPT(119)=' C!1SIG V=0-3  ELOSS= 12.950  '
      SCRPT(120)=' G 3PI V=0-3   ELOSS= 13.001  '
      SCRPT(121)=' C3 1PI V=0-3  ELOSS= 13.093  '
      SCRPT(122)=' F 3PI V=0-3   ELOSS= 13.174  '
      SCRPT(123)=' B!1SIG V=0-10 ELOSS= 13.371  '
      SCRPT(124)=' B 1PI V=7-14  ELOSS= 13.382  '
      SCRPT(125)=' O3 1PI V=0-3  ELOSS= 13.564  '
      SCRPT(126)=' B!1SIG V=10-H ELOSS= 14.0    '
      SCRPT(127)=' SUM SINGLETS  ELOSS= 14.2    '
C CALC VIBRATIONAL LEVEL V1 POPULATION
      APOPV1=DEXP(EIN(77)/AKT)
      APOPGS=1.0
      APOPSUM=APOPGS+APOPV1
      APOPV1=APOPV1/APOPSUM
      APOPGS=APOPGS/APOPSUM
C  RENORMALISE GROUND STATE TO ALLOW FOR EXCITATION FROM
C  THE EXCITED VIBRATIONAL STATE
      APOPGS=1.0
C
      EN=-ESTEP/2.0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
C
C ELASTIC (+ROTATIONAL)
      DO 10 J=2,NELA
      IF(EN.LE.XELA(J)) GO TO 15
   10 CONTINUE
      J=NELA
   15 A=(YELA(J)-YELA(J-1))/(XELA(J)-XELA(J-1))
      B=(XELA(J-1)*YELA(J)-XELA(J)*YELA(J-1))/(XELA(J-1)-XELA(J))
C ELASTIC
      QELA=(A*EN+B)*1.0D-16
      A=(YMOM(J)-YMOM(J-1))/(XELA(J)-XELA(J-1))
      B=(XELA(J-1)*YMOM(J)-XELA(J)*YMOM(J-1))/(XELA(J-1)-XELA(J))
C  MOMENTUM TRANSFER
      QMOM=(A*EN+B)*1.0D-16
      A=(YEPS(J)-YEPS(J-1))/(XELA(J)-XELA(J-1))
      B=(XELA(J-1)*YEPS(J)-XELA(J)*YEPS(J-1))/(XELA(J-1)-XELA(J))
C ANISOTROPY FUNCTIONS
      PQ2=(A*EN+B)
      PQ1=0.5+(QELA-QMOM)/QELA
      IF(NANISO.EQ.0) PEQEL(2,I)=0.5
      IF(NANISO.EQ.1) PEQEL(2,I)=PQ1
      IF(NANISO.EQ.2) PEQEL(2,I)=PQ2
      Q(2,I)=QELA
      IF(NANISO.EQ.0) Q(2,I)=QMOM
C GROSS IONISATION
      Q(3,I)=0.0
      PEQEL(3,I)=0.5
      IF(NANISO.EQ.2) PEQEL(3,I)=0.0
      IF(EN.LT.E(3)) GO TO 43
      IF(EN.GT.XION(NION)) GO TO 41
      DO 30 J=2,NION
      IF(EN.LE.XION(J)) GO TO 40
   30 CONTINUE
      J=NION
   40 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
      GO TO 42
C USE BORN BETHE X-SECTION ABOVE  XION(NION) EV
   41 GAMMA=(EMASS2+2.0D0*EN)/EMASS2
      BETA=DSQRT(1.0D0-1.0D0/(GAMMA*GAMMA))
      BETA2=BETA*BETA
      X2=1.0D0/BETA2
      X1=X2*DLOG(BETA2/(1.0D0-BETA2))-1.0D0
      Q(3,I)=CONST*(AM2*X1+C*X2)/0.991
   42 CONTINUE
C USE ANISOTROPIC SCATTERING FOR PRIMARY IONISATION ELECTRON AT
C ENERGIES ABOVE 2 * IONISATION ENERGY
C ANISOTROPIC ANGULAR DISRIBUTION SAME AS ELASTIC ANGULAR DISTRIBUTION
C AT AN ENERGY OFFSET BY THE IONISATION ENERGY
      IF(EN.LE.(2.0*E(3))) GO TO 43
      PEQEL(3,I)=PEQEL(2,(I-IOFF))
C ATTACHMENT X-SECTION SET TO 0.0
   43 Q(4,I)=0.0
C COUNTING IONISATION
      Q(5,I)=0.0
      PEQEL(5,I)=0.5
      IF(NANISO.EQ.2) PEQEL(5,I)=0.0
      IF(EN.LE.E(3)) GO TO 48
      IF(EN.GT.XION(NION)) GO TO 46
      DO 44 J=2,NION
      IF(EN.LE.XION(J)) GO TO 45
   44 CONTINUE
      J=NION
   45 A=(YINC(J)-YINC(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YINC(J)-XION(J)*YINC(J-1))/(XION(J-1)-XION(J))
      Q(5,I)=(A*EN+B)*1.D-16
      GO TO 47
C USE BORN BETHE X-SECTION ABOVE XION(NION) EV
   46 Q(5,I)=CONST*(AM2*X1+C*X2)
   47 CONTINUE
C USE ANISOTROPIC SCATTERING FOR PRIMARY IONISATION ELECTRON AT
C ENERGIES ABOVE 2 * IONISATION ENERGY
C ANISOTROPIC ANGULAR DISRIBUTION SAME AS ELASTIC ANGULAR DISTRIBUTION
C AT AN ENERGY OFFSET BY THE IONISATION ENERGY
      IF(EN.LE.(2.0*E(3))) GO TO 48
      PEQEL(5,I)=PEQEL(2,(I-IOFF))
   48 CONTINUE
      Q(6,I)=0.0
C---------------------------------------------------------------------
C  QUADRUPOLE BORN ROTATIONAL STATES  ( GERJUOY AND STEIN)
C---------------------------------------------------------------------
C
C  SUPERELASTIC ROTATION
C
      DO 53 K=1,38
      QIN(K,I)=0.0
      IF(EN.LE.0.0) GO TO 53
      AJ=DFLOAT(K+1)
      QIN(K,I)=PJ(K+1)*QBK*DSQRT(1.0-EIN(K)/EN)*AJ*(AJ-1.0)/((2.0*AJ+1.0
     /)*(2.0*AJ-1.0))
C CALCULATE ENHANCEMENT OF ROTATIONAL XSEC IN THE RESONANCE REGION
      DO 51 L=1,NROT
      IF((EN-EIN(K)).LE.XROT(L)) GO TO 52
   51 CONTINUE
      L=NROT
   52 A=(YROT(L)-YROT(L-1))/(XROT(L)-XROT(L-1))
      B=(XROT(L-1)*YROT(L)-XROT(L)*YROT(L-1))/(XROT(L-1)-XROT(L))
      RESFAC=(EN-EIN(K))*(A*(EN-EIN(K))+B)/EN
C USE 30% FOR RESFAC
      RESFAC=RESFAC*0.3
C BORN ROTATIONAL X-SEC SUM IN RESONANCE REGION = 0.249
      RESFAC=1.0+RESFAC/0.249
   53 QIN(K,I)=QIN(K,I)*RESFAC
C
C  INELASTIC ROTATION
C
C CALCULATE ENHANCEMENT OF ROTATIONAL XSEC IN THE RESONANCE REGION
   54 DO 55 K=39,76
   55 QIN(K,I)=0.0
      IF(EN.LE.0.0) GO TO 80
      DO 56 L=1,NROT
      IF(EN.LE.XROT(L)) GO TO 57
   56 CONTINUE
      L=NROT
   57 A=(YROT(L)-YROT(L-1))/(XROT(L)-XROT(L-1))
      B=(XROT(L-1)*YROT(L)-XROT(L)*YROT(L-1))/(XROT(L-1)-XROT(L))
      RESFAC=A*EN+B
C USE 30% FOR RESFAC
      RESFAC=RESFAC*0.3
C BORN ROTATIONAL X-SEC SUM IN RESONANCE REGION = 0.249
      RESFAC=1.0+RESFAC/0.249
C  ROT 0-2
      IF(EN.LE.EIN(39)) GO TO 80
      QIN(39,I)=FROT0*QBK*DSQRT(1.0-EIN(39)/EN)*2.0/3.0
      QIN(39,I)=QIN(39,I)*RESFAC
C ROT 1-3 AND HIGHER
      DO 58 K=40,76
      AJ=DFLOAT(K-39)
      IF(EN.LE.EIN(K)) GO TO 80
      QIN(K,I)=PJ(K-39)*QBK*DSQRT(1.0-EIN(K)/EN)*(AJ+2.0)*(AJ+1.0)/((2.0
     /*AJ+3.0)*(2.0*AJ+1.0))
   58 QIN(K,I)=QIN(K,I)*RESFAC
C  FORCE ROTATIONAL X-SEC TO FALL AT SAME RATE AS THE
C  ELASTIC X-SECTION ABOVE 5.0 EV
   60 IF(EN.LT.5.0) GO TO 80
      ASCALE=QMOM/8.90D-16
      DO 70 K=1,76
   70 QIN(K,I)=QIN(K,I)*ASCALE
   80 CONTINUE
C---------------------------------------------------------------------
C  VIBRATIONAL AND EXCITATION X-SECTIONS
C---------------------------------------------------------------------
C  V1 SUPERELASTIC
      QIN(77,I)=0.0
      IF(EN.LE.0.0) GO TO 87
      DO 85 J=2,NVIB1
      IF((EN-EIN(77)).LE.XVB1(J)) GO TO 86
   85 CONTINUE
      J=NVIB1
   86 A=(YVB1(J)-YVB1(J-1))/(XVB1(J)-XVB1(J-1))
      B=(XVB1(J-1)*YVB1(J)-XVB1(J)*YVB1(J-1))/(XVB1(J-1)-XVB1(J))
      QIN(77,I)=(EN-EIN(77))*(A*(EN-EIN(77))+B)/EN
      QIN(77,I)=APOPV1*QIN(77,I)*1.D-16
   87 CONTINUE
C  V1
      QIN(78,I)=0.0
      IF(EN.LE.EIN(78)) GO TO 110
      DO 90 J=2,NVIB1
      IF(EN.LE.XVB1(J)) GO TO 100
   90 CONTINUE
      J=NVIB1
  100 A=(YVB1(J)-YVB1(J-1))/(XVB1(J)-XVB1(J-1))
      B=(XVB1(J-1)*YVB1(J)-XVB1(J)*YVB1(J-1))/(XVB1(J-1)-XVB1(J))
      QIN(78,I)=APOPGS*(A*EN+B)*1.D-16
  110 CONTINUE
C  2V1
      QIN(79,I)=0.0
      IF(EN.LE.EIN(79)) GO TO 140
      DO 120 J=2,NVIB2
      IF(EN.LE.XVB2(J)) GO TO 130
  120 CONTINUE
      J=NVIB2
  130 A=(YVB2(J)-YVB2(J-1))/(XVB2(J)-XVB2(J-1))
      B=(XVB2(J-1)*YVB2(J)-XVB2(J)*YVB2(J-1))/(XVB2(J-1)-XVB2(J))
      QIN(79,I)=APOPGS*(A*EN+B)*1.D-16
  140 CONTINUE
C  3V1
      QIN(80,I)=0.0
      IF(EN.LE.EIN(80)) GO TO 170
      DO 150 J=2,NVIB3
      IF(EN.LE.XVB3(J)) GO TO 160
  150 CONTINUE
      J=NVIB3
  160 A=(YVB3(J)-YVB3(J-1))/(XVB3(J)-XVB3(J-1))
      B=(XVB3(J-1)*YVB3(J)-XVB3(J)*YVB3(J-1))/(XVB3(J-1)-XVB3(J))
      QIN(80,I)=APOPGS*(A*EN+B)*1.D-16
  170 CONTINUE
C 4V1
      QIN(81,I)=0.0
      IF(EN.LE.EIN(81)) GO TO 200
      DO 180 J=2,NVIB4
      IF(EN.LE.XVB4(J)) GO TO 190
  180 CONTINUE
      J=NVIB4
  190 A=(YVB4(J)-YVB4(J-1))/(XVB4(J)-XVB4(J-1))
      B=(XVB4(J-1)*YVB4(J)-XVB4(J)*YVB4(J-1))/(XVB4(J-1)-XVB4(J))
      QIN(81,I)=APOPGS*(A*EN+B)*1.D-16
  200 CONTINUE
C 5V1
      QIN(82,I)=0.0
      IF(EN.LE.EIN(82)) GO TO 230
      DO 210 J=2,NVIB5
      IF(EN.LE.XVB5(J)) GO TO 220
  210 CONTINUE
      J=NVIB5
  220 A=(YVB5(J)-YVB5(J-1))/(XVB5(J)-XVB5(J-1))
      B=(XVB5(J-1)*YVB5(J)-XVB5(J)*YVB5(J-1))/(XVB5(J-1)-XVB5(J))
      QIN(82,I)=APOPGS*(A*EN+B)*1.D-16
  230 CONTINUE
C 6V1
      QIN(83,I)=0.0
      IF(EN.LE.EIN(83)) GO TO 260
      DO 240 J=2,NVIB6
      IF(EN.LE.XVB6(J)) GO TO 250
  240 CONTINUE
      J=NVIB6
  250 A=(YVB6(J)-YVB6(J-1))/(XVB6(J)-XVB6(J-1))
      B=(XVB6(J-1)*YVB6(J)-XVB6(J)*YVB6(J-1))/(XVB6(J-1)-XVB6(J))
      QIN(83,I)=APOPGS*(A*EN+B)*1.D-16
  260 CONTINUE
C 7V1
      QIN(84,I)=0.0
      IF(EN.LE.EIN(84)) GO TO 330
      DO 310 J=2,NVIB7
      IF(EN.LE.XVB7(J)) GO TO 320
  310 CONTINUE
      J=NVIB7
  320 A=(YVB7(J)-YVB7(J-1))/(XVB7(J)-XVB7(J-1))
      B=(XVB7(J-1)*YVB7(J)-XVB7(J)*YVB7(J-1))/(XVB7(J-1)-XVB7(J))
      QIN(84,I)=APOPGS*(A*EN+B)*1.D-16
  330 CONTINUE
C 8V1
      QIN(85,I)=0.0
      IF(EN.LE.EIN(85)) GO TO 360
      DO 340 J=2,NVIB8
      IF(EN.LE.XVB8(J)) GO TO 350
  340 CONTINUE
      J=NVIB8
  350 A=(YVB8(J)-YVB8(J-1))/(XVB8(J)-XVB8(J-1))
      B=(XVB8(J-1)*YVB8(J)-XVB8(J)*YVB8(J-1))/(XVB8(J-1)-XVB8(J))
      QIN(85,I)=APOPGS*(A*EN+B)*1.D-16
  360 CONTINUE
C 9V1
      QIN(86,I)=0.0
      IF(EN.LE.EIN(86)) GO TO 2030
      DO 2010 J=2,NVIB9
      IF(EN.LE.XVB9(J)) GO TO 2020
 2010 CONTINUE
      J=NVIB9
 2020 A=(YVB9(J)-YVB9(J-1))/(XVB9(J)-XVB9(J-1))
      B=(XVB9(J-1)*YVB9(J)-XVB9(J)*YVB9(J-1))/(XVB9(J-1)-XVB9(J))
      QIN(86,I)=APOPGS*(A*EN+B)*1.D-16
 2030 CONTINUE
C 10V1
      QIN(87,I)=0.0
      IF(EN.LE.EIN(87)) GO TO 2060
      DO 2040 J=2,NVIB10
      IF(EN.LE.XVB10(J)) GO TO 2050
 2040 CONTINUE
      J=NVIB10
 2050 A=(YVB10(J)-YVB10(J-1))/(XVB10(J)-XVB10(J-1))
      B=(XVB10(J-1)*YVB10(J)-XVB10(J)*YVB10(J-1))/(XVB10(J-1)-XVB10(J))
      QIN(87,I)=APOPGS*(A*EN+B)*1.D-16
 2060 CONTINUE
C 11V1
      QIN(88,I)=0.0
      IF(EN.LE.EIN(88)) GO TO 2130
      DO 2110 J=2,NVIB11
      IF(EN.LE.XVB11(J)) GO TO 2120
 2110 CONTINUE
      J=NVIB11
 2120 A=(YVB11(J)-YVB11(J-1))/(XVB11(J)-XVB11(J-1))
      B=(XVB11(J-1)*YVB11(J)-XVB11(J)*YVB11(J-1))/(XVB11(J-1)-XVB11(J))
      QIN(88,I)=APOPGS*(A*EN+B)*1.D-16
 2130 CONTINUE
C 12V1
      QIN(89,I)=0.0
      IF(EN.LE.EIN(89)) GO TO 2160
      DO 2140 J=2,NVIB12
      IF(EN.LE.XVB12(J)) GO TO 2150
 2140 CONTINUE
      J=NVIB12
 2150 A=(YVB12(J)-YVB12(J-1))/(XVB12(J)-XVB12(J-1))
      B=(XVB12(J-1)*YVB12(J)-XVB12(J)*YVB12(J-1))/(XVB12(J-1)-XVB12(J))
      QIN(89,I)=APOPGS*(A*EN+B)*1.D-16
 2160 CONTINUE
C 13V1
      QIN(90,I)=0.0
      IF(EN.LE.EIN(90)) GO TO 2230
      DO 2210 J=2,NVIB13
      IF(EN.LE.XVB13(J)) GO TO 2220
 2210 CONTINUE
      J=NVIB13
 2220 A=(YVB13(J)-YVB13(J-1))/(XVB13(J)-XVB13(J-1))
      B=(XVB13(J-1)*YVB13(J)-XVB13(J)*YVB13(J-1))/(XVB13(J-1)-XVB13(J))
      QIN(90,I)=APOPGS*(A*EN+B)*1.D-16
 2230 CONTINUE
C 14V1
      QIN(91,I)=0.0
      IF(EN.LE.EIN(91)) GO TO 2260
      DO 2240 J=2,NVIB14
      IF(EN.LE.XVB14(J)) GO TO 2250
 2240 CONTINUE
      J=NVIB14
 2250 A=(YVB14(J)-YVB14(J-1))/(XVB14(J)-XVB14(J-1))
      B=(XVB14(J-1)*YVB14(J)-XVB14(J)*YVB14(J-1))/(XVB14(J-1)-XVB14(J))
      QIN(91,I)=APOPGS*(A*EN+B)*1.D-16
 2260 CONTINUE
C 15V1
      QIN(92,I)=0.0
      IF(EN.LE.EIN(92)) GO TO 2330
      DO 2310 J=2,NVIB15
      IF(EN.LE.XVB15(J)) GO TO 2320
 2310 CONTINUE
      J=NVIB15
 2320 A=(YVB15(J)-YVB15(J-1))/(XVB15(J)-XVB15(J-1))
      B=(XVB15(J-1)*YVB15(J)-XVB15(J)*YVB15(J-1))/(XVB15(J-1)-XVB15(J))
      QIN(92,I)=APOPGS*(A*EN+B)*1.D-16
 2330 CONTINUE
C
C A3SIGMA (V=0-4)
      QIN(93,I)=0.0
      PEQIN(93,I)=0.5
      IF(EN.LE.EIN(93)) GO TO 450
      DO 430 J=2,NTRP1
      IF(EN.LE.XTRP1(J)) GO TO 440
  430 CONTINUE
      J=NTRP1
  440 A=(YTRP1(J)-YTRP1(J-1))/(XTRP1(J)-XTRP1(J-1))
      B=(XTRP1(J-1)*YTRP1(J)-XTRP1(J)*YTRP1(J-1))/(XTRP1(J-1)-XTRP1(J))
      QIN(93,I)=(A*EN+B)*1.D-16
      A=(YTP1M(J)-YTP1M(J-1))/(XTRP1(J)-XTRP1(J-1))
      B=(XTRP1(J-1)*YTP1M(J)-XTRP1(J)*YTP1M(J-1))/(XTRP1(J-1)-XTRP1(J))
      RAT=A*EN+B
      PEQIN(93,I)=1.5-RAT
  450 CONTINUE
C A3SIGMA (V=5-9)
      QIN(94,I)=0.0
      PEQIN(94,I)=0.5
      IF(EN.LE.EIN(94)) GO TO 480
      DO 460 J=2,NTRP2
      IF(EN.LE.XTRP2(J)) GO TO 470
  460 CONTINUE
      J=NTRP2
  470 A=(YTRP2(J)-YTRP2(J-1))/(XTRP2(J)-XTRP2(J-1))
      B=(XTRP2(J-1)*YTRP2(J)-XTRP2(J)*YTRP2(J-1))/(XTRP2(J-1)-XTRP2(J))
      QIN(94,I)=(A*EN+B)*1.D-16
      A=(YTP2M(J)-YTP2M(J-1))/(XTRP2(J)-XTRP2(J-1))
      B=(XTRP2(J-1)*YTP2M(J)-XTRP2(J)*YTP2M(J-1))/(XTRP2(J-1)-XTRP2(J))
      RAT=A*EN+B
      PEQIN(94,I)=1.5-RAT
  480 CONTINUE
C B3PI (V=0-3)
      QIN(95,I)=0.0
      PEQIN(95,I)=0.5
      IF(EN.LE.EIN(95)) GO TO 510
      DO 490 J=2,NTRP3
      IF(EN.LE.XTRP3(J)) GO TO 500
  490 CONTINUE
      J=NTRP3
  500 A=(YTRP3(J)-YTRP3(J-1))/(XTRP3(J)-XTRP3(J-1))
      B=(XTRP3(J-1)*YTRP3(J)-XTRP3(J)*YTRP3(J-1))/(XTRP3(J-1)-XTRP3(J))
      QIN(95,I)=(A*EN+B)*1.D-16
      A=(YTP3M(J)-YTP3M(J-1))/(XTRP3(J)-XTRP3(J-1))
      B=(XTRP3(J-1)*YTP3M(J)-XTRP3(J)*YTP3M(J-1))/(XTRP3(J-1)-XTRP3(J))
      RAT=A*EN+B
      PEQIN(95,I)=1.5-RAT
  510 CONTINUE
C W3DELTA  (V=0-5)
      QIN(96,I)=0.0
      PEQIN(96,I)=0.5
      IF(EN.LE.EIN(96)) GO TO 540
      DO 520 J=2,NTRP4
      IF(EN.LE.XTRP4(J)) GO TO 530
  520 CONTINUE
      J=NTRP4
  530 A=(YTRP4(J)-YTRP4(J-1))/(XTRP4(J)-XTRP4(J-1))
      B=(XTRP4(J-1)*YTRP4(J)-XTRP4(J)*YTRP4(J-1))/(XTRP4(J-1)-XTRP4(J))
      QIN(96,I)=(A*EN+B)*1.D-16
      A=(YTP4M(J)-YTP4M(J-1))/(XTRP4(J)-XTRP4(J-1))
      B=(XTRP4(J-1)*YTP4M(J)-XTRP4(J)*YTP4M(J-1))/(XTRP4(J-1)-XTRP4(J))
      RAT=A*EN+B
      PEQIN(96,I)=1.5-RAT
  540 CONTINUE
C A3SIGMA  (V=10-21)
      QIN(97,I)=0.0
      PEQIN(97,I)=0.5
      IF(EN.LE.EIN(97)) GO TO 570
      DO 550 J=2,NTRP5
      IF(EN.LE.XTRP5(J)) GO TO 560
  550 CONTINUE
      J=NTRP5
  560 A=(YTRP5(J)-YTRP5(J-1))/(XTRP5(J)-XTRP5(J-1))
      B=(XTRP5(J-1)*YTRP5(J)-XTRP5(J)*YTRP5(J-1))/(XTRP5(J-1)-XTRP5(J))
      QIN(97,I)=(A*EN+B)*1.D-16
      A=(YTP5M(J)-YTP5M(J-1))/(XTRP5(J)-XTRP5(J-1))
      B=(XTRP5(J-1)*YTP5M(J)-XTRP5(J)*YTP5M(J-1))/(XTRP5(J-1)-XTRP5(J))
      RAT=A*EN+B
      PEQIN(97,I)=1.5-RAT
  570 CONTINUE
C B3PI (V=4-16)
      QIN(98,I)=0.0
      PEQIN(98,I)=0.5
      IF(EN.LE.EIN(98)) GO TO 600
      DO 580 J=2,NTRP6
      IF(EN.LE.XTRP6(J)) GO TO 590
  580 CONTINUE
      J=NTRP6
  590 A=(YTRP6(J)-YTRP6(J-1))/(XTRP6(J)-XTRP6(J-1))
      B=(XTRP6(J-1)*YTRP6(J)-XTRP6(J)*YTRP6(J-1))/(XTRP6(J-1)-XTRP6(J))
      QIN(98,I)=(A*EN+B)*1.D-16
      A=(YTP6M(J)-YTP6M(J-1))/(XTRP6(J)-XTRP6(J-1))
      B=(XTRP6(J-1)*YTP6M(J)-XTRP6(J)*YTP6M(J-1))/(XTRP6(J-1)-XTRP6(J))
      RAT=A*EN+B
      PEQIN(98,I)=1.5-RAT
  600 CONTINUE
C W3DEL (V=6-10)
      QIN(99,I)=0.0
      PEQIN(99,I)=0.5
      IF(EN.LE.EIN(99)) GO TO 603
      DO 601 J=2,NTRP7
      IF(EN.LE.XTRP7(J)) GO TO 602
  601 CONTINUE
      J=NTRP7
  602 A=(YTRP7(J)-YTRP7(J-1))/(XTRP7(J)-XTRP7(J-1))
      B=(XTRP7(J-1)*YTRP7(J)-XTRP7(J)*YTRP7(J-1))/(XTRP7(J-1)-XTRP7(J))
      QIN(99,I)=(A*EN+B)*1.D-16
      A=(YTP7M(J)-YTP7M(J-1))/(XTRP7(J)-XTRP7(J-1))
      B=(XTRP7(J-1)*YTP7M(J)-XTRP7(J)*YTP7M(J-1))/(XTRP7(J-1)-XTRP7(J))
      RAT=A*EN+B
      PEQIN(99,I)=1.5-RAT
  603 CONTINUE
C A1PI (V=0-3)
      QIN(100,I)=0.0
      PEQIN(100,I)=0.5
      IF(EN.LE.EIN(100)) GO TO 630
      DO 610 J=2,NSNG1
      IF(EN.LE.XSNG1(J)) GO TO 620
  610 CONTINUE
      J=NSNG1
  620 A=(YSNG1(J)-YSNG1(J-1))/(XSNG1(J)-XSNG1(J-1))
      B=(XSNG1(J-1)*YSNG1(J)-XSNG1(J)*YSNG1(J-1))/(XSNG1(J-1)-XSNG1(J))
      QIN(100,I)=(A*EN+B)*1.D-16
      A=(YSG1M(J)-YSG1M(J-1))/(XSNG1(J)-XSNG1(J-1))
      B=(XSNG1(J-1)*YSG1M(J)-XSNG1(J)*YSG1M(J-1))/(XSNG1(J-1)-XSNG1(J))
      RAT=A*EN+B
      PEQIN(100,I)=1.5-RAT
  630 CONTINUE
C B!3SIG (V=0-6)
      QIN(101,I)=0.0
      PEQIN(101,I)=0.5
      IF(EN.LE.EIN(101)) GO TO 633
      DO 631 J=2,NTRP8
      IF(EN.LE.XTRP8(J)) GO TO 632
  631 CONTINUE
      J=NTRP8
  632 A=(YTRP8(J)-YTRP8(J-1))/(XTRP8(J)-XTRP8(J-1))
      B=(XTRP8(J-1)*YTRP8(J)-XTRP8(J)*YTRP8(J-1))/(XTRP8(J-1)-XTRP8(J))
      QIN(101,I)=(A*EN+B)*1.D-16
      A=(YTP8M(J)-YTP8M(J-1))/(XTRP8(J)-XTRP8(J-1))
      B=(XTRP8(J-1)*YTP8M(J)-XTRP8(J)*YTP8M(J-1))/(XTRP8(J-1)-XTRP8(J))
      RAT=A*EN+B
      PEQIN(101,I)=1.5-RAT
  633 CONTINUE
C A!1SIG (V=0-6)
      QIN(102,I)=0.0
      PEQIN(102,I)=0.5
      IF(EN.LE.EIN(102)) GO TO 660
      DO 640 J=2,NSNG2
      IF(EN.LE.XSNG2(J)) GO TO 650
  640 CONTINUE
      J=NSNG2
  650 A=(YSNG2(J)-YSNG2(J-1))/(XSNG2(J)-XSNG2(J-1))
      B=(XSNG2(J-1)*YSNG2(J)-XSNG2(J)*YSNG2(J-1))/(XSNG2(J-1)-XSNG2(J))
      QIN(102,I)=(A*EN+B)*1.D-16
      A=(YSG2M(J)-YSG2M(J-1))/(XSNG2(J)-XSNG2(J-1))
      B=(XSNG2(J-1)*YSG2M(J)-XSNG2(J)*YSG2M(J-1))/(XSNG2(J-1)-XSNG2(J))
      RAT=A*EN+B
      PEQIN(102,I)=1.5-RAT
  660 CONTINUE
C W3DEL (V=11-19)
      QIN(103,I)=0.0
      PEQIN(103,I)=0.5
      IF(EN.LE.EIN(103)) GO TO 690
      DO 670 J=2,NTRP9
      IF(EN.LE.XTRP9(J)) GO TO 680
  670 CONTINUE
      J=NTRP9
  680 A=(YTRP9(J)-YTRP9(J-1))/(XTRP9(J)-XTRP9(J-1))
      B=(XTRP9(J-1)*YTRP9(J)-XTRP9(J)*YTRP9(J-1))/(XTRP9(J-1)-XTRP9(J))
      QIN(103,I)=(A*EN+B)*1.D-16
      A=(YTP9M(J)-YTP9M(J-1))/(XTRP9(J)-XTRP9(J-1))
      B=(XTRP9(J-1)*YTP9M(J)-XTRP9(J)*YTP9M(J-1))/(XTRP9(J-1)-XTRP9(J))
      RAT=A*EN+B
      PEQIN(103,I)=1.5-RAT
  690 CONTINUE
C W1DEL (V=0-5)
      QIN(104,I)=0.0
      PEQIN(104,I)=0.5
      IF(EN.LE.EIN(104)) GO TO 720
      DO 700 J=2,NSNG3
      IF(EN.LE.XSNG3(J)) GO TO 710
  700 CONTINUE
      J=NSNG3
  710 A=(YSNG3(J)-YSNG3(J-1))/(XSNG3(J)-XSNG3(J-1))
      B=(XSNG3(J-1)*YSNG3(J)-XSNG3(J)*YSNG3(J-1))/(XSNG3(J-1)-XSNG3(J))
      QIN(104,I)=(A*EN+B)*1.D-16
      A=(YSG3M(J)-YSG3M(J-1))/(XSNG3(J)-XSNG3(J-1))
      B=(XSNG3(J-1)*YSG3M(J)-XSNG3(J)*YSG3M(J-1))/(XSNG3(J-1)-XSNG3(J))
      RAT=A*EN+B
      PEQIN(104,I)=1.5-RAT
  720 CONTINUE
C A1PI (V=4-15)
      QIN(105,I)=0.0
      PEQIN(105,I)=0.5
      IF(EN.LE.EIN(105)) GO TO 723
      DO 721 J=2,NSNG4
      IF(EN.LE.XSNG4(J)) GO TO 722
  721 CONTINUE
      J=NSNG4
  722 A=(YSNG4(J)-YSNG4(J-1))/(XSNG4(J)-XSNG4(J-1))
      B=(XSNG4(J-1)*YSNG4(J)-XSNG4(J)*YSNG4(J-1))/(XSNG4(J-1)-XSNG4(J))
      QIN(105,I)=(A*EN+B)*1.D-16
      A=(YSG4M(J)-YSG4M(J-1))/(XSNG4(J)-XSNG4(J-1))
      B=(XSNG4(J-1)*YSG4M(J)-XSNG4(J)*YSG4M(J-1))/(XSNG4(J-1)-XSNG4(J))
      RAT=A*EN+B
      PEQIN(105,I)=1.5-RAT
  723 CONTINUE
C B!3SIG   (V=7-18)
      QIN(106,I)=0.0
      PEQIN(106,I)=0.5
      IF(EN.LE.EIN(106)) GO TO 750
      DO 730 J=2,NTRP10
      IF(EN.LE.XTRP10(J)) GO TO 740
  730 CONTINUE
      J=NTRP10
  740 A=(YTRP10(J)-YTRP10(J-1))/(XTRP10(J)-XTRP10(J-1))
      B=(XTRP10(J-1)*YTRP10(J)-XTRP10(J)*YTRP10(J-1))/(XTRP10(J-1)-
     /XTRP10(J))
      QIN(106,I)=(A*EN+B)*1.D-16
      A=(YTP10M(J)-YTP10M(J-1))/(XTRP10(J)-XTRP10(J-1))
      B=(XTRP10(J-1)*YTP10M(J)-XTRP10(J)*YTP10M(J-1))/(XTRP10(J-1)-
     /XTRP10(J))
      RAT=A*EN+B
      PEQIN(106,I)=1.5-RAT
  750 CONTINUE
C A!1SIG (V=7-19)
      QIN(107,I)=0.0
      PEQIN(107,I)=0.5
      IF(EN.LE.EIN(107)) GO TO 780
      DO 760 J=2,NSNG5
      IF(EN.LE.XSNG5(J)) GO TO 770
  760 CONTINUE
      J=NSNG5
  770 A=(YSNG5(J)-YSNG5(J-1))/(XSNG5(J)-XSNG5(J-1))
      B=(XSNG5(J-1)*YSNG5(J)-XSNG5(J)*YSNG5(J-1))/(XSNG5(J-1)-XSNG5(J))
      QIN(107,I)=(A*EN+B)*1.D-16
      A=(YSG5M(J)-YSG5M(J-1))/(XSNG5(J)-XSNG5(J-1))
      B=(XSNG5(J-1)*YSG5M(J)-XSNG5(J)*YSG5M(J-1))/(XSNG5(J-1)-XSNG5(J))
      RAT=A*EN+B
      PEQIN(107,I)=1.5-RAT
  780 CONTINUE
C W1DEL (V=6-18)
      QIN(108,I)=0.0
      PEQIN(108,I)=0.5
      IF(EN.LE.EIN(108)) GO TO 783
      DO 781 J=2,NSNG6
      IF(EN.LE.XSNG6(J)) GO TO 782
  781 CONTINUE
      J=NSNG6
  782 A=(YSNG6(J)-YSNG6(J-1))/(XSNG6(J)-XSNG6(J-1))
      B=(XSNG6(J-1)*YSNG6(J)-XSNG6(J)*YSNG6(J-1))/(XSNG6(J-1)-XSNG6(J))
      QIN(108,I)=(A*EN+B)*1.D-16
      A=(YSG6M(J)-YSG6M(J-1))/(XSNG6(J)-XSNG6(J-1))
      B=(XSNG6(J-1)*YSG6M(J)-XSNG6(J)*YSG6M(J-1))/(XSNG6(J-1)-XSNG6(J))
      RAT=A*EN+B
      PEQIN(108,I)=1.5-RAT
  783 CONTINUE
C C3PI (V=0-4)
      QIN(109,I)=0.0
      PEQIN(109,I)=0.5
      IF(EN.LE.EIN(109)) GO TO 786
      DO 784 J=2,NTRP11
      IF(EN.LE.XTRP11(J)) GO TO 785
  784 CONTINUE
      J=NTRP11
  785 A=(YTRP11(J)-YTRP11(J-1))/(XTRP11(J)-XTRP11(J-1))
      B=(XTRP11(J-1)*YTRP11(J)-XTRP11(J)*YTRP11(J-1))/(XTRP11(J-1)-
     /XTRP11(J))
      QIN(109,I)=(A*EN+B)*1.D-16
      A=(YTP11M(J)-YTP11M(J-1))/(XTRP11(J)-XTRP11(J-1))
      B=(XTRP11(J-1)*YTP11M(J)-XTRP11(J)*YTP11M(J-1))/(XTRP11(J-1)-
     /XTRP11(J))
      RAT=A*EN+B
      PEQIN(109,I)=1.5-RAT
  786 CONTINUE
C E3SIG
      QIN(110,I)=0.0
      PEQIN(110,I)=0.5
      IF(EN.LE.EIN(110)) GO TO 789
      DO 787 J=2,NTRP12
      IF(EN.LE.XTRP12(J)) GO TO 788
  787 CONTINUE
      J=NTRP12
  788 A=(YTRP12(J)-YTRP12(J-1))/(XTRP12(J)-XTRP12(J-1))
      B=(XTRP12(J-1)*YTRP12(J)-XTRP12(J)*YTRP12(J-1))/(XTRP12(J-1)-
     /XTRP12(J))
      QIN(110,I)=(A*EN+B)*1.D-16
      A=(YTP12M(J)-YTP12M(J-1))/(XTRP12(J)-XTRP12(J-1))
      B=(XTRP12(J-1)*YTP12M(J)-XTRP12(J)*YTP12M(J-1))/(XTRP12(J-1)-
     /XTRP12(J))
      RAT=A*EN+B
      PEQIN(110,I)=1.5-RAT
  789 CONTINUE
C A!!1SIG (V=0-1)
      QIN(111,I)=0.0
      PEQIN(111,I)=0.5
      IF(EN.LE.EIN(111)) GO TO 792
      DO 790 J=2,NSNG7
      IF(EN.LE.XSNG7(J)) GO TO 791
  790 CONTINUE
      J=NSNG7
  791 A=(YSNG7(J)-YSNG7(J-1))/(XSNG7(J)-XSNG7(J-1))
      B=(XSNG7(J-1)*YSNG7(J)-XSNG7(J)*YSNG7(J-1))/(XSNG7(J-1)-XSNG7(J))
      QIN(111,I)=(A*EN+B)*1.D-16
      A=(YSG7M(J)-YSG7M(J-1))/(XSNG7(J)-XSNG7(J-1))
      B=(XSNG7(J-1)*YSG7M(J)-XSNG7(J)*YSG7M(J-1))/(XSNG7(J-1)-XSNG7(J))
      RAT=A*EN+B
      PEQIN(111,I)=1.5-RAT
  792 CONTINUE
C B1PI  (V=0-6)
      QIN(112,I)=0.0
      PEQIN(112,I)=0.5
      IF(EN.LE.EIN(112)) GO TO 795
      DO 793 J=2,NSNG8
      IF(EN.LE.XSNG8(J)) GO TO 794
  793 CONTINUE
      J=NSNG8
  794 A=(YSNG8(J)-YSNG8(J-1))/(XSNG8(J)-XSNG8(J-1))
      B=(XSNG8(J-1)*YSNG8(J)-XSNG8(J)*YSNG8(J-1))/(XSNG8(J-1)-XSNG8(J))
      QIN(112,I)=(A*EN+B)*1.D-16
      A=(YSG8M(J)-YSG8M(J-1))/(XSNG8(J)-XSNG8(J-1))
      B=(XSNG8(J-1)*YSG8M(J)-XSNG8(J)*YSG8M(J-1))/(XSNG8(J-1)-XSNG8(J))
      RAT=A*EN+B
      PEQIN(112,I)=1.5-RAT
  795 CONTINUE
C C!1SIG (V=0-3)
      QIN(113,I)=0.0
      PEQIN(113,I)=0.5
      IF(EN.LE.EIN(113)) GO TO 798
      DO 796 J=2,NSNG9
      IF(EN.LE.XSNG9(J)) GO TO 797
  796 CONTINUE
      J=NSNG9
  797 A=(YSNG9(J)-YSNG9(J-1))/(XSNG9(J)-XSNG9(J-1))
      B=(XSNG9(J-1)*YSNG9(J)-XSNG9(J)*YSNG9(J-1))/(XSNG9(J-1)-XSNG9(J))
      QIN(113,I)=(A*EN+B)*1.D-16
      A=(YSG9M(J)-YSG9M(J-1))/(XSNG9(J)-XSNG9(J-1))
      B=(XSNG9(J-1)*YSG9M(J)-XSNG9(J)*YSG9M(J-1))/(XSNG9(J-1)-XSNG9(J))
      RAT=A*EN+B
      PEQIN(113,I)=1.5-RAT
  798 CONTINUE
C G 3PI (V=0-3)
      QIN(114,I)=0.0
      PEQIN(114,I)=0.5
      IF(EN.LE.EIN(114)) GO TO 801
      DO 799 J=2,NTRP13
      IF(EN.LE.XTRP13(J)) GO TO 800
  799 CONTINUE
      J=NTRP13
  800 A=(YTRP13(J)-YTRP13(J-1))/(XTRP13(J)-XTRP13(J-1))
      B=(XTRP13(J-1)*YTRP13(J)-XTRP13(J)*YTRP13(J-1))/(XTRP13(J-1)-
     /XTRP13(J))
      QIN(114,I)=(A*EN+B)*1.D-16
      A=(YTP13M(J)-YTP13M(J-1))/(XTRP13(J)-XTRP13(J-1))
      B=(XTRP13(J-1)*YTP13M(J)-XTRP13(J)*YTP13M(J-1))/(XTRP13(J-1)-
     /XTRP13(J))
      RAT=A*EN+B
      PEQIN(114,I)=1.5-RAT
  801 CONTINUE
C C3 1PI (V=0-3)
      QIN(115,I)=0.0
      PEQIN(115,I)=0.5
      IF(EN.LE.EIN(115)) GO TO 804
      DO 802 J=2,NSNG10
      IF(EN.LE.XSNG10(J)) GO TO 803
  802 CONTINUE
      J=NSNG10
  803 A=(YSNG10(J)-YSNG10(J-1))/(XSNG10(J)-XSNG10(J-1))
      B=(XSNG10(J-1)*YSNG10(J)-XSNG10(J)*YSNG10(J-1))/(XSNG10(J-1)-
     /XSNG10(J))
      QIN(115,I)=(A*EN+B)*1.D-16
      A=(YSG10M(J)-YSG10M(J-1))/(XSNG10(J)-XSNG10(J-1))
      B=(XSNG10(J-1)*YSG10M(J)-XSNG10(J)*YSG10M(J-1))/(XSNG10(J-1)-
     /XSNG10(J))
      RAT=A*EN+B
      PEQIN(115,I)=1.5-RAT
  804 CONTINUE
C F 3PI (V=0-3)
      QIN(116,I)=0.0
      PEQIN(116,I)=0.5
      IF(EN.LE.EIN(116)) GO TO 807
      DO 805 J=2,NTRP14
      IF(EN.LE.XTRP14(J)) GO TO 806
  805 CONTINUE
      J=NTRP14
  806 A=(YTRP14(J)-YTRP14(J-1))/(XTRP14(J)-XTRP14(J-1))
      B=(XTRP14(J-1)*YTRP14(J)-XTRP14(J)*YTRP14(J-1))/(XTRP14(J-1)-
     /XTRP14(J))
      QIN(116,I)=(A*EN+B)*1.D-16
      A=(YTP14M(J)-YTP14M(J-1))/(XTRP14(J)-XTRP14(J-1))
      B=(XTRP14(J-1)*YTP14M(J)-XTRP14(J)*YTP14M(J-1))/(XTRP14(J-1)-
     /XTRP14(J))
      RAT=A*EN+B
      PEQIN(116,I)=1.5-RAT
  807 CONTINUE
C B! 1SIG (V=0-10)
      QIN(117,I)=0.0
      PEQIN(117,I)=0.5
      IF(EN.LE.EIN(117)) GO TO 810
      DO 808 J=2,NSNG11
      IF(EN.LE.XSNG11(J)) GO TO 809
  808 CONTINUE
      J=NSNG11
  809 A=(YSNG11(J)-YSNG11(J-1))/(XSNG11(J)-XSNG11(J-1))
      B=(XSNG11(J-1)*YSNG11(J)-XSNG11(J)*YSNG11(J-1))/(XSNG11(J-1)-
     /XSNG11(J))
      QIN(117,I)=(A*EN+B)*1.D-16
      A=(YSG11M(J)-YSG11M(J-1))/(XSNG11(J)-XSNG11(J-1))
      B=(XSNG11(J-1)*YSG11M(J)-XSNG11(J)*YSG11M(J-1))/(XSNG11(J-1)-
     /XSNG11(J))
      RAT=A*EN+B
      PEQIN(117,I)=1.5-RAT
  810 CONTINUE
C B1PI  (V=7-14)
      QIN(118,I)=0.0
      PEQIN(118,I)=0.5
      IF(EN.LE.EIN(118)) GO TO 813
      DO 811 J=2,NSNG12
      IF(EN.LE.XSNG12(J)) GO TO 812
  811 CONTINUE
      J=NSNG12
  812 A=(YSNG12(J)-YSNG12(J-1))/(XSNG12(J)-XSNG12(J-1))
      B=(XSNG12(J-1)*YSNG12(J)-XSNG12(J)*YSNG12(J-1))/(XSNG12(J-1)-
     /XSNG12(J))
      QIN(118,I)=(A*EN+B)*1.D-16
      A=(YSG12M(J)-YSG12M(J-1))/(XSNG12(J)-XSNG12(J-1))
      B=(XSNG12(J-1)*YSG12M(J)-XSNG12(J)*YSG12M(J-1))/(XSNG12(J-1)-
     /XSNG12(J))
      RAT=A*EN+B
      PEQIN(118,I)=1.5-RAT
  813 CONTINUE
C O3 1PI (V=0-3)
      QIN(119,I)=0.0
      PEQIN(119,I)=0.5
      IF(EN.LE.EIN(119)) GO TO 816
      DO 814 J=2,NSNG13
      IF(EN.LE.XSNG13(J)) GO TO 815
  814 CONTINUE
      J=NSNG13
  815 A=(YSNG13(J)-YSNG13(J-1))/(XSNG13(J)-XSNG13(J-1))
      B=(XSNG13(J-1)*YSNG13(J)-XSNG13(J)*YSNG13(J-1))/(XSNG13(J-1)-
     /XSNG12(J))
      QIN(119,I)=(A*EN+B)*1.D-16
      A=(YSG13M(J)-YSG13M(J-1))/(XSNG13(J)-XSNG13(J-1))
      B=(XSNG13(J-1)*YSG13M(J)-XSNG13(J)*YSG13M(J-1))/(XSNG13(J-1)-
     /XSNG12(J))
      RAT=A*EN+B
      PEQIN(119,I)=1.5-RAT
  816 CONTINUE
C B! 1SIG  (V=11-HIGH)
      QIN(120,I)=0.0
      PEQIN(120,I)=0.5
      IF(EN.LE.EIN(120)) GO TO 819
      DO 817 J=2,NSNG14
      IF(EN.LE.XSNG14(J)) GO TO 818
  817 CONTINUE
      J=NSNG14
  818 A=(YSNG14(J)-YSNG14(J-1))/(XSNG14(J)-XSNG14(J-1))
      B=(XSNG14(J-1)*YSNG14(J)-XSNG14(J)*YSNG14(J-1))/(XSNG14(J-1)-
     /XSNG14(J))
      QIN(120,I)=(A*EN+B)*1.D-16
      A=(YSG14M(J)-YSG14M(J-1))/(XSNG14(J)-XSNG14(J-1))
      B=(XSNG14(J-1)*YSG14M(J)-XSNG14(J)*YSG14M(J-1))/(XSNG14(J-1)-
     /XSNG14(J))
      RAT=A*EN+B
      PEQIN(120,I)=1.5-RAT
  819 CONTINUE
C SUM OF HIGHER SINGLET STATES
      QIN(121,I)=0.0
      PEQIN(121,I)=0.5
      IF(EN.LE.EIN(121)) GO TO 895
      DO 893 J=2,NSNG15
      IF(EN.LE.XSNG15(J)) GO TO 894
  893 CONTINUE
      J=NSNG15
  894 A=(YSNG15(J)-YSNG15(J-1))/(XSNG15(J)-XSNG15(J-1))
      B=(XSNG15(J-1)*YSNG15(J)-XSNG15(J)*YSNG15(J-1))/(XSNG15(J-1)-
     /XSNG15(J))
      QIN(121,I)=(A*EN+B)*1.D-16
      A=(YSG15M(J)-YSG15M(J-1))/(XSNG15(J)-XSNG15(J-1))
      B=(XSNG15(J-1)*YSG15M(J)-XSNG15(J)*YSG15M(J-1))/(XSNG15(J-1)-
     /XSNG15(J))
      RAT=A*EN+B
      PEQIN(121,I)=1.5-RAT
  895 CONTINUE
C ROTATIONAL SUM
      SUMR=0.0
      DO 897 K=1,76
      SUMR=SUMR+QIN(K,I)
  897 CONTINUE
C  VIBRATIONAL SUM
      SUMV=0
      DO 898 K=77,92
      SUMV=SUMV+QIN(K,I)
  898 CONTINUE
C EXCITATION SUM
      SUMEX=0.0
      DO 899 K=93,111
      SUMEX=SUMEX+QIN(K,I)
  899 CONTINUE
C EXCITATION SUM
      SUMEX1=0.0
      DO 8999 K=112,121
      SUMEX1=SUMEX1+QIN(K,I)
 8999 CONTINUE
C GET CORRECT ELASTIC XSECTION BY SUBTRACTION OF ROTATION
      Q(2,I)=Q(2,I)-SUMR
C FOR VERY HIGH TEMPERATURES SOMETIMES SUMR BECOMES LARGER THAN
C THE ELASTIC+ROT (ONLY IN FIRST TWO ENERGY BINS) FIX GT 0
      IF(Q(2,I).LE.0.0) THEN
       Q(2,I)=0.95D-16
      ENDIF
      Q(1,I)=Q(2,I)+Q(3,I)+SUMR+SUMV+SUMEX+SUMEX1
C CAN PRINT OUT X-SECTION DATA
C     SUMR=SUMR*1.D16
C     SUMV=SUMV*1.D16
C     SUMEX=SUMEX*1.D16
C     SUMEX1=SUMEX1*1.D16
C     SUMVEX=SUMV+SUMEX+SUMEX1
C     SUMVEXI=SUMVEX+Q(5,I)*1.D16
C     WRITE(6,8769) EN,SUMR,SUMV,SUMEX,SUMEX1,SUMVEX,SUMVEXI
C8769 FORMAT(' EN=',F8.3,' SUMR=',F8.3,' SUMV=',F8.3,' SUMEX=',F8.3,' SU
C    /MEX1=',F8.3,' SUMVEX=',F8.3,' TOT=',F8.3)
  900 CONTINUE
C SAVE COMPUTE TIME
      DO 1000 K=1,121
      J=122-K
      IF(EFINAL.LE.EIN(J)) NIN=J-1
 1000 CONTINUE
      IF(NIN.LT.77) NIN=77
C
      RETURN
      END
      SUBROUTINE GAS17(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      DIMENSION XEN(58),YXSEC(58),XION(48),YION(48),XATT(23),YATT(23),
     /XROT1(18),YROT1(18),XVIB1(24),YVIB1(24),XVIB2(23),YVIB2(23),
     /XEXC1(32),YEXC1(32),
     /XAT3(18),YAT3(18)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      DATA XEN/0.00,.005,.007,0.01,.012,.015,0.02,0.03,0.04,0.05,
     /0.06,0.07,0.08,0.09,0.10,0.12,0.15,0.20,0.30,0.40,
     /0.50,0.60,0.70,0.80,0.90,1.00,1.20,1.50,2.00,3.00,
     /4.00,5.00,6.00,7.00,8.00,9.00,10.0,12.0,15.0,20.0,
     /30.0,40.0,50.0,60.0,70.0,80.0,90.0,100.,120.,150.,
     /200.,300.,400.,500.,1000.,2000.,10000.,100000./
      DATA YXSEC/32.0,30.8,29.8,27.8,25.5,22.1,20.0,15.7,13.3,11.2,
     /10.0,9.25,8.63,8.34,8.24,8.00,6.73,6.00,6.00,6.14,
     /6.50,6.88,7.70,8.25,8.95,9.78,10.6,13.3,13.6,12.8,
     /10.2,9.78,8.45,7.10,6.10,5.20,4.75,4.10,2.85,1.85,
     /1.12,0.82,0.59,0.49,0.39,0.32,0.28,0.24,0.18,0.14,
     /0.09,0.05,.035,.025,0.01,.004,.0005,.0001/
      DATA XION/9.2644,9.50,10.0,10.5,11.0,11.5,12.0,12.5,13.0,13.5,
     /14.0,15.0,16.0,17.0,18.0,19.0,20.0,22.0,24.0,26.0,
     /28.0,32.0,36.0,40.0,45.0,50.0,60.0,70.0,80.0,90.0,
     /100.,120.,140.,160.,200.,300.,400.,500.,600.,700.,
     /800.,900.,1000.,2000.,4000.,10000.,20000.,100000./
      DATA YION/0.00,.011,.018,.031,.047,.064,.093,.131,.184,.244,
     /.305,.418,.503,.585,.663,.736,.813,.959,1.11,1.26,
     /1.40,1.65,1.87,2.08,2.30,2.48,2.74,2.91,3.04,3.11,
     /3.14,3.14,3.10,3.04,2.86,2.45,2.11,1.86,1.67,1.51,
     /1.39,1.27,1.21,0.80,0.45,0.23,0.14,.035/
      DATA XATT/6.50,6.80,7.00,7.20,7.40,7.60,7.80,8.00,8.60,8.80,
     /9.00,9.20,9.40,9.60,9.80,10.0,10.4,10.6,10.8,11.0,
     /11.5,13.0,14.0/
      DATA YATT/0.00,0.02,0.08,0.33,0.71,0.96,1.08,1.11,1.11,1.09,
     /1.04,0.95,0.83,0.65,0.51,0.38,0.18,0.11,0.08,0.06,
     /0.04,0.03,0.00/
      DATA XAT3/0.01,.012,.015,0.02,0.03,0.04,0.05,0.06,0.07,0.08,
     /0.09,0.10,0.12,0.15,0.20,0.30,1.00,10.0/
      DATA YAT3/0.00,.085,0.24,0.14,0.07,.041,.029,.023,.019,.017,
     /.015,.014,.013,.012,.010,.0085,.0035,0.00/
      DATA XROT1/.100,0.12,0.15,0.20,0.30,0.40,0.50,0.60,0.70,0.80,
     /0.90,1.00,1.20,1.50,2.00,10.0,100.,100000./
      DATA YROT1/0.00,.037,.037,.033,.026,.018,.014,.011,.009,.006,
     /.005,.004,.003,.002,.001,.0001,.00001,.000001/
      DATA XVIB1/.2326,0.24,0.25,0.30,0.40,0.50,0.60,0.70,0.80,0.90,
     /1.00,1.20,1.50,2.00,3.00,4.00,5.00,6.00,7.00,8.00,
     /10.0,20.0,100.,100000./
      DATA YVIB1/0.00,0.05,0.08,0.10,0.08,0.06,0.05,0.04,.032,.027,
     /.023,.018,.012,.008,.004,.002,.0015,.0012,.001,.0008,
     /.0005,.0001,.00002,.000001/
      DATA XVIB2/0.60,0.63,0.70,0.80,0.90,1.00,1.20,1.50,2.00,3.00,
     /4.00,5.00,6.00,7.00,8.00,10.0,15.0,20.0,40.0,60.0,
     /100.,1000.,100000./
      DATA YVIB2/0.00,0.60,0.90,0.90,0.85,0.80,0.70,0.50,0.31,0.16,
     /0.11,.075,.055,.042,.035,.025,.012,.008,.002,.001,
     /.0005,.00005,.000005/
      DATA XEXC1/6.10,6.50,7.00,7.50,8.00,8.50,9.00,10.0,12.0,15.0,
     /20.0,30.0,40.0,50.0,60.0,70.0,80.0,90.0,100.,120.,
     /150.,200.,300.,400.,500.,1000.,2000.,4000.,10000.,20000.,
     /40000.,100000./
      DATA YEXC1/0.00,0.01,0.02,.085,0.20,0.55,0.70,1.00,1.65,2.21,
     /3.30,3.50,3.30,3.00,2.65,2.26,2.16,2.00,1.80,1.60,
     /1.40,1.03,0.85,0.65,0.52,0.25,0.13,0.06,.025,.012,
     /.0065,.0025/
      NAME='NO      1995   '
C ---------------------------------------------------------------------
C CALCULATE CORRECTION FACTOR FOR 3BODY ATTACHMENT CROSS-SECTION
      FAC=273.15*TORR/((TEMPC+273.15)*760.0)
C---------------------------------------------
C     WRITE(6,100)
C 100 FORMAT(1H1)
C     WRITE(6,100) FAC
C 101 FORMAT(' 3BODY ATTACHMENT INCLUDED DENSITY SCALING FACTOR =',F7.4)
      NIN=4
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      NDATA=58
      NION=48
      NATT=23
      NAT3=18
      NROT1=18
      NVIB1=24
      NVIB2=23
      NEXC1=32
      E(1)=0.0
      E(2)=2.0*EMASS/(30.00614*AMU)
      E(3)=9.2644
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=13.6
      EIN(1)=0.100
      EIN(2)=0.2326
      EIN(3)=0.600
      EIN(4)=6.10
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       NITRIC OXIDE   '
      SCRPT(3)=' IONISATION    ELOSS=  9.2644 '
      SCRPT(4)=' ATTACHMENT 2+3 BODY          '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' ROT           ELOSS=  0.100  '
      SCRPT(8)=' VIB V1        ELOSS=  0.2326 '
      SCRPT(9)=' VIB SUM       ELOSS=  0.600  '
      SCRPT(10)=' EXC           ELOSS=  6.10   '
      EN=-ESTEP/2.0
      DO 1000 I=1,NSTEP
      EN=EN+ESTEP
      DO 10 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 20
   10 CONTINUE
      J=NDATA
   20 A=(YXSEC(J)-YXSEC(J-1))/(XEN(J)-XEN(J-1))
      B=(XEN(J-1)*YXSEC(J)-XEN(J)*YXSEC(J-1))/(XEN(J-1)-XEN(J))
      Q(2,I)=(A*EN+B)*1.0D-16
      Q(3,I)=0.0
      IF(EN.LT.E(3)) GO TO 200
      DO 110 J=2,NION
      IF(EN.LE.XION(J)) GO TO 120
  110 CONTINUE
      J=NION
  120 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
  200 Q(4,I)=0.0
      SINGLE=0.0
      IF(EN.LT.XATT(1)) GO TO 250
      IF(EN.GT.XATT(NATT)) GO TO 250
      DO 210 J=2,NATT
      IF(EN.LE.XATT(J)) GO TO 220
  210 CONTINUE
      J=NATT
  220 A=(YATT(J)-YATT(J-1))/(XATT(J)-XATT(J-1))
      B=(XATT(J-1)*YATT(J)-XATT(J)*YATT(J-1))/(XATT(J-1)-XATT(J))
      SINGLE=(A*EN+B)*1.D-18
  250 THREEB=0.0
      IF(EN.LT.XAT3(1)) GO TO 300
      IF(EN.GT.XAT3(NAT3)) GO TO 300
      DO 260 J=2,NAT3
      IF(EN.LE.XAT3(J)) GO TO 270
  260 CONTINUE
      J=NAT3
  270 A=(YAT3(J)-YAT3(J-1))/(XAT3(J)-XAT3(J-1))
      B=(XAT3(J-1)*YAT3(J)-XAT3(J)*YAT3(J-1))/(XAT3(J-1)-XAT3(J))
      THREEB=FAC*(A*EN+B)*1.D-16
      Q(4,I)=SINGLE+THREEB
  300 Q(5,I)=0.0
      Q(6,I)=0.0
C
      QIN(1,I)=0.0
      IF(EN.LE.EIN(1)) GO TO 400
      DO 310 J=2,NROT1
      IF(EN.LE.XROT1(J)) GO TO 320
  310 CONTINUE
      J=NROT1
  320 A=(YROT1(J)-YROT1(J-1))/(XROT1(J)-XROT1(J-1))
      B=(XROT1(J-1)*YROT1(J)-XROT1(J)*YROT1(J-1))/(XROT1(J-1)-XROT1(J))
      QIN(1,I)=(A*EN+B)*1.D-16
  400 CONTINUE
      QIN(2,I)=0.0
      IF(EN.LE.EIN(2)) GO TO 500
      DO 410 J=2,NVIB1
      IF(EN.LE.XVIB1(J)) GO TO 420
  410 CONTINUE
      J=NVIB1
  420 A=(YVIB1(J)-YVIB1(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB1(J)-XVIB1(J)*YVIB1(J-1))/(XVIB1(J-1)-XVIB1(J))
      QIN(2,I)=(A*EN+B)*1.D-16
  500 CONTINUE
      QIN(3,I)=0.0
      IF(EN.LE.EIN(3)) GO TO 600
      DO 510 J=2,NVIB2
      IF(EN.LE.XVIB2(J)) GO TO 520
  510 CONTINUE
      J=NVIB2
  520 A=(YVIB2(J)-YVIB2(J-1))/(XVIB2(J)-XVIB2(J-1))
      B=(XVIB2(J-1)*YVIB2(J)-XVIB2(J)*YVIB2(J-1))/(XVIB2(J-1)-XVIB2(J))
      QIN(3,I)=(A*EN+B)*1.D-16
  600 CONTINUE
      QIN(4,I)=0.0
      IF(EN.LE.EIN(4)) GO TO 700
      DO 610 J=2,NEXC1
      IF(EN.LE.XEXC1(J)) GO TO 620
  610 CONTINUE
      J=NEXC1
  620 A=(YEXC1(J)-YEXC1(J-1))/(XEXC1(J)-XEXC1(J-1))
      B=(XEXC1(J-1)*YEXC1(J)-XEXC1(J)*YEXC1(J-1))/(XEXC1(J-1)-XEXC1(J))
      QIN(4,I)=(A*EN+B)*1.D-16
  700 CONTINUE
C
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+QIN(1,I)+QIN(2,I)+QIN(3,I)+QIN(4,I)
 1000 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(4)) NIN=3
      IF(EFINAL.LE.EIN(3)) NIN=2
      IF(EFINAL.LE.EIN(2)) NIN=1
      IF(EFINAL.LE.EIN(1)) NIN=0
      RETURN
      END
      SUBROUTINE GAS18(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220),
     /PJ(60)
      DIMENSION XEN(69),YXSEC(69),XION(47),YION(47),XATT(51),YATT(51),
     /XEXC1(28),YEXC1(28),XEXC2(24),YEXC2(24),XEXC3(25),YEXC3(25),
     /XVIBH(19),YVIBH(19),XVIBR(19),YVIBR(19)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
C ELASTIC +ROTATION MOMENTUM TRANSFER
      DATA XEN/0.00,0.001,.0034,0.01,.012,.014,.017,0.02,.025,0.03,
     /0.04,0.05,0.06,0.07,0.08,0.09,0.10,0.12,0.14,0.17,
     /0.20,0.25,0.30,0.35,0.40,0.50,0.60,0.70,0.80,1.00,
     /1.20,1.40,1.60,1.80,2.00,2.20,2.40,2.60,3.00,4.00,
     /5.00,6.00,7.00,8.00,9.00,10.0,12.0,14.0,17.0,20.0,
     /25.0,30.0,40.0,50.0,60.0,70.0,80.0,90.0,100.,140.,
     /200.,250.,300.,400.,500.,700.,1000.,10000.,100000./
      DATA YXSEC/180.,150.,105.,54.5,48.5,43.5,39.0,35.2,30.5,27.3,
     /22.6,19.8,17.5,15.5,13.4,12.1,10.8,8.90,7.55,6.10,
     /5.20,4.20,3.70,3.35,3.20,3.10,3.15,3.25,3.35,3.65,
     /4.30,5.00,6.30,8.70,10.2,11.5,12.0,11.5,10.2,8.90,
     /8.60,9.00,9.50,10.2,10.7,11.1,11.4,11.1,10.0,8.81,
     /7.31,6.44,5.21,4.40,3.81,3.41,2.88,2.65,2.33,1.59,
     /1.14,0.88,0.73,0.50,0.38,0.25,0.16,0.016,0.0016/
C IONISATION
      DATA XION/12.886,14.0,14.5,15.0,16.0,17.0,18.0,20.0,21.0,22.5,
     /25.0,30.0,35.0,40.0,45.0,50.0,55.0,60.0,70.0,80.0,
     /90.0,100.,110.,120.,140.,160.,200.,250.,300.,350.,
     /400.,450.,500.,600.,700.,800.,900.,1000.,1500.,2000.,
     /3000.,4000.,6000.,10000.,20000.,40000.,100000./
      DATA YION/0.00,.065,.135,.175,.255,.330,.414,.602,0.72,0.877,
     /1.16,1.61,2.03,2.34,2.61,2.82,3.02,3.18,3.46,3.63,
     /3.71,3.76,3.77,3.76,3.73,3.63,3.44,3.17,2.94,2.72,
     /2.51,2.36,2.22,1.95,1.77,1.62,1.49,1.42,1.05,0.83,
     /0.60,0.48,0.34,.218,.119,.065,.028/
C ATACHMENT
      DATA XATT/0.20,0.25,0.30,0.40,0.50,0.60,0.70,0.80,0.90,1.00,
     /1.10,1.20,1.30,1.40,1.50,1.60,1.70,1.80,1.90,2.00,
     /2.10,2.20,2.30,2.40,2.50,2.60,2.70,2.80,2.90,3.00,
     /3.10,3.20,3.30,3.40,3.50,3.60,3.70,3.80,3.90,4.00,
     /4.30,5.00,6.00,7.00,8.00,9.00,10.0,11.0,12.0,14.0,
     /16.0/
      DATA YATT/0.00,0.01,0.02,0.25,0.90,1.12,1.16,1.23,1.35,1.45,
     /1.52,1.61,1.70,1.76,2.05,2.29,2.92,3.59,4.48,5.35,
     /6.02,6.58,6.58,6.18,5.45,4.60,3.72,2.75,2.00,1.48,
     /1.07,0.75,0.48,0.36,0.27,0.22,0.17,0.15,0.13,0.10,
     /0.08,0.08,0.09,0.12,0.23,0.34,0.57,0.69,0.46,0.15,
     /0.00/
C VIBRATIONS
      DATA XVIBH/.073,1.00,1.20,1.40,1.60,1.80,2.00,2.20,2.40,2.60,
     /2.80,3.00,3.20,3.40,3.60,3.80,4.00,10.0,100000./
      DATA YVIBH/0.00,.022,.062,.144,.291,.500,.735,.927,1.00,.927,
     /.735,.500,.291,.144,.062,.022,.007,.000001,.000000001/
      DATA XVIBR/.073,5.20,5.60,6.00,6.40,6.80,7.20,7.60,8.00,8.40,
     /8.80,9.20,9.60,10.0,10.4,10.8,11.2,15.0,100000./
      DATA YVIBR/0.00,.006,0.02,.065,.174,.375,.644,.896,1.00,.896,
     /.644,.375,.174,.065,0.02,.006,.001,.000001,.000000001/
C EXCITATIONS
      DATA XEXC1/4.06,4.50,5.00,6.00,7.00,8.00,9.00,10.0,12.0,14.0,
     /17.0,20.0,25.0,30.0,40.0,50.0,60.0,70.0,80.0,90.0,
     /100.,140.,200.,300.,500.,1000.,10000.,100000./
      DATA YEXC1/0.00,0.55,0.83,0.93,0.93,0.84,0.78,0.69,0.60,0.50,
     /0.42,0.34,0.26,0.21,0.15,0.12,0.10,0.08,0.07,0.06,
     /0.05,.034,.022,.014,.008,.004,.0004,.00004/
      DATA XEXC2/8.50,9.00,10.0,12.0,14.0,17.0,20.0,25.0,30.0,40.0,
     /50.0,60.0,70.0,80.0,100.,140.,200.,300.,400.,500.,
     /700.,1000.,10000.,100000./
      DATA YEXC2/0.00,.016,.048,0.12,0.22,0.34,0.47,0.62,0.73,0.81,
     /0.75,0.64,0.57,0.48,0.36,0.26,0.17,0.12,.083,.067,
     /.046,.034,.003,.0003/
      DATA XEXC3/9.60,10.0,12.0,14.0,17.0,20.0,25.0,30.0,40.0,50.0,
     /60.0,70.0,80.0,90.0,100.,140.,200.,250.,300.,400.,
     /500.,700.,1000.,10000.,100000./
      DATA YEXC3/0.00,.036,0.26,0.76,1.44,2.23,3.20,3.87,4.40,4.40,
     /3.81,3.41,2.88,2.65,2.33,1.59,1.14,0.88,0.76,0.56,
     /0.44,0.33,0.25,.025,.0025/
      NAME='N2O     2004   '
C ----------------------------------------------------------------------
C DRIFT DIFFUSION AND TOWNSEND EXP DATA:
C  PACK VOSHALL AND PHELPS   PHYS.REV. 127 (1962) 2084
C  YOSHIDA SASAKI ET AL      J.PHYS.D  32  (1999) 862
C
C UPDATE OF HAYASHI X-SECTIONS INCLUDING NEW X-SECTION MEASUREMENTS BY:
C  KITAJIMA SAKAMOTO GULLEY BUCKMAN ET AL   J.PHYS.B 33(2000) 1687
C        AKTHER ET AL                       J.PHYS.B 35(2002) L481
C ---------------------------------------------------------------------
C  MOD OF 2003 DATA TO INCLUDE DIPOLE ROTATIONAL TRANSITIONS.
C  USED LINEAR UNSYMMETRIC ROTOR MODEL.
C  USED ANISOTROPIC ANGULAR BORN DIPOLE ROTATIONAL SCATTERING
C ---------------------------------------------------------------------
C   SCALEAT = SCALE FACTOR TO ALLOW FOR DEATTACHMENT COLLISIONS
C             SET SCALE =0.0 FOR COMPLETE DEATTACHMENT
C             SET SCALE =1.0 FOR NO DEATTACHMENT
C ---------------------------------------------------------------------
      SCALEAT=1.0
C
      AMPV2=0.06
      AMPV1=0.24
      AMPV3=0.12
      AMPV3=0.18
      ARESV2=2.65
      ARESV1=2.55
      ARESV3=0.30
      ARES2V1=0.95
      ARESVR=0.62
      NIN=131
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
      KIN(J)=0
    2 IF(J.LE.120) KIN(J)=1
      NDATA=69
      NION=47
      NATT=51
      NVIBH=19
      NVIBR=19
      NEXC1=28
      NEXC2=24
      NEXC3=25
      E(1)=0.0
      E(2)=2.0*EMASS/(44.01288*AMU)
      E(3)=12.886
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=12.886
C  B0 IS ROTATIONAL CONSTANT AND DBA IS DIPOLE MOMENT
C  DRAT IS RATIO OF MOMENTUM TRANSFER TO TOTAL X-SECTION FOR DIPOLE
C --------------------------------------------------------------------
      B0=5.185D-5
      DBA=0.06326
      DRAT=0.25
      A0=0.5291772083D-8
      RY=13.60569172
      DBK=8.37758*RY*(DBA*A0)**2
C --------------------------------------------------------------
C  CALCULATE ROTATIONAL STATE POPULATION AT TEMPERATURE AKT
      DO 3 K=1,60
    3 PJ(K)=(2*K+1)*DEXP(-K*(K+1)*B0/AKT)
      SUM=1.0D0
      DO 4 K=1,60
    4 SUM=SUM+PJ(K)
      FROT0=1.0/SUM
      DO 5 K=1,60
    5 PJ(K)=PJ(K)/SUM
C CALCULATE ROTATIONAL TRANSITION ENERGIES
      DO 6 K=1,60
      J=K-1
      EIN(K+60)=B0*2*(J+1)
    6 EIN(K)=-EIN(K+60)
      EIN(121)=-0.073
      EIN(122)=0.073
      EIN(123)=-0.15932
      EIN(124)=0.15932
      EIN(125)=0.27717
      EIN(126)=0.318
      EIN(127)=0.477
      EIN(128)=0.636
      EIN(129)=4.06
      EIN(130)=8.50
      EIN(131)=9.60
      APOPV2=DEXP(EIN(121)/AKT)
      APOPV1=DEXP(EIN(123)/AKT)
C     WRITE(6,99) FROT0,(PJ(J),J=1,60)
C  99 FORMAT(2X,'POP OF STATES=',/,10(2X,D10.3))
C     WRITE(6,98) (EIN(J),J=1,140)
C  98 FORMAT(2X,'TRANS ENERGY=',/,10(2X,D10.3))
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       NITROUS OXIDE  '
      SCRPT(3)=' IONISATION    ELOSS= 12.886  '
      SCRPT(4)=' ATTACHMENT (NO DEATTACHMENT) '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' ROT 1-0       ELOSS= -0.00010'
      SCRPT(8)=' ROT 2-1       ELOSS= -0.00021'
      SCRPT(9)=' ROT 3-2       ELOSS= -0.00031'
      SCRPT(10)=' ROT 4-3       ELOSS= -0.00041'
      SCRPT(11)=' ROT 5-4       ELOSS= -0.00052'
      SCRPT(12)=' ROT 6-5       ELOSS= -0.00062'
      SCRPT(13)=' ROT 7-6       ELOSS= -0.00073'
      SCRPT(14)=' ROT 8-7       ELOSS= -0.00083'
      SCRPT(15)=' ROT 9-8       ELOSS= -0.00093'
      SCRPT(16)=' ROT 10-9      ELOSS= -0.00104'
      SCRPT(17)=' ROT 11-10     ELOSS= -0.00114'
      SCRPT(18)=' ROT 12-11     ELOSS= -0.00124'
      SCRPT(19)=' ROT 13-12     ELOSS= -0.00135'
      SCRPT(20)=' ROT 14-13     ELOSS= -0.00145'
      SCRPT(21)=' ROT 15-14     ELOSS= -0.00156'
      SCRPT(22)=' ROT 16-15     ELOSS= -0.00166'
      SCRPT(23)=' ROT 17-16     ELOSS= -0.00176'
      SCRPT(24)=' ROT 18-17     ELOSS= -0.00187'
      SCRPT(25)=' ROT 19-18     ELOSS= -0.00197'
      SCRPT(26)=' ROT 20-19     ELOSS= -0.00207'
      SCRPT(27)=' ROT 21-20     ELOSS= -0.00218'
      SCRPT(28)=' ROT 22-21     ELOSS= -0.00228'
      SCRPT(29)=' ROT 23-22     ELOSS= -0.00239'
      SCRPT(30)=' ROT 24-23     ELOSS= -0.00249'
      SCRPT(31)=' ROT 25-24     ELOSS= -0.00259'
      SCRPT(32)=' ROT 26-25     ELOSS= -0.00270'
      SCRPT(33)=' ROT 27-26     ELOSS= -0.00280'
      SCRPT(34)=' ROT 28-27     ELOSS= -0.00290'
      SCRPT(35)=' ROT 29-28     ELOSS= -0.00301'
      SCRPT(36)=' ROT 30-29     ELOSS= -0.00311'
      SCRPT(37)=' ROT 31-30     ELOSS= -0.00321'
      SCRPT(38)=' ROT 32-31     ELOSS= -0.00332'
      SCRPT(39)=' ROT 33-32     ELOSS= -0.00342'
      SCRPT(40)=' ROT 34-33     ELOSS= -0.00353'
      SCRPT(41)=' ROT 35-34     ELOSS= -0.00363'
      SCRPT(42)=' ROT 36-35     ELOSS= -0.00373'
      SCRPT(43)=' ROT 37-36     ELOSS= -0.00384'
      SCRPT(44)=' ROT 38-37     ELOSS= -0.00394'
      SCRPT(45)=' ROT 39-38     ELOSS= -0.00404'
      SCRPT(46)=' ROT 40-39     ELOSS= -0.00415'
      SCRPT(47)=' ROT 41-40     ELOSS= -0.00425'
      SCRPT(48)=' ROT 42-41     ELOSS= -0.00436'
      SCRPT(49)=' ROT 43-42     ELOSS= -0.00446'
      SCRPT(50)=' ROT 44-43     ELOSS= -0.00456'
      SCRPT(51)=' ROT 45-44     ELOSS= -0.00467'
      SCRPT(52)=' ROT 46-45     ELOSS= -0.00477'
      SCRPT(53)=' ROT 47-46     ELOSS= -0.00487'
      SCRPT(54)=' ROT 48-47     ELOSS= -0.00498'
      SCRPT(55)=' ROT 49-48     ELOSS= -0.00508'
      SCRPT(56)=' ROT 50-49     ELOSS= -0.00519'
      SCRPT(57)=' ROT 51-50     ELOSS= -0.00529'
      SCRPT(58)=' ROT 52-51     ELOSS= -0.00539'
      SCRPT(59)=' ROT 53-52     ELOSS= -0.00550'
      SCRPT(60)=' ROT 54-53     ELOSS= -0.00560'
      SCRPT(61)=' ROT 55-54     ELOSS= -0.00570'
      SCRPT(62)=' ROT 56-55     ELOSS= -0.00581'
      SCRPT(63)=' ROT 57-56     ELOSS= -0.00591'
      SCRPT(64)=' ROT 58-57     ELOSS= -0.00601'
      SCRPT(65)=' ROT 59-58     ELOSS= -0.00612'
      SCRPT(66)=' ROT 60-59     ELOSS= -0.00622'
      SCRPT(67)=' ROT 0-1       ELOSS=  0.00010'
      SCRPT(68)=' ROT 1-2       ELOSS=  0.00021'
      SCRPT(69)=' ROT 2-3       ELOSS=  0.00031'
      SCRPT(70)=' ROT 3-4       ELOSS=  0.00041'
      SCRPT(71)=' ROT 4-5       ELOSS=  0.00052'
      SCRPT(72)=' ROT 5-6       ELOSS=  0.00062'
      SCRPT(73)=' ROT 6-7       ELOSS=  0.00073'
      SCRPT(74)=' ROT 7-8       ELOSS=  0.00083'
      SCRPT(75)=' ROT 8-9       ELOSS=  0.00093'
      SCRPT(76)=' ROT 9-10      ELOSS=  0.00104'
      SCRPT(77)=' ROT 10-11     ELOSS=  0.00114'
      SCRPT(78)=' ROT 11-12     ELOSS=  0.00124'
      SCRPT(79)=' ROT 12-13     ELOSS=  0.00135'
      SCRPT(80)=' ROT 13-14     ELOSS=  0.00145'
      SCRPT(81)=' ROT 14-15     ELOSS=  0.00156'
      SCRPT(82)=' ROT 15-16     ELOSS=  0.00166'
      SCRPT(83)=' ROT 16-17     ELOSS=  0.00176'
      SCRPT(84)=' ROT 17-18     ELOSS=  0.00187'
      SCRPT(85)=' ROT 18-19     ELOSS=  0.00197'
      SCRPT(86)=' ROT 19-20     ELOSS=  0.00207'
      SCRPT(87)=' ROT 20-21     ELOSS=  0.00218'
      SCRPT(88)=' ROT 21-22     ELOSS=  0.00228'
      SCRPT(89)=' ROT 22-23     ELOSS=  0.00239'
      SCRPT(90)=' ROT 23-24     ELOSS=  0.00249'
      SCRPT(91)=' ROT 24-25     ELOSS=  0.00259'
      SCRPT(92)=' ROT 25-26     ELOSS=  0.00270'
      SCRPT(93)=' ROT 26-27     ELOSS=  0.00280'
      SCRPT(94)=' ROT 27-28     ELOSS=  0.00290'
      SCRPT(95)=' ROT 28-29     ELOSS=  0.00301'
      SCRPT(96)=' ROT 29-30     ELOSS=  0.00311'
      SCRPT(97)=' ROT 30-31     ELOSS=  0.00321'
      SCRPT(98)=' ROT 31-32     ELOSS=  0.00332'
      SCRPT(99)=' ROT 32-33     ELOSS=  0.00342'
      SCRPT(100)=' ROT 33-34     ELOSS=  0.00353'
      SCRPT(101)=' ROT 34-35     ELOSS=  0.00363'
      SCRPT(102)=' ROT 35-36     ELOSS=  0.00373'
      SCRPT(103)=' ROT 36-37     ELOSS=  0.00384'
      SCRPT(104)=' ROT 37-38     ELOSS=  0.00394'
      SCRPT(105)=' ROT 38-39     ELOSS=  0.00404'
      SCRPT(106)=' ROT 39-40     ELOSS=  0.00415'
      SCRPT(107)=' ROT 40-41     ELOSS=  0.00425'
      SCRPT(108)=' ROT 41-42     ELOSS=  0.00436'
      SCRPT(109)=' ROT 42-43     ELOSS=  0.00446'
      SCRPT(110)=' ROT 43-44     ELOSS=  0.00456'
      SCRPT(111)=' ROT 44-45     ELOSS=  0.00467'
      SCRPT(112)=' ROT 45-46     ELOSS=  0.00477'
      SCRPT(113)=' ROT 46-47     ELOSS=  0.00487'
      SCRPT(114)=' ROT 47-48     ELOSS=  0.00498'
      SCRPT(115)=' ROT 48-49     ELOSS=  0.00508'
      SCRPT(116)=' ROT 49-50     ELOSS=  0.00519'
      SCRPT(117)=' ROT 50-51     ELOSS=  0.00529'
      SCRPT(118)=' ROT 51-52     ELOSS=  0.00539'
      SCRPT(119)=' ROT 52-53     ELOSS=  0.00550'
      SCRPT(120)=' ROT 53-54     ELOSS=  0.00560'
      SCRPT(121)=' ROT 54-55     ELOSS=  0.00570'
      SCRPT(122)=' ROT 55-56     ELOSS=  0.00581'
      SCRPT(123)=' ROT 56-57     ELOSS=  0.00591'
      SCRPT(124)=' ROT 57-58     ELOSS=  0.00601'
      SCRPT(125)=' ROT 58-59     ELOSS=  0.00612'
      SCRPT(126)=' ROT 59-60     ELOSS=  0.00622'
      SCRPT(127)=' VIB V2        ELOSS= -0.073  '
      SCRPT(128)=' VIB V2        ELOSS=  0.073  '
      SCRPT(129)=' VIB V1        ELOSS= -0.159  '
      SCRPT(130)=' VIB V1        ELOSS=  0.159  '
      SCRPT(131)=' VIB V3        ELOSS=  0.277  '
      SCRPT(132)=' VIB 2V1       ELOSS=  0.318  '
      SCRPT(133)=' VIB 3V1       ELOSS=  0.477  '
      SCRPT(134)=' VIB HIGH      ELOSS=  0.636  '
      SCRPT(135)=' EXC           ELOSS=  4.06   '
      SCRPT(136)=' EXC           ELOSS=  8.50   '
      SCRPT(137)=' EXC           ELOSS=  9.60   '
      EN=-ESTEP/2.0
      DO 1000 I=1,NSTEP
      EN=EN+ESTEP
      DO 10 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 20
   10 CONTINUE
      J=NDATA
   20 A=(YXSEC(J)-YXSEC(J-1))/(XEN(J)-XEN(J-1))
      B=(XEN(J-1)*YXSEC(J)-XEN(J)*YXSEC(J-1))/(XEN(J-1)-XEN(J))
      Q(2,I)=(A*EN+B)*1.0D-16
C
      Q(3,I)=0.0
      IF(EN.LT.E(3)) GO TO 50
      DO 30 J=2,NION
      IF(EN.LE.XION(J)) GO TO 40
   30 CONTINUE
      J=NION
   40 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
C
   50 Q(4,I)=0.0
      IF(EN.LT.XATT(1)) GO TO 60
      IF(EN.GT.XATT(NATT)) GO TO 60
      DO 51 J=2,NATT
      IF(EN.LE.XATT(J)) GO TO 52
   51 CONTINUE
      J=NATT
   52 A=(YATT(J)-YATT(J-1))/(XATT(J)-XATT(J-1))
      B=(XATT(J-1)*YATT(J)-XATT(J)*YATT(J-1))/(XATT(J-1)-XATT(J))
      Q(4,I)=(A*EN+B)*1.D-18*SCALEAT
C
   60 Q(5,I)=0.0
      Q(6,I)=0.0
C----------------------------------------------------------------------
C DIPOLE BORN ROTATIONAL STATES
C---------------------------------------------------------------------
      ENRT=DSQRT(EN)
C SUPERELASTIC COLLISIONS
      DO 100 L=1,60
      AL=DFLOAT(L)
      QIN(L,I)=PJ(L)*DBK*DLOG((ENRT+DSQRT(EN-EIN(L)))/(DSQRT(EN-EIN(L))-
     /ENRT))*AL/((2.0*AL+1.0)*EN)
  100 PEQIN(L,I)=0.5+(QIN(L,I)-DRAT*QIN(L,I))/QIN(L,I)
C ROT 0-1
      IF(EN.LE.EIN(61)) GO TO 200
      QIN(61,I)=FROT0*DBK*DLOG((ENRT+DSQRT(EN-EIN(61)))/(ENRT-DSQRT(EN-
     /EIN(61))))/EN
      PEQIN(61,I)=0.5+(QIN(61,I)-DRAT*QIN(61,I))/QIN(61,I)
C ROT 1-2 AND HIGHER
      DO 160 L=62,120
      IF(EN.LE.EIN(L)) GO TO 200
      AL=DFLOAT(L-61)
      QIN(L,I)=PJ(L-61)*DBK*DLOG((ENRT+DSQRT(EN-EIN(L)))/(ENRT-DSQRT(EN-
     /EIN(L))))*(AL+1.0)/((2.0*AL+1.0)*EN)
  160 PEQIN(L,I)=0.5+(QIN(L,I)-DRAT*QIN(L,I))/QIN(L,I)
C
C SUPERELASTIC V2 BEND MODE
  200 QIN(121,I)=0.0
      IF(EN.LE.0.0) GO TO 325
      EFAC=DSQRT(1.0-(EIN(121)/EN))
      QIN(121,I)=AMPV2*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      DO 310 J=2,NVIBH
      IF((EN+EIN(122)).LE.XVIBH(J)) GO TO 320
  310 CONTINUE
      J=NVIBH
  320 A=(YVIBH(J)-YVIBH(J-1))/(XVIBH(J)-XVIBH(J-1))
      B=(XVIBH(J-1)*YVIBH(J)-XVIBH(J)*YVIBH(J-1))/(XVIBH(J-1)-XVIBH(J))
      QIN(121,I)=QIN(121,I)+ARESV2*(EN+EIN(122))*(A*(EN+EIN(122))+B)/EN
C   FACTOR 0.5 FROM LEVEL DEGENERACY
      QIN(121,I)=0.5*QIN(121,I)*APOPV2/(1.0+APOPV2)*1.D-16
C V2 BEND MODE
  325 CONTINUE
      QIN(122,I)=0.0
      IF(EN.LE.EIN(122)) GO TO 350
      EFAC=DSQRT(1.0-(EIN(122)/EN))
      QIN(122,I)=AMPV2*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      DO 330 J=2,NVIBH
      IF(EN.LE.XVIBH(J)) GO TO 340
  330 CONTINUE
      J=NVIBH
  340 A=(YVIBH(J)-YVIBH(J-1))/(XVIBH(J)-XVIBH(J-1))
      B=(XVIBH(J-1)*YVIBH(J)-XVIBH(J)*YVIBH(J-1))/(XVIBH(J-1)-XVIBH(J))
      QIN(122,I)=QIN(122,I)+ARESV2*(A*EN+B)
      QIN(122,I)=QIN(122,I)*1.0/(1.0+APOPV2)*1.D-16
  350 CONTINUE
C SUPERELASTIC V1 SYMMETRIC STRETCH
      QIN(123,I)=0.0
      IF(EN.LE.0.0) GO TO 375
      EFAC=DSQRT(1.0-(EIN(123)/EN))
      QIN(123,I)=AMPV1*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      DO 360 J=2,NVIBH
      IF((EN+EIN(124)).LE.XVIBH(J)) GO TO 370
  360 CONTINUE
      J=NVIBH
  370 A=(YVIBH(J)-YVIBH(J-1))/(XVIBH(J)-XVIBH(J-1))
      B=(XVIBH(J-1)*YVIBH(J)-XVIBH(J)*YVIBH(J-1))/(XVIBH(J-1)-XVIBH(J))
      QIN(123,I)=QIN(123,I)+ARESV1*(EN+EIN(124))*(A*(EN+EIN(124))+B)/EN
      DO 371 J=2,NVIBR
      IF((EN+EIN(124)).LE.XVIBR(J)) GO TO 372
  371 CONTINUE
      J=NVIBR
  372 A=(YVIBR(J)-YVIBR(J-1))/(XVIBR(J)-XVIBR(J-1))
      B=(XVIBR(J-1)*YVIBR(J)-XVIBR(J)*YVIBR(J-1))/(XVIBR(J-1)-XVIBR(J))
      QIN(123,I)=QIN(123,I)+ARESVR*(EN+EIN(124))*(A*(EN+EIN(124))+B)/EN
      QIN(123,I)=QIN(123,I)*APOPV1/(1.0+APOPV1)*1.D-16
C V1 SYMMETRIC STRETCH
  375 CONTINUE
      QIN(124,I)=0.0
      IF(EN.LE.EIN(124)) GO TO 400
      EFAC=DSQRT(1.0-(EIN(124)/EN))
      QIN(124,I)=AMPV1*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      DO 380 J=2,NVIBH
      IF(EN.LE.XVIBH(J)) GO TO 390
  380 CONTINUE
      J=NVIBH
  390 A=(YVIBH(J)-YVIBH(J-1))/(XVIBH(J)-XVIBH(J-1))
      B=(XVIBH(J-1)*YVIBH(J)-XVIBH(J)*YVIBH(J-1))/(XVIBH(J-1)-XVIBH(J))
      QIN(124,I)=QIN(124,I)+ARESV1*(A*EN+B)
      DO 391 J=2,NVIBR
      IF(EN.LE.XVIBR(J)) GO TO 392
  391 CONTINUE
      J=NVIBR
  392 A=(YVIBR(J)-YVIBR(J-1))/(XVIBR(J)-XVIBR(J-1))
      B=(XVIBR(J-1)*YVIBR(J)-XVIBR(J)*YVIBR(J-1))/(XVIBR(J-1)-XVIBR(J))
      QIN(124,I)=QIN(124,I)+ARESVR*(A*EN+B)
      QIN(124,I)=QIN(124,I)*1.0/(1.0+APOPV1)*1.D-16
  400 CONTINUE
C V3 ASYMMETRIC STRETCH
      QIN(125,I)=0.0
      IF(EN.LE.EIN(125)) GO TO 450
      EFAC=DSQRT(1.0-(EIN(125)/EN))
      QIN(125,I)=AMPV3*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      DO 410 J=2,NVIBH
      IF(EN.LE.XVIBH(J)) GO TO 420
  410 CONTINUE
      J=NVIBH
  420 A=(YVIBH(J)-YVIBH(J-1))/(XVIBH(J)-XVIBH(J-1))
      B=(XVIBH(J-1)*YVIBH(J)-XVIBH(J)*YVIBH(J-1))/(XVIBH(J-1)-XVIBH(J))
      QIN(125,I)=QIN(125,I)+ARESV3*(A*EN+B)
      QIN(125,I)=QIN(125,I)*1.D-16
C 2V1 SYMMETRIC STRETCH HARMONICS
  450 CONTINUE
      QIN(126,I)=0.0
      IF(EN.LE.EIN(126)) GO TO 500
      DO 460 J=2,NVIBH
      IF(EN.LE.XVIBH(J)) GO TO 470
  460 CONTINUE
      J=NVIBH
  470 A=(YVIBH(J)-YVIBH(J-1))/(XVIBH(J)-XVIBH(J-1))
      B=(XVIBH(J-1)*YVIBH(J)-XVIBH(J)*YVIBH(J-1))/(XVIBH(J-1)-XVIBH(J))
      QIN(126,I)=ARES2V1*(A*EN+B)*1.D-16
C 3V1 SYMMETRIC STRETCH HARMONICS
  500 CONTINUE
      QIN(127,I)=0.0
      IF(EN.LE.EIN(127)) GO TO 550
      QIN(127,I)=QIN(126,I)*0.6
C SUM OF HIGHER VIBRATIONAL HARMONICS
  550 CONTINUE
      QIN(128,I)=0.0
      IF(EN.LE.EIN(128)) GO TO 600
      QIN(128,I)=QIN(127,I)*0.9
  600 CONTINUE
      QIN(129,I)=0.0
      IF(EN.LE.EIN(129)) GO TO 650
      DO 610 J=2,NEXC1
      IF(EN.LE.XEXC1(J)) GO TO 620
  610 CONTINUE
      J=NEXC1
  620 A=(YEXC1(J)-YEXC1(J-1))/(XEXC1(J)-XEXC1(J-1))
      B=(XEXC1(J-1)*YEXC1(J)-XEXC1(J)*YEXC1(J-1))/(XEXC1(J-1)-XEXC1(J))
      QIN(129,I)=(A*EN+B)*1.D-16
  650 CONTINUE
      QIN(130,I)=0.0
      IF(EN.LE.EIN(130)) GO TO 700
      DO 660 J=2,NEXC2
      IF(EN.LE.XEXC2(J)) GO TO 670
  660 CONTINUE
      J=NEXC2
  670 A=(YEXC2(J)-YEXC2(J-1))/(XEXC2(J)-XEXC2(J-1))
      B=(XEXC2(J-1)*YEXC2(J)-XEXC2(J)*YEXC2(J-1))/(XEXC2(J-1)-XEXC2(J))
      QIN(130,I)=(A*EN+B)*1.D-16
  700 CONTINUE
      QIN(131,I)=0.0
      IF(EN.LE.EIN(131)) GO TO 750
      DO 710 J=2,NEXC3
      IF(EN.LE.XEXC3(J)) GO TO 720
  710 CONTINUE
      J=NEXC3
  720 A=(YEXC3(J)-YEXC3(J-1))/(XEXC3(J)-XEXC3(J-1))
      B=(XEXC3(J-1)*YEXC3(J)-XEXC3(J)*YEXC3(J-1))/(XEXC3(J-1)-XEXC3(J))
      QIN(131,I)=(A*EN+B)*1.D-16
  750 CONTINUE
      SUMROT=0.0
      DO 800 L=1,120
  800 SUMROT=SUMROT+QIN(L,I)
C GET ELASTIC MOMENTUM TRANSFER
      Q(2,I)=Q(2,I)-SUMROT*DRAT
C Q(1,I) USED ONLY FOR INFORMATION
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+QIN(121,I)+QIN(122,I)+QIN(123,I)+
     /QIN(124,I)+QIN(125,I)+QIN(126,I)+QIN(127,I)+QIN(128,I)+QIN(129,I)+
     /QIN(130,I)+QIN(131,I)+SUMROT*DRAT
 1000 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(131)) NIN=130
      IF(EFINAL.LE.EIN(130)) NIN=129
      IF(EFINAL.LE.EIN(129)) NIN=128
      IF(EFINAL.LE.EIN(128)) NIN=127
      IF(EFINAL.LE.EIN(127)) NIN=126
      IF(EFINAL.LE.EIN(126)) NIN=125
      IF(EFINAL.LE.EIN(125)) NIN=124
      IF(EFINAL.LE.EIN(124)) NIN=123
      RETURN
      END
      SUBROUTINE GAS19(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      DIMENSION XEN(50),YXSEC(50),XVIB1(31),YVIB1(31),XVIB2(31),
     /YVIB2(31),XVIB3(18),YVIB3(18),XVIB4(31),YVIB4(31),XVIB5(21),
     /YVIB5(21),XEXC1(17),YEXC1(17),XEXC2(24),YEXC2(24),XEXC3(23),
     /YEXC3(23),XION(57),YION(57),XATT(16),YATT(16)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      DATA XEN/0.00,0.01,.014,0.02,.025,0.03,0.04,0.05,0.06,0.07,
     /0.08,0.09,0.10,0.12,0.14,0.17,0.20,0.25,0.30,0.40,
     /0.50,0.60,0.80,1.00,1.40,2.00,3.00,4.00,5.00,6.00,
     /7.00,8.00,10.0,14.0,20.0,30.0,40.0,50.0,70.0,100.,
     /140.,200.,300.,400.,600.,800.,1000.,2000.,10000.,100000./
      DATA YXSEC/8.40,8.40,7.80,7.20,6.60,6.00,4.90,3.90,3.00,2.70,
     /2.60,2.60,2.70,3.00,3.35,3.85,4.40,5.35,6.20,8.00,
     /9.60,11.0,13.0,14.5,16.0,17.0,17.0,16.5,16.5,17.5,
     /19.5,19.5,17.5,12.5,8.00,5.00,3.60,2.70,1.90,1.25,
     /0.85,0.58,0.37,0.27,0.17,0.12,0.10,.047,.008,.00006/
      DATA XVIB1/.117,1.00,1.20,1.40,1.60,1.80,2.00,2.20,2.40,2.60,
     /2.80,3.00,3.20,4.00,5.00,6.00,7.00,8.00,9.00,10.0,
     /11.0,15.0,20.0,25.0,30.0,50.0,100.,200.,1000.,10000.,
     /100000./
      DATA YVIB1/0.0,.001,.025,.044,.088,.094,.088,.063,.044,.029,
     /.014,.013,.038,.088,.125,.163,.212,.288,.312,.288,
     /.262,.125,0.10,.075,0.05,.025,0.01,.004,.0004,.000012,
     /.0000012/
      DATA XVIB2/.166,1.00,1.20,1.40,1.60,1.80,2.00,2.20,2.40,2.60,
     /2.80,3.00,3.20,4.00,5.00,6.00,7.00,8.00,9.00,10.0,
     /11.0,15.0,20.0,25.0,30.0,50.0,100.,200.,1000.,10000.,
     /100000./
      DATA YVIB2/0.00,.001,.138,0.47,2.36,3.30,2.91,2.04,1.35,0.76,
     /0.48,0.34,0.20,0.21,0.26,0.33,0.46,0.54,0.56,0.50,
     /0.41,0.23,0.18,0.14,0.10,.056,.024,0.01,.0012,.00004,
     /.000004/
      DATA XVIB3/.333,1.00,1.20,1.40,1.60,1.80,2.00,2.20,2.40,2.60,
     /2.80,3.00,3.20,10.0,100.0,1000.,10000.,100000./
      DATA YVIB3/0.00,.001,.094,0.11,0.51,0.94,0.85,0.56,0.33,0.19,
     /.094,0.05,.025,.0012,.00012,.000012,.0000012,.00000012/
      DATA XVIB4/.375,1.00,1.20,1.40,1.60,1.80,2.00,2.20,2.40,2.60,
     /2.80,3.00,3.20,4.00,5.00,6.00,7.00,8.00,9.00,10.0,
     /11.0,15.0,20.0,25.0,30.0,50.0,100.,200.,1000.,10000.,
     /100000./
      DATA YVIB4/0.00,.001,.033,.056,0.34,0.54,0.50,0.40,0.29,0.20,
     /0.16,0.14,0.14,0.18,0.30,0.50,0.63,0.65,0.58,0.48,
     /0.36,0.20,0.15,0.13,0.09,0.05,.021,.009,.0011,.00004,
     /.000004/
      DATA XVIB5/0.75,1.00,3.00,4.00,5.00,6.00,7.00,8.00,9.00,10.0,
     /11.0,15.0,20.0,25.0,30.0,50.0,100.,200.,1000.,10000.,
     /100000./
      DATA YVIB5/0.00,.0001,.001,.017,.030,0.05,0.06,.065,.058,.048,
     /.036,.020,.015,.012,.009,.005,.0021,.0009,.00011,.000004,
     /.0000004/
      DATA XEXC1/3.70,3.77,4.00,4.50,5.00,6.00,7.00,8.00,9.00,10.0,
     /14.0,20.0,30.0,100.,1000.,10000.,100000./
      DATA YEXC1/0.00,0.01,0.05,0.24,0.45,0.54,0.54,0.48,0.41,0.31,
     /0.12,.041,.010,.001,.0001,.00001,.000001/
      DATA XEXC2/4.85,4.90,5.00,5.50,6.00,7.00,8.00,9.00,10.0,14.0,
     /20.0,30.0,40.0,50.0,70.0,100.,140.,200.,300.,500.,
     /700.,1000.,10000.,100000./
      DATA YEXC2/0.00,.009,.019,.056,0.23,0.56,0.80,1.08,1.30,2.17,
     /3.09,3.88,4.00,3.76,3.38,3.01,2.40,1.79,1.18,0.66,
     /0.48,0.35,0.035,.0035/
      DATA XEXC3/7.10,7.15,8.00,8.50,9.00,10.0,14.0,20.0,25.0,30.0,
     /40.0,50.0,60.0,70.0,100.,140.,200.,300.,500.,700.,
     /1000.,10000.,100000./
      DATA YEXC3/0.00,0.01,0.08,0.14,0.25,0.41,0.82,1.07,1.10,1.12,
     /1.00,0.94,0.80,0.72,0.49,0.35,0.25,0.17,0.10,0.07,
     /0.05,.005,.0005/
      DATA XION/10.5,10.55,11.0,11.5,12.0,12.5,13.0,13.5,14.0,14.5,
     /15.0,16.0,17.0,18.0,19.0,21.0,22.0,24.0,26.0,28.0,
     /30.0,32.0,34.0,36.0,38.0,40.0,45.0,50.0,60.0,70.0,
     /80.0,90.0,100.,120.,140.,150.,175.,200.,250.,300.,
     /350.,400.,450.,500.,600.,700.,800.,900.,1000.,1250.,
     /1500.,1750.,2000.,2500.,3000.,10000.,100000./
      DATA YION/0.00,.011,.045,.087,.134,.193,.263,.345,.431,.533,
     /.641,.861,1.06,1.27,1.49,1.90,2.09,2.44,2.95,3.25,
     /3.52,3.76,3.98,4.18,4.35,4.50,4.80,5.07,5.47,5.69,
     /5.80,5.83,5.79,5.66,5.42,5.20,4.80,4.58,3.92,3.56,
     /3.18,2.87,2.64,2.45,2.19,1.96,1.75,1.63,1.52,1.28,
     /1.11,1.03,.908,.767,.678,0.26,.045/
      DATA XATT/6.85,7.00,7.20,7.50,8.00,8.50,9.00,9.50,10.0,10.5,
     /11.0,11.5,12.0,12.5,13.0,13.2/
      DATA YATT/0.00,0.67,1.10,1.65,2.80,4.40,6.60,10.3,14.7,12.3,
     /9.70,6.20,3.50,1.30,0.50,0.00/
      NAME='ETHENE C2H4 99 '
C ---------------------------------------------------------------------
C  1999 INCLUDED VIBRATIONAL RESONACE SHAPE FROM WALKER ET AL
C   REF J.CHEM.PHYS. 69(1978) 5532
C   NOW FITS ARGON-ETHENE MIXTURE DATA OF JEAN-MARIE ET AL.
C   AND SCHMIDTS DATA IN PURE ETHENE
C ---------------------------------------------------------------------
      NIN=10
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      NDATA=50
      NVIB1=31
      NVIB2=31
      NVIB3=18
      NVIB4=31
      NVIB5=21
      NEXC1=17
      NEXC2=24
      NEXC3=23
      NION=57
      NATT=16
      E(1)=0.0
      E(2)=2.0*EMASS/(28.05376*AMU)
      E(3)=10.5
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=10.5
      EIN(1)=-0.117
      EIN(2)=0.117
      EIN(3)=-0.166
      EIN(4)=0.166
      EIN(5)=0.333
      EIN(6)=0.375
      EIN(7)=0.750
      EIN(8)=3.70
      EIN(9)=4.85
      EIN(10)=7.10
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       ETHENE         '
      SCRPT(3)=' IONISATION    ELOSS= 10.5    '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' VIB V7        ELOSS= -0.117  '
      SCRPT(8)=' VIB V7        ELOSS=  0.117  '
      SCRPT(9)=' VIB V2+V3     ELOSS= -0.166  '
      SCRPT(10)=' VIB V2+V3     ELOSS=  0.166  '
      SCRPT(11)=' VIB 2V3+2V2   ELOSS=  0.333  '
      SCRPT(12)=' VIB V1        ELOSS=  0.375  '
      SCRPT(13)=' VIB 2V1       ELOSS=  0.750  '
      SCRPT(14)=' EXC           ELOSS=  3.70   '
      SCRPT(15)=' EXC           ELOSS=  4.85   '
      SCRPT(16)=' EXC           ELOSS=  7.10   '
      AMP1=0.091
      AMP2=0.091
      AMP3=0.10
      APOP=DEXP(EIN(1)/AKT)
      APOPH=DEXP(EIN(3)/AKT)
      EN=-ESTEP/2.0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      DO 10 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 20
   10 CONTINUE
      J=NDATA
   20 A=(YXSEC(J)-YXSEC(J-1))/(XEN(J)-XEN(J-1))
      B=(XEN(J-1)*YXSEC(J)-XEN(J)*YXSEC(J-1))/(XEN(J-1)-XEN(J))
      Q(2,I)=(A*EN+B)*1.0D-16
C
      Q(3,I)=0.0
      IF(EN.LT.E(3)) GO TO 200
      DO 110 J=2,NION
      IF(EN.LE.XION(J)) GO TO 120
  110 CONTINUE
      J=NION
  120 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
C
  200 Q(4,I)=0.0
      IF(EN.LT.XATT(1)) GO TO 300
      IF(EN.GT.XATT(NATT)) GO TO 300
      DO 210 J=2,NATT
      IF(EN.LE.XATT(J)) GO TO 220
  210 CONTINUE
      J=NATT
  220 A=(YATT(J)-YATT(J-1))/(XATT(J)-XATT(J-1))
      B=(XATT(J-1)*YATT(J)-XATT(J)*YATT(J-1))/(XATT(J-1)-XATT(J))
      Q(4,I)=(A*EN+B)*1.D-21
C
  300 Q(5,I)=0.0
      Q(6,I)=0.0
C
C V7 SUPERELASTIC
      QIN(1,I)=0.0
      IF(EN.LE.0.0) GO TO 350
      EFAC=DSQRT(1.0-(EIN(1)/EN))
      QIN(1,I)=AMP1*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      DO 310 J=2,NVIB1
      IF((EN+EIN(2)).LE.XVIB1(J)) GO TO 320
  310 CONTINUE
      J=NVIB1
  320 A=(YVIB1(J)-YVIB1(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB1(J)-XVIB1(J)*YVIB1(J-1))/(XVIB1(J-1)-XVIB1(J))
      QIN(1,I)=QIN(1,I)+(EN+EIN(2))*(A*(EN+EIN(2))+B)/EN
      QIN(1,I)=QIN(1,I)*APOP/(1.0+APOP)*1.D-16
  350 CONTINUE
C
C  V7
      QIN(2,I)=0.0
      IF(EN.LE.EIN(2)) GO TO 400
      EFAC=DSQRT(1.0-(EIN(2)/EN))
      QIN(2,I)=AMP1*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      DO 360 J=2,NVIB1
      IF(EN.LE.XVIB1(J)) GO TO 370
  360 CONTINUE
      J=NVIB1
  370 A=(YVIB1(J)-YVIB1(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB1(J)-XVIB1(J)*YVIB1(J-1))/(XVIB1(J-1)-XVIB1(J))
      QIN(2,I)=QIN(2,I)+(A*EN+B)
      QIN(2,I)=QIN(2,I)/(1.0+APOP)*1.D-16
  400 CONTINUE
C
C SUPERELASTIC
      QIN(3,I)=0.0
      IF(EN.LE.0.0) GO TO 4150
      EFAC=DSQRT(1.0-(EIN(3)/EN))
      QIN(3,I)=AMP2*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      DO 4110 J=2,NVIB2
      IF((EN+EIN(4)).LE.XVIB2(J)) GO TO 4120
 4110 CONTINUE
      J=NVIB2
 4120 A=(YVIB2(J)-YVIB2(J-1))/(XVIB2(J)-XVIB2(J-1))
      B=(XVIB2(J-1)*YVIB2(J)-XVIB2(J)*YVIB2(J-1))/(XVIB2(J-1)-XVIB2(J))
      QIN(3,I)=QIN(3,I)+(EN+EIN(4))*(A*(EN+EIN(4))+B)/EN
      QIN(3,I)=QIN(3,I)*APOPH/(1.0+APOPH)*1.D-16
 4150 CONTINUE
C  V2 + V3 (SUM OF VIBRATIONS AT 166 AND 201 MV)
      QIN(4,I)=0.0
      IF(EN.LE.EIN(4)) GO TO 450
      EFAC=DSQRT(1.0-(EIN(4)/EN))
      QIN(4,I)=AMP2*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      DO 410 J=2,NVIB2
      IF(EN.LE.XVIB2(J)) GO TO 420
  410 CONTINUE
      J=NVIB2
  420 A=(YVIB2(J)-YVIB2(J-1))/(XVIB2(J)-XVIB2(J-1))
      B=(XVIB2(J-1)*YVIB2(J)-XVIB2(J)*YVIB2(J-1))/(XVIB2(J-1)-XVIB2(J))
      QIN(4,I)=QIN(4,I)+(A*EN+B)
      QIN(4,I)=QIN(4,I)/(1.0+APOPH)*1.D-16
  450 CONTINUE
C
C  2V3+2V2 (HARMONICS)
      QIN(5,I)=0.0
      IF(EN.LE.EIN(5)) GO TO 500
      DO 460 J=2,NVIB3
      IF(EN.LE.XVIB3(J)) GO TO 470
  460 CONTINUE
      J=NVIB3
  470 A=(YVIB3(J)-YVIB3(J-1))/(XVIB3(J)-XVIB3(J-1))
      B=(XVIB3(J-1)*YVIB3(J)-XVIB3(J)*YVIB3(J-1))/(XVIB3(J-1)-XVIB3(J))
      QIN(5,I)=(A*EN+B)*1.D-16
  500 CONTINUE
C
C  V1
      QIN(6,I)=0.0
      IF(EN.LE.EIN(6)) GO TO 550
      EFAC=DSQRT(1.0-(EIN(6)/EN))
      QIN(6,I)=AMP3*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      DO 510 J=2,NVIB4
      IF(EN.LE.XVIB4(J)) GO TO 520
  510 CONTINUE
      J=NVIB4
  520 A=(YVIB4(J)-YVIB4(J-1))/(XVIB4(J)-XVIB4(J-1))
      B=(XVIB4(J-1)*YVIB4(J)-XVIB4(J)*YVIB4(J-1))/(XVIB4(J-1)-XVIB4(J))
      QIN(6,I)=(QIN(6,I)+(A*EN+B))*1.D-16
  550 CONTINUE
C
C 2V1 (HARMONIC)
      QIN(7,I)=0.0
      IF(EN.LE.EIN(7)) GO TO 600
      DO 560 J=2,NVIB5
      IF(EN.LE.XVIB5(J)) GO TO 570
  560 CONTINUE
      J=NVIB5
  570 A=(YVIB5(J)-YVIB5(J-1))/(XVIB5(J)-XVIB5(J-1))
      B=(XVIB5(J-1)*YVIB5(J)-XVIB5(J)*YVIB5(J-1))/(XVIB5(J-1)-XVIB5(J))
      QIN(7,I)=(A*EN+B)*1.D-16
  600 CONTINUE
C
      QIN(8,I)=0.0
      IF(EN.LE.EIN(8)) GO TO 700
      DO 610 J=2,NEXC1
      IF(EN.LE.XEXC1(J)) GO TO 620
  610 CONTINUE
      J=NEXC1
  620 A=(YEXC1(J)-YEXC1(J-1))/(XEXC1(J)-XEXC1(J-1))
      B=(XEXC1(J-1)*YEXC1(J)-XEXC1(J)*YEXC1(J-1))/(XEXC1(J-1)-XEXC1(J))
      QIN(8,I)=(A*EN+B)*1.D-16
  700 CONTINUE
C
      QIN(9,I)=0.0
      IF(EN.LE.EIN(9)) GO TO 800
      DO 710 J=2,NEXC2
      IF(EN.LE.XEXC2(J)) GO TO 720
  710 CONTINUE
      J=NEXC2
  720 A=(YEXC2(J)-YEXC2(J-1))/(XEXC2(J)-XEXC2(J-1))
      B=(XEXC2(J-1)*YEXC2(J)-XEXC2(J)*YEXC2(J-1))/(XEXC2(J-1)-XEXC2(J))
      QIN(9,I)=(A*EN+B)*1.D-16
  800 CONTINUE
C
      QIN(10,I)=0.0
      IF(EN.LE.EIN(10)) GO TO 899
      DO 810 J=2,NEXC3
      IF(EN.LE.XEXC3(J)) GO TO 820
  810 CONTINUE
      J=NEXC3
  820 A=(YEXC3(J)-YEXC3(J-1))/(XEXC3(J)-XEXC3(J-1))
      B=(XEXC3(J-1)*YEXC3(J)-XEXC3(J)*YEXC3(J-1))/(XEXC3(J-1)-XEXC3(J))
      QIN(10,I)=(A*EN+B)*1.D-16
  899 CONTINUE
C
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+QIN(1,I)+QIN(2,I)+QIN(3,I)+QIN(4,I)+
     /QIN(5,I)+QIN(6,I)+QIN(7,I)+QIN(8,I)+QIN(9,I)+QIN(10,I)
  900 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(10)) NIN=9
      IF(EFINAL.LE.EIN(9)) NIN=8
      IF(EFINAL.LE.EIN(8)) NIN=7
      IF(EFINAL.LE.EIN(7)) NIN=6
      IF(EFINAL.LE.EIN(6)) NIN=5
      IF(EFINAL.LE.EIN(5)) NIN=4
      IF(EFINAL.LE.EIN(4)) NIN=3
      IF(EFINAL.LE.EIN(3)) NIN=2
      IF(EFINAL.LE.EIN(2)) NIN=1
      IF(EFINAL.LE.EIN(1)) NIN=0
C
      RETURN
      END
      SUBROUTINE GAS20(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      DIMENSION XEN(58),YXSEC(58),XVIB1(37),YVIB1(37),XVIB2(27),
     /YVIB2(27),XVIB3(27),YVIB3(27),XEXC1(28),YEXC1(28),XEXC2(17),
     /YEXC2(17),XEXC3(32),YEXC3(32),XION(42),YION(42),
     /XATT(16),YATT(16)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      DATA XEN/0.00,0.01,0.02,0.03,0.04,0.05,0.06,0.07,0.08,0.09,
     /0.10,0.12,0.14,0.17,0.20,0.25,0.30,0.40,0.50,0.60,
     /0.80,1.00,1.20,1.40,1.70,2.00,2.50,3.00,4.00,5.00,
     /6.00,7.00,8.00,9.00,10.0,12.0,14.0,17.0,20.0,30.0,
     /40.0,50.0,60.0,70.0,80.0,90.0,100.,120.,140.,170.,
     /200.,300.,400.,600.,800.,1000.,10000.,100000./
      DATA YXSEC/10.5,10.3,9.85,9.60,9.50,9.45,9.45,9.55,9.75,9.95,
     /10.1,10.2,10.3,10.4,10.5,10.8,11.2,12.3,13.4,14.5,
     /16.7,18.5,20.3,22.0,24.5,27.0,27.0,23.0,18.0,17.0,
     /16.5,16.0,15.0,14.0,13.0,11.0,10.0,7.80,6.60,4.10,
     /2.95,2.30,1.85,1.55,1.30,1.15,1.00,0.85,0.72,0.57,
     /0.48,0.31,0.22,0.14,0.10,0.07,.007,.0007/
C  V5
      DATA XVIB1/.0904,.092,.095,0.10,0.11,0.12,0.14,0.17,0.20,0.25,
     /0.30,0.40,0.50,0.60,0.80,1.00,1.20,1.40,1.70,2.00,
     /2.50,3.00,4.00,5.00,6.00,7.00,8.00,10.0,12.0,14.0,
     /20.0,30.0,50.0,100.,1000.,10000.,100000./
      DATA YVIB1/0.0,1.32,2.15,2.95,3.75,4.15,4.50,4.50,4.35,4.05,
     /3.70,3.20,2.90,2.60,2.30,2.05,1.80,1.70,1.70,1.85,
     /2.00,1.65,1.10,0.80,0.60,0.50,0.40,0.28,0.24,0.21,
     /.155,.110,.070,.038,.0038,.00038,.000038/
C 2V5
      DATA XVIB2/0.18,0.25,0.30,0.40,0.50,0.60,0.70,0.80,0.90,1.00,
     /1.20,1.40,1.70,2.00,2.50,3.00,4.00,5.00,6.00,7.00,
     /8.00,9.00,10.0,100.,1000.,10000.,100000./
      DATA YVIB2/0.00,0.01,.015,0.02,.023,.026,0.03,.035,0.04,0.05,
     /0.07,0.11,0.26,0.64,1.27,1.00,0.35,0.15,0.08,0.04,
     /.025,.015,.011,.001,.0001,.00001,.000001/
C V3
      DATA XVIB3/.408,.412,0.43,0.45,0.50,0.60,0.70,0.80,0.90,1.00,
     /1.20,1.40,1.70,2.00,2.50,3.00,4.00,5.00,6.00,7.00,
     /8.00,9.00,10.0,100.,1000.,10000.,100000./
      DATA YVIB3/0.00,.018,0.15,0.22,0.35,0.49,0.56,0.57,0.57,0.56,
     /0.52,0.51,0.54,0.77,1.01,0.86,0.31,0.20,0.17,.156,
     /.141,.129,.119,.018,.0018,.00018,.000018/
C
      DATA XEXC1/1.95,1.97,2.00,2.20,2.50,3.00,4.00,5.00,6.00,7.00,
     /8.00,9.00,10.0,12.0,14.0,20.0,25.0,30.0,40.0,50.0,
     /70.0,100.,140.,200.,400.,1000.,10000.,100000./
      DATA YEXC1/0.00,.009,0.09,0.50,0.80,0.89,0.85,0.74,0.61,0.52,
     /0.45,0.40,0.36,0.30,0.26,0.18,0.14,0.12,0.09,.072,
     /.055,.036,.027,.018,.009,.004,.0004,.00004/
C
      DATA XEXC2/4.90,5.00,6.00,7.00,8.00,9.00,10.0,12.0,14.0,17.0,
     /20.0,25.0,30.0,100.,1000.,10000.,100000./
      DATA YEXC2/0.00,0.01,0.10,0.19,0.29,0.33,0.35,0.34,0.28,0.17,
     /.095,0.03,.008,.001,.0001,.00001,.000001/
C
      DATA XEXC3/7.90,8.00,8.20,8.50,8.80,9.00,10.0,12.0,14.0,17.0,
     /20.0,25.0,30.0,40.0,50.0,60.0,70.0,80.0,90.0,100.,
     /120.,140.,170.,200.,250.,300.,400.,600.,800.,1000.,
     /10000.,100000./
      DATA YEXC3/0.00,0.01,0.17,0.35,0.75,1.25,1.95,2.50,2.60,2.80,
     /2.85,2.85,2.80,2.65,2.35,2.00,1.75,1.55,1.40,1.25,
     /1.00,0.90,0.74,0.61,0.48,0.40,0.30,0.20,0.15,.125,
     /.013,.0013/
C
      DATA XION/11.42,11.5,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,
     /20.0,25.0,30.0,40.0,50.0,60.0,70.0,80.0,90.0,100.,
     /120.,140.,170.,200.,250.,300.,400.,500.,600.,700.,
     /800.,900.,1000.,1500.,2000.,4000.,6000.,8000.,10000.,20000.,
     /40000.,100000./
      DATA YION/0.00,.019,.095,.280,.484,.725,.931,1.13,1.31,1.47,
     /1.63,2.66,3.32,4.05,4.41,4.61,4.70,4.73,4.72,4.67,
     /4.50,4.32,4.00,3.73,3.33,2.99,2.49,2.13,1.86,1.64,
     /1.47,1.30,1.23,.908,.720,.405,.287,.223,.184,.100,
     /.054,.023/
      DATA XATT/6.85,7.00,7.20,7.50,8.00,8.50,9.00,9.50,10.0,10.5,
     /11.0,11.5,12.0,12.5,13.0,13.2/
      DATA YATT/0.00,0.67,1.10,1.65,2.80,4.40,6.60,10.3,14.7,12.3,
     /9.70,6.20,3.50,1.30,0.50,0.00/
      NAME=' ACETYLENE 2002'
C ---------------------------------------------------------------------
C FIT TO DRIFT VELOCITY AND TRANSVERSE DIFFUSION IN PURE GAS :
C             DUNCAN AND WALKER J.CHEM.SOC (LONDON) 68 (1972) 1800
C ARGON MIXTURE DATA ( DRIFT VELOCITY ONLY) :
C          CHRISTOPHOROU ET AL NUCL.INST.METH. 163(1979)141
C    TOWNSEND COEFICIENT : HEYLEN
C ---------------------------------------------------------------------
      NIN=7
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      NDATA=58
      NVIB1=37
      NVIB2=27
      NVIB3=27
      NEXC1=28
      NEXC2=17
      NEXC3=32
      NION=42
      NATT=16
      E(1)=0.0
      E(2)=2.0*EMASS/(26.03788*AMU)
      E(3)=11.42
C CORRECT ENERGY
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=10.0
      EIN(1)=-.0904
      EIN(2)=0.0904
      EIN(3)=0.180
      EIN(4)=0.408
      EIN(5)=1.95
      EIN(6)=4.90
      EIN(7)=7.90
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       ACETYLENE      '
      SCRPT(3)=' IONISATION    ELOSS= 11.42   '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' VIB V5        ELOSS= -0.0904 '
      SCRPT(8)=' VIB V5        ELOSS=  0.0904 '
      SCRPT(9)=' VIB 2V5       ELOSS=  0.180  '
      SCRPT(10)=' VIB V3        ELOSS=  0.408  '
      SCRPT(11)=' EXC           ELOSS=  1.95   '
      SCRPT(12)=' EXC           ELOSS=  4.90   '
      SCRPT(13)=' EXC           ELOSS=  7.90   '
      EN=-ESTEP/2.0
      APOPV5=DEXP(EIN(1)/AKT)
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      DO 10 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 20
   10 CONTINUE
      J=NDATA
   20 A=(YXSEC(J)-YXSEC(J-1))/(XEN(J)-XEN(J-1))
      B=(XEN(J-1)*YXSEC(J)-XEN(J)*YXSEC(J-1))/(XEN(J-1)-XEN(J))
      Q(2,I)=(A*EN+B)*1.0D-16
C
      Q(3,I)=0.0
      IF(EN.LT.E(3)) GO TO 200
      DO 110 J=2,NION
      IF(EN.LE.XION(J)) GO TO 120
  110 CONTINUE
      J=NION
  120 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
C
  200 Q(4,I)=0.0
      IF(EN.LT.XATT(1)) GO TO 300
      IF(EN.GT.XATT(NATT)) GO TO 300
      DO 210 J=2,NATT
      IF(EN.LE.XATT(J)) GO TO 220
  210 CONTINUE
      J=NATT
  220 A=(YATT(J)-YATT(J-1))/(XATT(J)-XATT(J-1))
      B=(XATT(J-1)*YATT(J)-XATT(J)*YATT(J-1))/(XATT(J-1)-XATT(J))
      Q(4,I)=(A*EN+B)*1.D-21
  300 Q(5,I)=0.0
      Q(6,I)=0.0
C
C SUPERELASTIC V5
      QIN(1,I)=0.0
      IF(EN.LE.0.0) GO TO 330
      DO 310 J=2,NVIB1
      IF((EN+EIN(2)).LE.XVIB1(J)) GO TO 320
  310 CONTINUE
      J=NVIB1
  320 A=(YVIB1(J)-YVIB1(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB1(J)-XVIB1(J)*YVIB1(J-1))/(XVIB1(J-1)-XVIB1(J))
      QIN(1,I)=(EN+EIN(2))*(A*(EN+EIN(2))+B)*1.D-16/EN
C FACTOR 0.5 FROM DENSITY OF STATES
      QIN(1,I)=0.5*QIN(1,I)*APOPV5/(1.0+APOPV5)
  330 CONTINUE
C V5
      QIN(2,I)=0.0
      IF(EN.LE.EIN(2)) GO TO 370
      DO 350 J=2,NVIB1
      IF(EN.LE.XVIB1(J)) GO TO 360
  350 CONTINUE
      J=NVIB1
  360 A=(YVIB1(J)-YVIB1(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB1(J)-XVIB1(J)*YVIB1(J-1))/(XVIB1(J-1)-XVIB1(J))
      QIN(2,I)=(A*EN+B)*1.D-16
      QIN(2,I)=QIN(2,I)/(1.0+APOPV5)
  370 CONTINUE
C 2V5
      QIN(3,I)=0.0
      IF(EN.LE.EIN(3)) GO TO 430
      DO 410 J=2,NVIB2
      IF(EN.LE.XVIB2(J)) GO TO 420
  410 CONTINUE
      J=NVIB2
  420 A=(YVIB2(J)-YVIB2(J-1))/(XVIB2(J)-XVIB2(J-1))
      B=(XVIB2(J-1)*YVIB2(J)-XVIB2(J)*YVIB2(J-1))/(XVIB2(J-1)-XVIB2(J))
      QIN(3,I)=(A*EN+B)*1.D-16
  430 CONTINUE
C V3
      QIN(4,I)=0.0
      IF(EN.LE.EIN(4)) GO TO 470
      DO 450 J=2,NVIB3
      IF(EN.LE.XVIB3(J)) GO TO 460
  450 CONTINUE
      J=NVIB3
  460 A=(YVIB3(J)-YVIB3(J-1))/(XVIB3(J)-XVIB3(J-1))
      B=(XVIB3(J-1)*YVIB3(J)-XVIB3(J)*YVIB3(J-1))/(XVIB3(J-1)-XVIB3(J))
      QIN(4,I)=(A*EN+B)*1.D-16
  470 CONTINUE
C
      QIN(5,I)=0.0
      IF(EN.LE.EIN(5)) GO TO 530
      DO 510 J=2,NEXC1
      IF(EN.LE.XEXC1(J)) GO TO 520
  510 CONTINUE
      J=NEXC1
  520 A=(YEXC1(J)-YEXC1(J-1))/(XEXC1(J)-XEXC1(J-1))
      B=(XEXC1(J-1)*YEXC1(J)-XEXC1(J)*YEXC1(J-1))/(XEXC1(J-1)-XEXC1(J))
      QIN(5,I)=(A*EN+B)*1.D-16
  530 CONTINUE
C
      QIN(6,I)=0.0
      IF(EN.LE.EIN(6)) GO TO 570
      DO 550 J=2,NEXC2
      IF(EN.LE.XEXC2(J)) GO TO 560
  550 CONTINUE
      J=NEXC2
  560 A=(YEXC2(J)-YEXC2(J-1))/(XEXC2(J)-XEXC2(J-1))
      B=(XEXC2(J-1)*YEXC2(J)-XEXC2(J)*YEXC2(J-1))/(XEXC2(J-1)-XEXC2(J))
      QIN(6,I)=(A*EN+B)*1.D-16
  570 CONTINUE
C
      QIN(7,I)=0.0
      IF(EN.LE.EIN(7)) GO TO 630
      DO 610 J=2,NEXC3
      IF(EN.LE.XEXC3(J)) GO TO 620
  610 CONTINUE
      J=NEXC3
  620 A=(YEXC3(J)-YEXC3(J-1))/(XEXC3(J)-XEXC3(J-1))
      B=(XEXC3(J-1)*YEXC3(J)-XEXC3(J)*YEXC3(J-1))/(XEXC3(J-1)-XEXC3(J))
      QIN(7,I)=(A*EN+B)*1.D-16
  630 CONTINUE
C
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+QIN(1,I)+QIN(2,I)+QIN(3,I)+QIN(4,I)+
     /QIN(5,I)+QIN(6,I)+QIN(7,I)
  900 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LT.EIN(7)) NIN=6
      IF(EFINAL.LE.EIN(6)) NIN=5
      IF(EFINAL.LE.EIN(5)) NIN=4
      IF(EFINAL.LE.EIN(4)) NIN=3
      IF(EFINAL.LE.EIN(3)) NIN=2
      IF(EFINAL.LE.EIN(2)) NIN=1
      IF(EFINAL.LE.EIN(1)) NIN=0
C
      RETURN
      END
      SUBROUTINE GAS21(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      DIMENSION XEN(57),YXSEC(57),XROT0(57),YROT0(57),XROT1(47),YROT1(47
     /),XROT2(32),YROT2(32),XROT3(32),YROT3(32),XVIB1(40),YVIB1(40),
     /XVIB2(39),YVIB2(39),XVIB3(16),YVIB3(16),XVIB4(15),YVIB4(15),
     /XEXC1(20),YEXC1(20),XEXC2(23),YEXC2(23),XATT(18),YATT(18),
     /XION(72),YION(72),PJ(5)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
C --------------------------------------------------------------
C ELASTIC MT
      DATA XEN/0.00,.001,.003,.005,.007,0.01,0.02,0.03,0.04,.046,
     /0.05,0.06,0.07,0.08,0.09,0.10,0.13,0.15,0.20,0.30,
     /0.40,0.50,0.60,0.70,0.90,1.00,1.10,1.40,1.50,1.60,
     /1.80,2.00,2.50,3.00,4.00,5.00,6.00,8.00,10.0,15.0,
     /20.0,30.0,40.0,50.0,60.0,80.0,100.,150.,200.,300.,
     /400.,500.,600.,800.,1000.,10000.,100000./
      DATA YXSEC/7.20,7.25,7.35,7.45,7.56,7.72,8.14,8.56,8.98,9.10,
     /9.27,9.53,9.79,10.04,10.25,10.47,11.08,11.43,12.06,13.00,
     /13.71,14.45,15.19,15.64,16.14,16.47,16.84,18.10,18.42,18.59,
     /18.15,17.90,17.30,16.40,13.80,11.80,9.800,7.20,5.10,2.80,
     /1.80,0.95,0.64,0.45,0.34,0.22,0.15,0.07,.043,.022,
     /.014,.010,.006,.004,.002,.0002,.00002/
C-----------------------------------------------------------------------
C ROTATION J=0-2
      DATA XROT0/.0439,.046,.047,.048,.049,.050,.051,.054,.055,
     /.060,
     /.065,.070,.080,.090,0.10,0.11,0.12,0.13,0.14,0.15,
     /0.20,0.25,0.30,0.35,0.40,0.45,0.50,0.55,0.60,0.65,
     /0.70,0.80,0.90,1.00,1.10,1.20,1.35,1.50,1.75,2.00,
     /2.50,3.00,3.50,4.00,4.50,5.00,6.00,7.00,8.00,9.00,
     /10.0,15.0,20.0,100.,1000.,10000.,100000./
      DATA YROT0/0.00,.0206,.0276,.0286,.0297,.0308,.0310,.0330,.0340,
     /.0394,
     /.0452,.0507,.0614,.0680,.0740,.0790,.0835,.088,.0925,.0970,
     /.115,.132,.152,.175,.200,.228,.260,.291,.323,.359,
     /.394,.469,.555,.636,.716,.796,.916,1.036,1.203,1.370,
     /1.585,1.704,1.755,1.758,1.732,1.689,1.579,1.462,1.350,1.248,
     /1.156,0.730,0.44,0.05,.0015,.0005,.00015/
C-----------------------------------------------------------------------
C ROTATION J=1-3
      DATA XROT1/0.0727,.075,.080,.085,.090,.095,0.10,0.11,0.12,0.13,
     /0.15,0.20,0.25,0.30,0.35,0.40,0.45,0.50,0.56,0.60,
     /0.66,0.70,0.80,0.90,1.01,1.20,1.40,1.60,1.80,2.00,
     /2.50,3.00,3.50,4.00,4.50,5.00,6.00,7.00,8.00,9.00,
     /10.0,15.0,20.0,100.,1000.,10000.,100000./
      DATA YROT1/0.00,.0085,.0149,.0203,.0238,.0266,.0282,.0351,.0403,
     /.0449,.0520,.0604,.0719,.0870,.1029,.1191,.1361,.1543,.1773,.1944,
     /.2212,.2396,.2839,.3328,.3842,.489,.569,.658,.743,.818,
     /.952,1.020,1.046,1.050,1.036,1.011,.946,.876,.809,.748,
     /.694,.440,.265,0.03,0.001,.0001,.00001/
C-----------------------------------------------------------------------
C ROTATION J=2-4  (ALSO USE THESE VALUES FOR 4-6 TRANSITION)
      DATA XROT2/0.1008,0.15,0.20,0.25,0.30,0.35,0.40,0.45,0.50,0.60,
     /0.70,0.80,0.90,1.00,1.50,2.00,2.50,3.00,3.50,4.00,
     /4.50,5.00,5.50,6.00,7.00,8.00,10.0,20.0,100.,1000.,
     /10000.,100000./
      DATA YROT2/0.00,.0249,.0367,.0475,.0577,.0694,.0834,.1003,.1192,
     /.145,.178,.216,.256,.299,.436,.543,.600,.649,.670,.672,
     /.662,.646,.627,.605,.561,.517,.444,0.17,.017,.0007,
     /.00007,.000007/
C-----------------------------------------------------------------------
C ROTATION J=3-5  (ALSO USE THESE VALUES  FOR 5-7 TRANSITION)
      DATA XROT3/0.1280,0.15,0.20,0.25,0.30,0.35,0.40,0.45,0.50,0.60,
     /0.70,0.80,0.90,1.00,1.50,2.00,2.50,3.00,3.50,4.00,
     /4.50,5.00,5.50,6.00,7.00,8.00,10.0,20.0,100.,1000.,
     /10000.,100000./
      DATA YROT3/0.00,.019,.033,.043,.050,.058,.066,.075,.085,.104,
     /.128,.154,.185,.214,.334,.565,.700,.750,.825,.828,
     /.818,.797,.774,.747,.692,.640,.548,0.18,0.02,.0007,
     /.00007,.000007/
C-----------------------------------------------------------------------
C VIBRATION V=0-1 DELTAJ=0  ROTATIONALLY ELASTIC
      DATA XVIB1/0.516,0.56,0.58,0.60,0.65,0.75,0.85,0.95,1.00,1.05,
     /1.10,1.15,1.20,1.30,1.40,1.60,1.80,2.20,2.40,2.60,
     /3.00,3.50,4.00,4.50,5.00,6.00,7.00,8.00,9.00,10.0,
     /11.0,12.0,13.0,14.0,15.0,20.0,100.,1000.,10000.,100000./
      DATA YVIB1/0.00,.0007,.0025,.0063,.0070,.0103,.0164,.0269,.0331,
     /.0386,.0435,.0483,.0525,.0626,.0707,.0926,.1166,.1556,.1635,.1719,
     /.1916,.2008,.1860,.1630,.1460,.1160,.0876,.0637,.0506,.0376,
     /.0292,.0215,.0180,.0170,.0150,.0092,.0018,.00006,.000006,.0000007/
C-----------------------------------------------------------------------
C VIBRATION V=0-1 DELTAJ=2  ROTATIONALLY INELASTIC
      DATA XVIB2/0.558,.575,0.60,0.65,0.75,0.85,0.95,1.00,1.05,1.10,
     /1.15,1.20,1.30,1.40,1.60,1.80,2.20,2.40,2.60,3.00,
     /3.50,4.00,4.50,5.00,6.00,7.00,8.00,9.00,10.0,11.0,
     /12.0,13.0,14.0,15.0,20.0,100.,1000.,10000.,100000./
      DATA YVIB2/0.00,.0002,.0016,.0027,.0056,.0107,.0197,.0255,.0305,
     /.0356,.0408,.0459,.0579,.0671,.0954,.1279,.1829,.1963,.2141,.2494,
     /.2672,.2540,.2270,.2040,.1640,.1224,.0879,.0684,.0498,.0388,
     /.0285,.0200,.0150,.0100,.0062,.0012,.00004,.000004,.0000004/
C-----------------------------------------------------------------------
C  VIBRATION V=0-2
      DATA XVIB3/1.023,1.34,1.50,2.00,3.00,4.00,5.00,6.00,8.00,10.0,
     /15.0,20.0,100.,1000.,10000.,100000./
      DATA YVIB3/0.00,.001,.002,.014,.035,.037,.035,.029,.021,.014,
     /.002,.001,.0003,.00001,.000001,.0000001/
C-----------------------------------------------------------------------
C  VIBRATION V=0-3
      DATA XVIB4/1.480,1.95,2.00,3.00,4.00,5.00,6.00,8.00,10.0,15.0,
     /20.0,100.,1000.,10000.,100000./
      DATA YVIB4/0.00,.001,.0012,.0036,.0037,.0035,.0027,.0019,.0012,
     /.0002,.0001,.00003,.000001,.0000001,.00000001/
C-----------------------------------------------------------------------
C EXCITATION TO TRIPLET STATES (DISSOCIATION)
      DATA XEXC1/8.85,8.92,9.34,10.0,11.0,12.0,15.0,20.0,25.0,30.0,
     /40.0,50.0,60.0,80.0,100.,150.,200.,1000.,10000.,100000./
      DATA YEXC1/0.00,0.01,0.05,0.10,0.23,0.42,0.64,0.57,0.35,0.23,
     /0.10,.051,.031,.013,.006,.0015,.0006,.0001,.00002,.000004/
C  EXCITATION TO SINGLET STATES
      DATA XEXC2/12.0,12.13,13.4,15.0,17.0,20.0,25.0,30.0,40.0,50.0,
     /60.0,80.0,100.,150.,200.,300.,400.,500.,600.,800.,
     /1000.,10000.,100000./
      DATA YEXC2/0.00,0.10,0.10,0.27,0.44,0.64,0.95,1.12,1.19,1.23,
     /1.26,1.17,1.10,0.88,0.78,0.64,0.55,0.47,0.42,0.34,
     /0.27,0.06,.015/
C-----------------------------------------------------------------------
      DATA XATT/7.00,8.00,9.00,10.0,11.0,12.0,13.0,14.0,15.0,16.0,
     /17.0,18.0,30.0,60.0,100.,1000.,10000.,100000./
      DATA YATT/0.00,.000032,.00009,.000128,.000118,.000075,.000052,
     /.00021,.000087,.000085,.00009,.0001,.00005,.00002,.00001,
     /.000001,.0000001,.00000001/
C-----------------------------------------------------------------------
      DATA XION/15.427,16.0,16.5,17.0,17.5,18.0,18.5,19.0,19.5,20.0,
     /20.5,21.0,21.5,22.0,22.5,23.0,23.5,24.0,24.5,25.0,
     /25.5,26.0,28.0,30.0,32.0,34.0,36.0,38.0,40.0,45.0,
     /50.0,55.0,60.0,65.0,70.0,75.0,80.0,85.0,90.0,95.0,
     /100.,105.,110.,115.,120.,125.,130.,135.,140.,145.,
     /150.,160.,180.,200.,250.,300.,350.,400.,450.,500.,
     /550.,600.,650.,700.,750.,800.,850.,900.,950.,1000.,
     /10000.,100000./
      DATA YION/0.00,.0299,.0607,.0924,.123,.156,.187,.220,.249,.280,
     /.310,.336,.362,.390,.413,.439,.461,.484,.505,.524,
     /.544,.563,.632,.688,.736,.776,.812,.840,.866,.913,
     /.941,.959,.968,.971,.971,.970,.964,.958,.948,.934,
     /.924,.916,.903,.891,.878,.864,.853,.844,.830,.821,
     /.813,.790,.752,.715,.636,.573,.518,.476,.438,.406,
     /.378,.354,.334,.315,.298,.283,.271,.260,.250,.240,
     /.060,.015/
C----------------------------------------------------------------------
      NAME='  H2  2001     '
C --------------------------------------------------------------------
C  CALCULATE FRACTIONAL POPULATION DENSITY FOR ROTATIONAL STATES
      B0=0.00753936
      DO 111 K=1,5,2
 111  PJ(K)=3*(2*K+1)*DEXP(-K*(K+1)*B0/AKT)
      DO 112 K=2,4,2
 112  PJ(K)=(2*K+1)*DEXP(-K*(K+1)*B0/AKT)
      SUM=1.0
      DO 113 K=1,5
 113  SUM=SUM+PJ(K)
      FROT0=1.0/SUM
      FROT1=PJ(1)/SUM
      FROT2=PJ(2)/SUM
      FROT3=PJ(3)/SUM
      FROT4=PJ(4)/SUM
      FROT5=PJ(5)/SUM
C     WRITE(6,88) FROT0,FROT1,FROT2,FROT3,FROT4,FROT5
C  88 FORMAT(3X,' FROT0=',F9.6,' FROT1=',F9.6,' FROT2=',F9.6,' FROT3=',
C    /F9.6,' FROT4=',F9.6,' FROT5=',F9.6)
C-----------------------------------------------------------------------
      NIN=14
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      NDATA=57
      NROT0=57
      NROT1=47
      NROT2=32
      NROT3=32
      NVIB1=40
      NVIB2=39
      NVIB3=16
      NVIB4=15
      NEXC1=20
      NEXC2=23
      NION=72
      NATT=18
      E(1)=0.0
      E(2)=2.0*EMASS/(2.015650*AMU)
      E(3)=15.427
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=8.30
      EIN(1)=-.0439
      EIN(2)=-.0727
      EIN(3)=-.1008
      EIN(4)=-.128
      EIN(5)=0.0439
      EIN(6)=0.0727
      EIN(7)=0.1008
      EIN(8)=0.128
      EIN(9)=0.516
      EIN(10)=0.558
      EIN(11)=1.023
      EIN(12)=1.480
      EIN(13)=8.85
      EIN(14)=12.0
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       HYDROGEN       '
      SCRPT(3)=' IONISATION    ELOSS= 15.427  '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' ROT 2-0       ELOSS= -0.0439 '
      SCRPT(8)=' ROT 3-1       ELOSS= -0.0727 '
      SCRPT(9)=' ROT 4-2       ELOSS= -0.1008 '
      SCRPT(10)=' ROT 5-3       ELOSS= -0.128  '
      SCRPT(11)=' ROT 0-2       ELOSS=  0.0439 '
      SCRPT(12)=' ROT 1-3       ELOSS=  0.0727 '
      SCRPT(13)=' ROT 2-4 + 4-6 ELOSS=  0.1008 '
      SCRPT(14)=' ROT 3-5 + 5-7 ELOSS=  0.128  '
      SCRPT(15)=' VIB V1 DJ=0   ELOSS=  0.516  '
      SCRPT(16)=' VIB V1 DJ=2   ELOSS=  0.558  '
      SCRPT(17)=' VIB 2V1       ELOSS=  1.023  '
      SCRPT(18)=' VIB 3V1       ELOSS=  1.480  '
      SCRPT(19)=' EXC TRPLT     ELOSS=  8.85   '
      SCRPT(20)=' EXC SNGLT     ELOSS= 12.0    '
      EN=-ESTEP/2.0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      DO 10 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 20
   10 CONTINUE
      J=NDATA
   20 A=(YXSEC(J)-YXSEC(J-1))/(XEN(J)-XEN(J-1))
      B=(XEN(J-1)*YXSEC(J)-XEN(J)*YXSEC(J-1))/(XEN(J-1)-XEN(J))
      Q(2,I)=(A*EN+B)*1.0D-16
C
      Q(3,I)=0.0
      IF(EN.LT.E(3)) GO TO 200
      DO 110 J=2,NION
      IF(EN.LE.XION(J)) GO TO 120
  110 CONTINUE
      J=NION
  120 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
  200 CONTINUE
C
      Q(4,I)=0.0
      IF(EN.LT.XATT(1)) GO TO 300
      DO 210 J=2,NATT
      IF(EN.LE.XATT(J)) GO TO 220
  210 CONTINUE
      J=NATT
  220 A=(YATT(J)-YATT(J-1))/(XATT(J)-XATT(J-1))
      B=(XATT(J-1)*YATT(J)-XATT(J)*YATT(J-1))/(XATT(J-1)-XATT(J))
      Q(4,I)=(A*EN+B)*1.D-16
  300 CONTINUE
      Q(5,I)=0.0
      Q(6,I)=0.0
C---------------------------------------------------------------------
C                    SUPERELASTIC 2-0
      QIN(1,I)=0.0
      IF(EN.LE.0.0) GO TO 1100
      DO 1010 J=2,NROT0
      IF((EN+EIN(5)).LE.XROT0(J)) GO TO 1020
 1010 CONTINUE
      J=NROT0
 1020 A=(YROT0(J)-YROT0(J-1))/(XROT0(J)-XROT0(J-1))
      B=(XROT0(J-1)*YROT0(J)-XROT0(J)*YROT0(J-1))/(XROT0(J-1)-XROT0(J))
      QIN(1,I)=FROT2*0.2*(EN+EIN(5))*(A*(EN+EIN(5))+B)*1.D-16/EN
 1100 CONTINUE
C                    SUPERELASTIC 3-1
      QIN(2,I)=0.0
      IF(EN.LE.0.0) GO TO 1200
      DO 1110 J=2,NROT1
      IF((EN+EIN(6)).LE.XROT1(J)) GO TO 1120
 1110 CONTINUE
      J=NROT1
 1120 A=(YROT1(J)-YROT1(J-1))/(XROT1(J)-XROT1(J-1))
      B=(XROT1(J-1)*YROT1(J)-XROT1(J)*YROT1(J-1))/(XROT1(J-1)-XROT1(J))
      QIN(2,I)=FROT3*(3.0/7.0)*(EN+EIN(6))*(A*(EN+EIN(6))+B)*1.D-16/EN
 1200 CONTINUE
C                    SUPERELASTIC 4-2
      QIN(3,I)=0.0
      IF(EN.LE.0.0) GO TO 1250
      DO 1210 J=2,NROT2
      IF((EN+EIN(7)).LE.XROT2(J)) GO TO 1220
 1210 CONTINUE
      J=NROT2
 1220 A=(YROT2(J)-YROT2(J-1))/(XROT2(J)-XROT2(J-1))
      B=(XROT2(J-1)*YROT2(J)-XROT2(J)*YROT2(J-1))/(XROT2(J-1)-XROT2(J))
      QIN(3,I)=FROT4*(5.0/9.0)*(EN+EIN(7))*(A*(EN+EIN(7))+B)*1.D-16/EN
 1250 CONTINUE
C                    SUPERELASTIC 5-3
      QIN(4,I)=0.0
      IF(EN.LE.0.0) GO TO 1290
      DO 1260 J=2,NROT3
      IF((EN+EIN(8)).LE.XROT3(J)) GO TO 1270
 1260 CONTINUE
      J=NROT3
 1270 A=(YROT3(J)-YROT3(J-1))/(XROT3(J)-XROT3(J-1))
      B=(XROT3(J-1)*YROT3(J)-XROT3(J)*YROT3(J-1))/(XROT3(J-1)-XROT3(J))
      QIN(4,I)=FROT5*(7.0/11.)*(EN+EIN(8))*(A*(EN+EIN(8))+B)*1.D-16/EN
 1290 CONTINUE
C                      ROTATION 0-2
      QIN(5,I)=0.0
      IF(EN.LE.EIN(5)) GO TO 1400
      DO 1310 J=2,NROT0
      IF(EN.LE.XROT0(J)) GO TO 1320
 1310 CONTINUE
      J=NROT0
 1320 A=(YROT0(J)-YROT0(J-1))/(XROT0(J)-XROT0(J-1))
      B=(XROT0(J-1)*YROT0(J)-XROT0(J)*YROT0(J-1))/(XROT0(J-1)-XROT0(J))
      QIN(5,I)=(A*EN+B)*1.D-16*FROT0
 1400 CONTINUE
C                        ROTATION 1-3
      QIN(6,I)=0.0
      IF(EN.LE.EIN(6)) GO TO 1401
      DO 1311 J=2,NROT1
      IF(EN.LE.XROT1(J)) GO TO 1321
 1311 CONTINUE
      J=NROT1
 1321 A=(YROT1(J)-YROT1(J-1))/(XROT1(J)-XROT1(J-1))
      B=(XROT1(J-1)*YROT1(J)-XROT1(J)*YROT1(J-1))/(XROT1(J-1)-XROT1(J))
      QIN(6,I)=(A*EN+B)*1.D-16*FROT1
 1401 CONTINUE
C                      ROTATION 2-4 +4-6
      QIN(7,I)=0.0
      IF(EN.LE.EIN(7)) GO TO 1402
      DO 1312 J=2,NROT2
      IF(EN.LE.XROT2(J)) GO TO 1322
 1312 CONTINUE
      J=NROT2
 1322 A=(YROT2(J)-YROT2(J-1))/(XROT2(J)-XROT2(J-1))
      B=(XROT2(J-1)*YROT2(J)-XROT2(J)*YROT2(J-1))/(XROT2(J-1)-XROT2(J))
      QIN(7,I)=(A*EN+B)*1.D-16*(FROT2+FROT4)
 1402 CONTINUE
C                        ROTATION 3-5 +5-7
      QIN(8,I)=0.0
      IF(EN.LE.EIN(8)) GO TO 1403
      DO 1313 J=2,NROT3
      IF(EN.LE.XROT3(J)) GO TO 1323
 1313 CONTINUE
      J=NROT3
 1323 A=(YROT3(J)-YROT3(J-1))/(XROT3(J)-XROT3(J-1))
      B=(XROT3(J-1)*YROT3(J)-XROT3(J)*YROT3(J-1))/(XROT3(J-1)-XROT3(J))
      QIN(8,I)=(A*EN+B)*1.D-16*(FROT3+FROT5)
 1403 CONTINUE
C-----------------------------------------------------------------------
      QIN(9,I)=0.0
      IF(EN.LE.EIN(9)) GO TO 400
      DO 310 J=2,NVIB1
      IF(EN.LE.XVIB1(J)) GO TO 320
  310 CONTINUE
      J=NVIB1
  320 A=(YVIB1(J)-YVIB1(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB1(J)-XVIB1(J)*YVIB1(J-1))/(XVIB1(J-1)-XVIB1(J))
      QIN(9,I)=(A*EN+B)*1.D-16
  400 CONTINUE
C
      QIN(10,I)=0.0
      IF(EN.LE.EIN(10)) GO TO 500
      DO 410 J=2,NVIB2
      IF(EN.LE.XVIB2(J)) GO TO 420
  410 CONTINUE
      J=NVIB2
  420 A=(YVIB2(J)-YVIB2(J-1))/(XVIB2(J)-XVIB2(J-1))
      B=(XVIB2(J-1)*YVIB2(J)-XVIB2(J)*YVIB2(J-1))/(XVIB2(J-1)-XVIB2(J))
      QIN(10,I)=(A*EN+B)*1.D-16
  500 CONTINUE
C
      QIN(11,I)=0.0
      IF(EN.LE.EIN(11)) GO TO 501
      DO 411 J=2,NVIB3
      IF(EN.LE.XVIB3(J)) GO TO 421
  411 CONTINUE
      J=NVIB3
  421 A=(YVIB3(J)-YVIB3(J-1))/(XVIB3(J)-XVIB3(J-1))
      B=(XVIB3(J-1)*YVIB3(J)-XVIB3(J)*YVIB3(J-1))/(XVIB3(J-1)-XVIB3(J))
      QIN(11,I)=(A*EN+B)*1.D-16
  501 CONTINUE
C
      QIN(12,I)=0.0
      IF(EN.LE.EIN(12)) GO TO 502
      DO 412 J=2,NVIB4
      IF(EN.LE.XVIB4(J)) GO TO 422
  412 CONTINUE
      J=NVIB4
  422 A=(YVIB4(J)-YVIB4(J-1))/(XVIB4(J)-XVIB4(J-1))
      B=(XVIB4(J-1)*YVIB4(J)-XVIB4(J)*YVIB4(J-1))/(XVIB4(J-1)-XVIB4(J))
      QIN(12,I)=(A*EN+B)*1.D-16
  502 CONTINUE
C-----------------------------------------------------------------------
      QIN(13,I)=0.0
      IF(EN.LE.EIN(13)) GO TO 600
      DO 510 J=2,NEXC1
      IF(EN.LE.XEXC1(J)) GO TO 520
  510 CONTINUE
      J=NEXC1
  520 A=(YEXC1(J)-YEXC1(J-1))/(XEXC1(J)-XEXC1(J-1))
      B=(XEXC1(J-1)*YEXC1(J)-XEXC1(J)*YEXC1(J-1))/(XEXC1(J-1)-XEXC1(J))
      QIN(13,I)=(A*EN+B)*1.D-16
  600 CONTINUE
C
      QIN(14,I)=0.0
      IF(EN.LE.EIN(14)) GO TO 700
      DO 610 J=2,NEXC2
      IF(EN.LE.XEXC2(J)) GO TO 620
  610 CONTINUE
      J=NEXC2
  620 A=(YEXC2(J)-YEXC2(J-1))/(XEXC2(J)-XEXC2(J-1))
      B=(XEXC2(J-1)*YEXC2(J)-XEXC2(J)*YEXC2(J-1))/(XEXC2(J-1)-XEXC2(J))
      QIN(14,I)=(A*EN+B)*1.D-16
  700 CONTINUE
C---------------------------------------------------------------------
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+QIN(1,I)+QIN(2,I)+QIN(3,I)+QIN(4,I)+
     /QIN(5,I)+QIN(6,I)+QIN(7,I)+QIN(8,I)+QIN(9,I)+QIN(10,I)+QIN(11,I)+
     /QIN(12,I)+QIN(13,I)+QIN(14,I)
  900 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(14)) NIN=13
      IF(EFINAL.LE.EIN(13)) NIN=12
      IF(EFINAL.LE.EIN(12)) NIN=11
      IF(EFINAL.LE.EIN(11)) NIN=10
      IF(EFINAL.LE.EIN(10)) NIN=9
      IF(EFINAL.LE.EIN(9)) NIN=8
      IF(EFINAL.LE.EIN(8)) NIN=7
      IF(EFINAL.LE.EIN(7)) NIN=6
      IF(EFINAL.LE.EIN(6)) NIN=5
      IF(EFINAL.LE.EIN(5)) NIN=4
      IF(EFINAL.LE.EIN(4)) NIN=3
      IF(EFINAL.LE.EIN(3)) NIN=2
      IF(EFINAL.LE.EIN(2)) NIN=1
      IF(EFINAL.LE.EIN(1)) NIN=0
C
      RETURN
      END
      SUBROUTINE GAS22(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      DIMENSION XEN(53),YXSEC(53),XROT0(40),YROT0(40),XROT1(42),YROT1(42
     /),XROT2(31),YROT2(31),XROT3(31),YROT3(31),XROT4(31),YROT4(31),
     /XROT5(30),YROT5(30),XVIB1(35),YVIB1(35),XVIB2(35),YVIB2(35),
     /XVIB3(16),YVIB3(16),XVIB4(16),YVIB4(16),XEXC1(20),YEXC1(20),
     /XEXC2(23),YEXC2(23),XATT(18),YATT(18),XION(72),YION(72),PJ(7)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      DATA XEN/0.00,0.01,0.02,0.03,0.04,.046,0.05,0.06,0.07,0.08,
     /0.09,0.10,0.13,0.15,0.20,0.30,0.40,0.50,0.60,0.70,
     /0.90,1.00,1.10,1.40,1.50,1.60,1.80,2.00,2.50,3.00,
     /4.00,5.00,6.00,8.00,10.0,15.0,20.0,30.0,40.0,50.0,
     /60.0,80.0,100.,150.,200.,300.,400.,500.,600.,800.,
     /1000.,10000.,100000./
      DATA YXSEC/6.36,7.26,7.95,8.45,8.91,9.05,9.22,9.50,9.79,10.04,
     /10.24,10.44,10.93,11.33,11.93,12.92,13.82,14.61,15.51,16.20,
     /16.9,17.2,17.3,17.7,17.7,17.8,17.7,17.5,16.8,16.1,
     /14.2,13.5,13.2,12.3,11.2,7.30,4.30,1.60,0.77,0.50,
     /0.35,0.22,0.15,0.07,.043,.022,.014,.010,.006,.004,
     /.002,.0002,.00002/
C-----------------------------------------------------------------------
C ROTATION J=0-2
      DATA XROT0/.0226,.025,0.03,0.04,0.05,0.06,0.07,0.08,0.10,0.15,
     /0.20,0.25,0.30,0.40,0.50,0.60,0.70,0.80,0.90,1.00,
     /1.20,1.50,2.00,2.50,3.00,3.50,4.00,4.50,5.00,6.00,
     /7.00,8.00,9.00,10.0,15.0,20.0,100.,1000.,10000.,100000./
      DATA YROT0/0.00,.024,.042,.061,.067,.073,.078,.082,.091,.110,
     /.129,.144,.170,.215,.264,.323,.394,.469,.555,.636,
     /.796,1.036,1.370,1.585,1.704,1.755,1.758,1.732,1.689,1.579,
     /1.462,1.350,1.248,1.156,0.730,0.44,0.05,.0015,.00015,.000015/
C-----------------------------------------------------------------------
C ROTATION J=1-3
      DATA XROT1/.0377,0.04,0.05,0.06,0.07,0.08,0.10,0.15,0.20,0.25,
     /0.30,0.40,0.50,0.56,0.60,0.66,0.70,0.80,0.90,1.01,
     /1.20,1.40,1.60,1.80,2.00,2.50,3.00,3.50,4.00,4.50,
     /5.00,6.00,7.00,8.00,9.00,10.0,15.0,20.0,100.,1000.,10000.,100000./
      DATA YROT1/0.00,0.01,.026,.032,.036,.040,.046,.058,.071,.082,
     /.094,.122,.152,.165,.178,.200,.214,.252,.292,.334,
     /.420,.510,.610,.700,.786,.937,1.01,1.05,1.05,1.04,
     /1.01,.946,.876,.809,.748,.694,.440,.265,0.03,.001,.0001,.00001/
C-----------------------------------------------------------------------
C ROTATION J=2-4
      DATA XROT2/.0528,0.07,0.10,0.15,0.20,0.30,0.40,0.50,0.60,0.70,
     /0.80,0.90,1.00,1.50,2.00,2.50,3.00,3.50,4.00,4.50,
     /5.00,5.50,6.00,7.00,8.00,10.0,20.0,100.,1000.,10000.,100000./
      DATA YROT2/0.00,.022,.034,.046,.055,.075,.099,.115,.132,.162,
     /.193,.227,.266,.463,.619,.719,.774,.799,.802,.790,
     /.771,.748,.721,.669,.617,.529,0.20,0.02,.0007,.00007,.000007/
C-----------------------------------------------------------------------
C ROTATION J=3-5
      DATA XROT3/.0679,0.10,0.15,0.20,0.25,0.30,0.40,0.50,0.60,0.70,
     /0.80,0.90,1.00,1.50,2.00,2.50,3.00,3.50,4.00,4.50,
     /5.00,5.50,6.00,7.00,8.00,10.0,20.0,100.,1000.,10000.,100000./
      DATA YROT3/0.00,0.02,0.04,0.05,0.06,0.07,.095,.110,.129,.160,
     /.194,.233,.271,.478,.637,.742,.799,.825,.828,.818,
     /.797,.774,.747,.692,.640,.548,0.18,0.02,.0007,.00007,.000007/
C-----------------------------------------------------------------------
C ROTATION J=4-6
      DATA XROT4/.0830,0.10,0.15,0.20,0.25,0.30,0.40,0.50,0.60,0.70,
     /0.80,0.90,1.00,1.50,2.00,2.50,3.00,3.50,4.00,4.50,
     /5.00,5.50,6.00,7.00,8.00,10.0,20.0,100.,1000.,10000.,100000./
      DATA YROT4/0.00,.012,0.03,.038,.045,.053,.071,.083,.097,.120,
     /.146,.175,0.20,0.36,0.48,0.56,0.60,0.62,0.62,0.61,
     /0.60,0.58,0.56,0.52,0.48,0.41,0.13,.015,.0005,.00005,.000005/
C-----------------------------------------------------------------------
C ROTATION J=5-7
      DATA XROT5/.0981,0.15,0.20,0.25,0.30,0.40,0.50,0.60,0.70,0.80,
     /0.90,1.00,1.50,2.00,2.50,3.00,3.50,4.00,4.50,5.00,
     /5.50,6.00,7.00,8.00,10.0,20.0,100.,1000.,10000.,100000./
      DATA YROT5/0.00,.015,.028,.034,0.04,.053,.062,.073,0.09,0.11,
     /0.13,0.15,0.27,0.36,0.42,0.45,0.46,0.46,0.46,0.45,
     /0.44,0.42,0.39,0.36,0.31,0.10,0.01,.0004,.00004,.000004/
C----------------------------------------------------------------------
C VIBRATION V=0-1 DELTAJ=0  ROTATIONALLY ELASTIC
      DATA XVIB1/0.371,0.50,0.60,0.65,0.75,0.85,1.00,1.15,1.25,1.50,
     /1.75,2.00,2.20,2.40,2.60,3.00,3.50,4.00,4.50,5.00,
     /6.00,7.00,8.00,9.00,10.0,11.0,12.0,13.0,14.0,15.0,
     /20.0,100.,1000.,10000.,100000./
      DATA YVIB1/0.00,.0045,.009,.011,.016,.020,.028,.037,.042,.064,
     /.084,.100,.110,.120,.128,.135,.140,.140,.135,.122,
     /.100,.077,.060,.046,.035,.027,.021,.017,.015,.013,
     /.0085,.0017,.00005,.000005,.0000005/
C-----------------------------------------------------------------------
C VIBRATION V=0-1 DELTAJ=2  ROTATIONALLY INELASTIC
      DATA XVIB2/0.391,0.50,0.60,0.65,0.75,0.85,1.00,1.15,1.25,1.50,
     /1.75,2.00,2.20,2.40,2.60,3.00,3.50,4.00,4.50,5.00,
     /6.00,7.00,8.00,9.00,10.0,11.0,12.0,13.0,14.0,15.0,
     /20.0,100.,1000.,10000.,100000./
      DATA YVIB2/0.00,.0025,.0055,.008,.012,.017,.026,.035,.040,.064,
     /.088,.115,.135,.150,.160,.176,.188,.188,.185,.172,
     /.142,.110,.082,.062,.045,.035,.026,.019,.014,.011,
     /.0074,.0015,.00004,.000004,.0000004/
C-----------------------------------------------------------------------
C  VIBRATION V=0-2
      DATA XVIB3/0.735,1.00,1.50,2.00,3.00,4.00,5.00,6.00,8.00,10.0,
     /15.0,20.0,100.,1000.,10000.,100000./
      DATA YVIB3/0.00,.0005,.003,.007,.017,.018,.017,.015,.011,.007,
     /.001,.0005,.00015,.000005,.0000005,.00000005/
C-----------------------------------------------------------------------
C  VIBRATION V=0-3
      DATA XVIB4/1.085,1.35,1.50,2.00,3.00,4.00,5.00,6.00,8.00,10.0,
     /15.0,20.0,100.,1000.,10000.,100000./
      DATA YVIB4/0.00,.00015,.0003,.0008,.0016,.0016,.0015,.0012,.001,
     /.0015,.0005,.0001,.000025,.0000008,.00000008,.000000008/
C-----------------------------------------------------------------------
C EXCITATION TO TRIPLET STATES (DISSOCIATION)
      DATA XEXC1/8.85,8.92,9.34,10.0,11.0,12.0,15.0,20.0,25.0,30.0,
     /40.0,50.0,60.0,80.0,100.,150.,200.,1000.,10000.,100000./
      DATA YEXC1/0.00,.008,0.04,0.08,.184,.336,0.51,0.46,0.28,0.18,
     /0.08,.041,.025,.010,.005,.0012,.0005,.00008,.000008,.0000008/
C  EXCITATION TO SINGLET STATES
      DATA XEXC2/12.0,12.13,13.4,15.0,17.0,20.0,25.0,30.0,40.0,50.0,
     /60.0,80.0,100.,150.,200.,300.,400.,500.,600.,800.,
     /1000.,10000.,100000./
      DATA YEXC2/0.00,0.09,0.09,0.24,0.40,0.58,0.86,1.01,1.07,1.11,
     /1.13,1.05,0.99,0.79,0.70,0.58,0.50,0.42,0.38,0.31,
     /0.24,.024,.0024/
C-----------------------------------------------------------------------
      DATA XATT/7.40,8.00,9.00,10.0,11.0,12.0,13.0,14.0,15.0,16.0,
     /17.0,18.0,30.0,60.0,100.,1000.,10000.,100000./
      DATA YATT/0.00,.000005,.000012,.000026,.000027,.00003,.000035,
     /.00010,.00008,.00009,.00010,.00011,.00006,.00001,.000001,
     /.0000001,.00000001,.000000001/
C-----------------------------------------------------------------------
      DATA XION/15.427,16.0,16.5,17.0,17.5,18.0,18.5,19.0,19.5,20.0,
     /20.5,21.0,21.5,22.0,22.5,23.0,23.5,24.0,24.5,25.0,
     /25.5,26.0,28.0,30.0,32.0,34.0,36.0,38.0,40.0,45.0,
     /50.0,55.0,60.0,65.0,70.0,75.0,80.0,85.0,90.0,95.0,
     /100.,105.,110.,115.,120.,125.,130.,135.,140.,145.,
     /150.,160.,180.,200.,250.,300.,350.,400.,450.,500.,
     /550.,600.,650.,700.,750.,800.,850.,900.,950.,1000.,
     /10000.,100000./
      DATA YION/0.00,.034,.069,.104,.138,.173,.207,.239,.272,.300,
     /.328,.355,.383,.406,.429,.454,.475,.498,.518,.537,
     /.556,.575,.641,.699,.744,.786,.821,.851,.876,.931,
     /.950,.968,.977,.981,.981,.980,.974,.968,.958,.948,
     /.939,.925,.913,.907,.889,.877,.866,.853,.839,.827,
     /.813,.792,.754,.716,.638,.576,.523,.482,.446,.414,
     /.387,.366,.344,.326,.310,.295,.282,.271,.257,.247,
     /.0247,.00247/
C----------------------------------------------------------------------
      NAME=' DEUTERIUM 98  '
C --------------------------------------------------------------------
C  CALCULATE FRACTIONAL POPULATION DENSITY FOR ROTATIONAL STATES
      B0=0.00377272
      DO 111 K=1,7,2
 111  PJ(K)=3*(2*K+1)*DEXP(-K*(K+1)*B0/AKT)
      DO 112 K=2,6,2
 112  PJ(K)=6*(2*K+1)*DEXP(-K*(K+1)*B0/AKT)
      SUM=6.0
      DO 113 K=1,7
 113  SUM=SUM+PJ(K)
      FROT0=6.0/SUM
      FROT1=PJ(1)/SUM
      FROT2=PJ(2)/SUM
      FROT3=PJ(3)/SUM
      FROT4=PJ(4)/SUM
      FROT5=PJ(5)/SUM
      FROT6=PJ(6)/SUM
      FROT7=PJ(7)/SUM
C     WRITE(6,88) FROT0,FROT1,FROT2,FROT3,FROT4,FROT5,FROT6,FROT7
C  88 FORMAT(2X,' FROT0=',F9.5,' FROT1=',F9.5,' FROT2=',F9.5,' FROT3=',
C    /F9.5,' FROT4=',F9.5,' FROT5=',F9.5,' FROT6=',F9.5,' FROT7=',F9.5)
C-----------------------------------------------------------------------
      NIN=15
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      NDATA=53
      NROT0=40
      NROT1=42
      NROT2=31
      NROT3=31
      NROT4=31
      NROT5=30
      NVIB1=35
      NVIB2=35
      NVIB3=16
      NVIB4=16
      NEXC1=20
      NEXC2=23
      NION=72
      NATT=18
      E(1)=0.0
      E(2)=2.0*EMASS/(4.028204*AMU)
      E(3)=15.427
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=8.30
      EIN(1)=-.0226
      EIN(2)=-.0377
      EIN(3)=-.0528
      EIN(4)=0.0226
      EIN(5)=0.0377
      EIN(6)=0.0528
      EIN(7)=0.0679
      EIN(8)=0.0830
      EIN(9)=0.0981
      EIN(10)=0.371
      EIN(11)=0.391
      EIN(12)=0.735
      EIN(13)=1.085
      EIN(14)=8.85
      EIN(15)=12.0
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       DEUTERIUM      '
      SCRPT(3)=' IONISATION    ELOSS= 15.427  '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' ROT 2-0       ELOSS= -0.0226 '
      SCRPT(8)=' ROT 3-1       ELOSS= -0.0377 '
      SCRPT(9)=' ROT 4-2       ELOSS= -0.0528 '
      SCRPT(10)=' ROT 0-2       ELOSS=  0.0226 '
      SCRPT(11)=' ROT 1-3       ELOSS=  0.0377 '
      SCRPT(12)=' ROT 2-4       ELOSS=  0.0528 '
      SCRPT(13)=' ROT 3-5       ELOSS=  0.0679 '
      SCRPT(14)=' ROT 4-6 + 6-8 ELOSS=  0.0830 '
      SCRPT(15)=' ROT 5-7 + 7-9 ELOSS=  0.0981 '
      SCRPT(16)=' VIB V1 DJ=0   ELOSS=  0.371  '
      SCRPT(17)=' VIB V1 DJ=2   ELOSS=  0.391  '
      SCRPT(18)=' VIB 2V1       ELOSS=  0.735  '
      SCRPT(19)=' VIB 3V1       ELOSS=  1.085  '
      SCRPT(20)=' EXC TRPLT     ELOSS=  8.85   '
      SCRPT(21)=' EXC SNGLT     ELOSS= 12.0    '
      EN=-ESTEP/2.0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      DO 10 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 20
   10 CONTINUE
      J=NDATA
   20 A=(YXSEC(J)-YXSEC(J-1))/(XEN(J)-XEN(J-1))
      B=(XEN(J-1)*YXSEC(J)-XEN(J)*YXSEC(J-1))/(XEN(J-1)-XEN(J))
      Q(2,I)=(A*EN+B)*1.0D-16
C
      Q(3,I)=0.0
      IF(EN.LT.E(3)) GO TO 200
      DO 110 J=2,NION
      IF(EN.LE.XION(J)) GO TO 120
  110 CONTINUE
      J=NION
  120 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
  200 CONTINUE
C
      Q(4,I)=0.0
      IF(EN.LT.XATT(1)) GO TO 300
      DO 210 J=2,NATT
      IF(EN.LE.XATT(J)) GO TO 220
  210 CONTINUE
      J=NATT
  220 A=(YATT(J)-YATT(J-1))/(XATT(J)-XATT(J-1))
      B=(XATT(J-1)*YATT(J)-XATT(J)*YATT(J-1))/(XATT(J-1)-XATT(J))
      Q(4,I)=(A*EN+B)*1.D-16
  300 CONTINUE
      Q(5,I)=0.0
      Q(6,I)=0.0
C---------------------------------------------------------------------
C                    SUPERELASTIC 2-0
      QIN(1,I)=0.0
      IF(EN.LE.0.0) GO TO 1100
      DO 1010 J=2,NROT0
      IF((EN+EIN(4)).LE.XROT0(J)) GO TO 1020
 1010 CONTINUE
      J=NROT0
 1020 A=(YROT0(J)-YROT0(J-1))/(XROT0(J)-XROT0(J-1))
      B=(XROT0(J-1)*YROT0(J)-XROT0(J)*YROT0(J-1))/(XROT0(J-1)-XROT0(J))
      QIN(1,I)=FROT2*0.2*(EN+EIN(4))*(A*(EN+EIN(4))+B)*1.D-16/EN
 1100 CONTINUE
C                    SUPERELASTIC 3-1
      QIN(2,I)=0.0
      IF(EN.LE.0.0) GO TO 1101
      DO 1011 J=2,NROT1
      IF((EN+EIN(5)).LE.XROT1(J)) GO TO 1021
 1011 CONTINUE
      J=NROT1
 1021 A=(YROT1(J)-YROT1(J-1))/(XROT1(J)-XROT1(J-1))
      B=(XROT1(J-1)*YROT1(J)-XROT1(J)*YROT1(J-1))/(XROT1(J-1)-XROT1(J))
      QIN(2,I)=FROT3*(3.0/7.0)*(EN+EIN(5))*(A*(EN+EIN(5))+B)*1.D-16/EN
 1101 CONTINUE
C                    SUPERELASTIC 4-2
      QIN(3,I)=0.0
      IF(EN.LE.0.0) GO TO 1102
      DO 1012 J=2,NROT2
      IF((EN+EIN(6)).LE.XROT2(J)) GO TO 1022
 1012 CONTINUE
      J=NROT2
 1022 A=(YROT2(J)-YROT2(J-1))/(XROT2(J)-XROT2(J-1))
      B=(XROT2(J-1)*YROT2(J)-XROT2(J)*YROT2(J-1))/(XROT2(J-1)-XROT2(J))
      QIN(3,I)=FROT4*(5.0/9.0)*(EN+EIN(6))*(A*(EN+EIN(6))+B)*1.D-16/EN
 1102 CONTINUE
C                      ROTATION 0-2
      QIN(4,I)=0.0
      IF(EN.LE.EIN(4)) GO TO 1400
      DO 1310 J=2,NROT0
      IF(EN.LE.XROT0(J)) GO TO 1320
 1310 CONTINUE
      J=NROT0
 1320 A=(YROT0(J)-YROT0(J-1))/(XROT0(J)-XROT0(J-1))
      B=(XROT0(J-1)*YROT0(J)-XROT0(J)*YROT0(J-1))/(XROT0(J-1)-XROT0(J))
      QIN(4,I)=(A*EN+B)*1.D-16*FROT0
 1400 CONTINUE
C                        ROTATION 1-3
      QIN(5,I)=0.0
      IF(EN.LE.EIN(5)) GO TO 1401
      DO 1311 J=2,NROT1
      IF(EN.LE.XROT1(J)) GO TO 1321
 1311 CONTINUE
      J=NROT1
 1321 A=(YROT1(J)-YROT1(J-1))/(XROT1(J)-XROT1(J-1))
      B=(XROT1(J-1)*YROT1(J)-XROT1(J)*YROT1(J-1))/(XROT1(J-1)-XROT1(J))
      QIN(5,I)=(A*EN+B)*1.D-16*FROT1
 1401 CONTINUE
C                      ROTATION 2-4
      QIN(6,I)=0.0
      IF(EN.LE.EIN(6)) GO TO 1402
      DO 1312 J=2,NROT2
      IF(EN.LE.XROT2(J)) GO TO 1322
 1312 CONTINUE
      J=NROT2
 1322 A=(YROT2(J)-YROT2(J-1))/(XROT2(J)-XROT2(J-1))
      B=(XROT2(J-1)*YROT2(J)-XROT2(J)*YROT2(J-1))/(XROT2(J-1)-XROT2(J))
      QIN(6,I)=(A*EN+B)*1.D-16*FROT2
 1402 CONTINUE
C                        ROTATION 3-5
      QIN(7,I)=0.0
      IF(EN.LE.EIN(7)) GO TO 1403
      DO 1313 J=2,NROT3
      IF(EN.LE.XROT3(J)) GO TO 1323
 1313 CONTINUE
      J=NROT3
 1323 A=(YROT3(J)-YROT3(J-1))/(XROT3(J)-XROT3(J-1))
      B=(XROT3(J-1)*YROT3(J)-XROT3(J)*YROT3(J-1))/(XROT3(J-1)-XROT3(J))
      QIN(7,I)=(A*EN+B)*1.D-16*FROT3
 1403 CONTINUE
C                      ROTATION 4-6 + 6-8
      QIN(8,I)=0.0
      IF(EN.LE.EIN(8)) GO TO 1404
      DO 1314 J=2,NROT4
      IF(EN.LE.XROT4(J)) GO TO 1324
 1314 CONTINUE
      J=NROT4
 1324 A=(YROT4(J)-YROT4(J-1))/(XROT4(J)-XROT4(J-1))
      B=(XROT4(J-1)*YROT4(J)-XROT4(J)*YROT4(J-1))/(XROT4(J-1)-XROT4(J))
      QIN(8,I)=(A*EN+B)*1.D-16*(FROT4+FROT6)
 1404 CONTINUE
C                      ROTATION 5-7 + 7-9
      QIN(9,I)=0.0
      IF(EN.LE.EIN(9)) GO TO 1405
      DO 1315 J=2,NROT5
      IF(EN.LE.XROT5(J)) GO TO 1325
 1315 CONTINUE
      J=NROT5
 1325 A=(YROT5(J)-YROT5(J-1))/(XROT5(J)-XROT5(J-1))
      B=(XROT5(J-1)*YROT5(J)-XROT5(J)*YROT5(J-1))/(XROT5(J-1)-XROT5(J))
      QIN(9,I)=(A*EN+B)*1.D-16*(FROT5+FROT7)
 1405 CONTINUE
C-----------------------------------------------------------------------
      QIN(10,I)=0.0
      IF(EN.LE.EIN(10)) GO TO 400
      DO 310 J=2,NVIB1
      IF(EN.LE.XVIB1(J)) GO TO 320
  310 CONTINUE
      J=NVIB1
  320 A=(YVIB1(J)-YVIB1(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB1(J)-XVIB1(J)*YVIB1(J-1))/(XVIB1(J-1)-XVIB1(J))
      QIN(10,I)=(A*EN+B)*1.D-16
  400 CONTINUE
C
      QIN(11,I)=0.0
      IF(EN.LE.EIN(11)) GO TO 500
      DO 410 J=2,NVIB2
      IF(EN.LE.XVIB2(J)) GO TO 420
  410 CONTINUE
      J=NVIB2
  420 A=(YVIB2(J)-YVIB2(J-1))/(XVIB2(J)-XVIB2(J-1))
      B=(XVIB2(J-1)*YVIB2(J)-XVIB2(J)*YVIB2(J-1))/(XVIB2(J-1)-XVIB2(J))
      QIN(11,I)=(A*EN+B)*1.D-16
  500 CONTINUE
C
      QIN(12,I)=0.0
      IF(EN.LE.EIN(12)) GO TO 501
      DO 411 J=2,NVIB3
      IF(EN.LE.XVIB3(J)) GO TO 421
  411 CONTINUE
      J=NVIB3
  421 A=(YVIB3(J)-YVIB3(J-1))/(XVIB3(J)-XVIB3(J-1))
      B=(XVIB3(J-1)*YVIB3(J)-XVIB3(J)*YVIB3(J-1))/(XVIB3(J-1)-XVIB3(J))
      QIN(12,I)=(A*EN+B)*1.D-16
  501 CONTINUE
C
      QIN(13,I)=0.0
      IF(EN.LE.EIN(13)) GO TO 502
      DO 412 J=2,NVIB4
      IF(EN.LE.XVIB4(J)) GO TO 422
  412 CONTINUE
      J=NVIB4
  422 A=(YVIB4(J)-YVIB4(J-1))/(XVIB4(J)-XVIB4(J-1))
      B=(XVIB4(J-1)*YVIB4(J)-XVIB4(J)*YVIB4(J-1))/(XVIB4(J-1)-XVIB4(J))
      QIN(13,I)=(A*EN+B)*1.D-16
  502 CONTINUE
C-----------------------------------------------------------------------
      QIN(14,I)=0.0
      IF(EN.LE.EIN(14)) GO TO 600
      DO 510 J=2,NEXC1
      IF(EN.LE.XEXC1(J)) GO TO 520
  510 CONTINUE
      J=NEXC1
  520 A=(YEXC1(J)-YEXC1(J-1))/(XEXC1(J)-XEXC1(J-1))
      B=(XEXC1(J-1)*YEXC1(J)-XEXC1(J)*YEXC1(J-1))/(XEXC1(J-1)-XEXC1(J))
      QIN(14,I)=(A*EN+B)*1.D-16
  600 CONTINUE
C
      QIN(15,I)=0.0
      IF(EN.LE.EIN(15)) GO TO 700
      DO 610 J=2,NEXC2
      IF(EN.LE.XEXC2(J)) GO TO 620
  610 CONTINUE
      J=NEXC2
  620 A=(YEXC2(J)-YEXC2(J-1))/(XEXC2(J)-XEXC2(J-1))
      B=(XEXC2(J-1)*YEXC2(J)-XEXC2(J)*YEXC2(J-1))/(XEXC2(J-1)-XEXC2(J))
      QIN(15,I)=(A*EN+B)*1.D-16
  700 CONTINUE
C---------------------------------------------------------------------
C NB. ROTATIONAL AND VIBRATIONAL STATES INCLUDED IN Q(2,I)
C -------------------------------------------------------------------
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+QIN(14,I)+QIN(15,I)
C GET CORRECT ELASTIC XSECTION
      IF(EN.LT.200.) THEN
      Q(2,I)=Q(2,I)-QIN(1,I)-QIN(2,I)-QIN(3,I)-QIN(4,I)-QIN(5,I)-QIN(6,I
     /)-QIN(7,I)-QIN(8,I)-QIN(9,I)-QIN(10,I)-QIN(11,I)-QIN(12,I)-QIN(13,
     /I)
      ENDIF
  900 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(15)) NIN=14
      IF(EFINAL.LE.EIN(14)) NIN=13
      IF(EFINAL.LE.EIN(13)) NIN=12
      IF(EFINAL.LE.EIN(12)) NIN=11
      IF(EFINAL.LE.EIN(11)) NIN=10
      IF(EFINAL.LE.EIN(10)) NIN=9
      IF(EFINAL.LE.EIN(9)) NIN=8
      IF(EFINAL.LE.EIN(8)) NIN=7
      IF(EFINAL.LE.EIN(7)) NIN=6
      IF(EFINAL.LE.EIN(6)) NIN=5
      IF(EFINAL.LE.EIN(5)) NIN=4
      IF(EFINAL.LE.EIN(4)) NIN=3
      IF(EFINAL.LE.EIN(3)) NIN=2
      IF(EFINAL.LE.EIN(2)) NIN=1
      IF(EFINAL.LE.EIN(1)) NIN=0
C
      RETURN
      END
      SUBROUTINE GAS23(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220),
     /PJ(40)
      DIMENSION XEN(53),YEN(53),XVIB1(52),YVIB1(52),XVIB2(27),YVIB2(27),
     /XVIB3(24),YVIB3(24),XVIB4(23),YVIB4(23),XVIB5(20),YVIB5(20),
     /XVIB6(19),YVIB6(19),XION(90),YION(90),XATT(52),YATT(52),
     /XEXC(30),YEXC(30),XEXC1(26),YEXC1(26),XEXC2(24),YEXC2(24),
     /XEXC3(22),YEXC3(22),XEXC4(21),YEXC4(21),XEXC5(19),YEXC5(19)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
C ELASTIC MOMENTUM TRANSFER
      DATA XEN/0.00,.001,.002,.003,.005,.007,.0085,0.01,.015,0.02,
     /0.03,0.04,0.05,0.07,0.10,0.12,0.14,0.16,0.18,0.20,
     /0.25,0.30,0.40,0.50,0.60,0.80,1.00,1.20,1.40,1.60,
     /1.80,2.00,2.50,3.00,4.00,5.00,6.00,7.00,8.00,10.0,
     /12.0,15.0,17.0,20.0,25.0,30.0,50.0,75.0,100.,200.,
     /1000.,10000.,100000./
      DATA YEN/0.51,0.90,1.08,1.24,1.50,1.72,1.85,2.00,2.42,2.77,
     /3.38,3.90,4.35,5.10,6.00,6.50,7.10,7.75,8.10,8.50,
     /10.7,12.4,14.7,15.6,16.1,16.4,17.5,22.4,30.1,36.2,
     /37.4,37.2,20.3,16.4,12.1,11.2,10.7,10.2,9.81,8.83,
     /8.48,8.38,8.08,7.58,6.59,5.79,3.59,2.29,1.70,1.00,
     /0.15,.015,.0015/
C
      DATA XVIB1/.266,.270,0.28,0.30,0.32,0.35,0.40,0.45,0.50,0.60,
     /0.70,0.80,0.85,0.90,0.95,1.00,1.05,1.10,1.22,1.31,
     /1.41,1.51,1.65,1.74,1.82,1.90,1.98,2.09,2.17,2.28,
     /2.32,2.40,2.51,2.69,2.87,3.07,3.29,3.53,3.82,4.00,
     /5.00,6.00,8.00,10.0,12.0,15.0,20.0,30.0,100.,1000.,
     /10000.,100000./
      DATA YVIB1/0.00,.045,.081,.117,.131,.153,.165,.168,.167,.155,
     /.135,.118,.112,.115,.120,.130,.196,.320,0.77,1.31,
     /2.30,3.44,3.23,3.80,4.20,3.74,3.34,3.64,3.18,2.67,
     /2.74,2.39,2.00,1.57,1.17,0.83,0.55,0.35,0.18,.051,
     /.043,.037,.030,.025,.022,.018,.014,.010,.0037,.00037,
     /.000037,.0000037/
      DATA XVIB2/.528,1.10,1.20,1.30,1.40,1.50,1.60,1.70,1.80,1.90,
     /2.00,2.10,2.20,2.30,2.40,2.50,2.60,2.70,2.80,2.90,
     /3.00,3.20,10.0,100.,1000.,10000.,100000./
      DATA YVIB2/0.00,.027,.055,.135,.495,1.11,1.66,1.43,1.22,1.66,
     /1.43,1.14,1.15,0.91,0.67,0.67,0.44,0.39,0.22,0.22,
     /0.11,.055,.005,.0005,.00005,.000005,.0000006/
      DATA XVIB3/.787,1.40,1.50,1.60,1.70,1.80,1.90,2.00,2.10,2.20,
     /2.30,2.40,2.50,2.60,2.70,2.80,2.90,3.00,3.20,10.0,
     /100.,1000.,10000.,100000./
      DATA YVIB3/0.00,.055,0.28,0.77,1.08,0.83,0.49,0.72,0.83,0.44,
     /0.39,0.44,0.22,0.25,0.17,0.11,0.12,.055,.022,.0022,
     /.00022,.000022,.0000022,.00000022/
      DATA XVIB4/1.043,1.40,1.50,1.60,1.70,1.80,1.90,2.00,2.10,2.20,
     /2.30,2.40,2.50,2.60,2.70,2.80,2.90,3.00,10.0,100.,
     /1000.,10000.,100000./
      DATA YVIB4/0.00,.013,0.11,0.25,0.61,0.77,0.61,0.20,0.32,0.41,
     /0.22,0.12,0.20,.045,.045,.012,.0032,.0027,.0003,.00003,
     /.000003,.0000003,.00000003/
      DATA XVIB5/1.295,1.60,1.70,1.80,1.90,2.00,2.10,2.20,2.30,2.40,
     /2.50,2.60,2.70,2.80,3.00,10.0,100.,1000.,10000.,100000./
      DATA YVIB5/0.00,.055,0.29,0.32,0.54,0.32,0.11,.049,0.20,.072,
     /.045,.045,.009,.004,.002,.0002,.00002,.000002,.0000002,.00000002/
      DATA XVIB6/1.544,1.70,1.80,1.90,2.00,2.10,2.20,2.30,2.40,2.50,
     /2.60,2.70,2.80,3.00,10.0,100.,1000.,10000.,100000./
      DATA YVIB6/0.00,.049,0.13,0.22,0.61,0.61,0.45,0.34,0.20,0.14,
     /0.13,.042,.014,.0045,.0005,.00005,.000005,.0000005,.00000005/
C
      DATA XION/14.013,14.5,15.0,15.5,16.0,16.5,17.0,17.5,18.0,18.5,
     /19.0,19.5,20.0,20.5,21.0,21.5,22.0,22.5,23.0,23.5,
     /24.0,26.0,28.0,30.0,32.0,34.0,36.0,38.0,40.0,45.0,
     /50.0,55.0,60.0,65.0,70.0,75.0,80.0,85.0,90.0,95.0,
     /100.,105.,110.,115.,120.,125.,130.,135.,140.,145.,
     /150.,160.,180.,200.,250.,300.,350.,400.,450.,500.,
     /550.,600.,650.,700.,750.,800.,850.,900.,950.,1000.,
     /1100.,1200.,1300.,1400.,1500.,1600.,1800.,2000.,2500.,3000.,
     /4000.,6000.,8000.,10000.,15000.,20000.,30000.,40000.,60000.,
     /100000./
      DATA YION/0.00,.0273,.051,.077,.106,.139,.177,.214,.254,.297,
     /.340,.386,.428,.472,.516,.560,.601,.643,.684,.724,
     /.766,.933,1.09,1.24,1.38,1.50,1.60,1.70,1.79,1.97,
     /2.12,2.24,2.34,2.43,2.50,2.53,2.59,2.60,2.63,2.64,
     /2.65,2.66,2.66,2.65,2.64,2.63,2.62,2.60,2.59,2.58,
     /2.57,2.52,2.45,2.37,2.16,1.99,1.85,1.72,1.59,1.50,
     /1.43,1.35,1.27,1.21,1.15,1.11,1.06,1.03,.994,.959,
     /.864,.810,.762,.721,.683,.650,.592,.545,.456,.392,
     /.309,.219,.172,.141,.099,.077,.054,.042,.029,
     /.019/
      DATA XATT/9.00,9.20,9.30,9.35,9.40,9.45,9.60,9.65,9.70,9.75,
     /9.80,9.85,9.90,10.0,10.1,10.2,10.3,10.4,10.5,10.6,
     /10.7,10.8,10.9,11.0,11.1,11.2,11.3,11.4,11.5,11.6,
     /11.7,11.8,11.9,12.0,12.1,12.2,12.3,12.4,12.5,12.6,
     /12.8,13.0,19.0,25.0,30.0,35.0,40.0,60.0,100.,1000.,
     /10000.,100000./
      DATA YATT/0.00,.00009,.00018,.00026,.00034,.00073,.0011,.0017,
     /.0018,.0019,.0020,.0020,.0020,.0020,.0020,.0019,.0018,.0017,.0015,
     /.0014,.0012,.0011,.0010,.00088,.00077,.00065,.00055,.00047,.00040,
     /.00033,.00028,.00024,.00019,.00017,.00014,.00011,.00010,.00009,
     /.00008,.00007,.00006,.00006,.00006,.00006,.0001,.0001,.0001,.0001,
     /.0001,.0001,.0000001,.00000001/
C  EXCITATION A3 PI
      DATA XEXC/6.04,6.20,6.40,6.60,7.00,7.15,8.00,9.00,10.0,11.0,
     /12.0,13.0,14.0,15.0,17.0,20.0,22.0,24.0,27.0,30.0,
     /35.0,40.0,50.0,60.0,70.0,80.0,100.,1000.,10000.,100000./
      DATA YEXC/0.00,2.04,2.09,2.04,0.55,0.29,0.53,0.94,1.06,1.08,
     /1.02,0.92,0.81,0.71,0.55,0.39,0.34,0.29,.245,0.22,
     /0.21,0.20,0.18,0.17,0.15,0.14,.127,.028,.0028,.00028/
C EXCITATION  A3 SIGMA
      DATA XEXC1/6.82,7.00,8.00,9.00,10.0,11.0,12.0,13.0,14.0,15.0,
     /17.0,20.0,22.0,24.0,27.0,30.0,35.0,40.0,50.0,60.0,
     /70.0,80.0,100.0,1000.,10000.,100000./
      DATA YEXC1/0.00,.013,0.07,0.34,0.46,0.50,0.49,0.46,0.42,0.38,
     /0.32,0.25,0.21,0.18,0.15,.118,.084,.056,.031,.018,
     /.0118,.007,.003,.00014,.000014,.0000014/
C EXCITATION  A1 PI
      DATA XEXC2/8.07,9.00,10.0,11.0,12.0,13.0,14.0,15.0,17.0,20.0,
     /22.0,24.0,27.0,30.0,35.0,40.0,50.0,60.0,70.0,80.0,
     /100.,1000.,10000.,100000./
      DATA YEXC2/0.00,.108,0.18,0.24,0.27,0.29,0.32,0.35,0.38,0.39,
     /0.40,0.42,0.42,0.41,0.40,0.39,0.38,0.36,0.35,0.34,
     /0.31,.084,.0084,.00084/
C  EXCITATION B3 SIGMA
      DATA XEXC3/10.39,11.0,12.0,13.0,14.0,15.0,17.0,20.0,22.0,24.0,
     /27.0,30.0,35.0,40.0,50.0,60.0,70.0,80.0,100.,1000.,
     /10000.,100000./
      DATA YEXC3/0.00,.025,.035,.055,.066,.074,.077,.060,.042,.028,
     /.018,.015,.0137,.0127,.0118,.0118,.0108,.0108,.0099,.0014,
     /.00014,.000014/
C  EXCITATION C1 SIGMA +E1 PI
      DATA XEXC4/11.3,12.0,13.0,14.0,15.0,17.0,20.0,22.0,24.0,27.0,
     /30.0,35.0,40.0,50.0,60.0,70.0,80.0,100.,1000.,10000.,
     /100000./
      DATA YEXC4/0.00,.056,.087,0.12,0.14,.175,0.22,0.24,0.25,0.27,
     /0.28,0.28,0.28,0.27,0.25,.245,0.24,0.22,.063,.0063,
     /.00063/
C   EXCITATION   SUM OF HIGHER LEVELS
      DATA XEXC5/13.5,14.0,15.0,17.0,20.0,22.0,24.0,27.0,30.0,35.0,
     /40.0,50.0,60.0,70.0,80.0,100.,1000.,10000.,100000./
      DATA YEXC5/0.00,0.07,0.14,0.29,0.39,0.42,0.45,0.48,0.49,0.50,
     /0.52,0.52,0.50,0.49,0.48,0.46,0.13,.013,.0013/
C -------------------------------------------------------------------
C  FIT TO DATA OF :
C             HADDAD AND MILLOY      AUST J. PHYS 36(1983)473
C             PETROVIC AND CROMPTON  AUST J. PHYS 42(1989)609
C             NAKAMURA               J.PHYS D 20(1987) 933
C             SAELEE AND LUCAS       J.PHYS D 10(1977) 343
C     AND LOW TEMPERTURE PACK AND PHELPS DATA
C    REPLACES 1998 ROUTINE
C  USES ANISTROPIC ANGULAR DISTRIBUTION FOR DIPOLE ROTATIONAL STATES
C -------------------------------------------------------------------
C
      NAME='  C-O  2003    '
C
      NIN=64
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
      KIN(J)=0
    2 IF(J.LE.52) KIN(J)=1
      NDATA=53
      NVIB1=52
      NVIB2=27
      NVIB3=24
      NVIB4=23
      NVIB5=20
      NVIB6=19
      NION=90
      NATT=52
      NEXC=30
      NEXC1=26
      NEXC2=24
      NEXC3=22
      NEXC4=21
      NEXC5=19
      E(1)=0.0
      E(2)=2.0*EMASS/(28.0104*AMU)
      E(3)=14.013
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=14.013
C   B0 IS ROTATIONAL CONSTANT AND DBA IS DIPOLE MOMENT
C   DRAT IS RATIO OF MOMENTUM TRANSFER TO TOTAL X-SECTION FOR DIPOLE
C ------------------------------------------------------
      B0=2.384D-4
      DBA=0.0432
      DRAT=0.25
      AVIB=1.0
C -------------------------------------------------------
      A0=0.5291772083D-8
      RY=13.60569172
      DBK=8.37758*RY*(DBA*A0)**2
C CALCULATE ROTATIONAL STATE POPULATION AT TEMPERATURE
      DO 3 K=1,26
    3 PJ(K)=(2*K+1)*DEXP(-K*(K+1)*B0/AKT)
      SUM=1.0
      DO 4 K=1,26
    4 SUM=SUM+PJ(K)
      FROT0=1.0/SUM
      DO 5 K=1,26
    5 PJ(K)=PJ(K)/SUM
C CALC ROTATIONAL TRANSITION ENERGIES
      DO 6 K=1,26
      J=K-1
      EIN(K+26)=B0*2*(J+1)
    6 EIN(K)=-EIN(K+26)
      EIN(53)=0.266
      EIN(54)=0.528
      EIN(55)=0.787
      EIN(56)=1.043
      EIN(57)=1.295
      EIN(58)=1.544
      EIN(59)=6.04
      EIN(60)=6.82
      EIN(61)=8.07
      EIN(62)=10.39
      EIN(63)=11.3
      EIN(64)=13.5
C     WRITE(6,99) FROT0,(PJ(J),J=1,30)
C  99 FORMAT(2X,'POP OF STATES=',/,11(2X,D10.3))
C     WRITE(6,98) (EIN(J),J=1,64)
C  98 FORMAT(2X,'TRANS ENERGY=',/,10(2X,D10.3))
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       CARBON MONOXIDE'
      SCRPT(3)=' IONISATION    ELOSS= 14.013  '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' ROT 1-0       ELOSS= -0.00048'
      SCRPT(8)=' ROT 2-1       ELOSS= -0.00095'
      SCRPT(9)=' ROT 3-2       ELOSS= -0.00143'
      SCRPT(10)=' ROT 4-3       ELOSS= -0.00191'
      SCRPT(11)=' ROT 5-4       ELOSS= -0.00238'
      SCRPT(12)=' ROT 6-5       ELOSS= -0.00286'
      SCRPT(13)=' ROT 7-6       ELOSS= -0.00334'
      SCRPT(14)=' ROT 8-7       ELOSS= -0.00381'
      SCRPT(15)=' ROT 9-8       ELOSS= -0.00429'
      SCRPT(16)=' ROT 10-9      ELOSS= -0.00477'
      SCRPT(17)=' ROT 11-10     ELOSS= -0.00524'
      SCRPT(18)=' ROT 12-11     ELOSS= -0.00572'
      SCRPT(19)=' ROT 13-12     ELOSS= -0.00620'
      SCRPT(20)=' ROT 14-13     ELOSS= -0.00668'
      SCRPT(21)=' ROT 15-14     ELOSS= -0.00715'
      SCRPT(22)=' ROT 16-15     ELOSS= -0.00763'
      SCRPT(23)=' ROT 17-16     ELOSS= -0.00811'
      SCRPT(24)=' ROT 18-17     ELOSS= -0.00858'
      SCRPT(25)=' ROT 19-18     ELOSS= -0.00906'
      SCRPT(26)=' ROT 20-19     ELOSS= -0.00954'
      SCRPT(27)=' ROT 21-20     ELOSS= -0.0100 '
      SCRPT(28)=' ROT 22-21     ELOSS= -0.0105 '
      SCRPT(29)=' ROT 23-22     ELOSS= -0.0110 '
      SCRPT(30)=' ROT 24-23     ELOSS= -0.0114 '
      SCRPT(31)=' ROT 25-24     ELOSS= -0.0119 '
      SCRPT(32)=' ROT 26-25     ELOSS= -0.0124 '
      SCRPT(33)=' ROT 0-1       ELOSS=  0.00048'
      SCRPT(34)=' ROT 1-2       ELOSS=  0.00095'
      SCRPT(35)=' ROT 2-3       ELOSS=  0.00143'
      SCRPT(36)=' ROT 3-4       ELOSS=  0.00191'
      SCRPT(37)=' ROT 4-5       ELOSS=  0.00238'
      SCRPT(38)=' ROT 5-6       ELOSS=  0.00286'
      SCRPT(39)=' ROT 6-7       ELOSS=  0.00334'
      SCRPT(40)=' ROT 7-8       ELOSS=  0.00381'
      SCRPT(41)=' ROT 8-9       ELOSS=  0.00429'
      SCRPT(42)=' ROT 9-10      ELOSS=  0.00477'
      SCRPT(43)=' ROT 10-11     ELOSS=  0.00524'
      SCRPT(44)=' ROT 11-12     ELOSS=  0.00572'
      SCRPT(45)=' ROT 12-13     ELOSS=  0.00620'
      SCRPT(46)=' ROT 13-14     ELOSS=  0.00668'
      SCRPT(47)=' ROT 14-15     ELOSS=  0.00715'
      SCRPT(48)=' ROT 15-16     ELOSS=  0.00763'
      SCRPT(49)=' ROT 16-17     ELOSS=  0.00811'
      SCRPT(50)=' ROT 17-18     ELOSS=  0.00858'
      SCRPT(51)=' ROT 18-19     ELOSS=  0.00906'
      SCRPT(52)=' ROT 19-20     ELOSS=  0.00954'
      SCRPT(53)=' ROT 20-21     ELOSS=  0.0100 '
      SCRPT(54)=' ROT 21-22     ELOSS=  0.0105 '
      SCRPT(55)=' ROT 22-23     ELOSS=  0.0110 '
      SCRPT(56)=' ROT 23-24     ELOSS=  0.0114 '
      SCRPT(57)=' ROT 24-25     ELOSS=  0.0119 '
      SCRPT(58)=' ROT 25-26     ELOSS=  0.0124 '
      SCRPT(59)=' VIB V1        ELOSS=  0.266  '
      SCRPT(60)=' VIB 2V1       ELOSS=  0.528  '
      SCRPT(61)=' VIB 3V1       ELOSS=  0.787  '
      SCRPT(62)=' VIB 4V1       ELOSS=  1.043  '
      SCRPT(63)=' VIB 5V1       ELOSS=  1.295  '
      SCRPT(64)=' VIB 6V1       ELOSS=  1.544  '
      SCRPT(65)=' EXC A3 PI     ELOSS=  6.04   '
      SCRPT(66)=' EXC A3 SIGMA  ELOSS=  6.82   '
      SCRPT(67)=' EXC A1 PI     ELOSS=  8.07   '
      SCRPT(68)=' EXC B3 SIGMA  ELOSS= 10.39   '
      SCRPT(69)=' EXC C1 + E1   ELOSS= 11.3    '
      SCRPT(70)=' EXC           ELOSS= 13.5    '
      EN=-ESTEP/2.0
      DO 9000 I=1,NSTEP
      EN=EN+ESTEP
      DO 10 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 20
   10 CONTINUE
      J=NDATA
   20 A=(YEN(J)-YEN(J-1))/(XEN(J)-XEN(J-1))
      B=(XEN(J-1)*YEN(J)-XEN(J)*YEN(J-1))/(XEN(J-1)-XEN(J))
      Q(2,I)=(A*EN+B)*1.0D-16
C
      Q(3,I)=0.0
      IF(EN.LT.E(3)) GO TO 50
      DO 30 J=2,NION
      IF(EN.LE.XION(J)) GO TO 40
   30 CONTINUE
      J=NION
   40 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
C
   50 Q(4,I)=0.0
      IF(EN.LT.XATT(1)) GO TO 55
      IF(EN.GT.XATT(NATT)) GO TO 55
      DO 51 J=2,NATT
      IF(EN.LE.XATT(J)) GO TO 52
   51 CONTINUE
      J=NATT
   52 A=(YATT(J)-YATT(J-1))/(XATT(J)-XATT(J-1))
      B=(XATT(J-1)*YATT(J)-XATT(J)*YATT(J-1))/(XATT(J-1)-XATT(J))
      Q(4,I)=(A*EN+B)*1.D-16
C
   55 Q(5,I)=0.0
      Q(6,I)=0.0
C----------------------------------------------------------------------
C DIPOLE BORN ROTATIONAL STATES
C----------------------------------------------------------------------
      ENRT=DSQRT(EN)
C SUPER ELASTIC ROTATIONAL COLLISIONS
      DO 150 L=1,26
      AL=DFLOAT(L)
      QIN(L,I)=PJ(L)*DBK*DLOG((ENRT+DSQRT(EN-EIN(L)))/(DSQRT(EN-EIN(L))-
     /ENRT))*AL/((2.0*AL+1.0)*EN)
  150 PEQIN(L,I)=0.5+(QIN(L,I)-DRAT*QIN(L,I))/QIN(L,I)
      DO 155 L=27,52
  155 QIN(L,I)=0.0
C ROT 0-1
      IF(EN.LE.EIN(27)) GO TO 200
      QIN(27,I)=FROT0*DBK*DLOG((ENRT+DSQRT(EN-EIN(27)))/(ENRT-DSQRT(EN-
     /EIN(27))))/EN
      PEQIN(27,I)=0.5+(QIN(27,I)-DRAT*QIN(27,I))/QIN(27,I)
C ROT 1-2 AND HIGHER
      DO 160 L=28,52
      IF(EN.LE.EIN(L)) GO TO 200
      AL=DFLOAT(L-27)
      QIN(L,I)=PJ(L-27)*DBK*DLOG((ENRT+DSQRT(EN-EIN(L)))/(ENRT-DSQRT(EN-
     /EIN(L))))*(AL+1.0)/((2.0*AL+1.0)*EN)
  160 PEQIN(L,I)=0.5+(QIN(L,I)-DRAT*QIN(L,I))/QIN(L,I)
C
  200 CONTINUE
C
      QIN(53,I)=0.0
      IF(EN.LE.EIN(53)) GO TO 400
      DO 310 J=2,NVIB1
      IF(EN.LE.XVIB1(J)) GO TO 320
  310 CONTINUE
      J=NVIB1
  320 A=(YVIB1(J)-YVIB1(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB1(J)-XVIB1(J)*YVIB1(J-1))/(XVIB1(J-1)-XVIB1(J))
      QIN(53,I)=(A*EN+B)*1.D-16*AVIB
  400 CONTINUE
C
      QIN(54,I)=0.0
      IF(EN.LE.EIN(54)) GO TO 500
      DO 410 J=2,NVIB2
      IF(EN.LE.XVIB2(J)) GO TO 420
  410 CONTINUE
      J=NVIB2
  420 A=(YVIB2(J)-YVIB2(J-1))/(XVIB2(J)-XVIB2(J-1))
      B=(XVIB2(J-1)*YVIB2(J)-XVIB2(J)*YVIB2(J-1))/(XVIB2(J-1)-XVIB2(J))
      QIN(54,I)=(A*EN+B)*1.D-16
  500 CONTINUE
C
      QIN(55,I)=0.0
      IF(EN.LE.EIN(55)) GO TO 600
      DO 510 J=2,NVIB3
      IF(EN.LE.XVIB3(J)) GO TO 520
  510 CONTINUE
      J=NVIB3
  520 A=(YVIB3(J)-YVIB3(J-1))/(XVIB3(J)-XVIB3(J-1))
      B=(XVIB3(J-1)*YVIB3(J)-XVIB3(J)*YVIB3(J-1))/(XVIB3(J-1)-XVIB3(J))
      QIN(55,I)=(A*EN+B)*1.D-16
  600 CONTINUE
C
      QIN(56,I)=0.0
      IF(EN.LE.EIN(56)) GO TO 700
      DO 610 J=2,NVIB4
      IF(EN.LE.XVIB4(J)) GO TO 620
  610 CONTINUE
      J=NVIB4
  620 A=(YVIB4(J)-YVIB4(J-1))/(XVIB4(J)-XVIB4(J-1))
      B=(XVIB4(J-1)*YVIB4(J)-XVIB4(J)*YVIB4(J-1))/(XVIB4(J-1)-XVIB4(J))
      QIN(56,I)=(A*EN+B)*1.D-16
  700 CONTINUE
C
      QIN(57,I)=0.0
      IF(EN.LE.EIN(57)) GO TO 800
      DO 710 J=2,NVIB5
      IF(EN.LE.XVIB5(J)) GO TO 720
  710 CONTINUE
      J=NVIB5
  720 A=(YVIB5(J)-YVIB5(J-1))/(XVIB5(J)-XVIB5(J-1))
      B=(XVIB5(J-1)*YVIB5(J)-XVIB5(J)*YVIB5(J-1))/(XVIB5(J-1)-XVIB5(J))
      QIN(57,I)=(A*EN+B)*1.D-16
  800 CONTINUE
C
      QIN(58,I)=0.0
      IF(EN.LE.EIN(58)) GO TO 900
      DO 810 J=2,NVIB6
      IF(EN.LE.XVIB6(J)) GO TO 820
  810 CONTINUE
      J=NVIB6
  820 A=(YVIB6(J)-YVIB6(J-1))/(XVIB6(J)-XVIB6(J-1))
      B=(XVIB6(J-1)*YVIB6(J)-XVIB6(J)*YVIB6(J-1))/(XVIB6(J-1)-XVIB6(J))
      QIN(58,I)=(A*EN+B)*1.D-16
  900 CONTINUE
C
      QIN(59,I)=0.0
      IF(EN.LE.EIN(59)) GO TO 1000
      DO 910 J=2,NEXC
      IF(EN.LE.XEXC(J)) GO TO 920
  910 CONTINUE
      J=NEXC
  920 A=(YEXC(J)-YEXC(J-1))/(XEXC(J)-XEXC(J-1))
      B=(XEXC(J-1)*YEXC(J)-XEXC(J)*YEXC(J-1))/(XEXC(J-1)-XEXC(J))
      QIN(59,I)=(A*EN+B)*1.D-16
 1000 CONTINUE
C
      QIN(60,I)=0.0
      IF(EN.LE.EIN(60)) GO TO 1100
      DO 1010 J=2,NEXC1
      IF(EN.LE.XEXC1(J)) GO TO 1020
 1010 CONTINUE
      J=NEXC1
 1020 A=(YEXC1(J)-YEXC1(J-1))/(XEXC1(J)-XEXC1(J-1))
      B=(XEXC1(J-1)*YEXC1(J)-XEXC1(J)*YEXC1(J-1))/(XEXC1(J-1)-XEXC1(J))
      QIN(60,I)=(A*EN+B)*1.D-16
 1100 CONTINUE
C
      QIN(61,I)=0.0
      IF(EN.LE.EIN(61)) GO TO 1200
      DO 1110 J=2,NEXC2
      IF(EN.LE.XEXC2(J)) GO TO 1120
 1110 CONTINUE
      J=NEXC2
 1120 A=(YEXC2(J)-YEXC2(J-1))/(XEXC2(J)-XEXC2(J-1))
      B=(XEXC2(J-1)*YEXC2(J)-XEXC2(J)*YEXC2(J-1))/(XEXC2(J-1)-XEXC2(J))
      QIN(61,I)=(A*EN+B)*1.D-16
 1200 CONTINUE
C
      QIN(62,I)=0.0
      IF(EN.LE.EIN(62)) GO TO 1300
      DO 1210 J=2,NEXC3
      IF(EN.LE.XEXC3(J)) GO TO 1220
 1210 CONTINUE
      J=NEXC3
 1220 A=(YEXC3(J)-YEXC3(J-1))/(XEXC3(J)-XEXC3(J-1))
      B=(XEXC3(J-1)*YEXC3(J)-XEXC3(J)*YEXC3(J-1))/(XEXC3(J-1)-XEXC3(J))
      QIN(62,I)=(A*EN+B)*1.D-16
 1300 CONTINUE
C
      QIN(63,I)=0.0
      IF(EN.LE.EIN(63)) GO TO 1400
      DO 1310 J=2,NEXC4
      IF(EN.LE.XEXC4(J)) GO TO 1320
 1310 CONTINUE
      J=NEXC4
 1320 A=(YEXC4(J)-YEXC4(J-1))/(XEXC4(J)-XEXC4(J-1))
      B=(XEXC4(J-1)*YEXC4(J)-XEXC4(J)*YEXC4(J-1))/(XEXC4(J-1)-XEXC4(J))
      QIN(63,I)=(A*EN+B)*1.D-16
 1400 CONTINUE
C
      QIN(64,I)=0.0
      IF(EN.LE.EIN(64)) GO TO 1500
      DO 1410 J=2,NEXC5
      IF(EN.LE.XEXC5(J)) GO TO 1420
 1410 CONTINUE
      J=NEXC5
 1420 A=(YEXC5(J)-YEXC5(J-1))/(XEXC5(J)-XEXC5(J-1))
      B=(XEXC5(J-1)*YEXC5(J)-XEXC5(J)*YEXC5(J-1))/(XEXC5(J-1)-XEXC5(J))
      QIN(64,I)=(A*EN+B)*1.D-16
 1500 CONTINUE
C
      SUM=0.0
      DO 2000 K=1,64
      SUM=SUM+QIN(K,I)
 2000 CONTINUE
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+SUM
 9000 CONTINUE
C  SAVE COMPUTE TIME
      DO 9900 K=1,64
      J=65-K
      IF(EFINAL.LE.EIN(J))  NIN=J-1
 9900 CONTINUE
C
      RETURN
      END
      SUBROUTINE GAS24(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      DIMENSION XEN(33),YXSEC(33),XVIB1(29),YVIB1(29),XVIB2(29),YVIB2(29
     /),XVIB3(28),YVIB3(28),XION(25),YION(25),XEXC(26),YEXC(26),
     /XEXC1(31),YEXC1(31)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      DATA XEN/0.00,0.001,0.003,0.007,0.01,0.014,0.02,0.03,0.05,0.07,
     /0.10,0.14,0.20,0.30,0.40,0.60,0.80,1.00,1.40,2.00,
     /3.00,5.00,6.00,8.00,10.0,14.0,20.0,40.0,70.0,100.,
     /140.,200.,1000./
      DATA YXSEC/165.,145.,135.,122.,108.,98.0,92.0,83.0,71.0,62.0,
     /50.0,43.0,36.0,28.5,24.0,15.8,11.5,9.30,8.50,9.20,
     /12.5,22.0,26.0,38.0,40.0,30.0,20.0,10.0,6.00,4.00,
     /2.80,2.00,0.40/
      DATA XVIB1/0.00,0.12,0.121,0.13,0.14,0.17,0.22,0.26,0.36,0.46,
     /0.56,0.66,0.76,0.96,1.36,2.00,3.00,4.00,5.00,6.00,
     /7.00,8.00,9.00,10.0,14.0,20.0,40.0,100.,1000./
      DATA YVIB1/0.00,0.00,.052,0.42,0.75,1.03,1.21,1.26,1.14,0.98,
     /0.84,0.74,0.66,0.58,0.49,0.56,0.77,1.23,1.75,2.27,
     /2.36,2.27,1.92,1.40,0.59,0.28,0.07,0.02,0.00/
      DATA XVIB2/0.00,0.16,0.161,0.17,0.18,0.21,0.26,0.30,0.40,0.50,
     /0.60,0.70,0.80,1.00,1.40,2.00,3.00,4.00,5.00,6.00,
     /7.00,8.00,9.00,10.0,14.0,20.0,40.0,100.,1000./
      DATA YVIB2/0.00,0.00,.052,0.42,0.75,1.03,1.21,1.26,1.14,0.98,
     /0.84,0.74,0.66,0.58,0.49,0.56,0.77,1.23,1.75,2.27,
     /2.36,2.27,1.92,1.40,0.59,0.28,0.07,0.02,0.00/
      DATA XVIB3/0.00,0.36,0.362,0.38,0.40,0.42,0.47,0.51,0.55,0.60,
     /0.70,0.80,1.00,1.40,2.00,3.00,4.00,5.00,6.00,7.00,
     /8.00,9.00,10.0,14.0,20.0,40.0,100.,1000./
      DATA YVIB3/0.00,0.00,.053,.105,0.21,0.28,0.42,0.53,0.61,0.66,
     /0.75,0.75,0.73,0.66,0.72,0.88,1.28,1.75,2.10,2.36,
     /2.36,1.92,1.40,0.54,0.23,0.07,0.02,0.00/
      DATA XION/10.0,10.8,13.3,18.3,19.3,20.3,23.3,28.3,33.3,38.3,
     /43.3,48.3,53.3,58.3,68.3,78.3,88.3,98.3,120.,140.,
     /200.,300.,500.,700.,1000./
      DATA YION/0.00,.251,2.28,5.93,6.84,7.52,9.01,11.1,12.6,13.6,
     /14.5,15.0,15.2,15.6,16.0,16.1,16.0,15.7,15.2,14.6,
     /12.5,9.67,6.74,5.04,4.01/
      DATA XEXC/6.30,6.70,7.30,7.80,8.30,8.80,9.30,10.3,11.3,13.3,
     /15.3,19.3,24.3,29.3,39.3,49.3,59.3,69.3,79.3,100.,
     /150.,200.,300.,400.,600.,1000./
      DATA YEXC/0.00,0.35,0.65,1.00,1.31,1.55,1.75,2.16,2.45,3.02,
     /3.49,4.08,4.43,4.51,4.31,3.90,3.55,3.23,2.94,2.47,
     /1.78,1.40,0.98,0.73,0.47,0.33/
      DATA XEXC1/8.30,8.50,9.10,9.60,10.1,10.6,11.1,12.1,13.1,14.1,
     /15.1,17.1,19.1,21.1,25.1,29.1,34.1,39.1,44.1,49.1,
     /59.1,69.1,79.1,100.,150.,200.,300.,400.,500.,600.,1000./
      DATA YEXC1/0.00,0.12,0.26,0.38,0.47,0.58,0.70,1.06,1.60,2.36,
     /3.29,4.81,5.94,6.53,7.16,7.24,7.06,6.61,6.10,5.54,
     /4.61,3.96,3.47,2.80,2.04,1.67,1.22,0.96,0.79,0.67,0.49/
C
C  NO EXPERIMENTAL DATA ON TRANSVERSE DIFFUSION AVAILABLE SO TWO
C  DATA SETS CREATED WITH EXPECTED MAXIMUM AND MINIMUM DIFFUSION
C  HOT IS THE MORE DIFFUSING GAS.
C
      NAME='METHYLAL  HOT  '
C
      NIN=5
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      NDATA=33
      NVIB1=29
      NVIB2=29
      NVIB3=28
      NION=25
      NEXC=26
      NEXC1=31
      E(1)=0.0
      E(2)=2.0*EMASS/(76.09532*AMU)
      E(3)=10.0
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EIN(1)=0.12
      EIN(2)=0.16
      EIN(3)=0.36
      EIN(4)=6.3
      EIN(5)=8.3
      EOBY=10.0
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       METHYLAL       '
      SCRPT(3)=' IONISATION    ELOSS= 10.0    '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' VIB           ELOSS=  0.12   '
      SCRPT(8)=' VIB           ELOSS=  0.16   '
      SCRPT(9)=' VIB           ELOSS=  0.36   '
      SCRPT(10)=' EXC           ELOSS=  6.3    '
      SCRPT(11)=' EXC           ELOSS=  8.3    '
      EN=-ESTEP/2.0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
C
      DO 10 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 20
   10 CONTINUE
      J=NDATA
   20 A=(YXSEC(J)-YXSEC(J-1))/(XEN(J)-XEN(J-1))
      B=(XEN(J-1)*YXSEC(J)-XEN(J)*YXSEC(J-1))/(XEN(J-1)-XEN(J))
      Q(2,I)=(A*EN+B)*1.0D-16
C
      Q(3,I)=0.0
      IF(EN.LT.E(3)) GO TO 200
      DO 110 J=2,NION
      IF(EN.LE.XION(J)) GO TO 120
  110 CONTINUE
      J=NION
  120 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
C
  200 Q(4,I)=0.0
      Q(5,I)=0.0
      Q(6,I)=0.0
C
      QIN(1,I)=0.0
      IF(EN.LE.EIN(1)) GO TO 400
      DO 310 J=2,NVIB1
      IF(EN.LE.XVIB1(J)) GO TO 320
  310 CONTINUE
      J=NVIB1
  320 A=(YVIB1(J)-YVIB1(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB1(J)-XVIB1(J)*YVIB1(J-1))/(XVIB1(J-1)-XVIB1(J))
      QIN(1,I)=(A*EN+B)*1.D-16
  400 CONTINUE
C
      QIN(2,I)=0.0
      IF(EN.LE.EIN(2)) GO TO 430
      DO 410 J=2,NVIB2
      IF(EN.LE.XVIB2(J)) GO TO 420
  410 CONTINUE
      J=NVIB2
  420 A=(YVIB2(J)-YVIB2(J-1))/(XVIB2(J)-XVIB2(J-1))
      B=(XVIB2(J-1)*YVIB2(J)-XVIB2(J)*YVIB2(J-1))/(XVIB2(J-1)-XVIB2(J))
      QIN(2,I)=(A*EN+B)*1.D-16
  430 CONTINUE
C
      QIN(3,I)=0.0
      IF(EN.LE.EIN(3)) GO TO 460
      DO 440 J=2,NVIB3
      IF(EN.LE.XVIB3(J)) GO TO 450
  440 CONTINUE
      J=NVIB3
  450 A=(YVIB3(J)-YVIB3(J-1))/(XVIB3(J)-XVIB3(J-1))
      B=(XVIB3(J-1)*YVIB3(J)-XVIB3(J)*YVIB3(J-1))/(XVIB3(J-1)-XVIB3(J))
      QIN(3,I)=(A*EN+B)*1.D-16
  460 CONTINUE
C
      QIN(4,I)=0.0
      IF(EN.LE.EIN(4)) GO TO 600
      DO 510 J=2,NEXC
      IF(EN.LE.XEXC(J)) GO TO 520
  510 CONTINUE
      J=NEXC
  520 A=(YEXC(J)-YEXC(J-1))/(XEXC(J)-XEXC(J-1))
      B=(XEXC(J-1)*YEXC(J)-XEXC(J)*YEXC(J-1))/(XEXC(J-1)-XEXC(J))
      QIN(4,I)=(A*EN+B)*1.D-16
  600 CONTINUE
C
      QIN(5,I)=0.0
      IF(EN.LE.EIN(5)) GO TO 700
      DO 610 J=2,NEXC1
      IF(EN.LE.XEXC(J)) GO TO 620
  610 CONTINUE
      J=NEXC1
  620 A=(YEXC1(J)-YEXC1(J-1))/(XEXC1(J)-XEXC1(J-1))
      B=(XEXC1(J-1)*YEXC1(J)-XEXC1(J)*YEXC1(J-1))/(XEXC1(J-1)-XEXC1(J))
      QIN(5,I)=(A*EN+B)*1.D-16
  700 CONTINUE
      Q(1,I)=Q(2,I)+Q(3,I)+QIN(1,I)+QIN(2,I)+QIN(3,I)+QIN(4,I)+QIN(5,I)
  900 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(5)) NIN=4
      IF(EFINAL.LE.EIN(4)) NIN=3
      IF(EFINAL.LE.EIN(3)) NIN=2
      IF(EFINAL.LE.EIN(2)) NIN=1
      IF(EFINAL.LE.EIN(1)) NIN=0
C
      RETURN
      END
      SUBROUTINE GAS25(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      DIMENSION XEN(54),YXSEC(54),XION(29),YION(29),XATT(16),YATT(16),
     /XVIB3(19),YVIB3(19),XVIB4(28),YVIB4(28),XVIB5(25),YVIB5(25),
     /XVIB6(19),YVIB6(19),XEXC(27),YEXC(27),XEXC1(35),YEXC1(35)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      DATA XEN/0.00,.004,0.01,0.02,0.03,0.04,0.05,0.06,0.07,0.08,
     /0.09,0.10,0.11,0.12,0.13,0.14,0.16,0.18,0.20,0.24,
     /0.30,0.40,0.50,0.60,0.80,1.00,1.40,2.00,3.00,4.00,
     /5.00,6.00,7.00,8.00,9.00,10.0,15.0,20.0,30.0,40.0,
     /70.0,100.,140.,200.,250.,300.,500.,1000.,1500.,3000.,
     /6000.,10000.,20000.,100000./
      DATA YXSEC/235.,235.,235.,233.,225.,215.,205.,190.,175.,160.,
     /140.,125.,110.,95.0,80.0,74.0,62.0,51.0,43.0,34.0,
     /25.0,20.0,18.0,16.5,15.7,15.0,14.5,15.0,17.5,20.0,
     /22.0,23.5,24.0,24.5,24.0,22.0,15.0,11.5,8.00,6.20,
     /3.50,2.60,1.50,0.95,0.70,0.55,0.30,0.14,0.09,0.04,
     /0.02,.012,.005,.001/
      DATA XION/10.04,10.9,13.4,18.4,19.4,20.4,23.4,28.4,33.4,38.4,
     /43.4,48.4,53.4,58.4,68.4,78.4,88.4,98.4,120.,140.,
     /200.,300.,500.,700.,1000.,2000.,4000.,10000.,100000./
      DATA YION/0.00,0.12,1.12,2.92,3.37,3.70,4.44,5.48,6.17,6.68,
     /7.13,7.41,7.52,7.66,7.84,7.89,7.84,7.75,7.53,7.20,
     /6.17,4.76,3.30,2.45,1.95,1.15,0.70,0.36,.06/
      DATA XATT/6.85,7.00,7.20,7.50,8.00,8.50,9.00,9.50,10.0,10.5,
     /11.0,11.5,12.0,12.5,13.0,13.2/
      DATA YATT/0.00,0.67,1.10,1.65,2.80,4.40,6.60,10.3,14.7,12.3,
     /9.70,6.20,3.50,1.30,0.50,0.00/
C V2 AND V3 DIPOLE PARTS GIVEN ANALYTICALLY
C NB V3 TABLE CONTAINS ONLY RESONANCE PART OF X-SECT.
      DATA XVIB3/.137,1.00,2.00,3.00,4.00,5.00,6.00,7.00,8.00,9.00,
     /10.0,14.0,20.0,30.0,40.0,100.,1000.,10000.,100000./
      DATA YVIB3/0.00,0.01,0.45,0.75,1.00,1.15,1.20,1.15,1.00,0.90,
     /0.80,0.50,0.35,0.21,0.16,0.05,.005,.0005,.00005/
      DATA XVIB4/.180,0.19,0.20,0.23,0.25,0.30,0.35,0.40,0.50,0.70,
     /1.00,1.50,2.00,3.00,4.00,5.00,6.00,7.50,8.50,10.0,
     /15.0,20.0,30.0,40.0,100.,1000.,10000.,100000./
      DATA YVIB4/0.00,0.17,0.22,0.30,0.32,0.34,0.34,0.32,0.31,0.25,
     /0.21,0.19,0.19,0.32,0.47,0.61,0.79,1.03,1.03,0.85,
     /0.58,0.33,0.18,0.11,0.03,.003,.0003,.00003/
      DATA XVIB5/.349,0.40,0.45,0.50,0.60,0.70,0.80,1.00,1.50,2.00,
     /3.00,4.00,5.00,6.00,7.50,8.50,10.0,15.0,20.0,30.0,
     /40.0,100.,1000.,10000.,100000./
      DATA YVIB5/0.00,0.35,0.43,0.47,0.48,0.48,0.46,0.43,0.43,0.47,
     /0.69,1.00,1.30,1.75,1.90,1.60,1.20,0.72,0.30,0.17,
     /0.10,0.02,.002,.0002,.00002/
      DATA XVIB6/.529,1.00,1.50,2.00,3.00,4.00,5.00,6.00,7.50,8.50,
     /10.0,15.0,20.0,30.0,40.0,100.,1000.,10000.,100000./
      DATA YVIB6/0.00,.001,0.01,.016,.035,0.06,0.09,0.12,0.13,0.11,
     /0.08,.045,0.02,0.01,.007,.0016,.00016,.000016,.0000016/
      DATA XEXC/7.70,8.50,9.00,9.50,10.5,11.5,13.0,15.0,20.0,25.0,
     /30.0,40.0,50.0,60.0,70.0,80.0,100.,150.,200.,300.,
     /400.,600.,1000.,2000.,4000.,10000.,100000./
      DATA YEXC/0.00,0.11,0.38,0.71,1.26,1.76,2.03,2.36,2.80,3.03,
     /3.08,3.19,3.25,3.25,3.20,3.10,2.81,1.93,1.49,1.10,
     /0.88,0.66,0.44,0.28,.160,.083,.0150/
      DATA XEXC1/8.50,8.70,9.30,9.85,10.3,10.8,11.3,12.3,13.3,14.3,
     /15.3,17.3,20.0,22.0,25.0,30.0,35.0,40.0,45.0,50.0,
     /60.0,70.0,80.0,100.,150.,200.,300.,400.,500.,600.,
     /1000.,2000.,4000.,10000.,100000./
      DATA YEXC1/0.00,0.077,0.16,0.23,0.29,0.34,0.42,0.64,0.97,1.43,
     /1.99,2.91,3.79,4.07,4.73,5.50,5.94,6.16,6.44,6.60,
     /6.82,6.82,6.77,6.44,4.79,3.91,2.86,2.20,1.87,1.65,
     /1.16,0.68,0.40,0.20,.038/
      NAME=' DME    1998   '
C ---------------------------------------------------------------------
C UPDATES DME97 WITH MONTE CARLO SIMULATION OF STEADY STATE TOWNSEND
C  VALUE FOR ALPHA.
C UPDATES DME94 WITH CORRECT VIBRATIONAL ANALYSIS FROM SVERDLOV.
C UPDATES DME92 WITH BETTER FIT TO FANO AND EV/ION PAIR
C ---------------------------------------------------------------------
      AVIB1=0.06
      AVIB2=0.35
      NIN=8
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      NDATA=54
      NVIB3=19
      NVIB4=28
      NVIB5=25
      NVIB6=19
      NION=29
      NATT=16
      NEXC=27
      NEXC1=35
      E(1)=0.0
      E(2)=2.0*EMASS/(46.06904*AMU)
      E(3)=10.04
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=10.04
      EIN(1)=-0.051
      EIN(2)=0.051
      EIN(3)=0.137
      EIN(4)=0.180
      EIN(5)=0.349
      EIN(6)=0.529
      EIN(7)=7.70
      EIN(8)=8.5
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       DME            '
      SCRPT(3)=' IONISATION    ELOSS= 10.04   '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' VIB           ELOSS= -0.051  '
      SCRPT(8)=' VIB           ELOSS=  0.051  '
      SCRPT(9)=' VIB           ELOSS=  0.137  '
      SCRPT(10)=' VIB           ELOSS=  0.180  '
      SCRPT(11)=' VIB           ELOSS=  0.349  '
      SCRPT(12)=' VIB           ELOSS=  0.529  '
      SCRPT(13)=' EXC           ELOSS=  7.70   '
      SCRPT(14)=' EXC           ELOSS=  8.50   '
      APOP=DEXP(EIN(1)/AKT)
      EN=-ESTEP/2.0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      DO 10 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 20
   10 CONTINUE
      J=NDATA
   20 A=(YXSEC(J)-YXSEC(J-1))/(XEN(J)-XEN(J-1))
      B=(XEN(J-1)*YXSEC(J)-XEN(J)*YXSEC(J-1))/(XEN(J-1)-XEN(J))
      Q(2,I)=(A*EN+B)*1.0D-16
      Q(3,I)=0.0
      IF(EN.LT.E(3)) GO TO 200
      DO 110 J=2,NION
      IF(EN.LE.XION(J)) GO TO 120
  110 CONTINUE
      J=NION
  120 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
  200 Q(4,I)=0.0
      IF(EN.LT.XATT(1)) GO TO 300
      IF(EN.GT.XATT(NATT)) GO TO 300
      DO 210 J=2,NATT
      IF(EN.LE.XATT(J)) GO TO 220
  210 CONTINUE
      J=NATT
  220 A=(YATT(J)-YATT(J-1))/(XATT(J)-XATT(J-1))
      B=(XATT(J-1)*YATT(J)-XATT(J)*YATT(J-1))/(XATT(J-1)-XATT(J))
      Q(4,I)=(A*EN+B)*1.D-21
  300 Q(5,I)=0.0
      Q(6,I)=0.0
C
C SUPERELASTIC OF VIBRATION
C
      QIN(1,I)=0.0
      IF(EN.EQ.0.0) GO TO 390
      EFAC=DSQRT(1.0-(EIN(1)/EN))
      QIN(1,I)=AVIB1*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      QIN(1,I)=QIN(1,I)*APOP/(1.0+APOP)*1.D-16
C
  390 QIN(2,I)=0.0
      IF(EN.LE.EIN(2)) GO TO 400
      EFAC=DSQRT(1.0-(EIN(2)/EN))
      QIN(2,I)=AVIB1*DLOG((1.0+EFAC)/(1.0-EFAC))/(EN*(1.0+APOP))*1.D-16
  400 CONTINUE
      QIN(3,I)=0.0
      IF(EN.LE.EIN(3)) GO TO 430
      DO 410 J=2,NVIB3
      IF(EN.LE.XVIB3(J)) GO TO 420
  410 CONTINUE
      J=NVIB3
  420 A=(YVIB3(J)-YVIB3(J-1))/(XVIB3(J)-XVIB3(J-1))
      B=(XVIB3(J-1)*YVIB3(J)-XVIB3(J)*YVIB3(J-1))/(XVIB3(J-1)-XVIB3(J))
      QIN(3,I)=(A*EN+B)
      EFAC=DSQRT(1.0-(EIN(3)/EN))
      QIN(3,I)=(QIN(3,I)+AVIB2*DLOG((1.0+EFAC)/(1.0-EFAC))/EN)*1.D-16
  430 CONTINUE
      QIN(4,I)=0.0
      IF(EN.LE.EIN(4)) GO TO 500
      DO 440 J=2,NVIB4
      IF(EN.LE.XVIB4(J)) GO TO 450
  440 CONTINUE
      J=NVIB4
  450 A=(YVIB4(J)-YVIB4(J-1))/(XVIB4(J)-XVIB4(J-1))
      B=(XVIB4(J-1)*YVIB4(J)-XVIB4(J)*YVIB4(J-1))/(XVIB4(J-1)-XVIB4(J))
      QIN(4,I)=(A*EN+B)*1.D-16
  500 CONTINUE
      QIN(5,I)=0.0
      IF(EN.LE.EIN(5)) GO TO 600
      DO 540 J=2,NVIB5
      IF(EN.LE.XVIB5(J)) GO TO 550
  540 CONTINUE
      J=NVIB5
  550 A=(YVIB5(J)-YVIB5(J-1))/(XVIB5(J)-XVIB5(J-1))
      B=(XVIB5(J-1)*YVIB5(J)-XVIB5(J)*YVIB5(J-1))/(XVIB5(J-1)-XVIB5(J))
      QIN(5,I)=(A*EN+B)*1.D-16
  600 CONTINUE
      QIN(6,I)=0.0
      IF(EN.LE.EIN(6)) GO TO 700
      DO 640 J=2,NVIB6
      IF(EN.LE.XVIB6(J)) GO TO 650
  640 CONTINUE
      J=NVIB6
  650 A=(YVIB6(J)-YVIB6(J-1))/(XVIB6(J)-XVIB6(J-1))
      B=(XVIB6(J-1)*YVIB6(J)-XVIB6(J)*YVIB6(J-1))/(XVIB6(J-1)-XVIB6(J))
      QIN(6,I)=(A*EN+B)*1.D-16
  700 CONTINUE
      QIN(7,I)=0.0
      IF(EN.LE.EIN(7)) GO TO 800
      DO 710 J=2,NEXC
      IF(EN.LE.XEXC(J)) GO TO 720
  710 CONTINUE
      J=NEXC
  720 A=(YEXC(J)-YEXC(J-1))/(XEXC(J)-XEXC(J-1))
      B=(XEXC(J-1)*YEXC(J)-XEXC(J)*YEXC(J-1))/(XEXC(J-1)-XEXC(J))
      QIN(7,I)=(A*EN+B)*1.D-16
  800 CONTINUE
      QIN(8,I)=0.0
      IF(EN.LE.EIN(8)) GO TO 899
      DO 810 J=2,NEXC1
      IF(EN.LE.XEXC1(J)) GO TO 820
  810 CONTINUE
      J=NEXC1
  820 A=(YEXC1(J)-YEXC1(J-1))/(XEXC1(J)-XEXC1(J-1))
      B=(XEXC1(J-1)*YEXC1(J)-XEXC1(J)*YEXC1(J-1))/(XEXC1(J-1)-XEXC1(J))
      QIN(8,I)=(A*EN+B)*1.D-16
  899 CONTINUE
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+QIN(1,I)+QIN(2,I)+QIN(3,I)+QIN(4,I)+
     /QIN(5,I)+QIN(6,I)+QIN(7,I)+QIN(8,I)
  900 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(8)) NIN=7
      IF(EFINAL.LE.EIN(7)) NIN=6
      IF(EFINAL.LE.EIN(6)) NIN=5
      IF(EFINAL.LE.EIN(5)) NIN=4
      IF(EFINAL.LE.EIN(4)) NIN=3
      IF(EFINAL.LE.EIN(3)) NIN=2
      IF(EFINAL.LE.EIN(2)) NIN=1
      IF(EFINAL.LE.EIN(1)) NIN=0
      RETURN
      END
      SUBROUTINE GAS26(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
C ----------------------------------------------------------------
C    NEW ANALYSIS UPDATED TO DECEMBER 1994
C ---------------------------------------------------------------
      NAME='REID STEP(ANIS)'
C
      NIN=1
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
C ANISOTROPIC SCATTERING FOR LEVEL 1
      KIN(1)=1
C
      E(1)=0.0
      E(2)=2.0*EMASS/(4.0*AMU)
      E(3)=15.90
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=15.90
      EIN(1)=0.2
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       REID STEP(ANIS)'
      SCRPT(3)=' IONISATION    ELOSS= 15.90   '
      SCRPT(4)='                              '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' EXC (ANIS)    ELOSS=  0.20   '
      EN=-ESTEP/2.0
      DO 9000 I=1,NSTEP
      PEQEL(2,I)=0.0
      PEQIN(1,I)=0.0
      EN=EN+ESTEP
      Q(2,I)=1.0E-16
      Q(3,I)=0.0
      Q(4,I)=0.0
      Q(5,I)=0.0
      Q(6,I)=0.0
      QIN(1,I)=0.0
      IF(EN.LE.EIN(1)) GO TO 400
      QIN(1,I)=10.0E-16
      PEQIN(1,I)=0.5+(QIN(1,I)-0.7*QIN(1,I))/QIN(1,I)
  400 CONTINUE
C
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+0.7*QIN(1,I)
 9000 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(1)) NIN=0
      RETURN
      END
      SUBROUTINE GAS27(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
C ----------------------------------------------------------------
C    MAXWELL MODEL DECEMBER 1994
C ---------------------------------------------------------------
      NAME=' MAXWEL 1994-- '
C
      NIN=0
      DO 1 J=1,6
    1 KEL(J)=0
C     DO 2 J=1,NIN
C   2 KIN(J)=0
      SIGC=6.0E-16
      E(1)=0.0
      E(2)=2.0*EMASS/(4.0*AMU)
      E(3)=99.
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=99.
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       MAXWELL        '
      SCRPT(3)='                              '
      SCRPT(4)='                              '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      EN=-ESTEP/2.0
      DO 9000 I=1,NSTEP
      EN=EN+ESTEP
      IF(EN.EQ.0.0) THEN
      Q(2,I)=100000.E-16
      GO TO 10
      ENDIF
      Q(2,I)=SIGC/DSQRT(EN)
  10  Q(3,I)=0.0
      Q(4,I)=0.0
      Q(5,I)=0.0
      Q(6,I)=0.0
C
      Q(1,I)=Q(2,I)
 9000 CONTINUE
      RETURN
      END
      SUBROUTINE GAS28(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
C ----------------------------------------------------------------
C    NEW ANALYSIS UPDATED TO DECEMBER 1994
C ---------------------------------------------------------------
      NAME=' REID RAMP S=10'
C
      NIN=1
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      E(1)=0.0
      E(2)=2.0*EMASS/(4.0*AMU)
      E(3)=15.90
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=15.9
      EIN(1)=0.2
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       REID RAMP      '
      SCRPT(3)='                              '
      SCRPT(4)='                              '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' EXC           ELOSS=  0.2    '
      EN=-ESTEP/2.0
      DO 9000 I=1,NSTEP
      EN=EN+ESTEP
      Q(2,I)=6.0E-16
      Q(3,I)=0.0
      Q(4,I)=0.0
      Q(5,I)=0.0
      Q(6,I)=0.0
      QIN(1,I)=0.0
      IF(EN.LE.EIN(1)) GO TO 400
      QIN(1,I)=(EN-EIN(1))*10.0E-16
  400 CONTINUE
C
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+QIN(1,I)
 9000 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(1)) NIN=0
      RETURN
      END
      SUBROUTINE GAS29(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      DIMENSION XENM(56),YXMOM(56),XENT(56),YXTOT(56),
     /XVIB2(22),YVIB2(22),XVIB3(22),YVIB3(22),XVIB4(22),YVIB4(22),
     /XVIB5(22),YVIB5(22),XVIB6(22),YVIB6(22),
     /XDISS(27),YDISS(27),XATT(26),YATT(26),XION(48),YION(48)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      DATA XENM/0.0,0.001,0.002,0.004,0.007,0.01,.015,0.02,.025,0.03,
     /0.04,0.05,0.06,0.07,0.08,0.09,0.10,0.12,0.15,0.20,
     /0.25,0.30,0.35,0.40,0.45,0.50,0.60,0.70,0.80,0.90,
     /1.00,1.50,2.00,3.00,4.00,5.00,6.00,7.00,8.00,9.00,
     /10.0,15.0,20.0,30.0,40.0,50.0,60.0,70.0,80.0,90.0,
     /100.0,200.,400.,1000.,10000.,100000./
C  ELASTIC MOMENTUM TRANSFER
      DATA YXMOM/29.0,26.0,24.0,20.0,16.0,12.9,9.60,7.65,6.40,5.55,
     /4.25,3.40,2.80,2.40,2.00,1.90,2.00,2.50,3.15,4.20,
     /5.25,6.10,6.80,7.40,7.80,8.20,8.80,9.30,9.60,9.80,
     /10.0,10.4,10.7,11.0,11.2,11.4,11.5,11.6,11.8,12.0,
     /12.5,14.5,14.5,13.2,11.5,10.0,9.20,8.50,7.66,6.66,
     /5.86,3.00,1.50,0.60,0.06,.0006/
      DATA XENT/0.0,0.001,0.002,0.004,0.007,0.01,.015,0.02,.025,0.03,
     /0.04,0.05,0.06,0.07,0.08,0.09,0.10,0.12,0.15,0.20,
     /0.25,0.30,0.35,0.40,0.45,0.50,0.60,0.70,0.80,0.90,
     /1.00,1.50,2.00,3.00,4.00,5.00,6.00,7.00,8.00,9.00,
     /10.0,15.0,20.0,30.0,40.0,50.0,60.0,70.0,80.0,90.0,
     /100.0,200.,400.,1000.,10000.,100000./
C  ELASTIC TOTAL
      DATA YXTOT/29.0,26.0,24.0,20.0,16.0,12.9,9.60,7.65,6.40,5.55,
     /4.25,3.40,2.80,2.40,2.00,1.90,2.00,2.50,3.15,4.20,
     /5.25,6.10,6.80,7.40,7.80,8.20,8.80,9.30,9.60,9.80,
     /11.3,12.5,13.5,14.5,15.5,16.5,17.5,18.5,19.5,20.0,
     /20.7,23.5,23.5,21.5,19.5,18.5,17.5,17.0,16.0,15.0,
     /14.5,11.5,9.00,7.00,0.70,0.07/
C  VIBRATION V11 (RESONANCE ONLY)
      DATA XVIB2/0.065,1.00,2.00,3.00,4.00,4.50,5.00,6.00,7.00,8.00,
     /9.00,10.0,11.0,12.0,13.0,15.0,20.0,50.0,100.,1000.,
     /10000.,100000./
      DATA YVIB2/0.0,0.0,.028,.063,.196,.182,0.14,.126,.182,0.21,
     /0.21,.175,.063,.028,.014,.007,.0014,.000007,.0000007,.00000007,
     /.000000007,.0000000007/
C  VIBRATION V2  (RESONANCE ONLY)
      DATA XVIB3/0.1001,1.00,2.00,3.00,4.00,4.50,5.00,6.00,7.00,8.00,
     /9.00,10.0,11.0,12.0,13.0,15.0,20.0,50.0,100.,1000.,
     /10000.,100000./
      DATA YVIB3/0.0,0.0,.175,.343,1.08,1.04,0.77,0.70,1.02,1.15,
     /1.13,.959,0.35,.154,.063,.028,.014,.000003,.0000003,.00000003,
     /.000000003,.0000000003/
C  VIBRATION V1 (RESONANCE ONLY)
      DATA XVIB4/0.1523,1.00,2.00,3.00,4.00,4.50,5.00,6.00,7.00,8.00,
     /9.00,10.0,11.0,12.0,13.0,15.0,20.0,50.0,100.,1000.,
     /10000.,100000./
      DATA YVIB4/0.0,0.0,.378,.756,2.34,2.24,1.68,1.51,2.23,2.52,
     /2.49,2.10,0.77,.336,0.14,0.07,.035,.00007,.000007,.0000007,
     /.00000007,.000000007/
C  VIBRATION HARMONIC 2(V1)
      DATA XVIB5/0.35,1.00,2.00,3.00,4.00,4.50,5.00,6.00,7.00,8.00,
     /9.00,10.0,11.0,12.0,13.0,15.0,20.0,50.0,100.,1000.,
     /10000.,100000./
      DATA YVIB5/0.0,0.0,.135,0.27,0.84,.795,0.60,0.54,.795,0.90,
     /.885,0.75,0.27,0.12,.045,0.03,.015,.00015,.000015,.0000015,
     /.00000015,.000000015/
C VIBRATION HARMONIC (3(V1) + ALL OTHER HARMONICS)
      DATA XVIB6/0.500,1.00,2.00,3.00,4.00,4.50,5.00,6.00,7.00,8.00,
     /9.00,10.0,11.0,12.0,13.0,15.0,20.0,50.0,100.,1000.,
     /10000.,100000./
      DATA YVIB6/0.0,0.0,0.54,1.08,3.35,3.20,2.40,2.16,3.18,3.60,
     /3.56,3.00,1.09,0.48,.195,.105,.045,.00015,.000015,.0000015,
     /.00000015,.000000015/
C  DISOCIATION X-SECTION
      DATA XDISS/11.8,12.0,13.0,14.0,15.0,18.0,20.0,25.0,30.0,40.0,
     /50.0,60.0,80.0,100.,120.,150.,200.,300.,400.,500.,
     /600.,800.,1000.,2000.,4000.,10000.,100000./
      DATA YDISS/0.00,.007,.072,0.40,0.75,1.33,1.61,1.88,2.00,2.25,
     /2.40,2.50,2.60,2.60,2.60,2.55,2.50,2.40,2.30,2.20,
     /2.00,1.75,1.48,0.80,0.46,0.21,0.021/
      DATA XION/14.48,17.0,18.0,19.0,21.0,23.0,25.0,27.0,29.0,31.0,
     /33.0,35.0,37.0,39.0,41.0,43.0,45.0,47.0,49.0,51.0,
     /61.0,71.0,81.0,91.0,101.,126.,151.,176.,201.,251.,
     /301.,351.,401.,451.,501.,601.,701.,801.,901.,1001.,
     /1251.,1501.,1751.,2001.,2501.,3001.,10000.,100000./
      DATA YION/0.00,.0889,.211,.375,.782,1.18,1.59,2.11,2.49,2.81,
     /3.16,3.49,3.86,4.17,4.54,4.85,5.14,5.52,5.77,6.19,
     /6.82,7.57,7.84,8.17,8.39,8.77,8.75,8.76,8.57,8.17,
     /7.41,7.13,6.55,6.21,5.89,5.17,4.72,4.40,3.96,3.77,
     /3.19,2.79,2.44,2.28,1.88,1.67,0.60,0.09/
      DATA XATT/2.00,2.25,2.50,2.75,3.00,3.25,3.50,3.75,4.00,4.25,
     /4.50,4.75,5.00,5.25,5.50,5.75,6.00,6.25,6.50,6.75,
     /7.00,8.00,10.0,20.0,100.0,100000./
      DATA YATT/.0,.0075,.020,.038,.053,.069,.083,.086,.083,.074,
     /.060,.046,.035,.025,.017,.010,.0068,.004,.0016,.0007,
     /.0003,.0002,.0001,.00001,.000001,.0000001/
C ---------------------------------------------------------------------
C    NEW ANALYSIS UPDATED TO NOVEMBER 1999.
C    ALLOWS SUPERELASTIC SCATTERING TO ALL VIBRATIONAL LEVELS
c    EXCLUDING VIBRATION HARMONICS.
C    BORN ANGULAR DISTRIBUTION FOR  V1(0.1001) AND V2(0.1523) LEVELS.
C --------------------------------------------------------------------
      NAME=' C2F6 -1999--- '
C
      NIN=9
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
C ANISOTROPIC SCATTERING FROM LEVEL 5 AND 6
      KIN(5)=1
      KIN(6)=1
C
      NDATA=56
      NETOT=56
      NVIB2=22
      NVIB3=22
      NVIB4=22
      NVIB5=22
      NVIB6=22
      NDISS=27
      NATT=26
      NION=48
      E(1)=0.0
      E(2)=2.0*EMASS/(138.0118*AMU)
      E(3)=14.48
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=14.48
      EIN(1)=-0.065
      EIN(2)=-0.1001
      EIN(3)=-0.1523
      EIN(4)=0.065
      EIN(5)=0.1001
      EIN(6)=0.1523
      EIN(7)=0.35
      EIN(8)=0.500
      EIN(9)=11.8
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       C2F6           '
      SCRPT(3)=' IONISATION    ELOSS= 14.48   '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' VIB V11       ELOSS= -0.065  '
      SCRPT(8)=' VIB V2        ELOSS= -0.1001 '
      SCRPT(9)=' VIB V1        ELOSS= -0.1523 '
      SCRPT(10)=' VIB V11       ELOSS=  0.065  '
      SCRPT(11)=' VIB V2        ELOSS=  0.1001 '
      SCRPT(12)=' VIB V1        ELOSS=  0.1523 '
      SCRPT(13)=' VIB 2V1       ELOSS=  0.35   '
      SCRPT(14)=' VIB           ELOSS=  0.50   '
      SCRPT(15)=' EXC DISOCN    ELOSS= 11.8    '
      APOP1=DEXP(EIN(1)/AKT)
      APOP2=DEXP(EIN(2)/AKT)
      APOP3=DEXP(EIN(3)/AKT)
      EN=-ESTEP/2.0
      DO 9000 I=1,NSTEP
      EN=EN+ESTEP
      DO 10 J=2,NDATA
      IF(EN.LE.XENM(J)) GO TO 20
   10 CONTINUE
      J=NDATA
   20 A=(YXMOM(J)-YXMOM(J-1))/(XENM(J)-XENM(J-1))
      B=(XENM(J-1)*YXMOM(J)-XENM(J)*YXMOM(J-1))/(XENM(J-1)-XENM(J))
      XMOMT=(A*EN+B)*1.0D-16
      DO 50 J=2,NETOT
      IF(EN.LE.XENT(J)) GO TO 60
   50 CONTINUE
      J=NETOT
   60 A=(YXTOT(J)-YXTOT(J-1))/(XENT(J)-XENT(J-1))
      B=(XENT(J-1)*YXTOT(J)-XENT(J)*YXTOT(J-1))/(XENT(J-1)-XENT(J))
      XTOT=(A*EN+B)*1.0D-16
      IF(KEL(2).EQ.1) Q(2,I)=XTOT
      IF(KEL(2).EQ.1) PEQEL(2,I)=0.5+(XTOT-XMOMT)/XTOT
      IF(KEL(2).EQ.0) Q(2,I)=XMOMT
C
      Q(3,I)=0.0
      IF(EN.LT.E(3)) GO TO 200
      DO 110 J=2,NION
      IF(EN.LE.XION(J)) GO TO 120
  110 CONTINUE
      J=NION
  120 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
C
  200 Q(4,I)=0.0
      IF(EN.LT.XATT(1)) GO TO 250
      IF(EN.GT.XATT(NATT)) GO TO 250
      DO 210 J=2,NATT
      IF(EN.LE.XATT(J)) GO TO 220
  210 CONTINUE
      J=NATT
  220 A=(YATT(J)-YATT(J-1))/(XATT(J)-XATT(J-1))
      B=(XATT(J-1)*YATT(J)-XATT(J)*YATT(J-1))/(XATT(J-1)-XATT(J))
      Q(4,I)=(A*EN+B)*1.D-16
  250 Q(5,I)=0.0
      Q(6,I)=0.0
C
C SUPERELASTICS
      QIN(1,I)=0.0
      QIN(2,I)=0.0
      QIN(3,I)=0.0
      IF(EN.EQ.0.0) GO TO 305
C SUPERELASTIC OF VIBRATION V11
      EFAC=DSQRT(1.0-(EIN(1)/EN))
      QIN(1,I)=0.0363*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      DO 260 J=2,NVIB2
      IF((EN+EIN(4)).LE.XVIB2(J)) GO TO 270
  260 CONTINUE
      J=NVIB2
  270 A=(YVIB2(J)-YVIB2(J-1))/(XVIB2(J)-XVIB2(J-1))
      B=(XVIB2(J-1)*YVIB2(J)-XVIB2(J)*YVIB2(J-1))/(XVIB2(J-1)-XVIB2(J))
      QIN(1,I)=QIN(1,I)+(EN+EIN(4))*(A*(EN+EIN(4))+B)/EN
      QIN(1,I)=QIN(1,I)*APOP1/(1.0+APOP1)*1.D-16
C  SUPERELASTIC OF VIBRATION V2
      EFAC=DSQRT(1.0-(EIN(2)/EN))
      QIN(2,I)=0.4230*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      DO 280 J=2,NVIB3
      IF((EN+EIN(5)).LE.XVIB3(J)) GO TO 290
  280 CONTINUE
      J=NVIB3
  290 A=(YVIB3(J)-YVIB3(J-1))/(XVIB3(J)-XVIB3(J-1))
      B=(XVIB3(J-1)*YVIB3(J)-XVIB3(J)*YVIB3(J-1))/(XVIB3(J-1)-XVIB3(J))
      QIN(2,I)=QIN(2,I)+(EN+EIN(5))*(A*(EN+EIN(5))+B)/EN
      QIN(2,I)=QIN(2,I)*APOP2/(1.0+APOP2)*1.D-16
C SUPERELASTIC OF VIBRATION V1
      EFAC=DSQRT(1.0-(EIN(3)/EN))
      QIN(3,I)=1.5000*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      DO 300 J=2,NVIB4
      IF((EN+EIN(6)).LE.XVIB4(J))GO TO 301
  300 CONTINUE
      J=NVIB4
  301 A=(YVIB4(J)-YVIB4(J-1))/(XVIB4(J)-XVIB4(J-1))
      B=(XVIB4(J-1)*YVIB4(J)-XVIB4(J)*YVIB4(J-1))/(XVIB4(J-1)-XVIB4(J))
      QIN(3,I)=QIN(3,I)+(EN+EIN(6))*(A*(EN+EIN(6))+B)/EN
      QIN(3,I)=QIN(3,I)*APOP3/(1.0+APOP3)*1.D-16
C
  305 CONTINUE
      QIN(4,I)=0.0
      IF(EN.LE.EIN(4)) GO TO 400
      DO 310 J=2,NVIB2
      IF(EN.LE.XVIB2(J)) GO TO 320
  310 CONTINUE
      J=NVIB2
  320 A=(YVIB2(J)-YVIB2(J-1))/(XVIB2(J)-XVIB2(J-1))
      B=(XVIB2(J-1)*YVIB2(J)-XVIB2(J)*YVIB2(J-1))/(XVIB2(J-1)-XVIB2(J))
      EFAC=DSQRT(1.0-(EIN(4)/EN))
      QIN(4,I)=0.0363*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      QIN(4,I)=((A*EN+B)+QIN(4,I))*1.0/(1.0+APOP1)*1.D-16
  400 CONTINUE
C
      QIN(5,I)=0.0
      IF(EN.LE.EIN(5)) GO TO 500
      DO 410 J=2,NVIB3
      IF(EN.LE.XVIB3(J)) GO TO 420
  410 CONTINUE
      J=NVIB3
  420 A=(YVIB3(J)-YVIB3(J-1))/(XVIB3(J)-XVIB3(J-1))
      B=(XVIB3(J-1)*YVIB3(J)-XVIB3(J)*YVIB3(J-1))/(XVIB3(J-1)-XVIB3(J))
      EFAC=DSQRT(1.0-(EIN(5)/EN))
      QIN(5,I)=0.4230*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      ELF=EN-EIN(5)
      FWD=DLOG((EN+ELF)/(EN+ELF-2.0*DSQRT(EN*ELF)))
      BCK=DLOG((EN+ELF+2.0*DSQRT(EN*ELF))/(EN+ELF))
C ASSUME RATIO  MOM.T /TOT X-SECT FOR RESONANCE PART = RAT3
      RAT3=0.80
      XMT=((1.5-FWD/(FWD+BCK))*QIN(5,I)+RAT3*(A*EN+B))*1.0D-16
      XMT=XMT/(1.0+APOP2)
      QIN(5,I)=((A*EN+B)+QIN(5,I))*1.0/(1.0+APOP2)*1.D-16
      PEQIN(5,I)=0.5+(QIN(5,I)-XMT)/QIN(5,I)
  500 CONTINUE
C
      QIN(6,I)=0.0
      IF(EN.LE.EIN(6)) GO TO 600
      DO 510 J=2,NVIB4
      IF(EN.LE.XVIB4(J)) GO TO 520
  510 CONTINUE
      J=NVIB4
  520 A=(YVIB4(J)-YVIB4(J-1))/(XVIB4(J)-XVIB4(J-1))
      B=(XVIB4(J-1)*YVIB4(J)-XVIB4(J)*YVIB4(J-1))/(XVIB4(J-1)-XVIB4(J))
      EFAC=DSQRT(1.0-(EIN(6)/EN))
      QIN(6,I)=1.500*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      ELF=EN-EIN(6)
      FWD=DLOG((EN+ELF)/(EN+ELF-2.0*DSQRT(EN*ELF)))
      BCK=DLOG((EN+ELF+2.0*DSQRT(EN*ELF))/(EN+ELF))
C   ASSUME RATIO MOM T./ TOT X-SECT FOR RESONANCE PART = RAT4
      RAT4=0.80
      XMT=((1.5-FWD/(FWD+BCK))*QIN(6,I)+RAT4*(A*EN+B))*1.0D-16
      XMT=XMT/(1.0+APOP3)
      QIN(6,I)=((A*EN+B)+QIN(6,I))*1.0/(1.0+APOP3)*1.D-16
      PEQIN(6,I)=0.5+(QIN(6,I)-XMT)/QIN(6,I)
  600 CONTINUE
C
      QIN(7,I)=0.0
      IF(EN.LE.EIN(7)) GO TO 700
      DO 610 J=2,NVIB5
      IF(EN.LE.XVIB5(J)) GO TO 620
  610 CONTINUE
      J=NVIB5
  620 A=(YVIB5(J)-YVIB5(J-1))/(XVIB5(J)-XVIB5(J-1))
      B=(XVIB5(J-1)*YVIB5(J)-XVIB5(J)*YVIB5(J-1))/(XVIB5(J-1)-XVIB5(J))
      QIN(7,I)=(A*EN+B)*1.D-16
  700 CONTINUE
C
      QIN(8,I)=0.0
      IF(EN.LE.EIN(8)) GO TO 800
      DO 710 J=2,NVIB6
      IF(EN.LE.XVIB6(J)) GO TO 720
  710 CONTINUE
      J=NVIB6
  720 A=(YVIB6(J)-YVIB6(J-1))/(XVIB6(J)-XVIB6(J-1))
      B=(XVIB6(J-1)*YVIB6(J)-XVIB6(J)*YVIB6(J-1))/(XVIB6(J-1)-XVIB6(J))
      QIN(8,I)=(A*EN+B)*1.D-16
  800 CONTINUE
C
      QIN(9,I)=0.0
      IF(EN.LE.EIN(9)) GO TO 900
      DO 810 J=2,NDISS
      IF(EN.LE.XDISS(J)) GO TO 820
  810 CONTINUE
      J=NDISS
  820 A=(YDISS(J)-YDISS(J-1))/(XDISS(J)-XDISS(J-1))
      B=(XDISS(J-1)*YDISS(J)-XDISS(J)*YDISS(J-1))/(XDISS(J-1)-XDISS(J))
      QIN(9,I)=(A*EN+B)*1.D-16
  900 CONTINUE
C
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+QIN(1,I)+QIN(2,I)+QIN(3,I)+QIN(4,I)+
     /QIN(5,I)+QIN(6,I)+QIN(7,I)+QIN(8,I)+QIN(9,I)
 9000 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(9)) NIN=8
      IF(EFINAL.LE.EIN(8)) NIN=7
      IF(EFINAL.LE.EIN(7)) NIN=6
      IF(EFINAL.LE.EIN(6)) NIN=5
      IF(EFINAL.LE.EIN(5)) NIN=4
      IF(EFINAL.LE.EIN(4)) NIN=3
      IF(EFINAL.LE.EIN(3)) NIN=2
      IF(EFINAL.LE.EIN(2)) NIN=1
      IF(EFINAL.LE.EIN(1)) NIN=0
      RETURN
      END
      SUBROUTINE GAS30(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
C ----------------------------------------------------------------
C   SF6 FILE FROM ITOH ET AL J.PHYS.D.  26 (1993) 1975-1979
C ---------------------------------------------------------------
      NAME='SF6 ITOH ET AL '
C
      NIN=2
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      E(1)=0.0
      E(2)=2.0D0*EMASS/(146.05642*AMU)
      E(3)=15.8
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=15.8
      EIN(1)=0.095
      EIN(2)=9.80
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       SF6            '
      SCRPT(3)=' IONISATION    ELOSS= 15.8    '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' VIB           ELOSS=  0.095  '
      SCRPT(8)=' EXC           ELOSS=  9.80   '
      EN=-ESTEP/2.0
      DO 9000 I=1,NSTEP
      EN=EN+ESTEP
      IF(EN.EQ.0.0D0) THEN
       BTA=-5.0
       GO TO 3
      ENDIF
      BTA=DLOG10(EN)
   3  BTA2=BTA*BTA
      BTA3=BTA2*BTA
      EN2=EN*EN
      EN3=EN2*EN
      Q(2,I)=0.0D0
      IF(EN.EQ.0.0) THEN
       Q(2,I)=20.0
       GO TO 10
      ENDIF
      IF(EN.LE.0.255) THEN
       Q(2,I)=10.0**(1.055-1.033*BTA-0.1632*BTA2+0.0126*BTA3)
       GO TO 10
      ENDIF
      IF(EN.LE.0.92) THEN
       Q(2,I)=10.0**(1.041-0.189*BTA+2.091*BTA2+1.348*BTA3)
       GO TO 10
      ENDIF
      IF(EN.LE.1.90) THEN
       Q(2,I)=10.0**(1.037-0.3741*BTA+1.193*BTA2+0.5179*BTA3)
       GO TO 10
      ENDIF
      IF(EN.LE.6.20) THEN
       Q(2,I)=1.917+6.463*EN-1.027*EN2+0.05562*EN3
       GO TO 10
      ENDIF
      IF(EN.LE.28.2) THEN
       Q(2,I)=12.53+0.7762*EN-0.0457*EN2+0.0006344*EN3
       GO TO 10
      ENDIF
      IF(EN.LE.51.0) THEN
       Q(2,I)=20.44-0.3373*EN+0.002436*EN2-0.000006189*EN3
       GO TO 10
      ENDIF
      IF(EN.LE.80.0) THEN
       Q(2,I)=29.09-0.7115*EN+0.007397*EN2-0.00002485*EN3
       GO TO 10
      ENDIF
      IF(EN.LE.188.0) THEN
       Q(2,I)=10.51*DEXP(-0.00558*EN)
       GO TO 10
      ENDIF
      IF(EN.LE.364.0) THEN
       Q(2,I)=1289.0*EN**(-1.118)
       GO TO 10
      ENDIF
      Q(2,I)=4.881*DEXP(-0.002807*EN)
  10  Q(2,I)=Q(2,I)*1.D-16
      Q(3,I)=0.0D0
      IF(EN.LE.15.8) GO TO 20
      IF(EN.LE.38.9) THEN
       Q(3,I)=4.715-0.693*EN+0.0306*EN2-0.0003508*EN3
       GO TO 20
      ENDIF
      IF(EN.LE.122.0) THEN
       Q(3,I)=6.986-DEXP(2.07-0.0145*EN-0.00014*EN2)
       GO TO 20
      ENDIF
      IF(EN.LE.201.0) THEN
       Q(3,I)=4.364+0.0323*EN-0.00009987*EN2
       GO TO 20
      ENDIF
      Q(3,I)=DEXP(2.151-0.00115*EN)
  20  Q(3,I)=Q(3,I)*1.D-16
      Q(4,I)=0.0D0
      QA1=0.0D0
      IF(EN.EQ.0.0) THEN
       QA1=4000.0
       GO TO 30
      ENDIF
      IF(EN.GT.25.0) THEN
       QA5=0.0D0
       GO TO 70
      ENDIF
      IF(EN.LE.0.14) THEN
       QA1=436.0*(0.0617*DSQRT(1.0/EN)*DEXP(-1.0*(EN/0.0045)**2)+
     /DEXP(-EN/0.0559))
       GO TO 30
      ENDIF
      IF(EN.LE.0.9746) THEN
       QA1=DEXP(6.477-20.91*EN+1.183*EN2)
      ENDIF
  30  Q(4,I)=QA1*1.D-16
      QA2=0.0D0
      IF(EN.LE.0.312) THEN
       QA2=2.85*EN+5.419*EN2+30.49*EN3
       GO TO 40
      ENDIF
      IF(EN.LE.0.425) THEN
       QA2=468.0*EN3-624.3*EN2+268.1*EN-34.75
       GO TO 40
      ENDIF
      IF(EN.LE.1.05) THEN
       QA2=8.751-22.15*EN+19.08*EN2-5.592*EN3
       GO TO 40
      ENDIF
      QA2=DEXP(8.054-10.42*EN)
  40  Q(4,I)=Q(4,I)+QA2*1.D-16
      QA3=0.0D0
      IF(EN.LT.2.19) GO TO 50
      IF(EN.LE.2.90) THEN
       QA3=-0.1069+0.08552*EN-0.01676*EN2
       GO TO 50
      ENDIF
      IF(EN.LT.3.32) GO TO 50
      IF(EN.LE.4.27) THEN
       QA3=-0.2016+0.2133*EN-0.07421*EN2+0.00851*EN3
       GO TO 50
      ENDIF
      IF(EN.LE.5.59) THEN
       QA3=0.7777-0.6913*EN+0.1856*EN2-0.0153*EN3
       GO TO 50
      ENDIF
      IF(EN.LE.7.95) THEN
       QA3=0.9885-0.3216*EN+0.03252*EN2-0.0009533*EN3
       GO TO 50
      ENDIF
      IF(EN.LE.9.73) THEN
       QA3=-0.3504+0.08087*EN-0.0045*EN2
       GO TO 50
      ENDIF
      IF(EN.LE.11.1) THEN
       QA3=1.397-0.2724*EN+0.01335*EN2
       GO TO 50
      ENDIF
      IF(EN.LE.11.8) THEN
       QA3=-3.30+0.5801*EN-0.02533*EN2
       GO TO 50
      ENDIF
      QA3=DEXP(10.91-1.264*EN)
  50  Q(4,I)=Q(4,I)+QA3*1.D-16
      QA4=0.0D0
      IF(EN.LT.3.92) GO TO 60
      IF(EN.LE.8.25) THEN
       QA4=DEXP(-466.8+296.4*EN-71.09*EN2+7.573*EN3-0.3033*EN*EN3)
      ENDIF
  60  Q(4,I)=Q(4,I)+QA4*1.D-16
      QA5=0.0D0
      IF(EN.LE.1.50) GO TO 70
      IF(EN.LE.3.27) THEN
       QA5=DEXP(2.932*EN3-22.91*EN2+56.52*EN-53.37)
       GO TO 70
      ENDIF
      IF(EN.LE.7.45) THEN
       QA5=DEXP(0.5554*EN3-9.613*EN2+52.832*EN-100.3)
       GO TO 70
      ENDIF
      IF(EN.LE.10.6) THEN
       QA5=DEXP(0.1216*EN2-1.035*EN-9.723)
       GO TO 70
      ENDIF
      IF(EN.LE.11.7) THEN
       QA5=DEXP(-1.114*EN2+25.12*EN-148.0)-0.00012
       GO TO 70
      ENDIF
      QA5=DEXP(-0.9386*EN2+21.0*EN-123.9)
  70  Q(4,I)=Q(4,I)+QA5*1.D-16
      Q(5,I)=0.0D0
      Q(6,I)=0.0D0
C VIBRATIONAL SUM
      QIN(1,I)=0.0D0
      IF(EN.LE.EIN(1).OR.EN.GT.50.0) GO TO 400
      IF(EN.LE.0.247) THEN
       QIN(1,I)=(14.06+4.425/EN-0.5472/EN2)*1.D-16
       GO TO 400
      ENDIF
      IF(EN.LE.0.505) THEN
       QIN(1,I)=(DEXP(11.19*EN3-13.91*EN2+4.663*EN+2.664))*1.D-16
       GO TO 400
      ENDIF
      IF(EN.LE.1.03) THEN
       QIN(1,I)=(DEXP(0.3166*EN2-1.341*EN+3.509))*1.D-16
       GO TO 400
      ENDIF
      QIN(1,I)=(22.0*10.0**(-0.2645*EN))*1.D-16
C EXCITATION
  400 QIN(2,I)=0.0D0
      IF(EN.LE.EIN(2)) GO TO 500
      IF(EN.LE.26.66) THEN
       QIN(2,I)=(4.811*BTA-4.769)*1.D-16
       GO TO 500
      ENDIF
      IF(EN.LE.29.3) THEN
       QIN(2,I)=(3.643-0.204*EN+0.005477*EN2)*1.D-16
       GO TO 500
      ENDIF
      IF(EN.LE.56.6) THEN
       QIN(2,I)=(0.01382*EN**(1.522))*1.D-16
       GO TO 500
      ENDIF
      IF(EN.LE.65.2) THEN
       QIN(2,I)=(-25.26+0.9902*EN-0.007593*EN2)*1.D-16
       GO TO 500
      ENDIF
      IF(EN.LE.100.0) THEN
       QIN(2,I)=(2.197+0.1479*EN-0.001123*EN2)*1.D-16
       GO TO 500
      ENDIF
      IF(EN.LE.250.0) THEN
       QIN(2,I)=(17.11*DEXP(-0.0109*EN))*1.D-16
       GO TO 500
      ENDIF
      QIN(2,I)=(6566000.0*EN**(-2.821))*1.D-16
  500 CONTINUE
      IF(QIN(2,I).LE.0.0) QIN(2,I)=0.0
C
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+QIN(1,I)+QIN(2,I)
 9000 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(2)) NIN=1
      IF(EFINAL.LE.EIN(1)) NIN=0
      RETURN
      END
      SUBROUTINE GAS31(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      DIMENSION XEN(24),YXSEC(24),XVIBH(19),YVIBH(19),XION(47),YION(47),
     /XATT(30),YATT(30),XEXC1(18),YEXC1(18)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      DATA XEN/0.00,.001,0.01,0.10,0.40,1.00,1.50,2.00,2.75,
     /3.50,5.00,7.50,10.0,12.0,15.0,20.0,30.0,60.0,100.,
     /200.0,500.0,1000.0,10000.,100000./
      DATA YXSEC/2000.,2000.,1700.,170.,40.0,13.0,6.00,2.50,2.30,
     /2.50,6.00,8.50,10.0,10.0,9.00,8.40,5.73,2.90,1.55,
     /0.70,0.15,.075,.007,.0007/
      DATA XVIBH/0.00,2.00,3.00,4.00,5.00,6.00,7.00,7.30,7.60,8.00,
     /9.00,10.0,12.0,15.0,20.0,100.,1000.,10000.,100000./
      DATA YVIBH/0.00,0.00,0.01,0.06,0.16,0.39,0.59,0.60,0.59,0.42,
     /0.31,0.16,0.06,0.01,.005,.001,.0001,.00001,.000001/
      DATA XION/10.16,11.6,12.5,14.0,16.0,18.0,20.0,25.0,30.0,35.0,
     /40.0,45.0,50.0,55.0,60.0,65.0,70.0,80.0,90.0,100.,
     /120.,140.,160.,180.,200.,240.,280.,320.,360.,400.,
     /440.,500.,550.,600.,650.,700.,750.,800.,900.,1000.,
     /2000.,4000.,6000.,10000.,20000.,40000.,100000./
      DATA YION/0.00,.067,0.16,0.29,0.46,0.63,0.80,1.25,1.65,2.02,
     /2.38,2.62,2.78,2.87,2.94,2.99,3.02,3.05,3.04,3.01,
     /2.91,2.80,2.70,2.60,2.50,2.30,2.13,1.98,1.85,1.74,
     /1.64,1.50,1.42,1.34,1.27,1.21,1.16,1.12,1.05,0.99,
     /0.53,0.30,0.21,0.14,.074,.040,.017/
      DATA XATT/4.60,4.75,5.00,5.25,5.50,5.65,5.75,6.00,6.25,6.50,
     /6.75,7.00,7.50,8.00,8.50,9.00,9.50,10.0,10.5,11.0,
     /11.5,12.0,12.5,13.0,14.0,16.0,100.,1000.,10000.,100000./
      DATA YATT/0.00,0.15,0.63,2.04,3.33,3.66,3.60,2.82,1.65,0.84,
     /0.36,0.12,.048,.048,.048,.081,.276,0.48,0.54,0.48,
     /0.36,.213,.114,0.06,0.03,.003,.0003,.00003,.000003,.0000003/
      DATA XEXC1/7.00,7.50,8.00,9.00,10.0,12.0,15.0,20.0,30.0,40.0,
     /50.0,80.0,100.0,200.,500.0,1000.,10000.,100000./
      DATA YEXC1/0.00,0.24,0.48,0.96,1.32,1.80,2.28,2.85,3.10,3.25,
     /3.35,3.20,3.00,2.40,1.35,0.72,.072,.0072/
C
      NAME='NH3        1999'
C --------------------------------------------------------------------
C  EXPERIMENTAL DATA NOT ACCURATE IN AMMONIA GAS. LACK OF GOOD QUALITY
C  TRANSVERSE DIFFUSION MEASUREMENTS.   ELECTRON SCATTERING DATA IS
C  USED IN THE ANALYSIS AND REPRODUCES DRIFT VELOCITY AND DIFFUSION
C  COEFFICIENTS TO AN  ACCURACY OF  5%.  ATTACHMENT X-SEC FROM SHARP ET
C   AL.
C ---------------------------------------------------------------------
      NIN=8
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      NDATA=24
      NVIBH=19
      NION=47
      NATT=30
      NEXC1=18
      E(1)=0.0
      E(2)=2.0*EMASS/(17.03056*AMU)
      E(3)=10.16
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=10.8
      EIN(1)=-0.025
      EIN(2)=0.025
      EIN(3)=-0.1178
      EIN(4)=0.1178
      EIN(5)=0.2013
      EIN(6)=0.4137
      EIN(7)=0.8274
      EIN(8)=7.00
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       NH3            '
      SCRPT(3)=' IONISATION    ELOSS= 10.16   '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' ROT           ELOSS= -0.025  '
      SCRPT(8)=' ROT           ELOSS=  0.025  '
      SCRPT(9)=' VIB V2        ELOSS= -0.1178 '
      SCRPT(10)=' VIB V2        ELOSS=  0.1178 '
      SCRPT(11)=' VIB V4        ELOSS=  0.2013 '
      SCRPT(12)=' VIB V1 + V3   ELOSS=  0.4137 '
      SCRPT(13)=' VIB  HAR      ELOSS=  0.8274 '
      SCRPT(14)=' EXC           ELOSS=  7.00   '
      APOP1=DEXP(EIN(1)/AKT)
      APOP2=DEXP(EIN(3)/AKT)
      EN=-ESTEP/2.0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      Q(2,I)=0.0
      IF(EN.LE.XEN(2)) THEN
       Q(2,I)=YXSEC(2)*1.D-16
       GO TO 30
      ENDIF
      DO 10 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 20
   10 CONTINUE
      J=NDATA
C USE LOG INTERPOLATION BECAUSE OF RAPID CHANGE IN X-SEC
   20 YXJ=DLOG(YXSEC(J))
      YXJ1=DLOG(YXSEC(J-1))
      XNJ=DLOG(XEN(J))
      XNJ1=DLOG(XEN(J-1))
      A=(YXJ-YXJ1)/(XNJ-XNJ1)
      B=(XNJ1*YXJ-XNJ*YXJ1)/(XNJ1-XNJ)
      Q(2,I)=DEXP(A*DLOG(EN)+B)*1.D-16
C
   30 Q(3,I)=0.0
      IF(EN.LT.E(3)) GO TO 40
      DO 31 J=2,NION
      IF(EN.LE.XION(J)) GO TO 32
   31 CONTINUE
      J=NION
   32 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
   40 CONTINUE
C
      Q(4,I)=0.0
      IF(EN.LT.XATT(1)) GO TO 50
      DO 41 J=2,NATT
      IF(EN.LE.XATT(J)) GO TO 42
   41 CONTINUE
      J=NATT
   42 A=(YATT(J)-YATT(J-1))/(XATT(J)-XATT(J-1))
      B=(XATT(J-1)*YATT(J)-XATT(J)*YATT(J-1))/(XATT(J-1)-XATT(J))
      Q(4,I)=(A*EN+B)*1.D-18
   50 CONTINUE
      Q(5,I)=0.0
      Q(6,I)=0.0
C
C  SUPERELASTIC  ROT1
C
      QIN(1,I)=0.0
      IF(EN.LE.0.0) GO TO 150
      EFAC=DSQRT(1.0-(EIN(1)/EN))
      QIN(1,I)=0.5*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      QIN(1,I)=QIN(1,I)*APOP1/(1.0+APOP1)*1.D-16
C  ROT1
  150 QIN(2,I)=0.0
      IF(EN.LE.EIN(2)) GO TO 200
      EFAC=DSQRT(1.0-(EIN(2)/EN))
      QIN(2,I)=0.5*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      QIN(2,I)=QIN(2,I)/(1.0+APOP1)*1.D-16
C
C  SUPERELASTIC V2
C
  200 QIN(3,I)=0.0
      IF(EN.LE.0.0) GO TO 250
      EFAC=DSQRT(1.0-(EIN(3)/EN))
      QIN(3,I)=0.30*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      DO 220 J=2,NVIBH
      IF((EN+EIN(4)).LE.XVIBH(J)) GO TO 230
  220 CONTINUE
      J=NVIBH
  230 A=(YVIBH(J)-YVIBH(J-1))/(XVIBH(J)-XVIBH(J-1))
      B=(XVIBH(J-1)*YVIBH(J)-XVIBH(J)*YVIBH(J-1))/(XVIBH(J-1)-XVIBH(J))
      QIN(3,I)=QIN(3,I)+0.25*(EN+EIN(4))*(A*(EN+EIN(4))+B)/EN
      QIN(3,I)=QIN(3,I)*APOP2/(1.0+APOP2)*1.D-16
C    V2
  250 QIN(4,I)=0.0
      IF(EN.LE.EIN(4)) GO TO 300
      EFAC=DSQRT(1.0-(EIN(4)/EN))
      QIN(4,I)=0.30*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      DO 270 J=2,NVIBH
      IF(EN.LE.XVIBH(J)) GO TO 280
  270 CONTINUE
      J=NVIBH
  280 A=(YVIBH(J)-YVIBH(J-1))/(XVIBH(J)-XVIBH(J-1))
      B=(XVIBH(J-1)*YVIBH(J)-XVIBH(J)*YVIBH(J-1))/(XVIBH(J-1)-XVIBH(J))
      QIN(4,I)=QIN(4,I)+0.25*(A*EN+B)
      QIN(4,I)=QIN(4,I)/(1.0+APOP2)*1.D-16
C  V4
  300 QIN(5,I)=0.0
      IF(EN.LE.EIN(5)) GO TO 400
      EFAC=DSQRT(1.0-(EIN(5)/EN))
      QIN(5,I)=0.28*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      DO 310 J=2,NVIBH
      IF(EN.LE.XVIBH(J)) GO TO 320
  310 CONTINUE
      J=NVIBH
  320 A=(YVIBH(J)-YVIBH(J-1))/(XVIBH(J)-XVIBH(J-1))
      B=(XVIBH(J-1)*YVIBH(J)-XVIBH(J)*YVIBH(J-1))/(XVIBH(J-1)-XVIBH(J))
      QIN(5,I)=(QIN(5,I)+0.52*(A*EN+B))*1.D-16
  400 CONTINUE
C  V1+V3
      QIN(6,I)=0.0
      IF(EN.LE.EIN(6)) GO TO 500
      EFAC=DSQRT(1.0-(EIN(6)/EN))
      QIN(6,I)=0.28*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      DO 410 J=2,NVIBH
      IF(EN.LE.XVIBH(J)) GO TO 420
  410 CONTINUE
      J=NVIBH
  420 A=(YVIBH(J)-YVIBH(J-1))/(XVIBH(J)-XVIBH(J-1))
      B=(XVIBH(J-1)*YVIBH(J)-XVIBH(J)*YVIBH(J-1))/(XVIBH(J-1)-XVIBH(J))
      QIN(6,I)=(QIN(6,I)+1.10*(A*EN+B))*1.D-16
  500 CONTINUE
C HARMONICS (2V1,2V1+V4,3V1, ETC )
      QIN(7,I)=0.0
      IF(EN.LE.EIN(7)) GO TO 600
      DO 510 J=2,NVIBH
      IF(EN.LE.XVIBH(J)) GO TO 520
  510 CONTINUE
      J=NVIBH
  520 A=(YVIBH(J)-YVIBH(J-1))/(XVIBH(J)-XVIBH(J-1))
      B=(XVIBH(J-1)*YVIBH(J)-XVIBH(J)*YVIBH(J-1))/(XVIBH(J-1)-XVIBH(J))
      QIN(7,I)=0.165*(A*EN+B)*1.D-16
  600 CONTINUE
C
      QIN(8,I)=0.0
      IF(EN.LE.EIN(8)) GO TO 700
      DO 610 J=2,NEXC1
      IF(EN.LE.XEXC1(J)) GO TO 620
  610 CONTINUE
      J=NEXC1
  620 A=(YEXC1(J)-YEXC1(J-1))/(XEXC1(J)-XEXC1(J-1))
      B=(XEXC1(J-1)*YEXC1(J)-XEXC1(J)*YEXC1(J-1))/(XEXC1(J-1)-XEXC1(J))
      QIN(8,I)=(A*EN+B)*1.D-16
  700 CONTINUE
  800 CONTINUE
C---------------------------------------------------------------------
C    SUBTRACT ROTATIONAL XSEC TO GET CORRECT ELASTIC XSEC.
      Q(2,I)=Q(2,I)-QIN(1,I)-QIN(2,I)
C     IF(Q(2,I).LE.0.0) WRITE(6,966) Q(2,I),I
C 966 FORMAT(3X,' ERROR IN GAS 27 Q(2,I)=',E12.3,'  I=',I5)
C  TOTAL
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+QIN(1,I)+QIN(2,I)+
     /QIN(3,I)+QIN(4,I)+QIN(5,I)+QIN(6,I)+QIN(7,I)+QIN(8,I)
  900 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(8)) NIN=7
      IF(EFINAL.LE.EIN(7)) NIN=6
      IF(EFINAL.LE.EIN(6)) NIN=5
      IF(EFINAL.LE.EIN(5)) NIN=4
      IF(EFINAL.LE.EIN(4)) NIN=3
      IF(EFINAL.LE.EIN(3)) NIN=2
      IF(EFINAL.LE.EIN(2)) NIN=1
      IF(EFINAL.LE.EIN(1)) NIN=0
C
      RETURN
      END
      SUBROUTINE GAS32(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      DIMENSION XEN(49),YXSEC(49),XVIB1(31),YVIB1(31),XVIB2(31),
     /YVIB2(31),XVIB3(18),YVIB3(18),XVIB4(31),YVIB4(31),XVIB5(21),
     /YVIB5(21),XEXC1(17),YEXC1(17),XEXC2(23),YEXC2(23),XEXC3(20),
     /YEXC3(20),XION(46),YION(46),XATT(16),YATT(16)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      DATA XEN/0.00,0.01,.014,0.02,0.03,0.04,0.05,0.06,0.07,0.08,
     /0.09,0.10,0.11,0.12,0.14,0.16,0.18,0.20,0.25,0.30,
     /0.40,0.50,0.60,0.80,1.00,1.40,2.00,3.00,4.00,5.00,
     /6.00,7.50,8.50,10.0,15.0,20.0,30.0,40.0,70.0,
     /100.,140.,200.,250.,300.,500.,1000.,1500.,10000.,100000./
      DATA YXSEC/54.0,51.0,50.0,49.0,45.0,42.0,39.0,34.0,28.5,22.0,
     /15.5,9.40,6.80,4.80,4.40,4.80,6.10,8.80,15.5,19.5,
     /22.0,22.5,23.0,23.5,24.0,24.0,24.5,24.0,25.0,27.0,
     /28.0,30.0,27.0,22.0,15.4,12.0,8.31,6.28,3.69,
     /2.66,1.57,0.97,0.70,0.57,0.32,.143,.092,.011,.001/
      DATA XVIB1/.114,1.00,1.20,1.40,1.60,1.80,2.00,2.20,2.40,2.60,
     /2.80,3.00,3.20,4.00,5.00,6.00,7.00,8.00,9.00,10.0,
     /11.0,15.0,20.0,25.0,30.0,50.0,100.,200.,1000.,10000.,
     /100000./
      DATA YVIB1/0.0,.001,0.04,0.07,0.14,0.15,0.14,0.10,0.08,0.08,
     /0.08,0.08,0.08,0.20,0.28,0.36,0.48,0.64,0.70,0.64,
     /0.59,0.30,0.22,0.17,0.11,0.06,.022,.008,.0008,.00003,
     /.000003/
      DATA XVIB2/.161,1.00,1.40,1.60,1.80,2.00,2.20,2.40,2.60,2.80,
     /3.00,3.20,3.40,4.00,5.00,6.00,7.00,8.00,9.00,10.0,
     /11.0,15.0,20.0,25.0,30.0,50.0,100.,200.,1000.,10000.,
     /100000./
      DATA YVIB2/0.00,.001,0.22,0.75,3.77,5.28,4.65,3.26,2.16,1.21,
     /0.77,0.54,0.38,0.42,0.60,0.80,1.11,1.30,1.35,1.20,
     /1.00,0.56,0.44,0.33,0.24,0.14,0.06,.024,.003,.0001,
     /.00001/
      DATA XVIB3/.322,1.00,1.40,1.60,1.80,2.00,2.20,2.40,2.60,2.80,
     /3.00,3.20,3.40,10.0,100.0,1000.,10000.,100000./
      DATA YVIB3/0.00,.001,0.15,0.17,0.82,1.50,1.36,0.90,0.52,0.30,
     /0.15,0.08,0.04,.002,.0002,.00002,.000002,.0000002/
      DATA XVIB4/.360,1.00,1.40,1.60,1.80,2.00,2.20,2.40,2.60,2.80,
     /3.00,3.20,3.40,4.00,5.00,6.00,7.00,8.00,9.00,10.0,
     /11.0,15.0,20.0,25.0,30.0,50.0,100.,200.,1000.,10000.,
     /100000./
      DATA YVIB4/0.00,.001,.052,.090,0.54,0.86,0.80,0.64,0.46,0.45,
     /0.45,0.45,0.50,0.60,1.00,1.40,1.80,1.85,1.70,1.50,
     /1.20,0.65,0.48,0.42,0.28,0.16,0.06,0.03,.004,.0001,
     /.00001/
      DATA XVIB5/0.72,1.00,3.00,4.00,5.00,6.00,7.00,8.00,9.00,10.0,
     /11.0,15.0,20.0,25.0,30.0,50.0,100.,200.,1000.,10000.,
     /100000./
      DATA YVIB5/0.00,.0001,.008,0.05,0.10,0.16,0.20,0.21,0.18,0.15,
     /0.12,0.06,0.05,0.04,0.03,.015,.007,.003,.0004,.00001,
     /.000001/
      DATA XEXC1/4.18,4.50,5.00,6.00,7.00,8.00,9.00,10.0,12.0,14.0,
     /16.0,20.0,30.0,100.,1000.,10000.,100000./
      DATA YEXC1/0.00,0.11,0.21,0.42,0.84,0.80,0.67,0.61,0.45,0.34,
     /0.27,0.25,0.20,0.06,.006,.0006,.00006/
      DATA XEXC2/7.30,7.50,8.00,8.50,9.00,10.0,11.0,14.0,20.0,25.0,
     /30.0,40.0,60.0,80.0,100.,150.,200.,400.,1000.,2000.,
     /10000.,20000.,100000./
      DATA YEXC2/0.00,.026,0.21,0.36,0.65,1.11,1.70,2.38,2.74,2.81,
     /2.86,2.81,2.69,2.55,2.38,2.14,1.87,1.46,0.82,0.41,
     /0.09,.044,.009/
      DATA XEXC3/9.00,10.0,11.0,14.0,16.0,20.0,25.0,30.0,40.0,60.0,
     /80.0,100.,150.,200.,400.,1000.,2000.,10000.,20000.,100000./
      DATA YEXC3/0.00,0.43,1.11,2.04,2.30,2.64,2.81,2.86,2.81,2.69,
     /2.55,2.38,2.14,1.87,1.46,0.82,0.41,0.09,.044,.009/
      DATA XION/9.73,11.0,12.0,13.0,14.0,16.5,19.0,24.0,30.0,35.0,
     /40.0,45.0,50.0,60.0,70.0,80.0,90.0,100.,125.,150.,
     /175.,200.,250.,300.,350.,400.,450.,500.,600.,700.,
     /800.,900.,1000.,1250.,1500.,1750.,2000.,2500.,3000.,5000.,
     /7000.,10000.,15000.,30000.,60000.,100000./
      DATA YION/0.00,0.19,0.43,0.70,1.05,2.12,3.06,4.81,5.97,6.80,
     /7.38,7.88,8.51,9.04,9.32,9.42,9.42,9.42,9.14,8.64,
     /8.16,7.71,7.20,6.31,5.77,5.34,4.86,4.55,4.00,3.68,
     /3.39,3.02,2.82,2.44,2.10,1.90,1.74,1.50,1.28,0.85,
     /0.64,0.47,0.33,0.18,.097,.061/
      DATA XATT/6.85,7.00,7.20,7.50,8.00,8.50,9.00,9.50,10.0,10.5,
     /11.0,11.5,12.0,12.5,13.0,13.2/
      DATA YATT/0.00,0.67,1.10,1.65,2.80,4.40,6.60,10.3,14.7,12.3,
     /9.70,6.20,3.50,1.30,0.50,0.00/
      NAME='PROPENE C3H6 99'
C ---------------------------------------------------------------------
C  1999 INCLUDED VIBRATIONAL RESONACE SHAPE FROM ALLEN  AND ALSO USED
C   SIMILAR RESONANCE SHAPE IN ETHENE FROM WALKER ET AL .:
C   REF J.CHEM.PHYS. 69(1978) 5532  (ETHENE RESONANCE MOVED TO 2.1 EV)
C   FIT TO  SCHMIDTS ,GEE+FREEMAN AND BOWMAN+GORDON DATA IN PURE PROPENE
C   NO GOOD DATA AT HIGH FIELD THEREFORE X-SECTIONS ABOVE 3 EV ARE
C   DERIVED FROM SYSTEMATICS IN THE HYDROCARBONS.
C ---------------------------------------------------------------------
      NIN=12
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      NDATA=49
      NVIB1=31
      NVIB2=31
      NVIB3=18
      NVIB4=31
      NVIB5=21
      NEXC1=17
      NEXC2=23
      NEXC3=20
      NION=46
      NATT=16
      E(1)=0.0
      E(2)=2.0*EMASS/(42.08064*AMU)
      E(3)=9.73
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=9.73
      EIN(1)=-0.0716
      EIN(2)=0.0716
      EIN(3)=-0.114
      EIN(4)=0.114
      EIN(5)=-0.161
      EIN(6)=0.161
      EIN(7)=0.322
      EIN(8)=0.360
      EIN(9)=0.720
      EIN(10)=4.18
      EIN(11)=7.30
      EIN(12)=9.00
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       PROPENE        '
      SCRPT(3)=' IONISATION    ELOSS=  9.73   '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' VIB V20       ELOSS= -0.0716 '
      SCRPT(8)=' VIB V20       ELOSS=  0.0716 '
      SCRPT(9)=' VIB V13       ELOSS= -0.114  '
      SCRPT(10)=' VIB V13       ELOSS=  0.114  '
      SCRPT(11)=' VIB           ELOSS= -0.161  '
      SCRPT(12)=' VIB           ELOSS=  0.161  '
      SCRPT(13)=' VIB HAR       ELOSS=  0.322  '
      SCRPT(14)=' VIB           ELOSS=  0.360  '
      SCRPT(15)=' VIB HAR       ELOSS=  0.720  '
      SCRPT(16)=' EXC           ELOSS=  4.18   '
      SCRPT(17)=' EXC           ELOSS=  7.30   '
      SCRPT(18)=' EXC           ELOSS=  9.00   '
      AMP=0.070
      AMP1=0.15
      AMP2=0.15
      AMP3=0.198
      APOPL=DEXP(EIN(1)/AKT)
      APOP=DEXP(EIN(3)/AKT)
      APOPH=DEXP(EIN(5)/AKT)
      EN=-ESTEP/2.0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      DO 10 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 20
   10 CONTINUE
      J=NDATA
   20 A=(YXSEC(J)-YXSEC(J-1))/(XEN(J)-XEN(J-1))
      B=(XEN(J-1)*YXSEC(J)-XEN(J)*YXSEC(J-1))/(XEN(J-1)-XEN(J))
      Q(2,I)=(A*EN+B)*1.0D-16
C
      Q(3,I)=0.0
      IF(EN.LT.E(3)) GO TO 200
      DO 110 J=2,NION
      IF(EN.LE.XION(J)) GO TO 120
  110 CONTINUE
      J=NION
  120 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
C
  200 Q(4,I)=0.0
      IF(EN.LT.XATT(1)) GO TO 300
      IF(EN.GT.XATT(NATT)) GO TO 300
      DO 210 J=2,NATT
      IF(EN.LE.XATT(J)) GO TO 220
  210 CONTINUE
      J=NATT
  220 A=(YATT(J)-YATT(J-1))/(XATT(J)-XATT(J-1))
      B=(XATT(J-1)*YATT(J)-XATT(J)*YATT(J-1))/(XATT(J-1)-XATT(J))
      Q(4,I)=(A*EN+B)*1.D-21
C
  300 Q(5,I)=0.0
      Q(6,I)=0.0
C  SUPERELASTIC
      QIN(1,I)=0.0
      IF(EN.LE.0.0) GO TO 3050
      EFAC=DSQRT(1.0-(EIN(1)/EN))
      QIN(1,I)=AMP*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      QIN(1,I)=QIN(1,I)*APOPL/(1.0+APOPL)*1.D-16
 3050 CONTINUE
      QIN(2,I)=0.0
      IF(EN.LE.EIN(2)) GO TO 3060
      EFAC=DSQRT(1.0-(EIN(2)/EN))
      QIN(2,I)=AMP*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      QIN(2,I)=QIN(2,I)/(1.0+APOPL)*1.D-16
 3060 CONTINUE
C
C V7 SUPERELASTIC
      QIN(3,I)=0.0
      IF(EN.LE.0.0) GO TO 350
      EFAC=DSQRT(1.0-(EIN(3)/EN))
      QIN(3,I)=AMP1*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      DO 310 J=2,NVIB1
      IF((EN+EIN(4)).LE.XVIB1(J)) GO TO 320
  310 CONTINUE
      J=NVIB1
  320 A=(YVIB1(J)-YVIB1(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB1(J)-XVIB1(J)*YVIB1(J-1))/(XVIB1(J-1)-XVIB1(J))
      QIN(3,I)=QIN(3,I)+(EN+EIN(4))*(A*(EN+EIN(4))+B)/EN
      QIN(3,I)=QIN(3,I)*APOP/(1.0+APOP)*1.D-16
  350 CONTINUE
C
C  V7
      QIN(4,I)=0.0
      IF(EN.LE.EIN(4)) GO TO 400
      EFAC=DSQRT(1.0-(EIN(4)/EN))
      QIN(4,I)=AMP1*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      DO 360 J=2,NVIB1
      IF(EN.LE.XVIB1(J)) GO TO 370
  360 CONTINUE
      J=NVIB1
  370 A=(YVIB1(J)-YVIB1(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB1(J)-XVIB1(J)*YVIB1(J-1))/(XVIB1(J-1)-XVIB1(J))
      QIN(4,I)=QIN(4,I)+(A*EN+B)
      QIN(4,I)=QIN(4,I)/(1.0+APOP)*1.D-16
  400 CONTINUE
C
C SUPERELASTIC
      QIN(5,I)=0.0
      IF(EN.LE.0.0) GO TO 4150
      EFAC=DSQRT(1.0-(EIN(5)/EN))
      QIN(5,I)=AMP2*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      DO 4110 J=2,NVIB2
      IF((EN+EIN(6)).LE.XVIB2(J)) GO TO 4120
 4110 CONTINUE
      J=NVIB2
 4120 A=(YVIB2(J)-YVIB2(J-1))/(XVIB2(J)-XVIB2(J-1))
      B=(XVIB2(J-1)*YVIB2(J)-XVIB2(J)*YVIB2(J-1))/(XVIB2(J-1)-XVIB2(J))
      QIN(5,I)=QIN(5,I)+(EN+EIN(6))*(A*(EN+EIN(6))+B)/EN
      QIN(5,I)=QIN(5,I)*APOPH/(1.0+APOPH)*1.D-16
 4150 CONTINUE
C  V2 + V3 (SUM OF VIBRATIONS AT 166 AND 201 MV)
      QIN(6,I)=0.0
      IF(EN.LE.EIN(6)) GO TO 450
      EFAC=DSQRT(1.0-(EIN(6)/EN))
      QIN(6,I)=AMP2*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      DO 410 J=2,NVIB2
      IF(EN.LE.XVIB2(J)) GO TO 420
  410 CONTINUE
      J=NVIB2
  420 A=(YVIB2(J)-YVIB2(J-1))/(XVIB2(J)-XVIB2(J-1))
      B=(XVIB2(J-1)*YVIB2(J)-XVIB2(J)*YVIB2(J-1))/(XVIB2(J-1)-XVIB2(J))
      QIN(6,I)=QIN(6,I)+(A*EN+B)
      QIN(6,I)=QIN(6,I)/(1.0+APOPH)*1.D-16
  450 CONTINUE
C
C  2V3+2V2 (HARMONICS)
      QIN(7,I)=0.0
      IF(EN.LE.EIN(7)) GO TO 500
      DO 460 J=2,NVIB3
      IF(EN.LE.XVIB3(J)) GO TO 470
  460 CONTINUE
      J=NVIB3
  470 A=(YVIB3(J)-YVIB3(J-1))/(XVIB3(J)-XVIB3(J-1))
      B=(XVIB3(J-1)*YVIB3(J)-XVIB3(J)*YVIB3(J-1))/(XVIB3(J-1)-XVIB3(J))
      QIN(7,I)=(A*EN+B)*1.D-16
  500 CONTINUE
C
C  V1
      QIN(8,I)=0.0
      IF(EN.LE.EIN(8)) GO TO 550
      EFAC=DSQRT(1.0-(EIN(8)/EN))
      QIN(8,I)=AMP3*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      DO 510 J=2,NVIB4
      IF(EN.LE.XVIB4(J)) GO TO 520
  510 CONTINUE
      J=NVIB4
  520 A=(YVIB4(J)-YVIB4(J-1))/(XVIB4(J)-XVIB4(J-1))
      B=(XVIB4(J-1)*YVIB4(J)-XVIB4(J)*YVIB4(J-1))/(XVIB4(J-1)-XVIB4(J))
      QIN(8,I)=(QIN(8,I)+(A*EN+B))*1.D-16
  550 CONTINUE
C
C 2V1 (HARMONIC)
      QIN(9,I)=0.0
      IF(EN.LE.EIN(9)) GO TO 600
      DO 560 J=2,NVIB5
      IF(EN.LE.XVIB5(J)) GO TO 570
  560 CONTINUE
      J=NVIB5
  570 A=(YVIB5(J)-YVIB5(J-1))/(XVIB5(J)-XVIB5(J-1))
      B=(XVIB5(J-1)*YVIB5(J)-XVIB5(J)*YVIB5(J-1))/(XVIB5(J-1)-XVIB5(J))
      QIN(9,I)=(A*EN+B)*1.D-16
  600 CONTINUE
C
      QIN(10,I)=0.0
      IF(EN.LE.EIN(10)) GO TO 700
      DO 610 J=2,NEXC1
      IF(EN.LE.XEXC1(J)) GO TO 620
  610 CONTINUE
      J=NEXC1
  620 A=(YEXC1(J)-YEXC1(J-1))/(XEXC1(J)-XEXC1(J-1))
      B=(XEXC1(J-1)*YEXC1(J)-XEXC1(J)*YEXC1(J-1))/(XEXC1(J-1)-XEXC1(J))
      QIN(10,I)=(A*EN+B)*1.D-16
  700 CONTINUE
C
      QIN(11,I)=0.0
      IF(EN.LE.EIN(11)) GO TO 800
      DO 710 J=2,NEXC2
      IF(EN.LE.XEXC2(J)) GO TO 720
  710 CONTINUE
      J=NEXC2
  720 A=(YEXC2(J)-YEXC2(J-1))/(XEXC2(J)-XEXC2(J-1))
      B=(XEXC2(J-1)*YEXC2(J)-XEXC2(J)*YEXC2(J-1))/(XEXC2(J-1)-XEXC2(J))
      QIN(11,I)=(A*EN+B)*1.D-16
  800 CONTINUE
C
      QIN(12,I)=0.0
      IF(EN.LE.EIN(12)) GO TO 899
      DO 810 J=2,NEXC3
      IF(EN.LE.XEXC3(J)) GO TO 820
  810 CONTINUE
      J=NEXC3
  820 A=(YEXC3(J)-YEXC3(J-1))/(XEXC3(J)-XEXC3(J-1))
      B=(XEXC3(J-1)*YEXC3(J)-XEXC3(J)*YEXC3(J-1))/(XEXC3(J-1)-XEXC3(J))
      QIN(12,I)=(A*EN+B)*1.D-16
  899 CONTINUE
C
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+QIN(1,I)+QIN(2,I)+QIN(3,I)+QIN(4,I)+
     /QIN(5,I)+QIN(6,I)+QIN(7,I)+QIN(8,I)+QIN(9,I)+QIN(10,I)+QIN(11,I)+
     /QIN(12,I)
  900 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(12)) NIN=11
      IF(EFINAL.LE.EIN(11)) NIN=10
      IF(EFINAL.LE.EIN(10)) NIN=9
      IF(EFINAL.LE.EIN(9)) NIN=8
      IF(EFINAL.LE.EIN(8)) NIN=7
      IF(EFINAL.LE.EIN(7)) NIN=6
      IF(EFINAL.LE.EIN(6)) NIN=5
      IF(EFINAL.LE.EIN(5)) NIN=4
      IF(EFINAL.LE.EIN(4)) NIN=3
      IF(EFINAL.LE.EIN(3)) NIN=2
      IF(EFINAL.LE.EIN(2)) NIN=1
      IF(EFINAL.LE.EIN(1)) NIN=0
C
      RETURN
      END
      SUBROUTINE GAS33(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      DIMENSION XEN(49),YXSEC(49),XVIB1(32),YVIB1(32),XVIB2(31),
     /YVIB2(31),XVIB3(15),YVIB3(15),XVIB4(28),YVIB4(28),XVIB5(21),
     /YVIB5(21),XEXC1(23),YEXC1(23),XEXC2(20),YEXC2(20),
     /XION(46),YION(46),XATT(16),YATT(16)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      DATA XEN/0.00,0.01,.014,0.02,0.03,0.04,0.05,0.06,0.07,0.08,
     /0.09,0.10,0.11,0.12,0.14,0.16,0.18,0.20,0.25,0.30,
     /0.40,0.50,0.60,0.80,1.00,1.40,2.00,3.00,4.00,5.00,
     /6.00,7.50,8.50,10.0,15.0,20.0,30.0,40.0,70.0,
     /100.,140.,200.,250.,300.,500.,1000.,1500.,10000.,100000./
      DATA YXSEC/13.0,11.0,10.5,9.80,7.80,5.60,4.20,2.90,2.10,2.00,
     /2.20,2.65,3.25,3.90,5.65,7.30,9.15,10.8,14.2,16.8,
     /20.0,21.5,22.0,22.5,22.7,22.8,22.9,23.0,23.5,25.5,
     /27.0,29.0,27.0,22.0,15.4,12.0,8.31,6.28,3.69,
     /2.66,1.57,0.97,0.70,0.57,0.32,.143,.092,.011,.001/
      DATA XVIB1/.107,1.00,1.20,1.40,1.60,1.80,2.00,2.20,2.40,2.60,
     /3.00,4.00,4.50,5.00,5.50,6.00,6.50,7.00,8.00,9.00,
     /10.0,11.0,15.0,20.0,25.0,30.0,50.0,100.,200.,1000.,
     /10000.,100000./
      DATA YVIB1/0.0,.001,.022,.040,.080,.080,.080,.085,.085,.085,
     /0.13,0.22,0.70,1.10,1.25,1.15,0.75,0.60,0.71,0.77,
     /0.71,0.64,0.31,0.25,0.18,0.12,0.06,.025,0.01,.001,
     /.00003,.000003/
      DATA XVIB2/.178,1.00,1.40,1.60,1.80,2.00,2.20,2.40,2.60,2.80,
     /3.00,3.20,3.40,4.00,5.00,6.00,7.00,8.00,9.00,10.0,
     /11.0,15.0,20.0,25.0,30.0,50.0,100.,200.,1000.,10000.,
     /100000./
      DATA YVIB2/0.00,.001,0.15,0.25,0.40,0.45,0.47,0.50,0.52,0.55,
     /0.57,0.60,0.62,0.66,0.74,0.90,1.14,1.33,1.38,1.23,
     /1.01,0.56,0.44,0.34,0.25,0.14,.059,.025,.003,.0001,
     /.00001/
      DATA XVIB3/.295,1.00,3.00,4.00,4.50,5.00,5.50,6.00,6.50,7.00,
     /10.0,100.0,1000.,10000.,100000./
      DATA YVIB3/0.00,.001,0.01,0.01,0.05,0.10,0.15,0.10,0.05,0.01,
     /.001,.0001,.00001,.000001,.0000001/
      DATA XVIB4/.374,1.00,1.40,1.60,1.80,2.00,2.20,2.40,2.60,3.00,
     /4.00,5.00,6.00,7.00,8.00,9.00,10.0,11.0,15.0,20.0,
     /25.0,30.0,50.0,100.,200.,1000.,10000.,100000./
      DATA YVIB4/0.00,.001,.029,.049,0.30,0.44,0.47,0.50,0.55,0.70,
     /0.75,1.15,1.40,1.70,1.80,1.70,1.50,1.40,0.90,0.66,
     /0.57,0.40,0.22,0.92,0.04,.004,.0004,.00004/
      DATA XVIB5/.748,1.00,3.00,4.00,5.00,6.00,7.00,8.00,9.00,10.0,
     /11.0,15.0,20.0,25.0,30.0,50.0,100.,200.,1000.,10000.,
     /100000./
      DATA YVIB5/0.00,.0001,.002,.030,.052,.088,0.11,0.12,0.10,.084,
     /.065,.035,.025,.020,.016,.009,.004,.0014,.0002,.000005,
     /.0000005/
      DATA XEXC1/7.30,7.50,8.00,8.50,9.00,10.0,11.0,14.0,20.0,25.0,
     /30.0,40.0,60.0,80.0,100.,150.,200.,400.,1000.,2000.,
     /10000.,20000.,100000./
      DATA YEXC1/0.00,.026,0.21,0.36,0.65,1.11,1.70,2.38,2.74,2.81,
     /2.86,2.81,2.69,2.55,2.38,2.14,1.87,1.46,0.82,0.41,
     /0.09,.044,.009/
      DATA XEXC2/9.00,10.0,11.0,14.0,16.0,20.0,25.0,30.0,40.0,60.0,
     /80.0,100.,150.,200.,400.,1000.,2000.,10000.,20000.,100000./
      DATA YEXC2/0.00,0.43,1.11,2.04,2.30,2.64,2.81,2.86,2.81,2.69,
     /2.55,2.38,2.14,1.87,1.46,0.82,0.41,0.09,.044,.009/
      DATA XION/9.86,11.0,12.0,13.0,14.0,16.5,19.0,24.0,30.0,35.0,
     /40.0,45.0,50.0,60.0,70.0,80.0,90.0,100.,125.,150.,
     /175.,200.,250.,300.,350.,400.,450.,500.,600.,700.,
     /800.,900.,1000.,1250.,1500.,1750.,2000.,2500.,3000.,5000.,
     /7000.,10000.,15000.,30000.,60000.,100000./
      DATA YION/0.00,0.19,0.43,0.70,1.05,2.12,3.06,4.81,5.97,6.80,
     /7.38,7.88,8.51,9.04,9.32,9.42,9.42,9.42,9.14,8.64,
     /8.16,7.71,7.20,6.31,5.77,5.34,4.86,4.55,4.00,3.68,
     /3.39,3.02,2.82,2.44,2.10,1.90,1.74,1.50,1.28,0.85,
     /0.64,0.47,0.33,0.18,.097,.061/
      DATA XATT/6.85,7.00,7.20,7.50,8.00,8.50,9.00,9.50,10.0,10.5,
     /11.0,11.5,12.0,12.5,13.0,13.2/
      DATA YATT/0.00,0.67,1.10,1.65,2.80,4.40,6.60,10.3,14.7,12.3,
     /9.70,6.20,3.50,1.30,0.50,0.00/
      NAME=' CYCLO--C3H6 99'
C ---------------------------------------------------------------------
C  1999 INCLUDED VIBRATIONAL RESONACE SHAPES FROM ALLEN (ERHARDT AND
C   MORGAN) AND ASLO BOESTEN AND TANAKA XIX ICPEAC
C   FIT TO  SCHMIDTS ,GEE+FREEMAN AND BOWMAN+GORDON DATA IN
C   PURE CYCLO - PROPANE AND SCHMIDT IN HELIUM/CYCLOPROPANE.
C   NO GOOD DATA AT HIGH FIELD THEREFORE X-SECTIONS ABOVE 1 EV ARE
C   DERIVED FROM SYSTEMATICS IN THE HYDROCARBONS AND ABOVE REFS.
C ---------------------------------------------------------------------
      NIN=9
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      NDATA=49
      NVIB1=32
      NVIB2=31
      NVIB3=15
      NVIB4=28
      NVIB5=21
      NEXC1=23
      NEXC2=20
      NION=46
      NATT=16
      E(1)=0.0
      E(2)=2.0*EMASS/(42.08064*AMU)
      E(3)=9.86
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=9.86
      EIN(1)=-0.107
      EIN(2)=0.107
      EIN(3)=-0.178
      EIN(4)=0.178
      EIN(5)=0.295
      EIN(6)=0.374
      EIN(7)=0.748
      EIN(8)=7.30
      EIN(9)=9.00
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       CYCLO PROPANE  '
      SCRPT(3)=' IONISATION    ELOSS=  9.86   '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' VIB V11       ELOSS= -0.107  '
      SCRPT(8)=' VIB V11       ELOSS=  0.107  '
      SCRPT(9)=' VIB           ELOSS= -0.178  '
      SCRPT(10)=' VIB           ELOSS=  0.178  '
      SCRPT(11)=' VIB 2V3       ELOSS=  0.295  '
      SCRPT(12)=' VIB           ELOSS=  0.374  '
      SCRPT(13)=' VIB HAR       ELOSS=  0.748  '
      SCRPT(14)=' EXC           ELOSS=  7.30   '
      SCRPT(15)=' EXC           ELOSS=  9.00   '
      AMP1=0.120
      AMP2=0.090
      AMP3=0.109
      APOP=DEXP(EIN(1)/AKT)
      APOPH=DEXP(EIN(3)/AKT)
      EN=-ESTEP/2.0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      DO 10 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 20
   10 CONTINUE
      J=NDATA
   20 A=(YXSEC(J)-YXSEC(J-1))/(XEN(J)-XEN(J-1))
      B=(XEN(J-1)*YXSEC(J)-XEN(J)*YXSEC(J-1))/(XEN(J-1)-XEN(J))
      Q(2,I)=(A*EN+B)*1.0D-16
C
      Q(3,I)=0.0
      IF(EN.LT.E(3)) GO TO 200
      DO 110 J=2,NION
      IF(EN.LE.XION(J)) GO TO 120
  110 CONTINUE
      J=NION
  120 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
C
  200 Q(4,I)=0.0
      IF(EN.LT.XATT(1)) GO TO 300
      IF(EN.GT.XATT(NATT)) GO TO 300
      DO 210 J=2,NATT
      IF(EN.LE.XATT(J)) GO TO 220
  210 CONTINUE
      J=NATT
  220 A=(YATT(J)-YATT(J-1))/(XATT(J)-XATT(J-1))
      B=(XATT(J-1)*YATT(J)-XATT(J)*YATT(J-1))/(XATT(J-1)-XATT(J))
      Q(4,I)=(A*EN+B)*1.D-21
C
  300 Q(5,I)=0.0
      Q(6,I)=0.0
C
C V7 SUPERELASTIC
      QIN(1,I)=0.0
      IF(EN.LE.0.0) GO TO 350
      EFAC=DSQRT(1.0-(EIN(1)/EN))
      QIN(1,I)=AMP1*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      DO 310 J=2,NVIB1
      IF((EN+EIN(2)).LE.XVIB1(J)) GO TO 320
  310 CONTINUE
      J=NVIB1
  320 A=(YVIB1(J)-YVIB1(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB1(J)-XVIB1(J)*YVIB1(J-1))/(XVIB1(J-1)-XVIB1(J))
      QIN(1,I)=QIN(1,I)+(EN+EIN(2))*(A*(EN+EIN(2))+B)/EN
      QIN(1,I)=QIN(1,I)*APOP/(1.0+APOP)*1.D-16
  350 CONTINUE
C
C  V11 + V3
      QIN(2,I)=0.0
      IF(EN.LE.EIN(2)) GO TO 400
      EFAC=DSQRT(1.0-(EIN(2)/EN))
      QIN(2,I)=AMP1*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      DO 360 J=2,NVIB1
      IF(EN.LE.XVIB1(J)) GO TO 370
  360 CONTINUE
      J=NVIB1
  370 A=(YVIB1(J)-YVIB1(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB1(J)-XVIB1(J)*YVIB1(J-1))/(XVIB1(J-1)-XVIB1(J))
      QIN(2,I)=QIN(2,I)+(A*EN+B)
      QIN(2,I)=QIN(2,I)/(1.0+APOP)*1.D-16
  400 CONTINUE
C
C SUPERELASTIC
      QIN(3,I)=0.0
      IF(EN.LE.0.0) GO TO 4150
      EFAC=DSQRT(1.0-(EIN(3)/EN))
      QIN(3,I)=AMP2*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      DO 4110 J=2,NVIB2
      IF((EN+EIN(4)).LE.XVIB2(J)) GO TO 4120
 4110 CONTINUE
      J=NVIB2
 4120 A=(YVIB2(J)-YVIB2(J-1))/(XVIB2(J)-XVIB2(J-1))
      B=(XVIB2(J-1)*YVIB2(J)-XVIB2(J)*YVIB2(J-1))/(XVIB2(J-1)-XVIB2(J))
      QIN(3,I)=QIN(3,I)+(EN+EIN(4))*(A*(EN+EIN(4))+B)/EN
      QIN(3,I)=QIN(3,I)*APOPH/(1.0+APOPH)*1.D-16
 4150 CONTINUE
C  V9 + V2 (SUM OF VIBRATIONS AT 179 AND 183 MV)
      QIN(4,I)=0.0
      IF(EN.LE.EIN(4)) GO TO 450
      EFAC=DSQRT(1.0-(EIN(4)/EN))
      QIN(4,I)=AMP2*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      DO 410 J=2,NVIB2
      IF(EN.LE.XVIB2(J)) GO TO 420
  410 CONTINUE
      J=NVIB2
  420 A=(YVIB2(J)-YVIB2(J-1))/(XVIB2(J)-XVIB2(J-1))
      B=(XVIB2(J-1)*YVIB2(J)-XVIB2(J)*YVIB2(J-1))/(XVIB2(J-1)-XVIB2(J))
      QIN(4,I)=QIN(4,I)+(A*EN+B)
      QIN(4,I)=QIN(4,I)/(1.0+APOPH)*1.D-16
  450 CONTINUE
C
C  2V3 (HARMONICS)
      QIN(5,I)=0.0
      IF(EN.LE.EIN(5)) GO TO 500
      DO 460 J=2,NVIB3
      IF(EN.LE.XVIB3(J)) GO TO 470
  460 CONTINUE
      J=NVIB3
  470 A=(YVIB3(J)-YVIB3(J-1))/(XVIB3(J)-XVIB3(J-1))
      B=(XVIB3(J-1)*YVIB3(J)-XVIB3(J)*YVIB3(J-1))/(XVIB3(J-1)-XVIB3(J))
      QIN(5,I)=(A*EN+B)*1.D-16
  500 CONTINUE
C
C  V1 + V8 + V12
      QIN(6,I)=0.0
      IF(EN.LE.EIN(6)) GO TO 550
      EFAC=DSQRT(1.0-(EIN(6)/EN))
      QIN(6,I)=AMP3*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      DO 510 J=2,NVIB4
      IF(EN.LE.XVIB4(J)) GO TO 520
  510 CONTINUE
      J=NVIB4
  520 A=(YVIB4(J)-YVIB4(J-1))/(XVIB4(J)-XVIB4(J-1))
      B=(XVIB4(J-1)*YVIB4(J)-XVIB4(J)*YVIB4(J-1))/(XVIB4(J-1)-XVIB4(J))
      QIN(6,I)=(QIN(6,I)+(A*EN+B))*1.D-16
  550 CONTINUE
C
C 2V1 (HARMONIC)
      QIN(7,I)=0.0
      IF(EN.LE.EIN(7)) GO TO 600
      DO 560 J=2,NVIB5
      IF(EN.LE.XVIB5(J)) GO TO 570
  560 CONTINUE
      J=NVIB5
  570 A=(YVIB5(J)-YVIB5(J-1))/(XVIB5(J)-XVIB5(J-1))
      B=(XVIB5(J-1)*YVIB5(J)-XVIB5(J)*YVIB5(J-1))/(XVIB5(J-1)-XVIB5(J))
      QIN(7,I)=(A*EN+B)*1.D-16
  600 CONTINUE
C
C
      QIN(8,I)=0.0
      IF(EN.LE.EIN(8)) GO TO 850
      DO 810 J=2,NEXC1
      IF(EN.LE.XEXC1(J)) GO TO 820
  810 CONTINUE
      J=NEXC1
  820 A=(YEXC1(J)-YEXC1(J-1))/(XEXC1(J)-XEXC1(J-1))
      B=(XEXC1(J-1)*YEXC1(J)-XEXC1(J)*YEXC1(J-1))/(XEXC1(J-1)-XEXC1(J))
      QIN(8,I)=(A*EN+B)*1.D-16
  850 CONTINUE
C
      QIN(9,I)=0.0
      IF(EN.LE.EIN(9)) GO TO 899
      DO 860 J=2,NEXC2
      IF(EN.LE.XEXC2(J)) GO TO 870
  860 CONTINUE
      J=NEXC2
  870 A=(YEXC2(J)-YEXC2(J-1))/(XEXC2(J)-XEXC2(J-1))
      B=(XEXC2(J-1)*YEXC2(J)-XEXC2(J)*YEXC2(J-1))/(XEXC2(J-1)-XEXC2(J))
      QIN(9,I)=(A*EN+B)*1.D-16
  899 CONTINUE
C
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+QIN(1,I)+QIN(2,I)+QIN(3,I)+QIN(4,I)+
     /QIN(5,I)+QIN(6,I)+QIN(7,I)+QIN(8,I)+QIN(9,I)
  900 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(9)) NIN=8
      IF(EFINAL.LE.EIN(8)) NIN=7
      IF(EFINAL.LE.EIN(7)) NIN=6
      IF(EFINAL.LE.EIN(6)) NIN=5
      IF(EFINAL.LE.EIN(5)) NIN=4
      IF(EFINAL.LE.EIN(4)) NIN=3
      IF(EFINAL.LE.EIN(3)) NIN=2
      IF(EFINAL.LE.EIN(2)) NIN=1
      IF(EFINAL.LE.EIN(1)) NIN=0
C
      RETURN
      END
      SUBROUTINE GAS34(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      DIMENSION XEN(24),YXSEC(24),XVIBH(18),YVIBH(18),XION(47),YION(47),
     /XATT(17),YATT(17),XEXC(25),YEXC(25),XEXC1(23),YEXC1(23),
     /XEXC2(19),YEXC2(19)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      DATA XEN/0.00,.001,0.01,0.10,0.40,1.00,1.50,2.00,3.00,
     /4.00,5.00,7.50,10.0,12.0,15.0,20.0,30.0,60.0,100.,
     /200.0,500.0,1000.0,10000.,100000./
      DATA YXSEC/2060.,2060.,1750.,175.,42.5,16.5,13.5,12.5,13.5,
     /15.0,16.0,20.0,19.0,18.0,15.0,11.5,8.60,3.60,2.05,
     /0.80,0.20,0.10,.008,.0008/
      DATA XVIBH/0.00,2.00,3.00,4.00,5.00,6.00,7.00,8.00,9.00,10.0,
     /11.0,12.0,15.0,20.0,100.,1000.,10000.,100000./
      DATA YVIBH/0.00,0.00,.025,0.45,0.60,0.80,0.95,1.00,0.95,0.80,
     /0.60,0.45,0.30,0.18,0.02,.001,.0001,.00001/
      DATA XION/10.85,11.5,12.0,12.5,13.5,14.5,15.5,16.5,17.5,18.5,
     /20.0,25.0,30.0,35.0,40.0,45.0,50.0,60.0,70.0,80.0,
     /90.0,100.,125.,150.,175.,200.,250.,300.,350.,400.,
     /450.,500.,600.,700.,800.,900.,1000.,1250.,1500.,1750.,
     /2000.,4000.,6000.,10000.,20000.,40000.,100000./
      DATA YION/0.00,.015,0.06,0.13,0.33,0.60,0.89,1.21,1.53,1.84,
     /2.12,3.29,4.20,4.67,5.11,5.52,5.70,6.30,6.54,6.48,
     /6.46,6.51,6.17,5.97,5.65,5.36,4.73,4.34,3.95,3.65,
     /3.28,3.15,2.86,2.56,2.25,2.12,1.92,1.65,1.44,1.29,
     /1.15,0.68,0.50,0.34,.189,.104,.043/
      DATA XATT/5.00,5.50,6.00,7.00,7.50,8.00,8.50,9.00,9.50,10.0,
     /10.4,11.0,12.0,13.0,14.0,15.0,20.0/
      DATA YATT/0.00,.145,0.44,0.38,0.32,0.24,0.26,0.36,0.66,1.24,
     /2.00,1.08,0.30,0.20,0.16,0.12,0.00/
      DATA XEXC/7.50,8.00,9.00,10.0,11.0,14.0,17.0,20.0,25.0,30.0,
     /40.0,60.0,80.0,100.,150.,200.,300.,400.,600.,1000.,
     /2000.,4000.,10000.,20000.,100000./
      DATA YEXC/0.00,0.21,0.46,0.53,0.60,0.67,0.69,0.79,0.90,0.96,
     /1.00,1.00,1.00,0.93,0.87,0.80,0.66,0.60,0.47,0.33,
     /0.17,0.09,.033,.017,.004/
      DATA XEXC1/9.80,10.5,11.5,13.5,16.0,20.0,25.0,30.0,
     /40.0,60.0,80.0,100.,150.,200.,300.,400.,600.,1000.,
     /2000.,4000.,10000.,20000.,100000./
      DATA YEXC1/0.00,0.11,0.23,0.42,0.64,0.87,1.02,1.10,
     /1.15,1.15,1.15,1.07,1.00,0.93,0.78,0.70,0.54,0.40,
     /0.20,0.10,0.04,0.02,.004/
      DATA XEXC2/17.0,20.0,25.0,30.0,
     /40.0,60.0,80.0,100.,150.,200.,300.,400.,600.,1000.,
     /2000.,4000.,10000.,20000.,100000./
      DATA YEXC2/0.00,0.24,0.52,0.66,
     /0.71,0.66,0.63,0.60,0.55,0.47,0.38,0.30,0.22,0.14,
     /.076,.043,.019,.009,.0019/
C
      NAME='METHANOL   1999'
C --------------------------------------------------------------------
C    X-SECTIONS FROM SCALING ETHANOL X-SECTIONS AND ALSO FROM
C    TOTAL ELECTRON SCATTERING FROM GDANSK.
C ---------------------------------------------------------------------
      NIN=9
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      NDATA=24
      NVIBH=18
      NION=47
      NATT=17
      NEXC=25
      NEXC1=23
      NEXC2=19
      E(1)=0.0
      E(2)=2.0*EMASS/(32.04186*AMU)
      E(3)=10.85
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=10.85
      EIN(1)=-0.025
      EIN(2)=0.025
      EIN(3)=-0.1281
      EIN(4)=0.1281
      EIN(5)=0.1668
      EIN(6)=0.3527
      EIN(7)=7.50
      EIN(8)=9.80
      EIN(9)=17.0
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       METHANOL       '
      SCRPT(3)=' IONISATION    ELOSS= 10.85   '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' ROT           ELOSS= -0.025  '
      SCRPT(8)=' ROT           ELOSS=  0.025  '
      SCRPT(9)=' VIB V8        ELOSS= -0.1281 '
      SCRPT(10)=' VIB V8        ELOSS=  0.1281 '
      SCRPT(11)=' VIB V6        ELOSS=  0.1668 '
      SCRPT(12)=' VIB V3        ELOSS=  0.3527 '
      SCRPT(13)=' EXC           ELOSS=  7.50   '
      SCRPT(14)=' EXC           ELOSS=  9.80   '
      SCRPT(15)=' EXC           ELOSS= 17.0    '
      APOP1=DEXP(EIN(1)/AKT)
      APOP2=DEXP(EIN(3)/AKT)
      EN=-ESTEP/2.0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      Q(2,I)=0.0
C USE LOG INTERPOLATION BECAUSE OF RAPID CHANGE IN X-SEC
      IF(EN.LE.XEN(2)) THEN
       Q(2,I)=YXSEC(2)*1.D-16
       GO TO 30
      ENDIF
      DO 10 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 20
   10 CONTINUE
      J=NDATA
   20 YXJ=DLOG(YXSEC(J))
      YXJ1=DLOG(YXSEC(J-1))
      XNJ=DLOG(XEN(J))
      XNJ1=DLOG(XEN(J-1))
      A=(YXJ-YXJ1)/(XNJ-XNJ1)
      B=(XNJ1*YXJ-XNJ*YXJ1)/(XNJ1-XNJ)
      Q(2,I)=DEXP(A*DLOG(EN)+B)*1.D-16
C
   30 Q(3,I)=0.0
      IF(EN.LT.E(3)) GO TO 40
      DO 31 J=2,NION
      IF(EN.LE.XION(J)) GO TO 32
   31 CONTINUE
      J=NION
   32 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
   40 CONTINUE
C
      Q(4,I)=0.0
      IF(EN.LT.XATT(1)) GO TO 50
      IF(EN.GE.XATT(NATT)) GO TO 50
      DO 41 J=2,NATT
      IF(EN.LE.XATT(J)) GO TO 42
   41 CONTINUE
      J=NATT
   42 A=(YATT(J)-YATT(J-1))/(XATT(J)-XATT(J-1))
      B=(XATT(J-1)*YATT(J)-XATT(J)*YATT(J-1))/(XATT(J-1)-XATT(J))
      Q(4,I)=(A*EN+B)*1.D-19
   50 CONTINUE
      Q(5,I)=0.0
      Q(6,I)=0.0
C
C  SUPERELASTIC  ROT1
C
      QIN(1,I)=0.0
      IF(EN.LE.0.0) GO TO 150
      EFAC=DSQRT(1.0-(EIN(1)/EN))
      QIN(1,I)=0.7*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      QIN(1,I)=QIN(1,I)*APOP1/(1.0+APOP1)*1.D-16
C  ROT1
  150 QIN(2,I)=0.0
      IF(EN.LE.EIN(2)) GO TO 200
      EFAC=DSQRT(1.0-(EIN(2)/EN))
      QIN(2,I)=0.7*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      QIN(2,I)=QIN(2,I)/(1.0+APOP1)*1.D-16
C
C  SUPERELASTIC V1
C
  200 QIN(3,I)=0.0
      IF(EN.LE.0.0) GO TO 250
      EFAC=DSQRT(1.0-(EIN(3)/EN))
      QIN(3,I)=0.40*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      DO 220 J=2,NVIBH
      IF((EN+EIN(4)).LE.XVIBH(J)) GO TO 230
  220 CONTINUE
      J=NVIBH
  230 A=(YVIBH(J)-YVIBH(J-1))/(XVIBH(J)-XVIBH(J-1))
      B=(XVIBH(J-1)*YVIBH(J)-XVIBH(J)*YVIBH(J-1))/(XVIBH(J-1)-XVIBH(J))
      QIN(3,I)=QIN(3,I)+(EN+EIN(4))*(A*(EN+EIN(4))+B)/EN
      QIN(3,I)=QIN(3,I)*APOP2/(1.0+APOP2)*1.D-16
C INELASTIC V1
  250 QIN(4,I)=0.0
      IF(EN.LE.EIN(4)) GO TO 300
      EFAC=DSQRT(1.0-(EIN(4)/EN))
      QIN(4,I)=0.40*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      DO 270 J=2,NVIBH
      IF(EN.LE.XVIBH(J)) GO TO 280
  270 CONTINUE
      J=NVIBH
  280 A=(YVIBH(J)-YVIBH(J-1))/(XVIBH(J)-XVIBH(J-1))
      B=(XVIBH(J-1)*YVIBH(J)-XVIBH(J)*YVIBH(J-1))/(XVIBH(J-1)-XVIBH(J))
      QIN(4,I)=QIN(4,I)+(A*EN+B)
      QIN(4,I)=QIN(4,I)/(1.0+APOP2)*1.D-16
C  VIB 2
  300 QIN(5,I)=0.0
      IF(EN.LE.EIN(5)) GO TO 400
      EFAC=DSQRT(1.0-(EIN(5)/EN))
      QIN(5,I)=0.44*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      DO 310 J=2,NVIBH
      IF(EN.LE.XVIBH(J)) GO TO 320
  310 CONTINUE
      J=NVIBH
  320 A=(YVIBH(J)-YVIBH(J-1))/(XVIBH(J)-XVIBH(J-1))
      B=(XVIBH(J-1)*YVIBH(J)-XVIBH(J)*YVIBH(J-1))/(XVIBH(J-1)-XVIBH(J))
      QIN(5,I)=(QIN(5,I)+(A*EN+B))*1.D-16
  400 CONTINUE
C  VIB 3
      QIN(6,I)=0.0
      IF(EN.LE.EIN(6)) GO TO 500
      EFAC=DSQRT(1.0-(EIN(6)/EN))
      QIN(6,I)=0.84*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      DO 410 J=2,NVIBH
      IF(EN.LE.XVIBH(J)) GO TO 420
  410 CONTINUE
      J=NVIBH
  420 A=(YVIBH(J)-YVIBH(J-1))/(XVIBH(J)-XVIBH(J-1))
      B=(XVIBH(J-1)*YVIBH(J)-XVIBH(J)*YVIBH(J-1))/(XVIBH(J-1)-XVIBH(J))
      QIN(6,I)=(QIN(6,I)+(A*EN+B))*1.D-16
  500 CONTINUE
C EXC
      QIN(7,I)=0.0
      IF(EN.LE.EIN(7)) GO TO 600
      DO 510 J=2,NEXC
      IF(EN.LE.XEXC(J)) GO TO 520
  510 CONTINUE
      J=NEXC
  520 A=(YEXC(J)-YEXC(J-1))/(XEXC(J)-XEXC(J-1))
      B=(XEXC(J-1)*YEXC(J)-XEXC(J)*YEXC(J-1))/(XEXC(J-1)-XEXC(J))
      QIN(7,I)=(A*EN+B)*1.D-16
  600 CONTINUE
C  EXC 1
      QIN(8,I)=0.0
      IF(EN.LE.EIN(8)) GO TO 700
      DO 610 J=2,NEXC1
      IF(EN.LE.XEXC1(J)) GO TO 620
  610 CONTINUE
      J=NEXC1
  620 A=(YEXC1(J)-YEXC1(J-1))/(XEXC1(J)-XEXC1(J-1))
      B=(XEXC1(J-1)*YEXC1(J)-XEXC1(J)*YEXC1(J-1))/(XEXC1(J-1)-XEXC1(J))
      QIN(8,I)=(A*EN+B)*1.D-16
  700 CONTINUE
C EXC 2
      QIN(9,I)=0.0
      IF(EN.LE.EIN(9)) GO TO 800
      DO 710 J=2,NEXC2
      IF(EN.LE.XEXC2(J)) GO TO 720
  710 CONTINUE
      J=NEXC2
  720 A=(YEXC2(J)-YEXC2(J-1))/(XEXC2(J)-XEXC2(J-1))
      B=(XEXC2(J-1)*YEXC2(J)-XEXC2(J)*YEXC2(J-1))/(XEXC2(J-1)-XEXC2(J))
      QIN(9,I)=(A*EN+B)*1.D-16
  800 CONTINUE
C---------------------------------------------------------------------
C    SUBTRACT ROTATIONAL XSEC TO GET CORRECT ELASTIC XSEC.
      Q(2,I)=Q(2,I)-QIN(1,I)-QIN(2,I)
C     IF(Q(2,I).LE.0.0) WRITE(6,966) Q(2,I),I
C 966 FORMAT(3X,' ERROR IN GAS 27 Q(2,I)=',E12.3,'  I=',I5)
C  TOTAL
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+QIN(1,I)+QIN(2,I)+
     /QIN(3,I)+QIN(4,I)+QIN(5,I)+QIN(6,I)+QIN(7,I)+QIN(8,I)+QIN(9,I)
  900 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(9)) NIN=8
      IF(EFINAL.LE.EIN(8)) NIN=7
      IF(EFINAL.LE.EIN(7)) NIN=6
      IF(EFINAL.LE.EIN(6)) NIN=5
      IF(EFINAL.LE.EIN(5)) NIN=4
      IF(EFINAL.LE.EIN(4)) NIN=3
      IF(EFINAL.LE.EIN(3)) NIN=2
      IF(EFINAL.LE.EIN(2)) NIN=1
      IF(EFINAL.LE.EIN(1)) NIN=0
C
      RETURN
      END
      SUBROUTINE GAS35(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      DIMENSION XEN(24),YXSEC(24),XVIBH(18),YVIBH(18),XION(48),YION(48),
     /XATT(17),YATT(17),XEXC(25),YEXC(25),XEXC1(23),YEXC1(23),
     /XEXC2(19),YEXC2(19)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      DATA XEN/0.00,.001,0.01,0.10,0.40,1.00,1.50,2.00,3.00,
     /4.00,5.00,7.50,10.0,12.0,15.0,20.0,30.0,60.0,100.,
     /200.0,500.0,1000.0,10000.,100000./
      DATA YXSEC/2060.,2060.,1750.,175.,42.5,16.5,13.5,12.5,13.5,
     /18.0,21.0,27.0,26.5,25.0,21.0,16.0,12.0,5.00,2.90,
     /1.05,0.35,0.16,.012,.001/
      DATA XVIBH/0.00,2.00,3.00,4.00,5.00,6.00,7.00,8.00,9.00,10.0,
     /11.0,12.0,15.0,20.0,100.,1000.,10000.,100000./
      DATA YVIBH/0.00,0.00,.025,0.25,0.66,0.88,1.05,1.10,1.05,0.88,
     /0.66,0.50,0.33,0.19,.022,.0011,.00011,.000011/
      DATA XION/10.48,11.0,12.0,12.5,13.0,14.0,15.0,17.0,20.0,25.0,
     /30.0,35.0,40.0,45.0,50.0,60.0,70.0,80.0,90.0,100.,
     /125.,150.,175.,200.,250.,300.,350.,400.,450.,500.,
     /600.,700.,800.,900.,1000.,1250.,1500.,1750.,2000.,2500.,
     /3000.,5000.,7000.,10000.,15000.,30000.,60000.,100000./
      DATA YION/0.00,0.11,0.32,0.45,0.59,0.91,1.32,2.21,3.12,5.01,
     /6.22,7.09,7.69,8.21,8.87,9.41,9.71,9.81,9.81,9.81,
     /9.52,9.00,8.50,8.03,7.50,6.58,6.01,5.56,5.06,4.74,
     /4.16,3.84,3.53,3.14,2.93,2.54,2.18,1.98,1.81,1.56,
     /1.34,0.88,0.66,0.49,0.35,.188,.101,.063/
      DATA XATT/5.00,5.50,6.00,7.00,7.50,8.00,8.50,9.00,9.50,10.0,
     /10.4,11.0,12.0,13.0,14.0,15.0,20.0/
      DATA YATT/0.00,.145,0.44,0.38,0.32,0.24,0.26,0.36,0.66,1.24,
     /2.00,1.08,0.30,0.20,0.16,0.12,0.00/
      DATA XEXC/7.20,9.00,10.0,11.0,12.0,14.0,16.0,20.0,25.0,30.0,
     /40.0,60.0,80.0,100.,150.,200.,300.,400.,600.,1000.,
     /2000.,4000.,10000.,20000.,100000./
      DATA YEXC/0.00,0.81,1.18,1.27,1.31,1.35,1.35,1.35,1.35,1.35,
     /1.39,1.39,1.35,1.27,1.06,0.98,0.82,0.77,0.65,0.42,
     /0.20,0.10,.041,.021,.004/
      DATA XEXC1/9.50,10.5,11.5,13.5,16.0,20.0,25.0,30.0,
     /40.0,60.0,80.0,100.,150.,200.,300.,400.,600.,1000.,
     /2000.,4000.,10000.,20000.,100000./
      DATA YEXC1/0.00,0.14,0.30,0.56,0.86,1.15,1.35,1.46,
     /1.59,1.64,1.59,1.49,1.25,1.15,0.96,0.90,0.77,0.50,
     /0.24,0.12,.048,.025,.005/
      DATA XEXC2/16.0,20.0,25.0,30.0,
     /40.0,60.0,80.0,100.,150.,200.,300.,400.,600.,1000.,
     /2000.,4000.,10000.,20000.,100000./
      DATA YEXC2/0.00,0.32,0.69,0.96,
     /1.35,1.59,1.59,1.49,1.25,1.15,0.96,0.90,0.77,0.50,
     /0.24,0.12,.048,.025,.005/
C
      NAME=' ETHANOL   1999'
C --------------------------------------------------------------------
C   VIBRATION EXCITATION AND IONISATION FROM SCALING PROPANE X-SECTIONS
C   EXPERIMENTAL DATA FROM CHRISTOPHOROU AND FROMMHOLD ALSO MIXTURE
c   DATA WITH ARGON FROM COLLI AND LEONARDIS
C ---------------------------------------------------------------------
      NIN=9
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      NDATA=24
      NVIBH=18
      NION=48
      NATT=17
      NEXC=25
      NEXC1=23
      NEXC2=19
      E(1)=0.0
      E(2)=2.0*EMASS/(46.06904*AMU)
      E(3)=10.48
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=10.48
      EIN(1)=-0.025
      EIN(2)=0.025
      EIN(3)=-0.109
      EIN(4)=0.109
      EIN(5)=0.1668
      EIN(6)=0.3527
      EIN(7)=7.20
      EIN(8)=9.50
      EIN(9)=16.0
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       ETHANOL        '
      SCRPT(3)=' IONISATION    ELOSS= 10.48   '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' ROT           ELOSS= -0.025  '
      SCRPT(8)=' ROT           ELOSS=  0.025  '
      SCRPT(9)=' VIB V8        ELOSS= -0.109  '
      SCRPT(10)=' VIB V8        ELOSS=  0.109  '
      SCRPT(11)=' VIB V6        ELOSS=  0.1668 '
      SCRPT(12)=' VIB V3        ELOSS=  0.3527 '
      SCRPT(13)=' EXC           ELOSS=  7.20   '
      SCRPT(14)=' EXC           ELOSS=  9.50   '
      SCRPT(15)=' EXC           ELOSS= 16.0    '
      APOP1=DEXP(EIN(1)/AKT)
      APOP2=DEXP(EIN(3)/AKT)
      EN=-ESTEP/2.0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      Q(2,I)=0.0
C USE LOG INTERPOLATION BECAUSE OF RAPID CHANGE IN X-SEC
      IF(EN.LE.XEN(2)) THEN
       Q(2,I)=YXSEC(2)*1.D-16
       GO TO 30
      ENDIF
      DO 10 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 20
   10 CONTINUE
      J=NDATA
   20 YXJ=DLOG(YXSEC(J))
      YXJ1=DLOG(YXSEC(J-1))
      XNJ=DLOG(XEN(J))
      XNJ1=DLOG(XEN(J-1))
      A=(YXJ-YXJ1)/(XNJ-XNJ1)
      B=(XNJ1*YXJ-XNJ*YXJ1)/(XNJ1-XNJ)
      Q(2,I)=DEXP(A*DLOG(EN)+B)*1.D-16
C
   30 Q(3,I)=0.0
      IF(EN.LT.E(3)) GO TO 40
      DO 31 J=2,NION
      IF(EN.LE.XION(J)) GO TO 32
   31 CONTINUE
      J=NION
   32 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
   40 CONTINUE
C
      Q(4,I)=0.0
      IF(EN.LT.XATT(1)) GO TO 50
      IF(EN.GE.XATT(NATT)) GO TO 50
      DO 41 J=2,NATT
      IF(EN.LE.XATT(J)) GO TO 42
   41 CONTINUE
      J=NATT
   42 A=(YATT(J)-YATT(J-1))/(XATT(J)-XATT(J-1))
      B=(XATT(J-1)*YATT(J)-XATT(J)*YATT(J-1))/(XATT(J-1)-XATT(J))
      Q(4,I)=(A*EN+B)*1.D-19
   50 CONTINUE
      Q(5,I)=0.0
      Q(6,I)=0.0
C
C  SUPERELASTIC  ROT1
C
      QIN(1,I)=0.0
      IF(EN.LE.0.0) GO TO 150
      EFAC=DSQRT(1.0-(EIN(1)/EN))
      QIN(1,I)=0.7*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      QIN(1,I)=QIN(1,I)*APOP1/(1.0+APOP1)*1.D-16
C  ROT1
  150 QIN(2,I)=0.0
      IF(EN.LE.EIN(2)) GO TO 200
      EFAC=DSQRT(1.0-(EIN(2)/EN))
      QIN(2,I)=0.7*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      QIN(2,I)=QIN(2,I)/(1.0+APOP1)*1.D-16
C
C  SUPERELASTIC V1
C
  200 QIN(3,I)=0.0
      IF(EN.LE.0.0) GO TO 250
      EFAC=DSQRT(1.0-(EIN(3)/EN))
      QIN(3,I)=0.403*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      DO 220 J=2,NVIBH
      IF((EN+EIN(4)).LE.XVIBH(J)) GO TO 230
  220 CONTINUE
      J=NVIBH
  230 A=(YVIBH(J)-YVIBH(J-1))/(XVIBH(J)-XVIBH(J-1))
      B=(XVIBH(J-1)*YVIBH(J)-XVIBH(J)*YVIBH(J-1))/(XVIBH(J-1)-XVIBH(J))
      QIN(3,I)=QIN(3,I)+(EN+EIN(4))*(A*(EN+EIN(4))+B)/EN
      QIN(3,I)=QIN(3,I)*APOP2/(1.0+APOP2)*1.D-16
C INELASTIC V1
  250 QIN(4,I)=0.0
      IF(EN.LE.EIN(4)) GO TO 300
      EFAC=DSQRT(1.0-(EIN(4)/EN))
      QIN(4,I)=0.403*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      DO 270 J=2,NVIBH
      IF(EN.LE.XVIBH(J)) GO TO 280
  270 CONTINUE
      J=NVIBH
  280 A=(YVIBH(J)-YVIBH(J-1))/(XVIBH(J)-XVIBH(J-1))
      B=(XVIBH(J-1)*YVIBH(J)-XVIBH(J)*YVIBH(J-1))/(XVIBH(J-1)-XVIBH(J))
      QIN(4,I)=QIN(4,I)+(A*EN+B)
      QIN(4,I)=QIN(4,I)/(1.0+APOP2)*1.D-16
C  VIB 2
  300 QIN(5,I)=0.0
      IF(EN.LE.EIN(5)) GO TO 400
      EFAC=DSQRT(1.0-(EIN(5)/EN))
      QIN(5,I)=0.423*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      DO 310 J=2,NVIBH
      IF(EN.LE.XVIBH(J)) GO TO 320
  310 CONTINUE
      J=NVIBH
  320 A=(YVIBH(J)-YVIBH(J-1))/(XVIBH(J)-XVIBH(J-1))
      B=(XVIBH(J-1)*YVIBH(J)-XVIBH(J)*YVIBH(J-1))/(XVIBH(J-1)-XVIBH(J))
      QIN(5,I)=(QIN(5,I)+(A*EN+B))*1.D-16
  400 CONTINUE
C  VIB 3
      QIN(6,I)=0.0
      IF(EN.LE.EIN(6)) GO TO 500
      EFAC=DSQRT(1.0-(EIN(6)/EN))
      QIN(6,I)=0.84*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      DO 410 J=2,NVIBH
      IF(EN.LE.XVIBH(J)) GO TO 420
  410 CONTINUE
      J=NVIBH
  420 A=(YVIBH(J)-YVIBH(J-1))/(XVIBH(J)-XVIBH(J-1))
      B=(XVIBH(J-1)*YVIBH(J)-XVIBH(J)*YVIBH(J-1))/(XVIBH(J-1)-XVIBH(J))
      QIN(6,I)=(QIN(6,I)+(A*EN+B))*1.D-16
  500 CONTINUE
C EXC
      QIN(7,I)=0.0
      IF(EN.LE.EIN(7)) GO TO 600
      DO 510 J=2,NEXC
      IF(EN.LE.XEXC(J)) GO TO 520
  510 CONTINUE
      J=NEXC
  520 A=(YEXC(J)-YEXC(J-1))/(XEXC(J)-XEXC(J-1))
      B=(XEXC(J-1)*YEXC(J)-XEXC(J)*YEXC(J-1))/(XEXC(J-1)-XEXC(J))
      QIN(7,I)=(A*EN+B)*1.D-16
  600 CONTINUE
C  EXC 1
      QIN(8,I)=0.0
      IF(EN.LE.EIN(8)) GO TO 700
      DO 610 J=2,NEXC1
      IF(EN.LE.XEXC1(J)) GO TO 620
  610 CONTINUE
      J=NEXC1
  620 A=(YEXC1(J)-YEXC1(J-1))/(XEXC1(J)-XEXC1(J-1))
      B=(XEXC1(J-1)*YEXC1(J)-XEXC1(J)*YEXC1(J-1))/(XEXC1(J-1)-XEXC1(J))
      QIN(8,I)=(A*EN+B)*1.D-16
  700 CONTINUE
C EXC 2
      QIN(9,I)=0.0
      IF(EN.LE.EIN(9)) GO TO 800
      DO 710 J=2,NEXC2
      IF(EN.LE.XEXC2(J)) GO TO 720
  710 CONTINUE
      J=NEXC2
  720 A=(YEXC2(J)-YEXC2(J-1))/(XEXC2(J)-XEXC2(J-1))
      B=(XEXC2(J-1)*YEXC2(J)-XEXC2(J)*YEXC2(J-1))/(XEXC2(J-1)-XEXC2(J))
      QIN(9,I)=(A*EN+B)*1.D-16
  800 CONTINUE
C---------------------------------------------------------------------
C    SUBTRACT ROTATIONAL XSEC TO GET CORRECT ELASTIC XSEC.
      Q(2,I)=Q(2,I)-QIN(1,I)-QIN(2,I)
C     IF(Q(2,I).LE.0.0) WRITE(6,966) Q(2,I),I
C 966 FORMAT(3X,' ERROR IN GAS 27 Q(2,I)=',E12.3,'  I=',I5)
C  TOTAL
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+QIN(1,I)+QIN(2,I)+
     /QIN(3,I)+QIN(4,I)+QIN(5,I)+QIN(6,I)+QIN(7,I)+QIN(8,I)+QIN(9,I)
  900 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(9)) NIN=8
      IF(EFINAL.LE.EIN(8)) NIN=7
      IF(EFINAL.LE.EIN(7)) NIN=6
      IF(EFINAL.LE.EIN(6)) NIN=5
      IF(EFINAL.LE.EIN(5)) NIN=4
      IF(EFINAL.LE.EIN(4)) NIN=3
      IF(EFINAL.LE.EIN(3)) NIN=2
      IF(EFINAL.LE.EIN(2)) NIN=1
      IF(EFINAL.LE.EIN(1)) NIN=0
C
      RETURN
      END
      SUBROUTINE GAS36(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      DIMENSION XEN(24),YXSEC(24),XVIBH(18),YVIBH(18),XION(46),YION(46),
     /XATT(17),YATT(17),XEXC(25),YEXC(25),XEXC1(23),YEXC1(23),
     /XEXC2(19),YEXC2(19)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      DATA XEN/0.00,.001,0.01,0.10,0.40,1.00,1.50,2.00,3.00,
     /4.00,5.00,7.50,10.0,12.0,15.0,20.0,30.0,60.0,100.,
     /200.0,500.0,1000.0,10000.,100000./
      DATA YXSEC/2160.,2160.,1840.,184.,44.5,17.0,14.0,13.0,14.0,
     /21.0,26.0,33.5,33.5,31.5,26.5,20.5,15.5,6.50,3.70,
     /1.30,0.45,0.21,.015,.0012/
      DATA XVIBH/0.00,2.00,3.00,4.00,5.00,6.00,7.00,8.00,9.00,10.0,
     /11.0,12.0,15.0,20.0,100.,1000.,10000.,100000./
      DATA YVIBH/0.00,0.00,.034,0.34,0.89,1.19,1.42,1.48,1.42,1.19,
     /0.89,0.68,0.45,0.25,.030,.0015,.00015,.000015/
      DATA XION/10.18,10.7,12.0,13.0,14.0,16.5,19.5,25.0,30.0,35.0,
     /40.0,45.0,50.0,60.0,70.0,80.0,90.0,100.,125.,150.,
     /175.,200.,250.,300.,350.,400.,450.,500.,600.,700.,
     /800.,900.,1000.,1250.,1500.,1750.,2000.,2500.,3000.,5000.,
     /7000.,10000.,15000.,30000.,60000.,100000./
      DATA YION/0.00,0.26,0.59,0.96,1.43,2.91,4.17,6.57,8.16,9.30,
     /10.1,10.8,11.6,12.3,12.7,12.9,12.9,12.9,12.5,11.8,
     /11.2,10.6,9.80,8.63,7.88,7.29,6.64,6.22,5.46,5.04,
     /4.63,4.12,3.85,3.33,2.86,2.60,2.37,2.05,1.76,1.16,
     /0.87,0.64,0.46,0.25,0.11,.083/
      DATA XATT/5.00,5.50,6.00,7.00,7.50,8.00,8.50,9.00,9.50,10.0,
     /10.4,11.0,12.0,13.0,14.0,15.0,20.0/
      DATA YATT/0.00,.145,0.44,0.38,0.32,0.24,0.26,0.36,0.66,1.24,
     /2.00,1.08,0.30,0.20,0.16,0.12,0.00/
      DATA XEXC/7.00,9.00,10.0,11.0,12.0,14.0,16.0,20.0,25.0,30.0,
     /40.0,60.0,80.0,100.,150.,200.,300.,400.,600.,1000.,
     /2000.,4000.,10000.,20000.,100000./
      DATA YEXC/0.00,1.07,1.57,1.69,1.74,1.80,1.80,1.80,1.80,1.80,
     /1.85,1.85,1.80,1.69,1.41,1.30,1.09,1.02,0.86,0.56,
     /0.27,0.13,.055,.028,.005/
      DATA XEXC1/9.00,10.0,11.0,13.0,16.0,20.0,25.0,30.0,
     /40.0,60.0,80.0,100.,150.,200.,300.,400.,600.,1000.,
     /2000.,4000.,10000.,20000.,100000./
      DATA YEXC1/0.00,0.19,0.40,0.75,1.14,1.53,1.80,1.94,
     /2.11,2.18,2.11,1.98,1.66,1.53,1.28,1.20,1.02,0.67,
     /0.32,0.16,.064,.033,.007/
      DATA XEXC2/16.0,20.0,25.0,30.0,
     /40.0,60.0,80.0,100.,150.,200.,300.,400.,600.,1000.,
     /2000.,4000.,10000.,20000.,100000./
      DATA YEXC2/0.00,0.42,0.92,1.28,
     /1.80,2.11,2.11,1.98,1.66,1.53,1.28,1.20,1.02,0.67,
     /0.32,0.16,.064,.033,.007/
C
      NAME='2-PROPANOL 1999'
C --------------------------------------------------------------------
C   X-SECTIONS FROM SCALING ETHANOL X-SECTIONS  AT LOW ENERGY AND
C   FITS TO DRIFT VELOCITY OF CHRISTOPHOROU AND CHRISTODOULIDES.
C ---------------------------------------------------------------------
      NIN=9
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      NDATA=24
      NVIBH=18
      NION=46
      NATT=17
      NEXC=25
      NEXC1=23
      NEXC2=19
      E(1)=0.0
      E(2)=2.0*EMASS/(60.09592*AMU)
      E(3)=10.18
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=10.18
      EIN(1)=-0.025
      EIN(2)=0.025
      EIN(3)=-0.109
      EIN(4)=0.109
      EIN(5)=0.1668
      EIN(6)=0.3527
      EIN(7)=7.00
      EIN(8)=9.00
      EIN(9)=16.0
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       PROPANOL       '
      SCRPT(3)=' IONISATION    ELOSS= 10.18   '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' ROT           ELOSS= -0.025  '
      SCRPT(8)=' ROT           ELOSS=  0.025  '
      SCRPT(9)=' VIB V8        ELOSS= -0.109  '
      SCRPT(10)=' VIB V8        ELOSS=  0.109  '
      SCRPT(11)=' VIB V6        ELOSS=  0.1668 '
      SCRPT(12)=' VIB V3        ELOSS=  0.3527 '
      SCRPT(13)=' EXC           ELOSS=  7.00   '
      SCRPT(14)=' EXC           ELOSS=  9.00   '
      SCRPT(15)=' EXC           ELOSS= 16.0    '
      APOP1=DEXP(EIN(1)/AKT)
      APOP2=DEXP(EIN(3)/AKT)
      EN=-ESTEP/2.0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      Q(2,I)=0.0
C USE LOG INTERPOLATION BECAUSE OF RAPID CHANGE IN X-SEC
      IF(EN.LE.XEN(2)) THEN
       Q(2,I)=YXSEC(2)*1.D-16
       GO TO 30
      ENDIF
      DO 10 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 20
   10 CONTINUE
      J=NDATA
   20 YXJ=DLOG(YXSEC(J))
      YXJ1=DLOG(YXSEC(J-1))
      XNJ=DLOG(XEN(J))
      XNJ1=DLOG(XEN(J-1))
      A=(YXJ-YXJ1)/(XNJ-XNJ1)
      B=(XNJ1*YXJ-XNJ*YXJ1)/(XNJ1-XNJ)
      Q(2,I)=DEXP(A*DLOG(EN)+B)*1.D-16
C
   30 Q(3,I)=0.0
      IF(EN.LT.E(3)) GO TO 40
      DO 31 J=2,NION
      IF(EN.LE.XION(J)) GO TO 32
   31 CONTINUE
      J=NION
   32 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
   40 CONTINUE
C
      Q(4,I)=0.0
      IF(EN.LT.XATT(1)) GO TO 50
      IF(EN.GE.XATT(NATT)) GO TO 50
      DO 41 J=2,NATT
      IF(EN.LE.XATT(J)) GO TO 42
   41 CONTINUE
      J=NATT
   42 A=(YATT(J)-YATT(J-1))/(XATT(J)-XATT(J-1))
      B=(XATT(J-1)*YATT(J)-XATT(J)*YATT(J-1))/(XATT(J-1)-XATT(J))
      Q(4,I)=(A*EN+B)*1.D-19
   50 CONTINUE
      Q(5,I)=0.0
      Q(6,I)=0.0
C
C  SUPERELASTIC  ROT1
C
      QIN(1,I)=0.0
      IF(EN.LE.0.0) GO TO 150
      EFAC=DSQRT(1.0-(EIN(1)/EN))
      QIN(1,I)=0.7*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      QIN(1,I)=QIN(1,I)*APOP1/(1.0+APOP1)*1.D-16
C  ROT1
  150 QIN(2,I)=0.0
      IF(EN.LE.EIN(2)) GO TO 200
      EFAC=DSQRT(1.0-(EIN(2)/EN))
      QIN(2,I)=0.7*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      QIN(2,I)=QIN(2,I)/(1.0+APOP1)*1.D-16
C
C  SUPERELASTIC V1
C
  200 QIN(3,I)=0.0
      IF(EN.LE.0.0) GO TO 250
      EFAC=DSQRT(1.0-(EIN(3)/EN))
      QIN(3,I)=0.443*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      DO 220 J=2,NVIBH
      IF((EN+EIN(4)).LE.XVIBH(J)) GO TO 230
  220 CONTINUE
      J=NVIBH
  230 A=(YVIBH(J)-YVIBH(J-1))/(XVIBH(J)-XVIBH(J-1))
      B=(XVIBH(J-1)*YVIBH(J)-XVIBH(J)*YVIBH(J-1))/(XVIBH(J-1)-XVIBH(J))
      QIN(3,I)=QIN(3,I)+(EN+EIN(4))*(A*(EN+EIN(4))+B)/EN
      QIN(3,I)=QIN(3,I)*APOP2/(1.0+APOP2)*1.D-16
C INELASTIC V1
  250 QIN(4,I)=0.0
      IF(EN.LE.EIN(4)) GO TO 300
      EFAC=DSQRT(1.0-(EIN(4)/EN))
      QIN(4,I)=0.443*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      DO 270 J=2,NVIBH
      IF(EN.LE.XVIBH(J)) GO TO 280
  270 CONTINUE
      J=NVIBH
  280 A=(YVIBH(J)-YVIBH(J-1))/(XVIBH(J)-XVIBH(J-1))
      B=(XVIBH(J-1)*YVIBH(J)-XVIBH(J)*YVIBH(J-1))/(XVIBH(J-1)-XVIBH(J))
      QIN(4,I)=QIN(4,I)+(A*EN+B)
      QIN(4,I)=QIN(4,I)/(1.0+APOP2)*1.D-16
C  VIB 2
  300 QIN(5,I)=0.0
      IF(EN.LE.EIN(5)) GO TO 400
      EFAC=DSQRT(1.0-(EIN(5)/EN))
      QIN(5,I)=0.465*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      DO 310 J=2,NVIBH
      IF(EN.LE.XVIBH(J)) GO TO 320
  310 CONTINUE
      J=NVIBH
  320 A=(YVIBH(J)-YVIBH(J-1))/(XVIBH(J)-XVIBH(J-1))
      B=(XVIBH(J-1)*YVIBH(J)-XVIBH(J)*YVIBH(J-1))/(XVIBH(J-1)-XVIBH(J))
      QIN(5,I)=(QIN(5,I)+(A*EN+B))*1.D-16
  400 CONTINUE
C  VIB 3
      QIN(6,I)=0.0
      IF(EN.LE.EIN(6)) GO TO 500
      EFAC=DSQRT(1.0-(EIN(6)/EN))
      QIN(6,I)=0.92*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      DO 410 J=2,NVIBH
      IF(EN.LE.XVIBH(J)) GO TO 420
  410 CONTINUE
      J=NVIBH
  420 A=(YVIBH(J)-YVIBH(J-1))/(XVIBH(J)-XVIBH(J-1))
      B=(XVIBH(J-1)*YVIBH(J)-XVIBH(J)*YVIBH(J-1))/(XVIBH(J-1)-XVIBH(J))
      QIN(6,I)=(QIN(6,I)+(A*EN+B))*1.D-16
  500 CONTINUE
C EXC
      QIN(7,I)=0.0
      IF(EN.LE.EIN(7)) GO TO 600
      DO 510 J=2,NEXC
      IF(EN.LE.XEXC(J)) GO TO 520
  510 CONTINUE
      J=NEXC
  520 A=(YEXC(J)-YEXC(J-1))/(XEXC(J)-XEXC(J-1))
      B=(XEXC(J-1)*YEXC(J)-XEXC(J)*YEXC(J-1))/(XEXC(J-1)-XEXC(J))
      QIN(7,I)=(A*EN+B)*1.D-16
  600 CONTINUE
C  EXC 1
      QIN(8,I)=0.0
      IF(EN.LE.EIN(8)) GO TO 700
      DO 610 J=2,NEXC1
      IF(EN.LE.XEXC1(J)) GO TO 620
  610 CONTINUE
      J=NEXC1
  620 A=(YEXC1(J)-YEXC1(J-1))/(XEXC1(J)-XEXC1(J-1))
      B=(XEXC1(J-1)*YEXC1(J)-XEXC1(J)*YEXC1(J-1))/(XEXC1(J-1)-XEXC1(J))
      QIN(8,I)=(A*EN+B)*1.D-16
  700 CONTINUE
C EXC 2
      QIN(9,I)=0.0
      IF(EN.LE.EIN(9)) GO TO 800
      DO 710 J=2,NEXC2
      IF(EN.LE.XEXC2(J)) GO TO 720
  710 CONTINUE
      J=NEXC2
  720 A=(YEXC2(J)-YEXC2(J-1))/(XEXC2(J)-XEXC2(J-1))
      B=(XEXC2(J-1)*YEXC2(J)-XEXC2(J)*YEXC2(J-1))/(XEXC2(J-1)-XEXC2(J))
      QIN(9,I)=(A*EN+B)*1.D-16
  800 CONTINUE
C---------------------------------------------------------------------
C    SUBTRACT ROTATIONAL XSEC TO GET CORRECT ELASTIC XSEC.
      Q(2,I)=Q(2,I)-QIN(1,I)-QIN(2,I)
C     IF(Q(2,I).LE.0.0) WRITE(6,966) Q(2,I),I
C 966 FORMAT(3X,' ERROR IN GAS 27 Q(2,I)=',E12.3,'  I=',I5)
C  TOTAL
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+QIN(1,I)+QIN(2,I)+
     /QIN(3,I)+QIN(4,I)+QIN(5,I)+QIN(6,I)+QIN(7,I)+QIN(8,I)+QIN(9,I)
  900 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(9)) NIN=8
      IF(EFINAL.LE.EIN(8)) NIN=7
      IF(EFINAL.LE.EIN(7)) NIN=6
      IF(EFINAL.LE.EIN(6)) NIN=5
      IF(EFINAL.LE.EIN(5)) NIN=4
      IF(EFINAL.LE.EIN(4)) NIN=3
      IF(EFINAL.LE.EIN(3)) NIN=2
      IF(EFINAL.LE.EIN(2)) NIN=1
      IF(EFINAL.LE.EIN(1)) NIN=0
C
      RETURN
      END
      SUBROUTINE GAS37(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      DIMENSION XEN(67),YXSEC(67),XATT(3),YATT(3),XION(27),YION(27),
     /XEXC1(27),YEXC1(27),XEXC2(25),YEXC2(25),XEXC3(22),YEXC3(22),
     /XEXC4(20),YEXC4(20),XEXC5(18),YEXC5(18)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      DATA XEN/0.00,.00005,.0001,.00015,.0002,.0003,.0004,.0005,.0006,
     /.0007,
     /.0008,.0009,.001,.00125,.0015,.0017,.00185,.002,.0025,.003,
     /.004,.005,.0056,.006,.007,.008,.009,0.01,.0125,.013,
     /.015,0.02,.025,0.03,0.04,0.05,0.06,0.07,0.08,0.09,
     /0.10,0.20,0.30,0.40,0.50,0.60,0.70,0.80,0.90,1.00,
     /1.20,1.40,1.50,1.60,1.80,2.00,2.20,2.40,2.60,2.80,
     /4.00,10.0,1000.,2000.,10000.,20000.,100000./
      DATA YXSEC/1190.,1188.,1005.,916.,851.,760.,708.,667.,639.,624.,
     /609.,639.,696.,1149.,4745.,10930.,10930.,7038.,2782.,2130.,
     /2354.,4620.,6849.,6300.,4016.,2848.,2520.,2876.,4365.,4745.,
     /4515.,2876.,1775.,1430.,1039.,851.,790.,710.,670.,630.,
     /600.,415.,340.,290.,260.,230.,210.,195.,180.,170.,
     /135.,100.,80.0,65.0,58.5,52.5,47.6,44.4,43.1,41.2,
     /36.0,26.0,0.14,0.07,.012,.006,.0012/
      DATA XION/3.8926,5.00,6.00,7.00,8.00,10.0,12.0,14.0,15.0,17.0,
     /20.0,25.0,30.0,40.0,50.0,60.0,80.0,100.,200.,300.,
     /400.,500.,600.,700.,1000.,10000.,100000./
      DATA YION/0.00,2.70,4.80,6.00,7.20,8.00,8.20,9.80,10.0,9.30,
     /8.40,9.90,10.2,9.92,9.82,9.58,9.08,8.79,7.40,6.25,
     /5.44,5.02,4.88,4.80,4.50,0.45,.045/
      DATA XATT/10.0,100.0,100000./
      DATA YATT/0.00,0.0000001,0.0000000001/
C  P1/2
      DATA XEXC1/1.3859,1.40,1.45,1.50,1.60,1.70,1.90,2.00,2.20,2.50,
     /3.00,3.50,4.00,5.00,6.00,7.00,8.00,10.0,15.0,20.0,
     /40.0,60.0,80.0,100.,1000.,10000.,100000./
      DATA YEXC1/0.00,1.47,15.4,23.7,17.8,17.1,14.2,12.7,12.0,11.2,
     /12.2,12.7,13.0,13.8,14.3,15.1,15.1,14.7,13.8,13.3,
     /8.32,6.24,4.94,4.16,0.42,.042,.0042/
C  P3/2
      DATA XEXC2/1.4546,1.50,1.60,1.70,1.90,2.00,2.20,2.50,3.00,3.50,
     /4.00,5.00,6.00,7.00,8.00,10.0,15.0,20.0,40.0,60.0,
     /80.0,100.,1000.,10000.,100000./
      DATA YEXC2/0.00,23.7,34.6,32.3,26.9,24.2,21.5,19.5,20.5,21.5,
     /22.0,23.3,24.2,25.5,25.5,24.9,23.3,22.4,14.1,10.6,
     /8.36,7.04,0.70,0.07,.007/
C  D3/2 + D5/2
      DATA XEXC3/1.7977,1.90,2.00,2.20,2.50,3.00,3.50,4.00,5.00,6.00,
     /7.00,8.00,10.0,15.0,20.0,40.0,60.0,80.0,100.,1000.,
     /10000.,100000./
      DATA YEXC3/0.00,7.50,14.7,19.8,20.3,21.8,23.2,23.5,24.9,25.8,
     /27.3,27.3,26.6,24.9,24.0,15.0,11.3,8.93,7.52,0.75,
     /.075,.0075/
C  S1/2
      DATA XEXC4/2.2981,2.40,2.50,3.00,3.50,4.00,5.00,6.00,7.00,8.00,
     /10.0,15.0,20.0,40.0,60.0,80.0,100.,1000.,10000.,100000./
      DATA YEXC4/0.00,3.40,4.90,6.40,7.30,7.50,7.95,8.25,8.70,8.70,
     /8.47,7.95,7.65,4.80,3.60,2.85,2.40,0.24,.024,.0024/
C  SUM OF HIGHER LEVELS
      DATA XEXC5/2.6986,3.00,3.50,4.00,5.00,6.00,7.00,8.00,10.0,15.0,
     /20.0,40.0,60.0,80.0,100.,1000.,10000.,100000./
      DATA YEXC5/0.00,1.90,3.30,4.40,4.66,4.84,5.10,5.10,4.97,4.66,
     /4.49,2.82,2.11,1.67,1.41,.141,.0141,.00141/
      NAME=' CESIUM 2001   '
C ---------------------------------------------------------------------
C ---------------------------------------------------------------------
      NIN=5
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      NDATA=67
      NION=27
      NATT=3
      NEXC1=27
      NEXC2=25
      NEXC3=22
      NEXC4=20
      NEXC5=18
      E(1)=0.0
      E(2)=2.0*EMASS/(132.90545*AMU)
      E(3)=3.8926
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=3.8926
      EIN(1)=1.3859
      EIN(2)=1.4546
      EIN(3)=1.7977
      EIN(4)=2.2981
      EIN(5)=2.6986
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       CESIUM         '
      SCRPT(3)=' IONISATION    ELOSS=  3.8926 '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' EXC P1/2      ELOSS=  1.3859 '
      SCRPT(8)=' EXC P3/2      ELOSS=  1.4546 '
      SCRPT(9)=' EXC D3/2+5/2  ELOSS=  1.7977 '
      SCRPT(10)=' EXC S1/2      ELOSS=  2.2981 '
      SCRPT(11)=' EXC HIGHER    ELOSS=  2.6986 '
      EN=-ESTEP/2.0
      DO 1000 I=1,NSTEP
      EN=EN+ESTEP
      DO 10 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 20
   10 CONTINUE
      J=NDATA
   20 A=(YXSEC(J)-YXSEC(J-1))/(XEN(J)-XEN(J-1))
      B=(XEN(J-1)*YXSEC(J)-XEN(J)*YXSEC(J-1))/(XEN(J-1)-XEN(J))
      Q(2,I)=(A*EN+B)*1.D-16
      Q(3,I)=0.0
      IF(EN.LT.E(3)) GO TO 200
      DO 110 J=2,NION
      IF(EN.LE.XION(J)) GO TO 120
  110 CONTINUE
      J=NION
  120 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
  200 Q(4,I)=0.0
      IF(EN.LT.XATT(1)) GO TO 300
      IF(EN.GE.XATT(NATT)) GO TO 300
      DO 210 J=2,NATT
      IF(EN.LE.XATT(J)) GO TO 220
  210 CONTINUE
      J=NATT
  220 A=(YATT(J)-YATT(J-1))/(XATT(J)-XATT(J-1))
      B=(XATT(J-1)*YATT(J)-XATT(J)*YATT(J-1))/(XATT(J-1)-XATT(J))
      Q(4,I)=(A*EN+B)*1.D-16
  300 Q(5,I)=0.0
      Q(6,I)=0.0
C
      QIN(1,I)=0.0
      IF(EN.LE.EIN(1)) GO TO 400
      DO 310 J=2,NEXC1
      IF(EN.LE.XEXC1(J)) GO TO 320
  310 CONTINUE
      J=NEXC1
  320 A=(YEXC1(J)-YEXC1(J-1))/(XEXC1(J)-XEXC1(J-1))
      B=(XEXC1(J-1)*YEXC1(J)-XEXC1(J)*YEXC1(J-1))/(XEXC1(J-1)-XEXC1(J))
      QIN(1,I)=(A*EN+B)*1.D-16
  400 CONTINUE
C
      QIN(2,I)=0.0
      IF(EN.LE.EIN(2)) GO TO 500
      DO 410 J=2,NEXC2
      IF(EN.LE.XEXC2(J)) GO TO 420
  410 CONTINUE
      J=NEXC2
  420 A=(YEXC2(J)-YEXC2(J-1))/(XEXC2(J)-XEXC2(J-1))
      B=(XEXC2(J-1)*YEXC2(J)-XEXC2(J)*YEXC2(J-1))/(XEXC2(J-1)-XEXC2(J))
      QIN(2,I)=(A*EN+B)*1.D-16
  500 CONTINUE
C
      QIN(3,I)=0.0
      IF(EN.LE.EIN(3)) GO TO 600
      DO 510 J=2,NEXC3
      IF(EN.LE.XEXC3(J)) GO TO 520
  510 CONTINUE
      J=NEXC3
  520 A=(YEXC3(J)-YEXC3(J-1))/(XEXC3(J)-XEXC3(J-1))
      B=(XEXC3(J-1)*YEXC3(J)-XEXC3(J)*YEXC3(J-1))/(XEXC3(J-1)-XEXC3(J))
      QIN(3,I)=(A*EN+B)*1.D-16
  600 CONTINUE
C
      QIN(4,I)=0.0
      IF(EN.LE.EIN(4)) GO TO 700
      DO 610 J=2,NEXC4
      IF(EN.LE.XEXC4(J)) GO TO 620
  610 CONTINUE
      J=NEXC4
  620 A=(YEXC4(J)-YEXC4(J-1))/(XEXC4(J)-XEXC4(J-1))
      B=(XEXC4(J-1)*YEXC4(J)-XEXC4(J)*YEXC4(J-1))/(XEXC4(J-1)-XEXC4(J))
      QIN(4,I)=(A*EN+B)*1.D-16
  700 CONTINUE
C
      QIN(5,I)=0.0
      IF(EN.LE.EIN(5)) GO TO 800
      DO 710 J=2,NEXC5
      IF(EN.LE.XEXC5(J)) GO TO 720
  710 CONTINUE
      J=NEXC5
  720 A=(YEXC5(J)-YEXC5(J-1))/(XEXC5(J)-XEXC5(J-1))
      B=(XEXC5(J-1)*YEXC5(J)-XEXC5(J)*YEXC5(J-1))/(XEXC5(J-1)-XEXC5(J))
      QIN(5,I)=(A*EN+B)*1.D-16
  800 CONTINUE
C
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+QIN(1,I)+QIN(2,I)+QIN(3,I)+QIN(4,I)+
     /QIN(5,I)
 1000 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(5)) NIN=4
      IF(EFINAL.LE.EIN(4)) NIN=3
      IF(EFINAL.LE.EIN(3)) NIN=2
      IF(EFINAL.LE.EIN(2)) NIN=1
      IF(EFINAL.LE.EIN(1)) NIN=0
      RETURN
      END
      SUBROUTINE GAS38(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      DIMENSION XEN(29),YXSEC(29),XATT(65),YATT(65),XION(24),YION(24),
     /XVIB1(55),YVIB1(55),XVIB2(54),YVIB2(54),XVIB3(32),YVIB3(32),
     /XVIB4(24),YVIB4(24),XEXC1(18),YEXC1(18),XEXC2(17),YEXC2(17),
     /XEXC3(18),YEXC3(18),XEXC4(17),YEXC4(17)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      DATA XEN/0.00,0.01,.028,.109,.282,.471,.681,1.01,1.25,1.45,
     /1.49,1.53,1.56,1.62,2.16,2.57,3.58,6.19,9.89,16.3,
     /24.5,39.3,71.0,120.,218.,379.,953.,10000.,100000./
      DATA YXSEC/10.3,10.3,10.2,10.3,10.5,11.1,12.7,16.6,21.6,32.6,
     /35.6,36.2,36.2,35.4,24.3,19.9,16.2,12.2,10.1,8.13,
     /6.24,4.19,2.52,1.44,.684,.301,.082,.009,.001/
      DATA XVIB1/.1108,0.20,0.30,0.40,0.50,0.60,0.70,0.80,0.90,1.00,
     /1.10,1.20,1.30,1.40,1.50,1.60,1.70,1.80,1.90,2.00,
     /2.10,2.20,2.30,2.40,2.50,2.60,2.70,2.80,2.90,3.00,
     /3.10,3.20,3.30,3.40,3.50,3.60,3.70,3.80,3.90,4.00,
     /4.10,4.20,4.30,4.40,4.50,4.60,4.70,4.80,4.90,5.00,
     /10.0,100.,1000.,10000.,100000./
      DATA YVIB1/0.00,0.64,0.85,0.86,0.77,0.63,0.50,0.39,0.30,0.23,
     /0.18,0.14,0.12,.095,.079,.066,.057,.049,.043,.038,
     /.033,.030,.027,.024,.022,.020,.018,.017,.015,.014,
     /.013,.012,.011,.0105,.010,.0094,.0089,.0084,.0078,.0074,
     /.0071,.0067,.0063,.0060,.0057,.0054,.0052,.0050,.0048,.0046,
     /.0025,.00030,.00003,.000003,.0000003/
      DATA XVIB2/.2188,0.30,0.40,0.50,0.60,0.70,0.80,0.90,1.00,1.10,
     /1.20,1.30,1.40,1.50,1.60,1.70,1.80,1.90,2.00,2.10,
     /2.20,2.30,2.40,2.50,2.60,2.70,2.80,2.90,3.00,3.10,
     /3.20,3.30,3.40,3.50,3.60,3.70,3.80,3.90,4.00,4.10,
     /4.20,4.30,4.40,4.50,4.60,4.70,4.80,4.90,5.00,10.0,
     /100.,1000.,10000.,100000./
      DATA YVIB2/0.00,0.82,0.99,0.97,0.85,0.70,0.55,0.43,0.33,0.26,
     /0.21,0.16,0.13,0.11,.093,.080,.069,.060,.053,.047,
     /.042,.037,.034,.031,.028,.026,.024,.022,.020,.019,
     /.017,.016,.015,.014,.013,.012,.011,.011,.010,.010,
     /.0094,.0089,.0084,.0081,.0077,.0073,.0070,.0067,.0064,.0035,
     /.0004,.00004,.000004,.0000004/
      DATA XVIB3/.3237,0.40,0.50,0.60,0.70,0.80,1.00,1.20,1.40,1.60,
     /1.80,2.00,2.20,2.40,2.60,2.80,3.00,3.20,3.40,3.60,
     /3.80,4.00,4.20,4.40,4.60,4.80,5.00,10.0,100.,1000.,
     /10000.,100000./
      DATA YVIB3/0.00,0.52,0.63,0.61,0.53,0.43,0.27,0.16,0.10,.069,
     /.050,.039,.031,.025,.021,.017,.015,.013,.011,.010,
     /.0088,.0079,.0071,.0064,.0058,.0053,.0048,.003,.0003,.00003,
     /.000003,.0000003/
      DATA XVIB4/.4205,0.50,0.60,0.70,0.80,0.90,1.00,1.20,1.40,1.60,
     /1.80,2.00,2.20,2.50,3.00,3.50,4.00,4.50,4.90,10.0,
     /100.,1000.,10000.,100000./
      DATA YVIB4/0.00,0.18,0.21,0.21,0.18,0.15,0.11,.060,.034,.023,
     /.016,.013,.010,.0078,.0052,.0038,.0028,.0022,.0018,.001,
     /.0001,.00001,.000001,.0000001/
      DATA XION/15.69,16.54,16.56,16.83,17.4,18.2,19.6,21.8,25.5,28.6,
     /35.4,42.5,52.1,66.6,94.0,118.,176.,269.,381.,507.,
     /720.,937.,10000.,100000./
      DATA YION/0.0,.0103,.015,.0255,.0413,.066,.106,.172,.302,.436,
     /.628,.783,.934,1.066,1.18,1.22,1.18,1.04,.865,.721,
     /.572,.473,0.05,0.005/
      DATA XATT/0.00,0.01,0.02,0.03,0.04,0.05,0.07,0.10,0.15,0.20,
     /0.25,0.30,0.35,0.40,0.45,0.50,0.60,0.70,0.80,0.90,
     /1.00,1.20,1.40,1.60,1.80,2.00,2.20,2.40,2.60,2.80,
     /3.00,3.20,3.40,3.60,3.80,4.00,4.20,4.40,4.60,4.80,
     /5.00,5.20,5.40,5.60,5.80,6.00,6.20,6.40,6.60,6.80,
     /7.00,7.20,7.40,7.60,7.80,8.00,8.20,8.40,8.60,8.80,
     /10.0,100.,1000.,10000.,100000./
      DATA YATT/80.0,44.4,24.7,13.7,8.20,7.40,7.10,6.50,5.45,4.80,
     /4.25,3.65,3.10,2.65,2.25,1.92,1.34,0.94,.655,.455,
     /.320,.153,.075,.036,.022,.014,.012,.011,.010,.0097,
     /.0093,.0082,.0069,.0056,.0046,.0039,.0035,.0036,.0038,.0042,
     /.0046,.0052,.0057,.0063,.0068,.0069,.0070,.0069,.0064,.0058,
     /.0052,.0049,.0040,.0035,.0030,.0025,.0021,.0017,.0014,.0012,
     /.0004,.00004,.000004,.0000004,.00000004/
      DATA XEXC1/3.16,4.00,4.20,4.60,5.60,6.00,7.00,8.00,10.0,15.0,
     /20.0,27.0,34.0,40.0,100.,1000.,10000.,100000./
      DATA YEXC1/0.0,.065,0.10,.145,0.20,0.22,0.23,0.22,0.20,0.14,
     /.107,.080,.060,.048,.024,.003,.0003,.00003/
      DATA XEXC2/4.34,5.00,6.00,7.00,8.00,10.0,14.7,20.0,25.0,40.0,
     /54.0,60.0,80.0,100.,1000.,10000.,100000./
      DATA YEXC2/0.00,0.04,0.06,.074,.080,.074,.060,.047,.040,.025,
     /.020,.017,.013,.010,.001,.0001,.00001/
      DATA XEXC3/11.57,11.73,12.62,14.0,17.0,18.7,21.6,25.8,31.1,39.5,
     /51.9,78.4,142.,235.,396.,959.,10000.,100000./
      DATA YEXC3/0.00,.0102,.0301,.0791,.232,.301,.373,.445,.502,.524,
     /.510,.477,.373,.282,.204,.119,.012,.0012/
      DATA XEXC4/13.08,19.25,20.4,23.8,28.6,34.6,43.0,53.4,68.2,90.6,
     /121.,180.,284.,427.,970.,10000.,100000./
      DATA YEXC4/.0,.0104,.0144,.025,.0396,.0552,.0666,.0722,.074,.0734,
     /.0693,.0588,.0442,.033,.0176,.0018,.00018/
      NAME=' F2   MORGAN   '
C ---------------------------------------------------------------------
C    COPIED FROM W.L.MORGAN
C ---------------------------------------------------------------------
      NIN=9
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      NDATA=29
      NION=24
      NATT=65
      NVIB1=55
      NVIB2=54
      NVIB3=32
      NVIB4=24
      NEXC1=18
      NEXC2=17
      NEXC3=18
      NEXC4=17
      E(1)=0.0
      E(2)=2.0*EMASS/(38.00000*AMU)
      E(3)=15.69
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=15.69
      EIN(1)=-0.1108
      EIN(2)=0.1108
      EIN(3)=0.2188
      EIN(4)=0.3237
      EIN(5)=0.4205
      EIN(6)=3.16
      EIN(7)=4.34
      EIN(8)=11.57
      EIN(9)=13.08
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       FLOURINE       '
      SCRPT(3)=' IONISATION    ELOSS= 15.69   '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' VIB V1        ELOSS= -0.1108 '
      SCRPT(8)=' VIB V1        ELOSS=  0.1108 '
      SCRPT(9)=' VIB 2V1       ELOSS=  0.2188 '
      SCRPT(10)=' VIB 3V1       ELOSS=  0.3237 '
      SCRPT(11)=' VIB 4V1       ELOSS=  0.4205 '
      SCRPT(12)=' EXC           ELOSS=  3.16   '
      SCRPT(13)=' EXC           ELOSS=  4.34   '
      SCRPT(14)=' EXC           ELOSS= 11.57   '
      SCRPT(15)=' EXC           ELOSS= 13.08   '
      APOP=DEXP(EIN(1)/AKT)
      EN=-ESTEP/2.0
      DO 1000 I=1,NSTEP
      EN=EN+ESTEP
      DO 10 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 20
   10 CONTINUE
      J=NDATA
   20 A=(YXSEC(J)-YXSEC(J-1))/(XEN(J)-XEN(J-1))
      B=(XEN(J-1)*YXSEC(J)-XEN(J)*YXSEC(J-1))/(XEN(J-1)-XEN(J))
      Q(2,I)=(A*EN+B)*1.D-16
      Q(3,I)=0.0
      IF(EN.LT.E(3)) GO TO 200
      DO 110 J=2,NION
      IF(EN.LE.XION(J)) GO TO 120
  110 CONTINUE
      J=NION
  120 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
  200 Q(4,I)=0.0
      IF(EN.GE.XATT(NATT)) GO TO 300
      DO 210 J=2,NATT
      IF(EN.LE.XATT(J)) GO TO 220
  210 CONTINUE
      J=NATT
  220 A=(YATT(J)-YATT(J-1))/(XATT(J)-XATT(J-1))
      B=(XATT(J-1)*YATT(J)-XATT(J)*YATT(J-1))/(XATT(J-1)-XATT(J))
      Q(4,I)=(A*EN+B)*1.D-16
  300 Q(5,I)=0.0
      Q(6,I)=0.0
C
C SUPERELASTIC V1
      QIN(1,I)=0.0
      IF(EN.LE.0.0) GO TO 305
      DO 301 J=2,NVIB1
      IF((EN+EIN(2)).LE.XVIB1(J)) GO TO 302
  301 CONTINUE
      J=NVIB1
  302 A=(YVIB1(J)-YVIB1(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB1(J)-XVIB1(J)*YVIB1(J-1))/(XVIB1(J-1)-XVIB1(J))
      QIN(1,I)=(EN+EIN(2))*(A*(EN+EIN(2))+B)*1.D-16/EN
      QIN(1,I)=QIN(1,I)*APOP/(1.0+APOP)
  305 CONTINUE
C V1
      QIN(2,I)=0.0
      IF(EN.LE.EIN(2)) GO TO 400
      DO 310 J=2,NVIB1
      IF(EN.LE.XVIB1(J)) GO TO 320
  310 CONTINUE
      J=NVIB1
  320 A=(YVIB1(J)-YVIB1(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB1(J)-XVIB1(J)*YVIB1(J-1))/(XVIB1(J-1)-XVIB1(J))
      QIN(2,I)=(A*EN+B)*1.D-16
      QIN(2,I)=QIN(2,I)/(1.0+APOP)
  400 CONTINUE
C 2V1
      QIN(3,I)=0.0
      IF(EN.LE.EIN(3)) GO TO 500
      DO 410 J=2,NVIB2
      IF(EN.LE.XVIB2(J)) GO TO 420
  410 CONTINUE
      J=NVIB2
  420 A=(YVIB2(J)-YVIB2(J-1))/(XVIB2(J)-XVIB2(J-1))
      B=(XVIB2(J-1)*YVIB2(J)-XVIB2(J)*YVIB2(J-1))/(XVIB2(J-1)-XVIB2(J))
      QIN(3,I)=(A*EN+B)*1.D-16
  500 CONTINUE
C 3V1
      QIN(4,I)=0.0
      IF(EN.LE.EIN(4)) GO TO 600
      DO 510 J=2,NVIB3
      IF(EN.LE.XVIB3(J)) GO TO 520
  510 CONTINUE
      J=NVIB3
  520 A=(YVIB3(J)-YVIB3(J-1))/(XVIB3(J)-XVIB3(J-1))
      B=(XVIB3(J-1)*YVIB3(J)-XVIB3(J)*YVIB3(J-1))/(XVIB3(J-1)-XVIB3(J))
      QIN(4,I)=(A*EN+B)*1.D-16
  600 CONTINUE
C 4V1
      QIN(5,I)=0.0
      IF(EN.LE.EIN(5)) GO TO 700
      DO 610 J=2,NVIB4
      IF(EN.LE.XVIB4(J)) GO TO 620
  610 CONTINUE
      J=NVIB4
  620 A=(YVIB4(J)-YVIB4(J-1))/(XVIB4(J)-XVIB4(J-1))
      B=(XVIB4(J-1)*YVIB4(J)-XVIB4(J)*YVIB4(J-1))/(XVIB4(J-1)-XVIB4(J))
      QIN(5,I)=(A*EN+B)*1.D-16
  700 CONTINUE
C
      QIN(6,I)=0.0
      IF(EN.LE.EIN(6)) GO TO 800
      DO 710 J=2,NEXC1
      IF(EN.LE.XEXC1(J)) GO TO 720
  710 CONTINUE
      J=NEXC1
  720 A=(YEXC1(J)-YEXC1(J-1))/(XEXC1(J)-XEXC1(J-1))
      B=(XEXC1(J-1)*YEXC1(J)-XEXC1(J)*YEXC1(J-1))/(XEXC1(J-1)-XEXC1(J))
      QIN(6,I)=(A*EN+B)*1.D-16
  800 CONTINUE
C
      QIN(7,I)=0.0
      IF(EN.LE.EIN(7)) GO TO 900
      DO 810 J=2,NEXC2
      IF(EN.LE.XEXC2(J)) GO TO 820
  810 CONTINUE
      J=NEXC2
  820 A=(YEXC2(J)-YEXC2(J-1))/(XEXC2(J)-XEXC2(J-1))
      B=(XEXC2(J-1)*YEXC2(J)-XEXC2(J)*YEXC2(J-1))/(XEXC2(J-1)-XEXC2(J))
      QIN(7,I)=(A*EN+B)*1.D-16
  900 CONTINUE
C
      QIN(8,I)=0.0
      IF(EN.LE.EIN(8)) GO TO 990
      DO 910 J=2,NEXC3
      IF(EN.LE.XEXC3(J)) GO TO 920
  910 CONTINUE
      J=NEXC3
  920 A=(YEXC3(J)-YEXC3(J-1))/(XEXC3(J)-XEXC3(J-1))
      B=(XEXC3(J-1)*YEXC3(J)-XEXC3(J)*YEXC3(J-1))/(XEXC3(J-1)-XEXC3(J))
      QIN(8,I)=(A*EN+B)*1.D-16
  990 CONTINUE
C
      QIN(9,I)=0.0
      IF(EN.LE.EIN(9)) GO TO 1990
      DO 1910 J=2,NEXC4
      IF(EN.LE.XEXC4(J)) GO TO 1920
 1910 CONTINUE
      J=NEXC4
 1920 A=(YEXC4(J)-YEXC4(J-1))/(XEXC4(J)-XEXC4(J-1))
      B=(XEXC4(J-1)*YEXC4(J)-XEXC4(J)*YEXC4(J-1))/(XEXC4(J-1)-XEXC4(J))
      QIN(9,I)=(A*EN+B)*1.D-16
 1990 CONTINUE
C
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+QIN(1,I)+QIN(2,I)+QIN(3,I)+QIN(4,I)+
     /QIN(5,I)+QIN(6,I)+QIN(7,I)+QIN(8,I)+QIN(9,I)
 1000 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(9)) NIN=8
      IF(EFINAL.LE.EIN(8)) NIN=7
      IF(EFINAL.LE.EIN(7)) NIN=6
      IF(EFINAL.LE.EIN(6)) NIN=5
      IF(EFINAL.LE.EIN(5)) NIN=4
      IF(EFINAL.LE.EIN(4)) NIN=3
      IF(EFINAL.LE.EIN(3)) NIN=2
      IF(EFINAL.LE.EIN(2)) NIN=1
      IF(EFINAL.LE.EIN(1)) NIN=0
      RETURN
      END
      SUBROUTINE GAS39(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      DIMENSION XEN(30),YXSEC(30),XVIB1(39),YVIB1(39),
     /XVIB2(34),YVIB2(34),XEXC(18),YEXC(18),XION(69),YION(69),
     /XATT(30),YATT(30),XAT1(9),YAT1(9)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
C  ELASTIC
      DATA XEN/0.00,0.01,0.02,0.04,0.07,0.10,0.15,0.20,0.30,0.50,
     /0.80,1.00,1.20,1.50,1.80,2.20,3.00,3.50,5.00,8.00,
     /10.0,12.0,15.0,20.0,30.0,40.0,100.,1000.,10000.,100000./
      DATA YXSEC/99.0,90.0,80.0,58.0,45.0,36.5,28.5,23.0,16.0,9.82,
     /7.62,8.61,11.6,14.3,20.0,23.8,27.6,28.1,26.4,28.1,
     /29.2,29.2,26.4,17.1,9.90,6.50,2.70,0.27,.027,.0027/
C  VIBRATION V2 (010) BENDING
      DATA XVIB1/.0490,0.05,.055,0.06,0.07,0.08,0.09,0.10,0.12,0.14,
     /0.17,0.20,0.25,0.30,0.35,0.40,0.50,0.60,0.80,1.00,
     /1.20,1.40,1.70,2.00,2.50,3.00,3.50,4.00,5.00,6.00,
     /8.00,10.0,15.0,20.0,40.0,100.,1000.,10000.,100000./
      DATA YVIB1/0.00,2.40,10.0,18.5,21.0,22.0,21.0,19.5,14.0,10.0,
     /7.00,5.00,3.20,2.10,1.50,1.20,0.90,0.78,0.60,0.50,
     /0.43,0.39,0.33,0.29,0.25,0.22,0.25,0.32,0.40,0.45,
     /0.20,0.10,.075,.052,.032,.013,.0013,.00013,.000013/
C  VIBRATION V1  (100) SYMMETRIC STRETCH
      DATA XVIB2/.0810,0.09,0.10,0.11,0.12,0.13,0.15,0.17,0.20,0.25,
     /0.30,0.35,0.40,0.50,0.60,0.80,1.00,1.20,1.40,1.70,
     /2.00,2.50,3.00,3.50,4.00,5.00,6.00,8.00,10.0,20.0,
     /100.,1000.,10000.,100000./
      DATA YVIB2/0.00,2.50,6.00,7.50,8.00,7.50,5.80,4.20,2.50,1.50,
     /1.05,0.74,0.58,0.40,0.29,0.16,0.12,0.10,0.10,.125,
     /.165,0.27,0.43,0.51,0.49,0.20,0.12,0.07,.057,.033,
     /.008,.0008,.00008,.000008/
C VIBRATION V3  (001) ASYMMETRIC STRETCH : USED DIPOLE EXCITATION FUNC.
C
C IONISATION
      DATA XION/10.07,10.5,11.0,11.5,12.0,12.5,13.0,13.5,14.0,14.5,
     /15.0,15.5,16.0,16.5,17.0,18.0,19.0,20.0,21.0,22.0,
     /23.0,24.0,26.0,28.0,30.0,32.0,34.0,36.0,38.0,40.0,
     /45.0,50.0,55.0,60.0,65.0,70.0,75.0,80.0,90.0,100.,
     /120.,140.,160.,180.,200.,220.,240.,250.,300.,350.,
     /400.,450.,500.,550.,600.,650.,700.,800.,900.,1000.,
     /1500.,2000.,2500.,3000.,5000.,10000.,20000.,40000.,100000./
      DATA YION/0.00,.192,.421,.652,.880,1.10,1.32,1.53,1.72,1.92,
     /2.20,2.48,2.74,3.03,3.31,3.84,4.34,4.83,5.28,5.69,
     /6.06,6.40,6.99,7.48,7.90,8.26,8.58,8.84,9.05,9.23,
     /9.53,9.69,9.75,9.74,9.68,9.59,9.47,9.34,9.06,8.76,
     /8.17,7.63,7.14,6.71,6.33,5.99,5.69,5.55,4.96,4.48,
     /4.10,3.79,3.52,3.29,3.09,2.92,2.76,2.50,2.29,2.12,
     /1.56,1.28,1.10,0.94,0.66,0.42,0.24,.134,.069/
C ATTACHMENT CS2 -  (PROBABLY 3 BODY MORMALISED AT 40 TORR)
      DATA XAT1/.0001,.001,0.01,.017,.025,0.03,.035,0.04,10.0/
      DATA YAT1/35.0,35.0,28.0,20.0,10.0,5.00,1.50,.00001,.0000001/
C DISOCIATIVE ATTACHMENT    UNITS OF 10**-19
      DATA XATT/2.41,2.50,2.60,2.70,2.80,3.00,3.20,3.35,3.60,3.70,
     /3.80,4.00,4.20,4.40,5.40,5.50,5.75,6.00,6.25,6.50,
     /6.75,7.00,7.50,7.75,8.00,8.25,8.50,10.0,100.,100000./
      DATA YATT/0.00,0.01,0.02,0.04,0.08,0.40,2.00,3.70,3.00,3.10,
     /2.70,1.50,0.40,0.01,0.01,0.10,0.50,1.45,1.80,0.90,
     /0.30,0.20,0.30,0.90,0.50,0.10,0.01,0.01,.001,.0001/
C  EXCITATION
      DATA XEXC/6.20,7.00,8.00,9.00,10.0,11.0,12.0,14.0,17.0,20.0,
     /30.0,40.0,60.0,80.0,100.,1000.,10000.,100000./
      DATA YEXC/0.00,0.60,1.50,3.30,5.20,7.00,8.00,8.80,9.20,8.90,
     /8.00,7.40,6.30,5.50,5.00,0.50,0.05,.005/
C ----------------------------------------------------------------
C LACK OF ELECTRON DRIFT DATA .
C USED SOHNS ELECTRON SCATTERING DATA AND UNPUBLISHED DATA BY ALLEN.
C  THE ATTACHMENT IS PROBABLY 3 BODY EXCEPT FOR THE DISOCIATIVE
C   ATTACHMENT.
C  THE 3-BODY X-SECTION  CORRESPONDS TO 40 TORR PRESSURE
C ---------------------------------------------------------------
      NAME=' CS2  -2001--- '
C
      NIN=6
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      NDATA=30
      NVIB1=39
      NVIB2=34
      NION=69
      NATT=30
      NAT1=9
      NEXC=18
      E(1)=0.0
      E(2)=2.0*EMASS/(76.1427*AMU)
      E(3)=10.07
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=10.07
      EIN(1)=-0.049
      EIN(2)=0.049
      EIN(3)=-0.081
      EIN(4)=0.081
      EIN(5)=0.190
      EIN(6)=6.20
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       CS2            '
      SCRPT(3)=' IONISATION    ELOSS= 10.07   '
      SCRPT(4)=' ATTACHMENT  (ASSUMED 2 BODY) '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' VIB V2        ELOSS= -0.049  '
      SCRPT(8)=' VIB V2        ELOSS=  0.049  '
      SCRPT(9)=' VIB V1        ELOSS= -0.081  '
      SCRPT(10)=' VIB V1        ELOSS=  0.081  '
      SCRPT(11)=' VIB V3        ELOSS=  0.190  '
      SCRPT(12)=' EXC           ELOSS=  6.20   '
      APOPV2=DEXP(EIN(1)/AKT)
      APOPV1=DEXP(EIN(3)/AKT)
      EN=-ESTEP/2.0
      DO 9000 I=1,NSTEP
      EN=EN+ESTEP
      DO 10 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 20
   10 CONTINUE
      J=NDATA
   20 A=(YXSEC(J)-YXSEC(J-1))/(XEN(J)-XEN(J-1))
      B=(XEN(J-1)*YXSEC(J)-XEN(J)*YXSEC(J-1))/(XEN(J-1)-XEN(J))
      Q(2,I)=(A*EN+B)*1.0D-16
   30 Q(3,I)=0.0
      IF(EN.LT.E(3)) GO TO 200
      DO 110 J=2,NION
      IF(EN.LE.XION(J)) GO TO 120
  110 CONTINUE
      J=NION
  120 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
C
  200 Q(4,I)=0.0
      IF(EN.LT.XAT1(1)) GO TO 250
      IF(EN.GT.XAT1(NAT1)) GO TO 250
      DO 210 J=2,NAT1
      IF(EN.LE.XAT1(J)) GO TO 220
  210 CONTINUE
      J=NAT1
  220 A=(YAT1(J)-YAT1(J-1))/(XAT1(J)-XAT1(J-1))
      B=(XAT1(J-1)*YAT1(J)-XAT1(J)*YAT1(J-1))/(XAT1(J-1)-XAT1(J))
      Q(4,I)=(A*EN+B)*1.D-16*1.3
  250 CONTINUE
      IF(EN.LT.XATT(1)) GO TO 300
      IF(EN.GT.XATT(NATT)) GO TO 300
      DO 260 J=2,NATT
      IF(EN.LE.XATT(J)) GO TO 270
  260 CONTINUE
      J=NATT
  270 A=(YATT(J)-YATT(J-1))/(XATT(J)-XATT(J-1))
      B=(XATT(J-1)*YATT(J)-XATT(J)*YATT(J-1))/(XATT(J-1)-XATT(J))
      Q(4,I)=Q(4,I)+(A*EN+B)*1.D-19
  300 Q(5,I)=0.0
      Q(6,I)=0.0
C			
C SUPERELASTIC V2 BENDING MODE
C
      QIN(1,I)=0.0
      IF(EN.EQ.0.0) GO TO 340
      DO 310 J=2,NVIB1
      IF((EN+EIN(2)).LE.XVIB1(J)) GO TO 320
  310 CONTINUE
      J=NVIB1
  320 A=(YVIB1(J)-YVIB1(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB1(J)-XVIB1(J)*YVIB1(J-1))/(XVIB1(J-1)-XVIB1(J))
      QIN(1,I)=(EN+EIN(2))*(A*(EN+EIN(2))+B)*1.D-16/EN
      QIN(1,I)=QIN(1,I)*APOPV2/(1.0+APOPV2)
  340 CONTINUE
C
C VIBRATION V2 BENDING MODE
      QIN(2,I)=0.0
      IF(EN.LE.EIN(2)) GO TO 400
      DO 350 J=2,NVIB1
      IF(EN.LE.XVIB1(J)) GO TO 360
  350 CONTINUE
      J=NVIB1
  360 A=(YVIB1(J)-YVIB1(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB1(J)-XVIB1(J)*YVIB1(J-1))/(XVIB1(J-1)-XVIB1(J))
      QIN(2,I)=(A*EN+B)*1.D-16
      QIN(2,I)=QIN(2,I)/(1.0+APOPV2)
  400 CONTINUE
C
C SUPERELASTIC OF V1 SYMMETRIC STRETCH VIBRATION
C
      QIN(3,I)=0.0
      IF(EN.EQ.0.0) GO TO 440
      DO 410 J=2,NVIB2
      IF((EN+EIN(4)).LE.XVIB2(J)) GO TO 420
  410 CONTINUE
      J=NVIB2
  420 A=(YVIB2(J)-YVIB2(J-1))/(XVIB2(J)-XVIB2(J-1))
      B=(XVIB2(J-1)*YVIB2(J)-XVIB2(J)*YVIB2(J-1))/(XVIB2(J-1)-XVIB2(J))
      QIN(3,I)=(EN+EIN(4))*(A*(EN+EIN(4))+B)*1.D-16/EN
      QIN(3,I)=QIN(3,I)*APOPV1/(1.0+APOPV1)
  440 CONTINUE
C
C VIBRATION V3 SYMMETRIC STRETCH
      QIN(4,I)=0.0
      IF(EN.LE.EIN(4)) GO TO 500
      DO 450 J=2,NVIB2
      IF(EN.LE.XVIB2(J)) GO TO 460
  450 CONTINUE
      J=NVIB2
  460 A=(YVIB2(J)-YVIB2(J-1))/(XVIB2(J)-XVIB2(J-1))
      B=(XVIB2(J-1)*YVIB2(J)-XVIB2(J)*YVIB2(J-1))/(XVIB2(J-1)-XVIB2(J))
      QIN(4,I)=(A*EN+B)*1.D-16
      QIN(4,I)=QIN(4,I)/(1.0+APOPV1)
  500 CONTINUE
C
C  VIBRATION V3 ASYMMETRIC STRETCH
      QIN(5,I)=0.0
      IF(EN.LE.EIN(5)) GO TO 600
      EFAC=DSQRT(1.0-(EIN(5)/EN))
      QIN(5,I)=0.710*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      QIN(5,I)=QIN(5,I)*1.D-16
  600 CONTINUE
C
C EXCITATION (DISOCIATION)
      QIN(6,I)=0.0
      IF(EN.LE.EIN(6)) GO TO 900
      DO 810 J=2,NEXC
      IF(EN.LE.XEXC(J)) GO TO 820
  810 CONTINUE
      J=NEXC
  820 A=(YEXC(J)-YEXC(J-1))/(XEXC(J)-XEXC(J-1))
      B=(XEXC(J-1)*YEXC(J)-XEXC(J)*YEXC(J-1))/(XEXC(J-1)-XEXC(J))
      QIN(6,I)=(A*EN+B)*1.D-16
  900 CONTINUE
C
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+QIN(1,I)+QIN(2,I)+QIN(3,I)+QIN(4,I)+
     /QIN(5,I)+QIN(6,I)
 9000 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(6)) NIN=5
      IF(EFINAL.LE.EIN(5)) NIN=4
      RETURN
      END
      SUBROUTINE GAS40(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      DIMENSION XEN(34),YXSEC(34),XVIB1(40),YVIB1(40),
     /XVIB2(39),YVIB2(39),XVIB3(31),YVIB3(31),
     /XVIB4(14),YVIB4(14),XVIB5(22),YVIB5(22),XVIB6(22),YVIB6(22),
     /XEXC(17),YEXC(17),XION(70),YION(70),XATT(20),YATT(20)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
C  ELASTIC
      DATA XEN/1.D-6,.001,0.01,0.10,0.15,0.20,0.30,0.40,0.50,0.60,
     /0.70,0.80,1.00,1.20,1.50,1.70,2.00,2.50,3.00,4.00,
     /5.00,7.00,10.0,15.0,20.0,30.0,40.0,60.0,80.0,100.,
     /200.,1000.,10000.,100000./
      DATA YXSEC/1.9D3,1.9D3,190.,19.0,11.5,9.00,7.20,7.40,7.70,8.00,
     /8.40,8.80,10.0,10.7,10.0,9.50,9.00,10.0,11.5,14.5,
     /15.0,15.5,16.0,14.5,13.0,9.00,6.50,4.00,2.60,2.00,
     /1.00,0.20,0.02,.002/
C  VIBRATION V2 (010)   BENDING
      DATA XVIB1/.064,0.07,0.08,0.09,0.10,0.12,0.14,0.17,0.20,0.24,
     /0.28,0.32,0.36,0.40,0.45,0.50,0.60,0.70,0.80,0.90,
     /1.00,1.10,1.15,1.20,1.30,1.50,1.70,2.00,2.50,3.00,
     /4.00,5.00,6.00,7.00,8.00,10.0,100.,1000.,10000.,100000./
      DATA YVIB1/0.00,2.75,4.20,4.80,4.80,4.50,3.50,2.60,2.10,1.60,
     /1.35,1.15,1.05,1.00,1.00,1.05,1.15,1.40,1.85,2.30,
     /2.80,3.40,3.80,3.80,3.30,2.20,1.30,0.80,0.35,0.25,
     /0.21,.165,0.14,.125,0.11,0.09,.013,.0013,.00013,.000013/
C  VIBRATION V1 (100) SYMMETRIC STRETCH
      DATA XVIB2/.107,0.11,0.12,0.13,0.14,0.15,0.16,0.18,0.20,0.22,
     /0.25,0.30,0.35,0.40,0.50,0.60,0.70,0.80,0.90,1.00,
     /1.10,1.15,1.20,1.30,1.50,2.00,2.50,3.00,3.50,4.00,
     /4.50,5.00,6.00,8.00,10.0,100.,1000.,10000.,100000./
      DATA YVIB2/0.00,0.30,0.56,0.68,0.75,0.78,0.81,0.81,0.75,0.64,
     /0.58,0.50,0.47,0.46,0.46,0.50,0.55,0.70,0.90,1.15,
     /1.40,1.50,1.50,1.30,0.90,0.50,0.40,0.40,0.68,0.84,
     /0.65,0.48,0.30,0.24,0.21,.021,.0021,.00021,.000021/
C VIBRATION HARMONIC   2V2 (020)  BENDING
      DATA XVIB3/.128,0.13,0.14,0.15,0.16,0.18,0.20,0.22,0.25,0.30,
     /0.40,0.50,0.60,0.70,0.80,0.90,1.00,1.10,1.15,1.20,
     /1.30,1.50,1.70,2.00,3.00,5.00,10.0,100.,1000.,10000.,
     /100000./
      DATA YVIB3/0.00,1.07,2.40,3.00,3.35,3.70,3.75,3.50,2.75,1.95,
     /1.35,1.20,1.30,1.50,1.90,2.40,2.80,3.50,3.90,3.90,
     /3.60,2.50,1.50,0.90,0.20,.035,0.01,.001,.0001,.00001,
     /.000001/
C VIBRATION V3 (001) ASYMMETRIC STRETCH  ( RESONANCE PART ONLY)
      DATA XVIB4/.256,0.70,0.80,0.90,1.00,1.10,1.15,1.20,1.30,1.50,
     /1.70,2.00,10.0,100000./
      DATA YVIB4/0.00,0.02,0.60,1.50,2.60,3.00,3.50,3.50,3.00,1.80,
     /0.90,0.08,0.001,.000002/
C VIBRATION SUM OF HARMONICS  NV1
      DATA XVIB5/0.38,0.70,0.80,0.90,1.00,1.10,1.15,1.20,1.30,1.50,
     /1.70,2.00,3.00,3.50,4.00,4.50,5.00,6.00,10.0,100.,
     /1000.,100000./
      DATA YVIB5/0.00,.001,0.04,0.12,0.20,0.26,0.30,0.30,0.26,0.20,
     /0.12,0.02,0.05,0.10,0.15,0.10,0.05,0.02,0.01,.001,
     /.0001,.0000001/
C VIBRATION SUM OF HIGHER HARMONICS (0.512)
      DATA XVIB6/.512,0.70,0.80,0.90,1.00,1.10,1.15,1.20,1.30,1.50,
     /1.70,2.00,3.00,3.50,4.00,4.50,5.00,6.00,10.0,100.,
     /1000.,100000./
      DATA YVIB6/0.00,.001,0.03,0.08,0.13,0.17,0.20,0.20,0.17,0.13,
     /0.08,0.02,0.03,0.07,0.10,0.07,0.03,0.02,0.01,.001,
     /.0001,.0000001/
C IONISATION
      DATA XION/11.19,11.5,12.0,12.5,13.0,13.5,14.0,14.5,15.0,15.5,
     /16.0,16.5,17.0,17.5,18.0,18.5,19.0,19.5,20.0,21.0,
     /22.0,23.0,24.0,26.0,28.0,30.0,32.0,34.0,36.0,38.0,
     /40.0,45.0,50.0,55.0,60.0,65.0,70.0,75.0,80.0,90.0,
     /100.,110.,120.,140.,160.,180.,200.,250.,300.,350.,
     /400.,450.,500.,550.,600.,650.,700.,750.,800.,900.,
     /1000.,1500.,2000.,2500.,3000.,5000.,10000.,20000.,40000.,100000./
      DATA YION/0.00,.105,.279,.455,.630,.802,0.97,1.13,1.29,1.44,
     /1.58,1.72,1.85,1.99,2.14,2.28,2.43,2.58,2.73,3.01,
     /3.27,3.52,3.75,4.16,4.51,4.81,5.09,5.33,5.53,5.71,
     /5.85,6.14,6.33,6.44,6.50,6.53,6.52,6.50,6.46,6.34,
     /6.20,6.05,5.90,5.59,5.29,5.02,4.78,4.26,3.84,3.51,
     /3.23,2.99,2.79,2.62,2.47,2.34,2.22,2.11,2.01,1.85,
     /1.71,1.26,1.03,0.88,0.76,0.54,0.34,0.20,.108,.055/
      DATA XATT/0.94,1.00,1.10,1.20,1.25,1.30,1.40,1.50,1.60,1.70,
     /1.80,1.90,2.00,2.10,2.20,2.30,2.40,2.50,10.0,100000./
      DATA YATT/0.00,0.03,.182,.272,.290,.282,.263,.219,.151,.106,
     /.069,.042,.026,.015,.011,.005,.002,.001,.001,.0000001/
C  EXCITATION
      DATA XEXC/7.00,8.00,9.00,10.0,11.0,12.0,14.0,17.0,20.0,30.0,
     /40.0,60.0,80.0,100.,1000.,10000.,100000./
      DATA YEXC/0.0,0.60,1.40,2.80,4.00,5.00,5.75,6.10,6.00,5.40,
     /5.00,4.20,3.70,3.35,0.65,.065,.0065/
C ----------------------------------------------------------------
C  LACK OF ELECTRON DRIFT DATA.
C  USED SOHNS ELECTRON SCATTERING DATA .
C  POSSIBLE 3-BODY ATTACHMENT NOT YET INCLUDED .
C  3-BODY ATTACHMENT IS SMALLER THAN CARBON DISULPHIDE BUT MAY BE
C  SIGNIFICANT..
C ---------------------------------------------------------------
      NAME=' COS  -2001--- '
C
      NIN=10
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      NDATA=34
      NVIB1=40
      NVIB2=39
      NVIB3=31
      NVIB4=14
      NVIB5=22
      NVIB6=22
      NION=70
      NATT=20
      NEXC=17
      E(1)=0.0
      E(2)=2.0*EMASS/(60.0761*AMU)
      E(3)=11.19
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=11.19
      EIN(1)=-0.064
      EIN(2)=0.064
      EIN(3)=-0.107
      EIN(4)=0.107
      EIN(5)=-0.128
      EIN(6)=0.128
      EIN(7)=0.256
      EIN(8)=0.380
      EIN(9)=0.512
      EIN(10)=7.00
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       COS            '
      SCRPT(3)=' IONISATION    ELOSS= 11.19   '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' VIB V2        ELOSS= -0.064  '
      SCRPT(8)=' VIB V2        ELOSS=  0.064  '
      SCRPT(9)=' VIB V1        ELOSS= -0.107  '
      SCRPT(10)=' VIB V1        ELOSS=  0.107  '
      SCRPT(11)=' VIB 2V2       ELOSS= -0.128  '
      SCRPT(12)=' VIB 2V2       ELOSS=  0.128  '
      SCRPT(13)=' VIB V3        ELOSS=  0.256  '
      SCRPT(14)=' VIB NV1       ELOSS=  0.380  '
      SCRPT(15)=' VIB           ELOSS=  0.512  '
      SCRPT(16)=' EXC           ELOSS=  7.00   '
      APOPV2=DEXP(EIN(1)/AKT)
      APOPV1=DEXP(EIN(3)/AKT)
      APOP2V2=DEXP(EIN(5)/AKT)
      EN=-ESTEP/2.0
      DO 9000 I=1,NSTEP
      EN=EN+ESTEP
      IF(EN.EQ.0.0) Q(2,I)=1900.D-16
      IF(EN.EQ.0.0) GO TO 30
      DO 10 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 20
   10 CONTINUE
      J=NDATA
C USE LOG INTERPOLATION
   20 Y1=DLOG(YXSEC(J-1))
      Y2=DLOG(YXSEC(J))
      X1=DLOG(XEN(J-1))
      X2=DLOG(XEN(J))
      A=(Y2-Y1)/(X2-X1)
      B=(X1*Y2-X2*Y1)/(X1-X2)
      Q(2,I)=DEXP((A*DLOG(EN)+B))*1.0D-16
   30 Q(3,I)=0.0
      IF(EN.LT.E(3)) GO TO 200
      DO 110 J=2,NION
      IF(EN.LE.XION(J)) GO TO 120
  110 CONTINUE
      J=NION
  120 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
C
  200 Q(4,I)=0.0
      IF(EN.LT.XATT(1)) GO TO 300
      IF(EN.GT.XATT(NATT)) GO TO 300
      DO 210 J=2,NATT
      IF(EN.LE.XATT(J)) GO TO 220
  210 CONTINUE
      J=NATT
  220 A=(YATT(J)-YATT(J-1))/(XATT(J)-XATT(J-1))
      B=(XATT(J-1)*YATT(J)-XATT(J)*YATT(J-1))/(XATT(J-1)-XATT(J))
      Q(4,I)=(A*EN+B)*1.D-16
  300 Q(5,I)=0.0
      Q(6,I)=0.0
C			
C SUPERELASTIC V2 BENDING MODE
C
      QIN(1,I)=0.0
      IF(EN.EQ.0.0) GO TO 340
      DO 310 J=2,NVIB1
      IF((EN+EIN(2)).LE.XVIB1(J)) GO TO 320
  310 CONTINUE
      J=NVIB1
  320 A=(YVIB1(J)-YVIB1(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB1(J)-XVIB1(J)*YVIB1(J-1))/(XVIB1(J-1)-XVIB1(J))
      QIN(1,I)=(EN+EIN(2))*(A*(EN+EIN(2))+B)/EN
      QIN(1,I)=QIN(1,I)*APOPV2/(1.0+APOPV2)*1.D-16
  340 CONTINUE
C
C VIBRATION V2 BENDING MODE
C
      QIN(2,I)=0.0
      IF(EN.LE.EIN(2)) GO TO 400
      DO 350 J=2,NVIB1
      IF(EN.LE.XVIB1(J)) GO TO 360
  350 CONTINUE
      J=NVIB1
  360 A=(YVIB1(J)-YVIB1(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB1(J)-XVIB1(J)*YVIB1(J-1))/(XVIB1(J-1)-XVIB1(J))
      QIN(2,I)=(A*EN+B)
      QIN(2,I)=QIN(2,I)/(1.0+APOPV2)*1.D-16
  400 CONTINUE
C
C SUPERELASTIC OF VIBRATION V1 SYMMETRIC STRETCH
C
      QIN(3,I)=0.0
      IF(EN.EQ.0.0) GO TO 440
      DO 410 J=2,NVIB2
      IF((EN+EIN(4)).LE.XVIB2(J)) GO TO 420
  410 CONTINUE
      J=NVIB2
  420 A=(YVIB2(J)-YVIB2(J-1))/(XVIB2(J)-XVIB2(J-1))
      B=(XVIB2(J-1)*YVIB2(J)-XVIB2(J)*YVIB2(J-1))/(XVIB2(J-1)-XVIB2(J))
      QIN(3,I)=(EN+EIN(4))*(A*(EN+EIN(4))+B)/EN
      QIN(3,I)=QIN(3,I)*APOPV1/(1.0+APOPV1)*1.D-16
  440 CONTINUE
C
C VIBRATION V1 SYMMETRIC STRETCH
C
      QIN(4,I)=0.0
      IF(EN.LE.EIN(4)) GO TO 500
      DO 450 J=2,NVIB2
      IF(EN.LE.XVIB2(J)) GO TO 460
  450 CONTINUE
      J=NVIB2
  460 A=(YVIB2(J)-YVIB2(J-1))/(XVIB2(J)-XVIB2(J-1))
      B=(XVIB2(J-1)*YVIB2(J)-XVIB2(J)*YVIB2(J-1))/(XVIB2(J-1)-XVIB2(J))
      QIN(4,I)=(A*EN+B)
      QIN(4,I)=QIN(4,I)/(1.0+APOPV1)*1.D-16
  500 CONTINUE
C
C  SUPERELASTIC VIBRATION HARMONIC 2V2 BENDING MODE
C
      QIN(5,I)=0.0
      IF(EN.EQ.0.0) GO TO 540
      DO 510 J=2,NVIB3
      IF((EN+EIN(6)).LE.XVIB3(J)) GO TO 520
  510 CONTINUE
      J=NVIB3
  520 A=(YVIB3(J)-YVIB3(J-1))/(XVIB3(J)-XVIB3(J-1))
      B=(XVIB3(J-1)*YVIB3(J)-XVIB3(J)*YVIB3(J-1))/(XVIB3(J-1)-XVIB3(J))
      QIN(5,I)=(EN+EIN(6))*(A*(EN+EIN(6))+B)/EN
      QIN(5,I)=QIN(5,I)*APOP2V2/(1.0+APOP2V2)*1.D-16
  540 CONTINUE
C
C VIBRATION HARMONIC 2V2 BENDING MODE
C
      QIN(6,I)=0.0
      IF(EN.LE.EIN(6)) GO TO 600
      DO 550 J=2,NVIB3
      IF(EN.LE.XVIB3(J)) GO TO 560
  550 CONTINUE
      J=NVIB3
  560 A=(YVIB3(J)-YVIB3(J-1))/(XVIB3(J)-XVIB3(J-1))
      B=(XVIB3(J-1)*YVIB3(J)-XVIB3(J)*YVIB3(J-1))/(XVIB3(J-1)-XVIB3(J))
      QIN(6,I)=(A*EN+B)
      QIN(6,I)=QIN(6,I)/(1.0+APOP2V2)*1.D-16
  600 CONTINUE
C
C  VIBRATION V3 ASYMMETRIC STRETCH
C
      QIN(7,I)=0.0
      IF(EN.LE.EIN(7)) GO TO 700
      DO 610 J=2,NVIB4
      IF(EN.LE.XVIB4(J)) GO TO 620
  610 CONTINUE
      J=NVIB4
  620 A=(YVIB4(J)-YVIB4(J-1))/(XVIB4(J)-XVIB4(J-1))
      B=(XVIB4(J-1)*YVIB4(J)-XVIB4(J)*YVIB4(J-1))/(XVIB4(J-1)-XVIB4(J))
      EFAC=DSQRT(1.0-(EIN(7)/EN))
      QIN(7,I)=0.639*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      QIN(7,I)=(QIN(7,I)+(A*EN+B))*1.D-16
  700 CONTINUE
C
C  SUM OF HARMONICS NV1
C
      QIN(8,I)=0.0
      IF(EN.LE.EIN(8)) GO TO 740
      DO 710 J=2,NVIB5
      IF(EN.LE.XVIB5(J)) GO TO 720
  710 CONTINUE
      J=NVIB5
  720 A=(YVIB5(J)-YVIB5(J-1))/(XVIB5(J)-XVIB5(J-1))
      B=(XVIB5(J-1)*YVIB5(J)-XVIB5(J)*YVIB5(J-1))/(XVIB5(J-1)-XVIB5(J))
      QIN(8,I)=(A*EN+B)*1.D-16
  740 CONTINUE
C
C  SUM OF HIGHER HARMONICS (0.512)
C
      QIN(9,I)=0.0
      IF(EN.LE.EIN(9)) GO TO 800
      DO 750 J=2,NVIB6
      IF(EN.LE.XVIB6(J)) GO TO 760
  750 CONTINUE
      J=NVIB6
  760 A=(YVIB6(J)-YVIB6(J-1))/(XVIB6(J)-XVIB6(J-1))
      B=(XVIB6(J-1)*YVIB6(J)-XVIB6(J)*YVIB6(J-1))/(XVIB6(J-1)-XVIB6(J))
      QIN(9,I)=(A*EN+B)*1.D-16
  800 CONTINUE
C
C EXCITATION (DISOCIATION)
C
      QIN(10,I)=0.0
      IF(EN.LE.EIN(10)) GO TO 900
      DO 810 J=2,NEXC
      IF(EN.LE.XEXC(J)) GO TO 820
  810 CONTINUE
      J=NEXC
  820 A=(YEXC(J)-YEXC(J-1))/(XEXC(J)-XEXC(J-1))
      B=(XEXC(J-1)*YEXC(J)-XEXC(J)*YEXC(J-1))/(XEXC(J-1)-XEXC(J))
      QIN(10,I)=(A*EN+B)*1.D-16
  900 CONTINUE
C
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+QIN(1,I)+QIN(2,I)+QIN(3,I)+QIN(4,I)+
     /QIN(5,I)+QIN(6,I)+QIN(7,I)+QIN(8,I)+QIN(9,I)+QIN(10,I)
 9000 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(10)) NIN=9
      IF(EFINAL.LE.EIN(9)) NIN=8
      IF(EFINAL.LE.EIN(8)) NIN=7
      IF(EFINAL.LE.EIN(7)) NIN=6
      RETURN
      END
      SUBROUTINE GAS41(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      DIMENSION XEN(73),YXSEC(73),XVIB1(24),YVIB1(24),XVIB2(22),YVIB2(22
     /),XION(82),YION(82),XATT(14),YATT(14),XDIS1(32),YDIS1(32),
     /XDIS2(32),YDIS2(32),XDIS3(32),YDIS3(32),XDIS4(32),YDIS4(32),
     /YELAT(73),XVIB3(19),YVIB3(19),XVIB4(19),YVIB4(19)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      DATA XEN/0.00,.0001,.001,.004,.007,0.01,.012,.014,.017,0.02,
     /.025,0.03,.035,0.04,0.05,0.06,0.07,0.08,0.09,0.10,
     /0.12,0.14,0.17,0.20,0.24,0.28,0.32,0.36,0.40,0.45,
     /0.50,0.60,0.70,0.80,1.00,1.20,1.40,1.70,2.00,2.50,
     /3.00,3.50,4.00,5.00,6.00,7.00,8.00,9.00,10.0,12.0,
     /15.0,20.0,30.0,40.0,50.0,60.0,80.0,100.,150.,200.,
     /300.,400.,500.,600.,800.,1000.,2000.,4000.,6000.,8000.,
     /10000.,20000.,100000./
C ELASTIC MOMENTUM TRANSFER X-SECTION
      DATA YXSEC/26.7,25.4,22.7,18.9,16.6,14.9,14.0,13.1,12.1,11.1,
     /9.80,8.71,7.78,6.98,5.68,4.70,3.85,3.31,2.75,2.32,
     /1.72,1.23,0.78,.500,.330,.315,.340,.375,.430,.500,
     /.600,.810,1.05,1.29,1.80,2.15,2.55,3.25,4.05,5.80,
     /7.90,10.1,11.7,14.5,16.3,17.2,17.6,17.6,17.0,15.0,
     /13.0,8.50,4.70,3.40,2.50,2.10,1.55,1.20,0.66,0.44,
     /0.25,0.16,0.12,0.09,0.06,.045,.016,.006,.003,.002,
     /.001,.00025,.000015/
C ELASTIC TOTAL X-SECTION
      DATA YELAT/26.7,25.6,23.3,19.9,17.9,16.4,15.5,14.8,13.8,12.9,
     /11.6,10.6,9.67,8.89,7.60,6.57,5.60,4.90,4.20,3.70,
     /2.80,2.20,1.62,1.23,0.95,0.82,0.75,0.72,0.71,0.73,
     /0.77,0.95,1.10,1.28,1.72,2.25,3.00,4.00,5.00,7.32,
     /8.81,11.0,13.3,17.6,21.2,23.2,24.0,23.8,23.1,21.4,
     /19.7,15.6,11.2,8.55,7.20,6.09,4.74,3.89,2.55,2.00,
     /1.35,1.05,0.78,0.65,0.50,0.42,0.23,0.14,0.10,0.08,
     /.064,.030,.007/
      DATA XVIB1/.1234,0.20,0.30,0.40,0.50,0.60,0.80,1.00,2.00,3.00,
     /5.00,6.00,7.00,8.00,9.00,10.0,12.5,15.0,20.0,50.0,
     /100.0,1000.,10000.,100000./
      DATA YVIB1/0.00,.0001,.048,.054,.057,.059,.069,.079,.119,.152,
     /0.50,0.70,0.80,0.75,0.65,0.55,0.39,0.33,0.19,.077,
     /.044,0.004,.0004,.00004/
      DATA XVIB2/.275,0.40,0.50,0.60,0.80,1.00,2.00,3.00,5.00,6.00,
     /7.00,8.00,9.00,10.0,12.5,15.0,20.0,50.0,100.,1000.,
     /10000.,100000./
      DATA YVIB2/0.00,.006,.009,.010,.011,.013,.033,.090,0.50,0.70,
     /0.80,0.75,0.65,0.50,0.25,0.19,0.10,0.04,0.02,0.01,
     /.001,.0001/
      DATA XVIB3/.405,1.00,2.00,3.00,5.00,6.00,7.00,8.00,9.00,10.0,
     /12.5,15.0,17.5,20.0,50.0,100.,1000.,10000.,100000./
      DATA YVIB3/0.00,.001,.005,.027,.095,.125,.135,.135,.110,.080,
     /.055,.037,.028,.020,.008,.003,.0003,.00003,.000003/
      DATA XVIB4/.545,1.00,2.00,3.00,5.00,6.00,7.00,8.00,9.00,10.0,
     /12.5,15.0,17.5,20.0,50.0,100.,1000.,10000.,100000./
      DATA YVIB4/0.00,.0008,.004,.024,.080,.105,.115,.115,.095,.070,
     /.045,.027,.018,.010,.007,.003,.0003,.00003,.000003/
      DATA XION/12.99,13.5,14.0,14.5,15.0,15.5,16.0,16.5,17.0,17.5,
     /18.0,18.5,19.0,19.5,21.0,21.5,22.0,22.5,23.0,23.5,
     /24.0,26.0,28.0,30.0,32.0,34.0,36.0,38.0,40.0,45.0,
     /50.0,55.0,60.0,65.0,70.0,75.0,80.0,85.0,90.0,95.0,
     /100.,105.,110.,115.,120.,125.,130.,135.,140.,145.,
     /150.,160.,180.,200.,250.,300.,350.,400.,450.,500.,
     /550.,600.,650.,700.,750.,800.,850.,900.,950.,1000.,
     /1500.,2000.,3000.,4000.,5000.,7000.,10000.,12000.,15000.,20000.,
     /40000.,100000./
      DATA YION/0.00,.034,.074,0.13,.198,.278,.361,.445,.530,.610,
     /.706,.793,.880,.977,1.24,1.34,1.42,1.50,1.57,1.65,
     /1.72,1.97,2.20,2.38,2.54,2.68,2.79,2.91,3.02,3.21,
     /3.36,3.47,3.56,3.62,3.66,3.68,3.69,3.70,3.69,3.68,
     /3.66,3.63,3.62,3.59,3.55,3.52,3.48,3.45,3.41,3.38,
     /3.33,3.25,3.11,3.01,2.72,2.49,2.27,2.09,1.94,1.83,
     /1.72,1.63,1.54,1.47,1.40,1.34,1.28,1.24,1.20,1.18,
     /0.82,0.66,0.47,0.37,0.31,.235,.175,.151,.127,0.10,
     /.058,.028/
      DATA XATT/7.00,7.50,8.00,8.50,9.00,9.50,10.0,10.5,11.0,11.5,
     /12.0,12.5,13.0,13.5/
      DATA YATT/0.00,0.005,0.12,0.51,0.75,0.85,0.96,0.91,0.72,0.49,
     /0.27,0.13,0.06,0.00/
      DATA XDIS1/9.00,10.0,13.0,15.0,17.0,20.0,22.0,25.0,30.0,40.0,
     /50.0,60.0,70.0,80.0,100.,150.,200.,300.,400.,500.,
     /600.,800.,1000.,1500.,2000.,3000.,4000.,6000.,8000.,10000.,
     /20000.,100000./
      DATA YDIS1/0.00,0.27,0.27,0.36,0.45,0.53,0.58,0.59,0.58,0.57,
     /0.56,0.55,0.54,0.53,0.52,0.50,0.46,0.40,0.33,0.28,
     /0.24,0.18,0.14,.098,.075,.055,.040,.029,.022,.018,
     /.009,.0018/
      DATA XDIS2/10.0,11.0,13.0,15.0,17.0,20.0,22.0,25.0,30.0,40.0,
     /50.0,60.0,70.0,80.0,100.,150.,200.,300.,400.,500.,
     /600.,800.,1000.,1500.,2000.,3000.,4000.,6000.,8000.,10000.,
     /20000.,100000./
      DATA YDIS2/0.00,0.27,0.27,0.36,0.45,0.53,0.58,0.59,0.58,0.57,
     /0.56,0.55,0.54,0.53,0.52,0.50,0.46,0.40,0.33,0.28,
     /0.24,0.18,0.14,.098,.075,.055,.040,.029,.022,.018,
     /.009,.0018/
      DATA XDIS3/11.0,12.0,13.0,15.0,17.0,20.0,22.0,25.0,30.0,40.0,
     /50.0,60.0,70.0,80.0,100.,150.,200.,300.,400.,500.,
     /600.,800.,1000.,1500.,2000.,3000.,4000.,6000.,8000.,10000.,
     /20000.,100000./
      DATA YDIS3/0.00,0.27,0.27,0.36,0.45,0.53,0.58,0.59,0.58,0.57,
     /0.56,0.55,0.54,0.53,0.52,0.50,0.46,0.40,0.33,0.28,
     /0.24,0.18,0.14,.098,.075,.055,.040,.029,.022,.018,
     /.009,.0018/
      DATA XDIS4/11.8,12.0,13.0,15.0,17.0,20.0,22.0,25.0,30.0,40.0,
     /50.0,60.0,70.0,80.0,100.,150.,200.,300.,400.,500.,
     /600.,800.,1000.,1500.,2000.,3000.,4000.,6000.,8000.,10000.,
     /20000.,100000./
      DATA YDIS4/0.00,.045,0.27,0.36,0.45,0.53,0.58,0.59,0.58,0.57,
     /0.56,0.55,0.54,0.53,0.52,0.50,0.46,0.40,0.33,0.28,
     /0.24,0.18,0.14,.098,.075,.055,.040,.029,.022,.018,
     /.009,.0018/
C ---------------------------------------------------------------------
C SCALED VIBRATIONAL X-SECTIONS FROM METHANE (CH4) TO GIVE FIT TO DRIFT
C VELOCITY AND TRANSVERSE DIFFUSION IN DEUTERATED METHANE.
C NO MIXTURE DATA AVAILABLE.
C  REFS: DRIFT VELOCITY:
C        COTTRELL AND WALKER  TRANS.FARADAY.SOC. 61 (1585) 1965
C        TRANSVERSE DIFFUSION:
C        MILLICAN AND WALKER  J.PHYS.D 20 (193) 1987
C ---------------------------------------------------------------------
      NAME=' CD4    2004   '
C
      AVIB1=0.059
      AVIB2=0.050
      NIN=9
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
C USE ANISOTROPIC SCATTERING FOR ELASTIC AND COPY (OFFSET) TO IONISATION
      KEL(2)=1
      KEL(3)=1
C USE ANISOTROPIC SCATTERING FOR LEVEL 2 AND 3
      KIN(2)=1
      KIN(3)=1
C
      RAT=0.8
      NDATA=73
      NVIB1=24
      NVIB2=22
      NVIB3=19
      NVIB4=19
      NION=82
      NATT=14
      NDIS1=32
      NDIS2=32
      NDIS3=32
      NDIS4=32
      E(1)=0.0
      E(2)=2.0*EMASS/(20.0671*AMU)
      E(3)=12.99
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=7.3
      IOFF=IFIX(SNGL(0.5+E(3)/ESTEP))
      EIN(1)=-0.1234
      EIN(2)=0.1234
      EIN(3)=0.275
      EIN(4)=0.405
      EIN(5)=0.545
      EIN(6)=9.0
      EIN(7)=10.0
      EIN(8)=11.0
      EIN(9)=11.8
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC (ANIS)   CD4         '
      SCRPT(3)=' IONISATION    ELOSS= 12.99   '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' VIB V2+V4     ELOSS= -0.1234 '
      SCRPT(8)=' VIB V2+V4     ELOSS=  0.1234 '
      SCRPT(9)=' VIB V1+V3     ELOSS=  0.275  '
      SCRPT(10)=' VIB  HAR      ELOSS=  0.405  '
      SCRPT(11)=' VIB  HAR      ELOSS=  0.545  '
      SCRPT(12)=' EXC DISOCIATN ELOSS=  9.0    '
      SCRPT(13)=' EXC DISOCIATN ELOSS= 10.0    '
      SCRPT(14)=' EXC DISOCIATN ELOSS= 11.0    '
      SCRPT(15)=' EXC DISOCIATN ELOSS= 11.8    '
      APOP=DEXP(EIN(1)/AKT)
C     WRITE(6,99) APOP
C  99 FORMAT(3X,'APOP=',D12.3)
      EN=-ESTEP/2.0
      DO 1000 I=1,NSTEP
      EN=EN+ESTEP
C USE LOG INTERPOLATION FOR ELASTIC
      IF(EN.LE.XEN(2)) THEN
       QELA=26.7D-16
       QMOM=26.7D-16
       GO TO 30
      ENDIF
      DO 3 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 4
   3  CONTINUE
      J=NDATA
   4  YXJ=DLOG(YELAT(J))
      YXJ1=DLOG(YELAT(J-1))
      XNJ=DLOG(XEN(J))
      XNJ1=DLOG(XEN(J-1))
      A=(YXJ-YXJ1)/(XNJ-XNJ1)
      B=(XNJ1*YXJ-XNJ*YXJ1)/(XNJ1-XNJ)
      QELA=DEXP(A*DLOG(EN)+B)*1.D-16
      YXJ=DLOG(YXSEC(J))
      YXJ1=DLOG(YXSEC(J-1))
      A=(YXJ-YXJ1)/(XNJ-XNJ1)
      B=(XNJ1*YXJ-XNJ*YXJ1)/(XNJ1-XNJ)
      QMOM=DEXP(A*DLOG(EN)+B)*1.D-16
   30 CONTINUE
      PEQEL(2,I)=0.5+(QELA-QMOM)/QELA
      Q(2,I)=QELA
C
      Q(3,I)=0.0
      PEQEL(3,I)=0.5
      IF(EN.LT.E(3)) GO TO 200
      DO 110 J=2,NION
      IF(EN.LE.XION(J)) GO TO 120
  110 CONTINUE
      J=NION
  120 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
C   USE ANISOTROPIC SCATTERING FOR PRIMARY IONISATION ELECTRON FOR
C ENERGIES ABOVE 2 * IONISATION ENERGY
C  ANISOTROPIC DISTRIBUTION SAME AS ELASTIC AT ENERGY OFFSET BY
C  IONISATION ENERGY
      IF(EN.LE.(2.0*E(3))) GO TO 200
      PEQEL(3,I)=PEQEL(2,(I-IOFF))
C
  200 Q(4,I)=0.0
      IF(EN.LT.XATT(1)) GO TO 300
      IF(EN.GT.XATT(14)) GO TO 300
      DO 210 J=2,NATT
      IF(EN.LE.XATT(J)) GO TO 220
  210 CONTINUE
      J=NATT
  220 A=(YATT(J)-YATT(J-1))/(XATT(J)-XATT(J-1))
      B=(XATT(J-1)*YATT(J)-XATT(J)*YATT(J-1))/(XATT(J-1)-XATT(J))
      Q(4,I)=(A*EN+B)*1.D-19
  300 Q(5,I)=0.0
      Q(6,I)=0.0
C V4 + V2 SUPERELASTIC
      QIN(1,I)=0.0
      IF(EN.LE.0.0) GO TO 350
      DO 310 J=2,NVIB1
      IF((EN+EIN(2)).LE.XVIB1(J)) GO TO 320
  310 CONTINUE
      J=NVIB1
  320 A=(YVIB1(J)-YVIB1(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB1(J)-XVIB1(J)*YVIB1(J-1))/(XVIB1(J-1)-XVIB1(J))
      EFAC=DSQRT(1.0-(EIN(1)/EN))
      QIN(1,I)=AVIB1*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      QIN(1,I)=QIN(1,I)+(EN+EIN(2))*(A*(EN+EIN(2))+B)/EN
      QIN(1,I)=QIN(1,I)*APOP/(1.0+APOP)*1.D-16
  350 CONTINUE
C V4 + V2
      QIN(2,I)=0.0
      IF(EN.LE.EIN(2)) GO TO 400
      DO 360 J=2,NVIB1
      IF(EN.LE.XVIB1(J)) GO TO 370
  360 CONTINUE
      J=NVIB1
  370 A=(YVIB1(J)-YVIB1(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB1(J)-XVIB1(J)*YVIB1(J-1))/(XVIB1(J-1)-XVIB1(J))
      EFAC=DSQRT(1.0-(EIN(2)/EN))
      QIN(2,I)=AVIB1*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      ELF=EN-EIN(2)
      FWD=DLOG((EN+ELF)/(EN+ELF-2.0*DSQRT(EN*ELF)))
      BCK=DLOG((EN+ELF+2.0*DSQRT(EN*ELF))/(EN+ELF))
C RATIO OF MT TO TOTAL X-SECT FOR RESONANCE PART =RAT
      XMT=((1.5-FWD/(FWD+BCK))*QIN(2,I)+RAT*(A*EN+B))*1.D-16
      QIN(2,I)=((A*EN+B)+QIN(2,I))*1.D-16
      PEQIN(2,I)=0.5+(QIN(2,I)-XMT)/QIN(2,I)
      QIN(2,I)=QIN(2,I)/(1.0+APOP)
  400 CONTINUE
C V1 + V3
      QIN(3,I)=0.0
      IF(EN.LE.EIN(3)) GO TO 500
      DO 410 J=2,NVIB2
      IF(EN.LE.XVIB2(J)) GO TO 420
  410 CONTINUE
      J=NVIB2
  420 A=(YVIB2(J)-YVIB2(J-1))/(XVIB2(J)-XVIB2(J-1))
      B=(XVIB2(J-1)*YVIB2(J)-XVIB2(J)*YVIB2(J-1))/(XVIB2(J-1)-XVIB2(J))
      EFAC=DSQRT(1.0-(EIN(3)/EN))
      QIN(3,I)=AVIB2*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      ELF=EN-EIN(3)
      FWD=DLOG((EN+ELF)/(EN+ELF-2.0*DSQRT(EN*ELF)))
      BCK=DLOG((EN+ELF+2.0*DSQRT(EN*ELF))/(EN+ELF))
C RATIO OF MT TO TOTAL X-SECT FOR RESONANCE PART =RAT
      XMT=((1.5-FWD/(FWD+BCK))*QIN(3,I)+RAT*(A*EN+B))*1.D-16
      QIN(3,I)=((A*EN+B)+QIN(3,I))*1.D-16
      PEQIN(3,I)=0.5+(QIN(3,I)-XMT)/QIN(3,I)
  500 CONTINUE
C  VIBRATION HARMONICS 1
      QIN(4,I)=0.0
      IF(EN.LE.EIN(4)) GO TO 600
      DO 510 J=2,NVIB3
      IF(EN.LE.XVIB3(J)) GO TO 520
  510 CONTINUE
      J=NVIB3
  520 A=(YVIB3(J)-YVIB3(J-1))/(XVIB3(J)-XVIB3(J-1))
      B=(XVIB3(J-1)*YVIB3(J)-XVIB3(J)*YVIB3(J-1))/(XVIB3(J-1)-XVIB3(J))
      QIN(4,I)=(A*EN+B)*1.D-16
  600 CONTINUE
C  VIBRATION HARMONICS 2
      QIN(5,I)=0.0
      IF(EN.LE.EIN(5)) GO TO 700
      DO 610 J=2,NVIB4
      IF(EN.LE.XVIB4(J)) GO TO 620
  610 CONTINUE
      J=NVIB4
  620 A=(YVIB4(J)-YVIB4(J-1))/(XVIB4(J)-XVIB4(J-1))
      B=(XVIB4(J-1)*YVIB4(J)-XVIB4(J)*YVIB4(J-1))/(XVIB4(J-1)-XVIB4(J))
      QIN(5,I)=(A*EN+B)*1.D-16
  700 CONTINUE
C  DISOCIATIVE EXCITATION
      QIN(6,I)=0.0
      IF(EN.LE.EIN(6)) GO TO 850
      DO 810 J=2,NDIS1
      IF(EN.LE.XDIS1(J)) GO TO 820
  810 CONTINUE
      J=NDIS1
  820 A=(YDIS1(J)-YDIS1(J-1))/(XDIS1(J)-XDIS1(J-1))
      B=(XDIS1(J-1)*YDIS1(J)-XDIS1(J)*YDIS1(J-1))/(XDIS1(J-1)-XDIS1(J))
      QIN(6,I)=(A*EN+B)*1.D-16
  850 CONTINUE
C  DISOCIATIVE EXCITATION
      QIN(7,I)=0.0
      IF(EN.LE.EIN(7)) GO TO 900
      DO 860 J=2,NDIS2
      IF(EN.LE.XDIS2(J)) GO TO 870
  860 CONTINUE
      J=NDIS2
  870 A=(YDIS2(J)-YDIS2(J-1))/(XDIS2(J)-XDIS2(J-1))
      B=(XDIS2(J-1)*YDIS2(J)-XDIS2(J)*YDIS2(J-1))/(XDIS2(J-1)-XDIS2(J))
      QIN(7,I)=(A*EN+B)*1.D-16
  900 CONTINUE
C    DISOCIATIVE EXCITATION
      QIN(8,I)=0.0
      IF(EN.LE.EIN(8)) GO TO 950
      DO 910 J=2,NDIS3
      IF(EN.LE.XDIS3(J)) GO TO 920
  910 CONTINUE
      J=NDIS3
  920 A=(YDIS3(J)-YDIS3(J-1))/(XDIS3(J)-XDIS3(J-1))
      B=(XDIS3(J-1)*YDIS3(J)-XDIS3(J)*YDIS3(J-1))/(XDIS3(J-1)-XDIS3(J))
      QIN(8,I)=(A*EN+B)*1.D-16
  950 CONTINUE
C    DISOCIATIVE EXCITATION
      QIN(9,I)=0.0
      IF(EN.LE.EIN(9)) GO TO 990
      DO 960 J=2,NDIS4
      IF(EN.LE.XDIS4(J)) GO TO 970
  960 CONTINUE
      J=NDIS4
  970 A=(YDIS4(J)-YDIS4(J-1))/(XDIS4(J)-XDIS4(J-1))
      B=(XDIS4(J-1)*YDIS4(J)-XDIS4(J)*YDIS4(J-1))/(XDIS4(J-1)-XDIS4(J))
      QIN(9,I)=(A*EN+B)*1.D-16
  990 CONTINUE
C
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+QIN(1,I)+QIN(2,I)+QIN(3,I)+QIN(4,I)+
     /QIN(5,I)+QIN(6,I)+QIN(7,I)+QIN(8,I)+QIN(9,I)
C
 1000 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(9)) NIN=8
      IF(EFINAL.LE.EIN(8)) NIN=7
      IF(EFINAL.LE.EIN(7)) NIN=6
      IF(EFINAL.LE.EIN(6)) NIN=5
      IF(EFINAL.LE.EIN(5)) NIN=4
      IF(EFINAL.LE.EIN(4)) NIN=3
      IF(EFINAL.LE.EIN(3)) NIN=2
C
      RETURN
      END
      SUBROUTINE GAS42(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      DIMENSION XEN(62),YXSEC(62),XVIBH(15),YVIBH(15),
     /XVIB1(15),YVIB1(15),XVIB3(15),YVIB3(15),XEXC(34),YEXC(34),
     /XION(71),YION(71),XATT(33),YATT(33)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
C
      DATA XEN/0.0,.001,0.01,0.02,0.03,0.04,0.05,0.06,0.07,0.08,
     /0.09,0.10,0.12,0.14,0.16,0.18,0.20,0.24,0.30,0.35,
     /0.40,0.50,0.60,0.70,0.80,1.00,1.50,2.00,2.50,3.00,
     /3.50,4.00,5.00,6.00,7.00,8.00,10.0,12.0,14.0,17.0,
     /20.0,24.0,28.0,32.0,36.0,40.0,45.0,50.0,60.0,75.0,
     /100.,150.,200.,300.,500.,700.,1000.,2000.,4000.,10000.,
     /20000.,100000./
C
      DATA YXSEC/100.,80.0,50.3,43.0,39.0,35.5,33.0,31.0,29.4,27.8,
     /26.8,25.5,23.5,21.0,18.5,16.0,14.0,10.5,7.20,5.65,
     /4.25,3.15,2.70,2.70,3.30,4.30,6.20,7.80,9.30,10.4,
     /11.1,11.3,11.3,10.9,10.5,10.0,9.00,8.50,8.00,7.50,
     /7.20,6.80,6.50,6.40,6.30,6.20,6.00,5.75,5.05,4.50,
     /3.75,2.70,1.75,1.00,0.57,0.38,0.24,0.11,0.05,0.02,
     /0.01,.002/
C
C  VIBRATION V1
      DATA XVIB1/0.110,1.00,1.50,2.00,2.50,3.00,3.50,4.00,5.00,6.00,
     /10.0,100.,1000.,10000.,100000./
      DATA YVIB1/0.0,.00001,0.20,0.48,0.72,0.80,0.72,0.48,0.32,0.12,
     /.0016,.001,.0001,.00001,.000001/
C  VIBRATION V3
      DATA XVIB3/0.180,1.00,1.50,2.00,2.50,3.00,3.50,4.00,5.00,6.00,
     /10.0,100.,1000.,10000.,100000./
      DATA YVIB3/0.0,.00001,0.40,0.96,1.44,1.60,1.44,0.96,0.64,0.24,
     /.0032,.001,.0001,.00001,.000001/
C  VIBRATION HARMONIC (2V1+2V3 AND HIGHER HARMONICS)
      DATA XVIBH/0.360,1.00,1.50,2.00,2.50,3.00,3.50,4.00,5.00,6.00,
     /10.0,100.,1000.,10000.,100000./
      DATA YVIBH/0.0,.00001,0.21,0.54,0.78,0.90,0.78,0.54,0.36,0.18,
     /.0024,.001,.0001,.00001,.000001/
C
      DATA XION/15.56,16.5,17.0,17.5,18.0,18.5,19.0,19.5,20.0,20.5,
     /21.0,22.0,23.0,24.0,26.0,28.0,30.0,32.0,34.0,36.0,
     /38.0,40.0,45.0,50.0,55.0,60.0,65.0,70.0,75.0,80.0,
     /85.0,90.0,95.0,100.,105.,110.,115.,120.,125.,130.,
     /135.,140.,150.,160.,170.,180.,200.,220.,250.,300.,
     /350.,400.,450.,500.,600.,700.,800.,900.,1000.,1200.,
     /1400.,2000.,2500.,3000.,4000.,5000.,6000.,8000.,10000.,20000.,
     /100000./
      DATA YION/0.0,0.045,.064,.079,.130,.183,.236,.295,.356,.419,
     /.493,.645,0.80,0.96,1.26,1.54,1.80,2.03,2.25,2.45,
     /2.63,2.79,3.15,3.48,3.76,3.99,4.19,4.35,4.48,4.58,
     /4.67,4.74,4.80,4.84,4.88,4.90,4.92,4.93,4.93,4.93,
     /4.93,4.92,4.89,4.86,4.81,4.76,4.66,4.54,4.37,4.08,
     /3.83,3.59,3.38,3.20,2.88,2.62,2.41,2.23,2.07,1.85,
     /1.66,1.37,1.15,1.02,0.82,0.67,0.58,0.45,0.36,0.21,
     /.06/
C  ATTACHMENT
      DATA XATT/10.0,10.4,10.5,10.6,10.7,10.8,10.9,11.0,11.1,11.2,
     /11.3,11.4,11.5,11.6,11.7,11.8,11.9,12.0,12.1,12.2,
     /12.3,12.4,12.5,12.6,12.7,12.8,12.9,13.0,20.0,100.,
     /1000.,10000.,100000./
      DATA YATT/0.00,.0015,.0032,.0046,.0063,.0084,.010,.014,.017,.020,
     /.022,.024,.025,.025,.023,.021,.018,.015,.012,.0097,
     /.0069,.0048,.0033,.0022,.0015,.00092,.00061,.00024,.0002,.0001,
     /.00001,.000001,.0000001/
C  DISOCIATION X-SECTION EXCLUDING DISOCIATIVE IONISATION X-SECTION
      DATA XEXC/10.0,10.1,10.6,11.1,11.6,12.1,12.6,13.1,13.6,14.1,
     /14.6,15.1,16.2,17.2,18.2,20.2,22.2,24.2,27.2,30.3,
     /40.0,50.0,100.,200.,300.,400.,500.,600.,1000.,2000.,
     /4000.,10000.,20000.,100000./
      DATA YEXC/0.00,0.01,0.11,0.21,0.39,0.58,0.65,0.73,0.82,0.89,
     /0.97,1.03,1.15,1.24,1.33,1.49,1.61,1.68,1.78,1.82,
     /1.81,1.83,1.88,1.88,1.70,1.40,1.10,0.88,0.49,0.22,
     /0.11,0.05,0.03,.008/
C ----------------------------------------------------------------
C ---------------------------------------------------------------
      NAME=' BF3  -2001--- '
C
      NIN=9
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
C ANISOTROPIC SCATTERING FOR LEVELS 6 AND 7
      KIN(6)=1
      KIN(7)=1
C
      NDATA=62
      NVIB1=15
      NVIB3=15
      NVIBH=15
      NION=71
      NATT=33
      NEXC=34
      E(1)=0.0
      E(2)=2.0*EMASS/(67.8062*AMU)
      E(3)=15.56
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=15.56
      EIN(1)=-0.0596
      EIN(2)=-0.086
      EIN(3)=-0.110
      EIN(4)=0.0596
      EIN(5)=0.086
      EIN(6)=0.110
      EIN(7)=0.180
      EIN(8)=0.360
      EIN(9)=10.0
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       BF3            '
      SCRPT(3)=' IONISATION    ELOSS= 15.56   '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' VIB V4        ELOSS= -0.0596 '
      SCRPT(8)=' VIB V2        ELOSS= -0.086  '
      SCRPT(9)=' VIB V1        ELOSS= -0.110  '
      SCRPT(10)=' VIB V4        ELOSS=  0.0596 '
      SCRPT(11)=' VIB V2        ELOSS=  0.086  '
      SCRPT(12)=' VIB V1 (ANIS) ELOSS=  0.110  '
      SCRPT(13)=' VIB V3 (ANIS) ELOSS=  0.180  '
      SCRPT(14)=' VIB HAR       ELOSS=  0.360  '
      SCRPT(15)=' EXC           ELOSS= 10.0    '
      APOP1=DEXP(EIN(1)/AKT)
      APOP2=DEXP(EIN(2)/AKT)
      APOP3=DEXP(EIN(3)/AKT)
      EN=-ESTEP/2.0
      DO 9000 I=1,NSTEP
      EN=EN+ESTEP
      DO 10 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 20
   10 CONTINUE
      J=NDATA
   20 A=(YXSEC(J)-YXSEC(J-1))/(XEN(J)-XEN(J-1))
      B=(XEN(J-1)*YXSEC(J)-XEN(J)*YXSEC(J-1))/(XEN(J-1)-XEN(J))
      Q(2,I)=(A*EN+B)*1.0D-16
      Q(3,I)=0.0
      IF(EN.LT.E(3)) GO TO 200
      DO 110 J=2,NION
      IF(EN.LE.XION(J)) GO TO 120
  110 CONTINUE
      J=NION
  120 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
C
  200 Q(4,I)=0.0
      IF(EN.LT.XATT(1)) GO TO 300
      IF(EN.GT.XATT(NATT)) GO TO 300
      DO 210 J=2,NATT
      IF(EN.LE.XATT(J)) GO TO 220
  210 CONTINUE
      J=NATT
  220 A=(YATT(J)-YATT(J-1))/(XATT(J)-XATT(J-1))
      B=(XATT(J-1)*YATT(J)-XATT(J)*YATT(J-1))/(XATT(J-1)-XATT(J))
      Q(4,I)=(A*EN+B)*1.D-16
  300 Q(5,I)=0.0
      Q(6,I)=0.0
C
C SUPERELASTIC OF VIBRATION V4
C
      QIN(1,I)=0.0
      IF(EN.EQ.0.0) GO TO 305
      EFAC=DSQRT(1.0-(EIN(1)/EN))
      QIN(1,I)=0.018*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      QIN(1,I)=QIN(1,I)*APOP1/(1.0+APOP1)*1.D-16
  305 CONTINUE
C
C SUPERELASTIC OF VIBRATION V2
      QIN(2,I)=0.0
      IF(EN.EQ.0.0) GO TO 400
      EFAC=DSQRT(1.0-(EIN(2)/EN))
      QIN(2,I)=0.045*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      QIN(2,I)=QIN(2,I)*APOP2/(1.0+APOP2)*1.D-16
  400 CONTINUE
C SUPERELASTIC OF VIBRATION V1
      QIN(3,I)=0.0
      IF(EN.EQ.0.0) GO TO 500
      EFAC=DSQRT(1.0-(EIN(3)/EN))
      QIN(3,I)=0.37*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      QIN(3,I)=QIN(3,I)*APOP3/(1.0+APOP3)*1.D-16
  500 CONTINUE
C   V4
      QIN(4,I)=0.0
      IF(EN.LE.EIN(4)) GO TO 600
      EFAC=DSQRT(1.0-(EIN(4)/EN))
      QIN(4,I)=0.018*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      QIN(4,I)=QIN(4,I)*1.0/(1.0+APOP1)*1.D-16
  600 CONTINUE
C   V2
      QIN(5,I)=0.0
      IF(EN.LE.EIN(5)) GO TO 700
      EFAC=DSQRT(1.0-(EIN(5)/EN))
      QIN(5,I)=0.045*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      QIN(5,I)=QIN(5,I)*1.0/(1.0+APOP2)*1.D-16
  700 CONTINUE
C   V1
      QIN(6,I)=0.0
      IF(EN.LE.EIN(6)) GO TO 800
      DO 710 J=2,NVIB1
      IF(EN.LE.XVIB1(J)) GO TO 720
  710 CONTINUE
      J=NVIB1
  720 A=(YVIB1(J)-YVIB1(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB1(J)-XVIB1(J)*YVIB1(J-1))/(XVIB1(J-1)-XVIB1(J))
      EFAC=DSQRT(1.0-(EIN(6)/EN))
      QIN(6,I)=0.37*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      ELF=EN-EIN(6)
      FWD=DLOG((EN+ELF)/(EN+ELF-2.0*DSQRT(EN*ELF)))
      BCK=DLOG((EN+ELF+2.0*DSQRT(EN*ELF))/(EN+ELF))
C ASSUME RATIO MOM T./ TOT X-SECT FOR RESONANCE PART = RAT4
      RAT4=0.58
      XMT=((1.5-FWD/(FWD+BCK))*QIN(6,I)+RAT4*(A*EN+B))*1.D-16
      QIN(6,I)=(QIN(6,I)+(A*EN+B))*1.D-16
      PEQIN(6,I)=0.5+(QIN(6,I)-XMT)/QIN(6,I)
      QIN(6,I)=QIN(6,I)*1.0/(1.0+APOP3)
  800 CONTINUE
C  V3
      QIN(7,I)=0.0
      IF(EN.LE.EIN(7)) GO TO 900
      DO 810 J=2,NVIB3
      IF(EN.LE.XVIB3(J)) GO TO 820
  810 CONTINUE
      J=NVIB3
  820 A=(YVIB3(J)-YVIB3(J-1))/(XVIB3(J)-XVIB3(J-1))
      B=(XVIB3(J-1)*YVIB3(J)-XVIB3(J)*YVIB3(J-1))/(XVIB3(J-1)-XVIB3(J))
      EFAC=DSQRT(1.0-(EIN(7)/EN))
      QIN(7,I)=0.74*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      ELF=EN-EIN(7)
      FWD=DLOG((EN+ELF)/(EN+ELF-2.0*DSQRT(EN*ELF)))
      BCK=DLOG((EN+ELF+2.0*DSQRT(EN*ELF))/(EN+ELF))
C ASSUME RATIO MOM T./ TOT X-SECT FOR RESONANCE PART = RAT4
      RAT4=0.58
      XMT=((1.5-FWD/(FWD+BCK))*QIN(7,I)+RAT4*(A*EN+B))*1.D-16
      QIN(7,I)=(QIN(7,I)+(A*EN+B))*1.D-16
      PEQIN(7,I)=0.5+(QIN(7,I)-XMT)/QIN(7,I)
  900 CONTINUE
C
      QIN(8,I)=0.0
      IF(EN.LE.EIN(8)) GO TO 1000
      DO 910 J=2,NVIBH
      IF(EN.LE.XVIBH(J)) GO TO 920
  910 CONTINUE
      J=NVIBH
  920 A=(YVIBH(J)-YVIBH(J-1))/(XVIBH(J)-XVIBH(J-1))
      B=(XVIBH(J-1)*YVIBH(J)-XVIBH(J)*YVIBH(J-1))/(XVIBH(J-1)-XVIBH(J))
      QIN(8,I)=(A*EN+B)*1.D-16
 1000 CONTINUE
C
      QIN(9,I)=0.0
      IF(EN.LE.EIN(9)) GO TO 1100
      DO 1010 J=2,NEXC
      IF(EN.LE.XEXC(J)) GO TO 1020
 1010 CONTINUE
      J=NEXC
 1020 A=(YEXC(J)-YEXC(J-1))/(XEXC(J)-XEXC(J-1))
      B=(XEXC(J-1)*YEXC(J)-XEXC(J)*YEXC(J-1))/(XEXC(J-1)-XEXC(J))
      QIN(9,I)=(A*EN+B)*1.D-16
 1100 CONTINUE
C
C
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+QIN(1,I)+QIN(2,I)+QIN(3,I)+QIN(4,I)+
     /QIN(5,I)+QIN(6,I)+QIN(7,I)+QIN(8,I)+QIN(9,I)
 9000 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(9)) NIN=8
      IF(EFINAL.LE.EIN(8)) NIN=7
      IF(EFINAL.LE.EIN(7)) NIN=6
      IF(EFINAL.LE.EIN(6)) NIN=5
      IF(EFINAL.LE.EIN(5)) NIN=4
      IF(EFINAL.LE.EIN(4)) NIN=3
      IF(EFINAL.LE.EIN(3)) NIN=2
      IF(EFINAL.LE.EIN(2)) NIN=1
      IF(EFINAL.LE.EIN(1)) NIN=0
      RETURN
      END
      SUBROUTINE GAS43(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      DIMENSION XENM(30),YXMOM(30),XENT(30),YXTOT(30),
     /XVIB2(22),YVIB2(22),XVIB3(22),YVIB3(22),XVIB4(22),YVIB4(22),
     /XVIB5(22),YVIB5(22),XVIB6(22),YVIB6(22),
     /XDISS(27),YDISS(27),XATT(26),YATT(26),XION(48),YION(48)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      DATA XENM/1.D-6,0.001,0.01,0.10,1.00,1.50,2.00,3.00,4.00,5.00,
     /6.00,7.00,8.00,9.00,10.0,15.0,20.0,30.0,40.0,50.0,
     /60.0,70.0,80.0,90.0,100.,200.,400.,1000.,10000.,100000./
C  ELASTIC MOMENTUM TRANSFER
      DATA YXMOM/2500.,2500.,1700.,170.,17.0,12.0,10.0,8.60,8.20,8.80,
     /9.80,10.7,11.4,12.0,12.5,14.5,14.5,13.2,11.5,10.0,
     /9.20,8.50,7.66,6.66,5.86,3.00,1.50,0.60,0.06,.006/
C  ELASTIC
      DATA XENT/1.D-6,0.001,0.01,0.10,1.00,1.50,2.00,3.00,4.00,5.00,
     /6.00,7.00,8.00,9.00,10.0,15.0,20.0,30.0,40.0,50.0,
     /60.0,70.0,80.0,90.0,100.,200.,400.,1000.,10000.,100000./
C  ELASTIC TOTAL
      DATA YXTOT/2500.,2500.,1700.,170.,17.0,13.0,13.5,14.5,15.5,16.5,
     /17.5,18.5,19.5,20.0,20.7,23.5,23.5,21.5,19.5,18.5,
     /17.5,17.0,16.0,15.0,14.5,11.5,9.00,7.00,0.70,0.07/
C  VIBRATION V11 (RESONANCE ONLY)
      DATA XVIB2/0.065,1.00,2.00,3.00,4.00,4.50,5.00,6.00,7.00,8.00,
     /9.00,10.0,11.0,12.0,13.0,15.0,20.0,50.0,100.,1000.,
     /10000.,100000./
      DATA YVIB2/0.0,0.0,.028,.063,.196,.182,0.14,.126,.182,0.21,
     /0.21,.175,.063,.028,.014,.007,.0014,.000007,.0000007,.00000007,
     /.000000007,.0000000007/
C  VIBRATION V2  (RESONANCE ONLY)
      DATA XVIB3/0.1001,1.00,2.00,3.00,4.00,4.50,5.00,6.00,7.00,8.00,
     /9.00,10.0,11.0,12.0,13.0,15.0,20.0,50.0,100.,1000.,
     /10000.,100000./
      DATA YVIB3/0.0,0.0,.175,.343,1.08,1.04,0.77,0.70,1.02,1.15,
     /1.13,.959,0.35,.154,.063,.028,.014,.000003,.0000003,.00000003,
     /.000000003,.0000000003/
C  VIBRATION V1 (RESONANCE ONLY)
      DATA XVIB4/0.1523,1.00,2.00,3.00,4.00,4.50,5.00,6.00,7.00,8.00,
     /9.00,10.0,11.0,12.0,13.0,15.0,20.0,50.0,100.,1000.,
     /10000.,100000./
      DATA YVIB4/0.0,0.0,.378,.756,2.34,2.24,1.68,1.51,2.23,2.52,
     /2.49,2.10,0.77,.336,0.14,0.07,.035,.00007,.000007,.0000007,
     /.00000007,.000000007/
C  VIBRATION HARMONIC 2(V1)
      DATA XVIB5/0.35,1.00,2.00,3.00,4.00,4.50,5.00,6.00,7.00,8.00,
     /9.00,10.0,11.0,12.0,13.0,15.0,20.0,50.0,100.,1000.,
     /10000.,100000./
      DATA YVIB5/0.0,0.0,.135,0.27,0.84,.795,0.60,0.54,.795,0.90,
     /.885,0.75,0.27,0.12,.045,0.03,.015,.00015,.000015,.0000015,
     /.00000015,.000000015/
C VIBRATION HARMONIC (3(V1) + ALL OTHER HARMONICS)
      DATA XVIB6/0.500,1.00,2.00,3.00,4.00,4.50,5.00,6.00,7.00,8.00,
     /9.00,10.0,11.0,12.0,13.0,15.0,20.0,50.0,100.,1000.,
     /10000.,100000./
      DATA YVIB6/0.0,0.0,0.54,1.08,3.35,3.20,2.40,2.16,3.18,3.60,
     /3.56,3.00,1.09,0.48,.195,.105,.045,.00015,.000015,.0000015,
     /.00000015,.000000015/
C  DISOCIATION X-SECTION
      DATA XDISS/11.8,12.0,13.0,14.0,15.0,18.0,20.0,25.0,30.0,40.0,
     /50.0,60.0,80.0,100.,120.,150.,200.,300.,400.,500.,
     /600.,800.,1000.,2000.,4000.,10000.,100000./
      DATA YDISS/0.00,.007,.072,0.40,0.75,1.33,1.61,1.88,2.00,2.25,
     /2.40,2.50,2.60,2.60,2.60,2.55,2.50,2.40,2.30,2.20,
     /2.00,1.75,1.48,0.80,0.46,0.21,0.021/
      DATA XION/14.48,17.0,18.0,19.0,21.0,23.0,25.0,27.0,29.0,31.0,
     /33.0,35.0,37.0,39.0,41.0,43.0,45.0,47.0,49.0,51.0,
     /61.0,71.0,81.0,91.0,101.,126.,151.,176.,201.,251.,
     /301.,351.,401.,451.,501.,601.,701.,801.,901.,1001.,
     /1251.,1501.,1751.,2001.,2501.,3001.,10000.,100000./
      DATA YION/0.00,.0889,.211,.375,.782,1.18,1.59,2.11,2.49,2.81,
     /3.16,3.49,3.86,4.17,4.54,4.85,5.14,5.52,5.77,6.19,
     /6.82,7.57,7.84,8.17,8.39,8.77,8.75,8.76,8.57,8.17,
     /7.41,7.13,6.55,6.21,5.89,5.17,4.72,4.40,3.96,3.77,
     /3.19,2.79,2.44,2.28,1.88,1.67,0.60,0.09/
      DATA XATT/2.00,2.25,2.50,2.75,3.00,3.25,3.50,3.75,4.00,4.25,
     /4.50,4.75,5.00,5.25,5.50,5.75,6.00,6.25,6.50,6.75,
     /7.00,8.00,10.0,20.0,100.0,100000./
      DATA YATT/.0,.0075,.020,.038,.053,.069,.083,.086,.083,.074,
     /.060,.046,.035,.025,.017,.010,.0068,.004,.0016,.0007,
     /.0003,.0002,.0001,.00001,.000001,.0000001/
C ---------------------------------------------------------------------
C    DATA SET USES C2F6 FOR ALL XSECS EXCEPT LOW ENERGY ELASTIC WHICH
C    IS DOMINATED BY DIPOLE SCATTERING BELOW 1 EV ENRGY .
c    ABOVE 1EV SMOOTH JOIN TO C2F6 ELASTIC IS USED .
C    THE LARGEST ERRORS IN SWARM PARAMETERS PROBABLY WILL BE FOR THE
C    ATTACHMENT WHICH MAY BE VERY SENSITIVE TO DETAILED MOLECULAR
C    STRUCTURE.
C --------------------------------------------------------------------
      NAME=' C2HF5/C2H2F4  '
C
      NIN=9
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
C ANISOTROPIC SCATTERING FOR LEVELS 5  AND 6
      KIN(5)=1
      KIN(6)=1
C
      NDATA=30
      NETOT=30
      NVIB2=22
      NVIB3=22
      NVIB4=22
      NVIB5=22
      NVIB6=22
      NDISS=27
      NATT=26
C RENORMALISE ATTACHMENT X-SECTION
      ATTNRM=0.05
      NION=48
      E(1)=0.0
      E(2)=2.0*EMASS/(120.*AMU)
      E(3)=14.48
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=14.48
      EIN(1)=-0.065
      EIN(2)=-0.1001
      EIN(3)=-0.1523
      EIN(4)=0.065
      EIN(5)=0.1001
      EIN(6)=0.1523
      EIN(7)=0.35
      EIN(8)=0.500
      EIN(9)=11.8
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       C2HF5/C2H2F4   '
      SCRPT(3)=' IONISATION    ELOSS= 14.48   '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' VIB V11       ELOSS= -0.065  '
      SCRPT(8)=' VIB V2        ELOSS= -0.1001 '
      SCRPT(9)=' VIB V1        ELOSS= -0.1523 '
      SCRPT(10)=' VIB V11       ELOSS=  0.065  '
      SCRPT(11)=' VIB V2 (ANIS) ELOSS=  0.1001 '
      SCRPT(12)=' VIB V1 (ANIS) ELOSS=  0.1523 '
      SCRPT(13)=' VIB           ELOSS=  0.35   '
      SCRPT(14)=' VIB           ELOSS=  0.50   '
      SCRPT(15)=' EXC DISOCN    ELOSS= 11.8    '
      APOP1=DEXP(EIN(1)/AKT)
      APOP2=DEXP(EIN(2)/AKT)
      APOP3=DEXP(EIN(3)/AKT)
      EN=-ESTEP/2.0
      DO 9000 I=1,NSTEP
      EN=EN+ESTEP
      IF(EN.EQ.0.0) XMOMT=2500.D-16
      IF(EN.EQ.0.0) GO TO 30
      DO 10 J=2,NDATA
      IF(EN.LE.XENM(J)) GO TO 20
   10 CONTINUE
      J=NDATA
C USE LOG INTERPOLATION
   20 Y1=DLOG(YXMOM(J-1))
      Y2=DLOG(YXMOM(J))
      X1=DLOG(XENM(J-1))
      X2=DLOG(XENM(J))
      A=(Y2-Y1)/(X2-X1)
      B=(X1*Y2-X2*Y1)/(X1-X2)
      XMOMT=DEXP((A*DLOG(EN)+B))*1.0D-16
   30 IF(EN.EQ.0.0) XTOT=2500.D-16
      IF(EN.EQ.0.0) GO TO 70
      DO 50 J=2,NETOT
      IF(EN.LE.XENT(J)) GO TO 60
   50 CONTINUE
      J=NETOT
   60 Y1=DLOG(YXTOT(J-1))
      Y2=DLOG(YXTOT(J))
      X1=DLOG(XENT(J-1))
      X2=DLOG(XENT(J))
      A=(Y2-Y1)/(X2-X1)
      B=(X1*Y2-X2*Y1)/(X1-X2)
      XTOT=DEXP((A*DLOG(EN)+B))*1.0D-16
   70 CONTINUE
      Q(2,I)=XTOT
      PEQEL(2,I)=0.5+(XTOT-XMOMT)/XTOT
      IF(KEL(2).EQ.0) Q(2,I)=XMOMT
      IF(KEL(2).EQ.0) PEQEL(2,I)=0.5
C
      Q(3,I)=0.0
      IF(EN.LT.E(3)) GO TO 200
      DO 110 J=2,NION
      IF(EN.LE.XION(J)) GO TO 120
  110 CONTINUE
      J=NION
  120 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
C
  200 Q(4,I)=0.0
      IF(EN.LT.XATT(1)) GO TO 250
      IF(EN.GT.XATT(NATT)) GO TO 250
      DO 210 J=2,NATT
      IF(EN.LE.XATT(J)) GO TO 220
  210 CONTINUE
      J=NATT
  220 A=(YATT(J)-YATT(J-1))/(XATT(J)-XATT(J-1))
      B=(XATT(J-1)*YATT(J)-XATT(J)*YATT(J-1))/(XATT(J-1)-XATT(J))
      Q(4,I)=(A*EN+B)*1.D-16*ATTNRM
  250 Q(5,I)=0.0
      Q(6,I)=0.0
C
C SUPERELASTICS
      QIN(1,I)=0.0
      QIN(2,I)=0.0
      QIN(3,I)=0.0
      IF(EN.EQ.0.0) GO TO 305
C SUPERELASTIC OF VIBRATION V11
      EFAC=DSQRT(1.0-(EIN(1)/EN))
      QIN(1,I)=0.0363*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      DO 260 J=2,NVIB2
      IF((EN+EIN(4)).LE.XVIB2(J)) GO TO 270
  260 CONTINUE
      J=NVIB2
  270 A=(YVIB2(J)-YVIB2(J-1))/(XVIB2(J)-XVIB2(J-1))
      B=(XVIB2(J-1)*YVIB2(J)-XVIB2(J)*YVIB2(J-1))/(XVIB2(J-1)-XVIB2(J))
      QIN(1,I)=QIN(1,I)+(EN+EIN(4))*(A*(EN+EIN(4))+B)/EN
      QIN(1,I)=QIN(1,I)*APOP1/(1.0+APOP1)*1.D-16
C  SUPERELASTIC OF VIBRATION V2
      EFAC=DSQRT(1.0-(EIN(2)/EN))
      QIN(2,I)=0.4230*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      DO 280 J=2,NVIB3
      IF((EN+EIN(5)).LE.XVIB3(J)) GO TO 290
  280 CONTINUE
      J=NVIB3
  290 A=(YVIB3(J)-YVIB3(J-1))/(XVIB3(J)-XVIB3(J-1))
      B=(XVIB3(J-1)*YVIB3(J)-XVIB3(J)*YVIB3(J-1))/(XVIB3(J-1)-XVIB3(J))
      QIN(2,I)=QIN(2,I)+(EN+EIN(5))*(A*(EN+EIN(5))+B)/EN
      QIN(2,I)=QIN(2,I)*APOP2/(1.0+APOP2)*1.D-16
C SUPERELASTIC OF VIBRATION V1
      EFAC=DSQRT(1.0-(EIN(3)/EN))
      QIN(3,I)=1.5000*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      DO 300 J=2,NVIB4
      IF((EN+EIN(6)).LE.XVIB4(J))GO TO 301
  300 CONTINUE
      J=NVIB4
  301 A=(YVIB4(J)-YVIB4(J-1))/(XVIB4(J)-XVIB4(J-1))
      B=(XVIB4(J-1)*YVIB4(J)-XVIB4(J)*YVIB4(J-1))/(XVIB4(J-1)-XVIB4(J))
      QIN(3,I)=QIN(3,I)+(EN+EIN(6))*(A*(EN+EIN(6))+B)/EN
      QIN(3,I)=QIN(3,I)*APOP3/(1.0+APOP3)*1.D-16
C
  305 CONTINUE
      QIN(4,I)=0.0
      IF(EN.LE.EIN(4)) GO TO 400
      DO 310 J=2,NVIB2
      IF(EN.LE.XVIB2(J)) GO TO 320
  310 CONTINUE
      J=NVIB2
  320 A=(YVIB2(J)-YVIB2(J-1))/(XVIB2(J)-XVIB2(J-1))
      B=(XVIB2(J-1)*YVIB2(J)-XVIB2(J)*YVIB2(J-1))/(XVIB2(J-1)-XVIB2(J))
      EFAC=DSQRT(1.0-(EIN(4)/EN))
      QIN(4,I)=0.0363*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      QIN(4,I)=((A*EN+B)+QIN(4,I))*1.0/(1.0+APOP1)*1.D-16
  400 CONTINUE
C
      QIN(5,I)=0.0
      IF(EN.LE.EIN(5)) GO TO 500
      DO 410 J=2,NVIB3
      IF(EN.LE.XVIB3(J)) GO TO 420
  410 CONTINUE
      J=NVIB3
  420 A=(YVIB3(J)-YVIB3(J-1))/(XVIB3(J)-XVIB3(J-1))
      B=(XVIB3(J-1)*YVIB3(J)-XVIB3(J)*YVIB3(J-1))/(XVIB3(J-1)-XVIB3(J))
      EFAC=DSQRT(1.0-(EIN(5)/EN))
      QIN(5,I)=0.4230*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      ELF=EN-EIN(5)
      FWD=DLOG((EN+ELF)/(EN+ELF-2.0*DSQRT(EN*ELF)))
      BCK=DLOG((EN+ELF+2.0*DSQRT(EN*ELF))/(EN+ELF))
C ASSUME RATIO  MOM.T /TOT X-SECT FOR RESONANCE PART = RAT3
      RAT3=0.80
      XMT=((1.5-FWD/(FWD+BCK))*QIN(5,I)+RAT3*(A*EN+B))*1.0D-16
      XMT=XMT/(1.0+APOP2)
      QIN(5,I)=((A*EN+B)+QIN(5,I))*1.0/(1.0+APOP2)*1.D-16
      PEQIN(5,I)=0.5+(QIN(5,I)-XMT)/QIN(5,I)
  500 CONTINUE
C
      QIN(6,I)=0.0
      IF(EN.LE.EIN(6)) GO TO 600
      DO 510 J=2,NVIB4
      IF(EN.LE.XVIB4(J)) GO TO 520
  510 CONTINUE
      J=NVIB4
  520 A=(YVIB4(J)-YVIB4(J-1))/(XVIB4(J)-XVIB4(J-1))
      B=(XVIB4(J-1)*YVIB4(J)-XVIB4(J)*YVIB4(J-1))/(XVIB4(J-1)-XVIB4(J))
      EFAC=DSQRT(1.0-(EIN(6)/EN))
      QIN(6,I)=1.500*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      ELF=EN-EIN(6)
      FWD=DLOG((EN+ELF)/(EN+ELF-2.0*DSQRT(EN*ELF)))
      BCK=DLOG((EN+ELF+2.0*DSQRT(EN*ELF))/(EN+ELF))
C   ASSUME RATIO MOM T./ TOT X-SECT FOR RESONANCE PART = RAT4
      RAT4=0.80
      XMT=((1.5-FWD/(FWD+BCK))*QIN(6,I)+RAT4*(A*EN+B))*1.0D-16
      XMT=XMT/(1.0+APOP3)
      QIN(6,I)=((A*EN+B)+QIN(6,I))*1.0/(1.0+APOP3)*1.D-16
      PEQIN(6,I)=0.5+(QIN(6,I)-XMT)/QIN(6,I)
  600 CONTINUE
C
      QIN(7,I)=0.0
      IF(EN.LE.EIN(7)) GO TO 700
      DO 610 J=2,NVIB5
      IF(EN.LE.XVIB5(J)) GO TO 620
  610 CONTINUE
      J=NVIB5
  620 A=(YVIB5(J)-YVIB5(J-1))/(XVIB5(J)-XVIB5(J-1))
      B=(XVIB5(J-1)*YVIB5(J)-XVIB5(J)*YVIB5(J-1))/(XVIB5(J-1)-XVIB5(J))
      QIN(7,I)=(A*EN+B)*1.D-16
  700 CONTINUE
C
      QIN(8,I)=0.0
      IF(EN.LE.EIN(8)) GO TO 800
      DO 710 J=2,NVIB6
      IF(EN.LE.XVIB6(J)) GO TO 720
  710 CONTINUE
      J=NVIB6
  720 A=(YVIB6(J)-YVIB6(J-1))/(XVIB6(J)-XVIB6(J-1))
      B=(XVIB6(J-1)*YVIB6(J)-XVIB6(J)*YVIB6(J-1))/(XVIB6(J-1)-XVIB6(J))
      QIN(8,I)=(A*EN+B)*1.D-16
  800 CONTINUE
C
      QIN(9,I)=0.0
      IF(EN.LE.EIN(9)) GO TO 900
      DO 810 J=2,NDISS
      IF(EN.LE.XDISS(J)) GO TO 820
  810 CONTINUE
      J=NDISS
  820 A=(YDISS(J)-YDISS(J-1))/(XDISS(J)-XDISS(J-1))
      B=(XDISS(J-1)*YDISS(J)-XDISS(J)*YDISS(J-1))/(XDISS(J-1)-XDISS(J))
      QIN(9,I)=(A*EN+B)*1.D-16
  900 CONTINUE
C
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+QIN(1,I)+QIN(2,I)+QIN(3,I)+QIN(4,I)+
     /QIN(5,I)+QIN(6,I)+QIN(7,I)+QIN(8,I)+QIN(9,I)
 9000 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(9)) NIN=8
      IF(EFINAL.LE.EIN(8)) NIN=7
      IF(EFINAL.LE.EIN(7)) NIN=6
      IF(EFINAL.LE.EIN(6)) NIN=5
      IF(EFINAL.LE.EIN(5)) NIN=4
      IF(EFINAL.LE.EIN(4)) NIN=3
      IF(EFINAL.LE.EIN(3)) NIN=2
      IF(EFINAL.LE.EIN(2)) NIN=1
      IF(EFINAL.LE.EIN(1)) NIN=0
      RETURN
      END
      SUBROUTINE GAS44(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      NAME=' DUMMY         '
C ---------------------------------------------------------------------
C   DUMMY ROUTINE
C ---------------------------------------------------------------------
      NIN=0
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      E(1)=0.0
      E(2)=0.0
      E(3)=0.0
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=0.0
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       DUMMY          '
      SCRPT(3)=' IONISATION    ELOSS=         '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      EN=-ESTEP/2.0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      Q(2,I)=0.0
      Q(3,I)=0.0
      Q(4,I)=0.0
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)
  900 CONTINUE
C  SAVE COMPUTE TIME
      RETURN
      END
      SUBROUTINE GAS45(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      NAME=' DUMMY         '
C ---------------------------------------------------------------------
C   DUMMY ROUTINE
C ---------------------------------------------------------------------
      NIN=0
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      E(1)=0.0
      E(2)=0.0
      E(3)=0.0
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=0.0
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       DUMMY          '
      SCRPT(3)=' IONISATION    ELOSS=         '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      EN=-ESTEP/2.0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      Q(2,I)=0.0
      Q(3,I)=0.0
      Q(4,I)=0.0
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)
  900 CONTINUE
C  SAVE COMPUTE TIME
      RETURN
      END
      SUBROUTINE GAS46(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      NAME=' DUMMY         '
C ---------------------------------------------------------------------
C   DUMMY ROUTINE
C ---------------------------------------------------------------------
      NIN=0
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      E(1)=0.0
      E(2)=0.0
      E(3)=0.0
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=0.0
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       DUMMY          '
      SCRPT(3)=' IONISATION    ELOSS=         '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      EN=-ESTEP/2.0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      Q(2,I)=0.0
      Q(3,I)=0.0
      Q(4,I)=0.0
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)
  900 CONTINUE
C  SAVE COMPUTE TIME
      RETURN
      END
      SUBROUTINE GAS47(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      NAME=' DUMMY         '
C ---------------------------------------------------------------------
C   DUMMY ROUTINE
C ---------------------------------------------------------------------
      NIN=0
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      E(1)=0.0
      E(2)=0.0
      E(3)=0.0
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=0.0
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       DUMMY          '
      SCRPT(3)=' IONISATION    ELOSS=         '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      EN=-ESTEP/2.0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      Q(2,I)=0.0
      Q(3,I)=0.0
      Q(4,I)=0.0
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)
  900 CONTINUE
C  SAVE COMPUTE TIME
      RETURN
      END
      SUBROUTINE GAS48(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      NAME=' DUMMY         '
C ---------------------------------------------------------------------
C   DUMMY ROUTINE
C ---------------------------------------------------------------------
      NIN=0
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      E(1)=0.0
      E(2)=0.0
      E(3)=0.0
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=0.0
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       DUMMY          '
      SCRPT(3)=' IONISATION    ELOSS=         '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      EN=-ESTEP/2.0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      Q(2,I)=0.0
      Q(3,I)=0.0
      Q(4,I)=0.0
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)
  900 CONTINUE
C  SAVE COMPUTE TIME
      RETURN
      END
      SUBROUTINE GAS49(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      NAME=' DUMMY         '
C ---------------------------------------------------------------------
C   DUMMY ROUTINE
C ---------------------------------------------------------------------
      NIN=0
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      E(1)=0.0
      E(2)=0.0
      E(3)=0.0
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=0.0
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       DUMMY          '
      SCRPT(3)=' IONISATION    ELOSS=         '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      EN=-ESTEP/2.0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      Q(2,I)=0.0
      Q(3,I)=0.0
      Q(4,I)=0.0
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)
  900 CONTINUE
C  SAVE COMPUTE TIME
      RETURN
      END
      SUBROUTINE GAS50(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      DIMENSION XEN(32),YXSEC(32),XVIB3(14),YVIB3(14),XVIB4(16),
     /YVIB4(16),XVIB6(16),YVIB6(16),XEXC(33),YEXC(33),XION(52),YION(52),
     /XATT(13),YATT(13)
      CHARACTER*15 NAME
      CHARACTER*30 SCRPT(226)
      DATA XEN/1.D-6,.001,0.01,0.10,1.00,1.50,2.00,3.00,4.00,5.00,
     /7.00,9.00,10.0,15.0,20.0,30.0,35.0,50.0,60.0,75.0,
     /100.,150.,200.,300.,500.,700.,1000.,2000.,4000.,10000.,
     /20000.,100000./
      DATA YXSEC/1.63D4,1.63D4,1630.,163.,16.3,11.5,10.5,9.50,9.50,10.0,
     /11.0,11.0,10.8,10.5,10.0,9.50,8.40,6.50,5.50,4.60,
     /3.54,2.55,1.63,0.96,0.54,0.36,0.23,0.10,0.05,0.02,
     /0.01,.002/
C  VIBRATION V5 + V2 + V4 (RESONANCE ONLY)
      DATA XVIB3/0.1429,4.00,4.70,5.70,6.70,7.70,9.50,15.0,20.0,50.0,
     /100.,1000.,10000.,100000./
      DATA YVIB3/0.0,0.0,.109,.952,1.43,1.22,0.79,.068,.023,.0001,
     /.00001,.000001,.0000001,.00000001/
C  VIBRATION HARMONIC 2(V5)
      DATA XVIB4/0.2858,1.00,3.00,3.70,4.70,5.70,6.70,7.70,9.50,15.0,
     /20.0,50.0,100.0,1000.,10000.,100000./
      DATA YVIB4/0.0,.001,.005,0.02,0.03,0.23,0.35,0.30,0.20,.016,
     /.006,.0003,.00001,.000001,.0000001,.00000001/
C VIBRATION HARMONIC (3(V5) + ALL OTHER HARMONICS)
      DATA XVIB6/0.4287,1.00,3.00,3.70,4.70,5.70,6.70,7.70,9.50,15.0,
     /20.0,50.0,100.,1000.,10000.,100000./
      DATA YVIB6/0.0,.001,0.04,0.08,0.12,0.92,1.40,1.20,0.80,.064,
     /.020,.0004,.00004,.000004,.0000004,.00000004/
      DATA XION/13.86,14.0,15.0,16.0,17.0,18.0,20.0,22.0,24.0,26.0,
     /28.0,30.0,32.0,34.0,36.0,38.0,40.0,42.0,44.0,46.0,
     /48.0,60.0,70.0,80.0,90.0,100.,125.,150.,175.,200.,
     /250.,300.,350.,400.,450.,500.,600.,700.,800.,900.,
     /1000.,1250.,1500.,1750.,2000.,2500.,3000.,5000.,10000.,20000.,
     /40000.,100000./
      DATA YION/0.0,.031,.072,.123,.184,.266,.431,.590,.843,1.07,
     /1.27,1.46,1.65,1.83,1.96,2.14,2.34,2.50,2.68,2.93,
     /3.07,3.57,3.95,4.28,4.42,4.61,4.78,4.75,4.78,4.59,
     /4.30,4.13,3.88,3.65,3.45,3.16,2.80,2.55,2.35,2.14,
     /2.01,1.70,1.48,1.35,1.21,1.04,0.89,0.63,0.40,.230,
     /.127,.065/
      DATA XATT/1.00,2.50,4.00,6.00,7.00,8.00,9.00,10.0,11.0,12.0,
     /14.0,100.,10000./
      DATA YATT/0.00,0.04,0.17,0.17,0.07,0.07,0.56,2.26,1.30,0.67,
     /0.01,.0001,.000001/
C  DISOCIATION X-SECTION EXCLUDING DISOCIATIVE IONISATION X-SECTION
      DATA XEXC/10.7,11.0,12.0,13.0,14.0,16.0,18.0,23.0,28.0,33.0,
     /38.0,43.0,48.0,60.0,70.0,80.0,100.,120.,140.,160.,
     /180.,200.,250.,300.,400.,500.,600.,1000.,2000.,4000.,
     /10000.,20000.,100000./
      DATA YEXC/0.0,0.05,0.21,0.37,0.57,0.87,1.10,1.42,1.52,1.57,
     /1.60,1.63,1.62,1.61,1.60,1.60,1.59,1.57,1.55,1.52,
     /1.49,1.45,1.37,1.27,1.10,0.92,0.80,0.53,0.31,0.18,
     /0.09,0.05,.013/
C ----------------------------------------------------------------
C DATA ON DRIFT VELOCITY AND TOWNSEND IN PURE GAS
C                : P.REV. E 60 (1999) 4990
C              ALSO CLARK ET AL IN ABOVE REF.
C  ARGON MIXTURE DATA IN : CHEM. PHYS.LETT. 304(1999) 303
C
C ---------------------------------------------------------------
C
      NAME=' CHF3 -2001--- '
C
      NIN=9
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      NDATA=32
      NVIB3=14
      NVIB4=16
      NVIB6=16
      NION=52
      NATT=13
      NEXC=33
      E(1)=0.0
      E(2)=2.0*EMASS/(70.0138*AMU)
      E(3)=13.86
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
C SET OPAL AND BEATY ENERGY SPLITTING TO EION
      EOBY=E(3)
      EIN(1)=-0.035
      EIN(2)=0.035
      EIN(3)=-0.063
      EIN(4)=0.063
      EIN(5)=0.1429
      EIN(6)=0.2858
      EIN(7)=0.3764
      EIN(8)=0.4287
      EIN(9)=10.7
      APOPR=DEXP(EIN(1)/AKT)
      APOPV=DEXP(EIN(3)/AKT)
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC         CHF3         '
      SCRPT(3)=' IONISATION    ELOSS= 13.86   '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' ROT           ELOSS= -0.035  '
      SCRPT(8)=' ROT           ELOSS=  0.035  '
      SCRPT(9)=' VIB63         ELOSS= -0.063  '
      SCRPT(10)=' VIB63         ELOSS=  0.063  '
      SCRPT(11)=' VIB524        ELOSS=  0.1429 '
      SCRPT(12)=' VIB1          ELOSS=  0.2858 '
      SCRPT(13)=' VIB HAR       ELOSS=  0.3764 '
      SCRPT(14)=' VIB HAR       ELOSS=  0.4287 '
      SCRPT(15)=' EXC (DISOCTN)  ELOSS= 10.7   '
      EN=-ESTEP/2.0
      DO 9000 I=1,NSTEP
      EN=EN+ESTEP
      IF(EN.EQ.0.0) Q(2,I)=16300.D-16
      IF(EN.EQ.0.0) GO TO 30
      DO 10 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 20
   10 CONTINUE
      J=NDATA
C USE LOG INTERPOLATION
   20 Y1=DLOG(YXSEC(J-1))
      Y2=DLOG(YXSEC(J))
      X1=DLOG(XEN(J-1))
      X2=DLOG(XEN(J))
      A=(Y2-Y1)/(X2-X1)
      B=(X1*Y2-X2*Y1)/(X1-X2)
      Q(2,I)=DEXP((A*DLOG(EN)+B))*1.0D-16
   30 Q(3,I)=0.0
      IF(EN.LT.E(3)) GO TO 200
      DO 110 J=2,NION
      IF(EN.LE.XION(J)) GO TO 120
  110 CONTINUE
      J=NION
  120 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
C
  200 Q(4,I)=0.0
      IF(EN.LT.XATT(1)) GO TO 300
      IF(EN.GT.XATT(NATT)) GO TO 300
      DO 210 J=2,NATT
      IF(EN.LE.XATT(J)) GO TO 220
  210 CONTINUE
      J=NATT
  220 A=(YATT(J)-YATT(J-1))/(XATT(J)-XATT(J-1))
      B=(XATT(J-1)*YATT(J)-XATT(J)*YATT(J-1))/(XATT(J-1)-XATT(J))
      Q(4,I)=(A*EN+B)*1.D-19
  300 Q(5,I)=0.0
      Q(6,I)=0.0
C
C SUPERELASTIC EFFECTIVE ROTATION
C
      QIN(1,I)=0.0
      IF(EN.EQ.0.0) GO TO 305
      EFAC=DSQRT(1.0-(EIN(1)/EN))
      QIN(1,I)=0.100*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      QIN(1,I)=QIN(1,I)*APOPR/(1.0+APOPR)*1.D-16
C
C EFFECTIVE ROTATION
  305 CONTINUE
      QIN(2,I)=0.0
      IF(EN.LE.EIN(2)) GO TO 350
      EFAC=DSQRT(1.0-(EIN(2)/EN))
      QIN(2,I)=0.100*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      QIN(2,I)=QIN(2,I)*1.0/(1.0+APOPR)*1.D-16
  350 CONTINUE
C
C SUPERELASTIC OF VIBRATION V6 + V3
C
      QIN(3,I)=0.0
      IF(EN.EQ.0.0) GO TO 365
      EFAC=DSQRT(1.0-(EIN(3)/EN))
      QIN(3,I)=0.152*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      QIN(3,I)=QIN(3,I)*APOPV/(1.0+APOPV)*1.D-16
C
C VIB V6 + V3
  365 CONTINUE
      QIN(4,I)=0.0
      IF(EN.LE.EIN(4)) GO TO 400
      EFAC=DSQRT(1.0-(EIN(4)/EN))
      QIN(4,I)=0.152*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      QIN(4,I)=QIN(4,I)*1.0/(1.0+APOPV)*1.D-16
  400 CONTINUE
C
C  V5 + V2 + V4
      QIN(5,I)=0.0
      IF(EN.LE.EIN(5)) GO TO 500
      DO 410 J=2,NVIB3
      IF(EN.LE.XVIB3(J)) GO TO 420
  410 CONTINUE
      J=NVIB3
  420 A=(YVIB3(J)-YVIB3(J-1))/(XVIB3(J)-XVIB3(J-1))
      B=(XVIB3(J-1)*YVIB3(J)-XVIB3(J)*YVIB3(J-1))/(XVIB3(J-1)-XVIB3(J))
      EFAC=DSQRT(1.0-(EIN(5)/EN))
      QIN(5,I)=0.748*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      QIN(5,I)=((A*EN+B)+QIN(5,I))*1.D-16
  500 CONTINUE
C 2V5
      QIN(6,I)=0.0
      IF(EN.LE.EIN(6)) GO TO 600
      DO 510 J=2,NVIB4
      IF(EN.LE.XVIB4(J)) GO TO 520
  510 CONTINUE
      J=NVIB4
  520 A=(YVIB4(J)-YVIB4(J-1))/(XVIB4(J)-XVIB4(J-1))
      B=(XVIB4(J-1)*YVIB4(J)-XVIB4(J)*YVIB4(J-1))/(XVIB4(J-1)-XVIB4(J))
      QIN(6,I)=(A*EN+B)*1.D-16
  600 CONTINUE
C  V1
      QIN(7,I)=0.0
      IF(EN.LE.EIN(7)) GO TO 700
      EFAC=DSQRT(1.0-(EIN(7)/EN))
      QIN(7,I)=0.421*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      QIN(7,I)=QIN(7,I)*1.D-16
  700 CONTINUE
C  HIGHER HARMONICS
      QIN(8,I)=0.0
      IF(EN.LE.EIN(8)) GO TO 800
      DO 710 J=2,NVIB6
      IF(EN.LE.XVIB6(J)) GO TO 720
  710 CONTINUE
      J=NVIB6
  720 A=(YVIB6(J)-YVIB6(J-1))/(XVIB6(J)-XVIB6(J-1))
      B=(XVIB6(J-1)*YVIB6(J)-XVIB6(J)*YVIB6(J-1))/(XVIB6(J-1)-XVIB6(J))
      QIN(8,I)=(A*EN+B)*1.D-16
  800 CONTINUE
C   EXCITATION (DISOCIATION)
      QIN(9,I)=0.0
      IF(EN.LE.EIN(9)) GO TO 900
      DO 810 J=2,NEXC
      IF(EN.LE.XEXC(J)) GO TO 820
  810 CONTINUE
      J=NEXC
  820 A=(YEXC(J)-YEXC(J-1))/(XEXC(J)-XEXC(J-1))
      B=(XEXC(J-1)*YEXC(J)-XEXC(J)*YEXC(J-1))/(XEXC(J-1)-XEXC(J))
      QIN(9,I)=(A*EN+B)*1.D-16
  900 CONTINUE
C
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+QIN(1,I)+QIN(2,I)+QIN(3,I)+QIN(4,I)+
     /QIN(5,I)+QIN(6,I)+QIN(7,I)+QIN(8,I)+QIN(9,I)
 9000 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(9)) NIN=8
      IF(EFINAL.LE.EIN(8)) NIN=7
      IF(EFINAL.LE.EIN(7)) NIN=6
      IF(EFINAL.LE.EIN(6)) NIN=5
      IF(EFINAL.LE.EIN(5)) NIN=4
      IF(EFINAL.LE.EIN(4)) NIN=3
      IF(EFINAL.LE.EIN(3)) NIN=2
      IF(EFINAL.LE.EIN(2)) NIN=1
      IF(EFINAL.LE.EIN(1)) NIN=0
      RETURN
      END
      SUBROUTINE GAS51(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      DIMENSION XEL(30),YEL(30),XVIBH(16),YVIBH(16),
     /XEXC(31),YEXC(31),XION(40),YION(40)
      CHARACTER*15 NAME
      CHARACTER*30 SCRPT(226)
      DATA XEL/1.D-6,.001,0.01,0.10,0.40,0.60,0.80,1.00,1.40,2.00,
     /3.00,5.00,7.50,10.0,14.0,20.0,30.0,50.0,75.0,100.,
     /150.,200.,400.,700.,1000.,2000.,4000.,10000.,20000.,100000./
      DATA YEL/2800.,2800.,280.,28.0,7.00,5.50,5.00,5.00,6.00,7.00,
     /9.00,11.5,15.5,18.0,18.0,17.0,14.0,10.0,8.00,6.00,
     /4.00,3.00,1.45,0.90,0.65,0.30,0.15,0.05,0.02,.004/
C  VIBRATION HARMONIC 2(V3)
      DATA XVIBH/0.30,1.00,3.00,3.70,4.70,5.70,6.70,7.70,9.50,15.0,
     /20.0,50.0,100.0,1000.,10000.,100000./
      DATA YVIBH/0.00,.005,.025,0.10,0.25,1.15,1.75,1.50,1.00,.080,
     /.030,.0015,.00005,.000005,.0000005,.00000005/
      DATA XION/11.40,12.0,13.0,14.0,16.0,18.0,20.0,22.0,24.0,26.0,
     /30.0,34.0,38.0,42.0,46.0,50.0,60.0,70.0,80.0,90.0,
     /100.,125.,150.,175.,200.,250.,300.,400.,500.,600.,
     /800.,1000.,1500.,2000.,2500.,3000.,5000.,10000.,20000.,100000./
      DATA YION/0.00,0.04,0.13,0.25,0.40,0.66,1.00,1.30,1.70,2.05,
     /2.45,2.85,3.30,3.80,4.30,4.60,5.35,5.90,6.40,6.60,
     /6.80,7.00,7.05,7.00,6.90,6.45,6.20,5.50,4.75,4.20,
     /3.55,3.05,2.25,1.85,1.60,1.35,0.95,0.60,0.35,0.10/
C  DISOCIATION X-SECTION EXCLUDING DISOCIATIVE IONISATION X-SECTION
      DATA XEXC/8.70,9.00,10.0,11.0,12.0,14.0,16.0,21.0,26.0,31.0,
     /36.0,40.0,50.0,70.0,100.,120.,140.,160.,180.,200.,
     /250.,300.,400.,500.,600.,1000.,2000.,4000.,10000.,20000.,
     /100000./
      DATA YEXC/0.0,0.07,0.32,0.56,0.85,1.35,1.65,2.15,2.30,2.35,
     /2.40,2.45,2.45,2.43,2.41,2.39,2.35,2.30,2.25,2.20,
     /2.05,1.90,1.65,1.40,1.20,0.80,0.46,0.27,0.14,0.07,
     /.020/
C ----------------------------------------------------------------
C SCALED X-SECTIONS FROM SYSTEMATICS AND USED ATTACHMENT X-SECTION
C  FROM ALAJAJIAN ET AL : J.PHYS B21(1988) 4021
C  AND NORMALISED TO MCCORKLE (1987) AND SPYROU ET AL
C ---------------------------------------------------------------
C
      NAME=' CF3BR -2002-- '
C
      NIN=7
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      NEL=30
      NVIBH=16
      NION=40
      NEXC=31
      E(1)=0.0
      E(2)=2.0*EMASS/(148.90991*AMU)
      E(3)=11.40
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
C SET OPAL AND BEATY ENERGY SPLITTING TO EION
      EOBY=E(3)
      EIN(1)=-0.050
      EIN(2)=0.050
      EIN(3)=-0.1345
      EIN(4)=0.1345
      EIN(5)=0.1499
      EIN(6)=0.30
      EIN(7)=8.7
      APOPV1=DEXP(EIN(1)/AKT)
      APOPV2=DEXP(EIN(3)/AKT)
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC         CF3BR        '
      SCRPT(3)=' IONISATION    ELOSS= 11.40   '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' VIB1          ELOSS= -0.050  '
      SCRPT(8)=' VIB1          ELOSS=  0.050  '
      SCRPT(9)=' VIB2          ELOSS= -0.1345 '
      SCRPT(10)=' VIB2          ELOSS=  0.1345 '
      SCRPT(11)=' VIB3          ELOSS=  0.1499 '
      SCRPT(12)=' VIB HAR       ELOSS=  0.30   '
      SCRPT(13)=' EXC           ELOSS=  8.7    '
      EN=-ESTEP/2.0
      DO 9000 I=1,NSTEP
      EN=EN+ESTEP
      IF(EN.EQ.0.0) Q(2,I)=2800.D-16
      IF(EN.EQ.0.0) GO TO 30
      DO 10 J=2,NEL
      IF(EN.LE.XEL(J)) GO TO 20
   10 CONTINUE
      J=NEL
C USE LOG INTERPOLATION
   20 Y1=DLOG(YEL(J-1))
      Y2=DLOG(YEL(J))
      X1=DLOG(XEL(J-1))
      X2=DLOG(XEL(J))
      A=(Y2-Y1)/(X2-X1)
      B=(X1*Y2-X2*Y1)/(X1-X2)
      Q(2,I)=DEXP((A*DLOG(EN)+B))*1.0D-16
   30 Q(3,I)=0.0
      IF(EN.LT.E(3)) GO TO 100
      DO 40 J=2,NION
      IF(EN.LE.XION(J)) GO TO 50
   40 CONTINUE
      J=NION
   50 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
C
  100 Q(4,I)=0.0
      IF(EN.EQ.0.0.OR.EN.GT.2.0) GO TO 200
C FUNCTIONAL FORM OF ATTACHMENT FROM J.PHYS.B 21(1988) 4021
      AT1=0.0353/DSQRT(EN)
      AT2=DEXP(-EN*EN/9.D-6)
      AT3=DEXP(-EN/0.0588)
      Q(4,I)=(AT1*AT2+AT3)*27.4D-16
  200 Q(5,I)=0.0
      Q(6,I)=0.0
C
C SUPERELASTIC VIBRATION V1
C
      QIN(1,I)=0.0
      IF(EN.EQ.0.0) GO TO 250
      EFAC=DSQRT(1.0-(EIN(1)/EN))
      QIN(1,I)=0.100*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      QIN(1,I)=QIN(1,I)*APOPV1/(1.0+APOPV1)*1.D-16
C
C  VIBRATION V1
C
  250 CONTINUE
      QIN(2,I)=0.0
      IF(EN.LE.EIN(2)) GO TO 300
      EFAC=DSQRT(1.0-(EIN(2)/EN))
      QIN(2,I)=0.100*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      QIN(2,I)=QIN(2,I)*1.0/(1.0+APOPV1)*1.D-16
  300 CONTINUE
C
C SUPERELASTIC OF VIBRATION V2
C
      QIN(3,I)=0.0
      IF(EN.EQ.0.0) GO TO 350
      EFAC=DSQRT(1.0-(EIN(3)/EN))
      QIN(3,I)=0.110*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      QIN(3,I)=QIN(3,I)*APOPV2/(1.0+APOPV2)*1.D-16
C
C VIBRATION V2
  350 CONTINUE
      QIN(4,I)=0.0
      IF(EN.LE.EIN(4)) GO TO 400
      EFAC=DSQRT(1.0-(EIN(4)/EN))
      QIN(4,I)=0.110*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      QIN(4,I)=QIN(4,I)*1.0/(1.0+APOPV2)*1.D-16
  400 CONTINUE
C
C VIBRATION V3
      QIN(5,I)=0.0
      IF(EN.LE.EIN(5)) GO TO 500
      EFAC=DSQRT(1.0-(EIN(5)/EN))
      QIN(5,I)=0.750*DLOG((1.0+EFAC)/(1.0-EFAC))/EN*1.D-16
  500 CONTINUE
C
C  VIBRATION HARMONIC 2V3
      QIN(6,I)=0.0
      IF(EN.LE.EIN(6)) GO TO 600
      DO 510 J=2,NVIBH
      IF(EN.LE.XVIBH(J)) GO TO 520
  510 CONTINUE
      J=NVIBH
  520 A=(YVIBH(J)-YVIBH(J-1))/(XVIBH(J)-XVIBH(J-1))
      B=(XVIBH(J-1)*YVIBH(J)-XVIBH(J)*YVIBH(J-1))/(XVIBH(J-1)-XVIBH(J))
      QIN(6,I)=(A*EN+B)*1.D-16
  600 CONTINUE
C
      QIN(7,I)=0.0
      IF(EN.LE.EIN(7)) GO TO 700
      DO 610 J=2,NEXC
      IF(EN.LE.XEXC(J)) GO TO 620
  610 CONTINUE
      J=NEXC
  620 A=(YEXC(J)-YEXC(J-1))/(XEXC(J)-XEXC(J-1))
      B=(XEXC(J-1)*YEXC(J)-XEXC(J)*YEXC(J-1))/(XEXC(J-1)-XEXC(J))
      QIN(7,I)=(A*EN+B)*1.D-16
  700 CONTINUE
C
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+QIN(1,I)+QIN(2,I)+QIN(3,I)+QIN(4,I)+
     /QIN(5,I)+QIN(6,I)+QIN(7,I)
 9000 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(7)) NIN=6
      IF(EFINAL.LE.EIN(6)) NIN=5
      IF(EFINAL.LE.EIN(5)) NIN=4
      IF(EFINAL.LE.EIN(4)) NIN=3
      IF(EFINAL.LE.EIN(3)) NIN=2
      IF(EFINAL.LE.EIN(2)) NIN=1
      IF(EFINAL.LE.EIN(1)) NIN=0
      RETURN
      END
      SUBROUTINE GAS52(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      DIMENSION XENM(56),YXMOM(56),XENT(56),YXTOT(56),
     /XVIB2(22),YVIB2(22),XVIB3(22),YVIB3(22),XVIB4(22),YVIB4(22),
     /XVIB5(22),YVIB5(22),XVIB6(22),YVIB6(22),YATT1(23),
     /XDISS(27),YDISS(27),XATT(23),YATT(23),XION(50),YION(50)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      DATA XENM/0.0,0.001,0.002,0.004,0.007,0.01,.015,0.02,.025,0.03,
     /0.04,0.05,0.06,0.07,0.08,0.09,0.10,0.12,0.15,0.20,
     /0.25,0.30,0.35,0.40,0.45,0.50,0.60,0.70,0.80,0.90,
     /1.00,1.50,2.00,3.00,4.00,5.00,6.00,7.00,8.00,9.00,
     /10.0,15.0,20.0,30.0,40.0,50.0,60.0,70.0,80.0,90.0,
     /100.0,200.,400.,1000.,10000.,100000./
C  ELASTIC MOMENTUM TRANSFER
      DATA YXMOM/56.0,52.0,49.0,42.0,35.0,28.0,21.0,16.5,13.5,11.5,
     /9.20,7.40,6.10,5.20,4.20,3.90,4.00,4.40,5.20,6.40,
     /7.60,8.50,9.60,10.2,10.8,11.3,12.0,12.5,12.9,13.1,
     /13.2,13.6,14.0,14.5,15.5,16.5,17.5,18.5,19.5,20.5,
     /21.5,25.0,25.5,23.5,20.5,16.8,14.0,12.2,10.7,9.60,
     /8.50,4.50,2.20,0.85,.085,.0085/
      DATA XENT/0.0,0.001,0.002,0.004,0.007,0.01,.015,0.02,.025,0.03,
     /0.04,0.05,0.06,0.07,0.08,0.09,0.10,0.12,0.15,0.20,
     /0.25,0.30,0.35,0.40,0.45,0.50,0.60,0.70,0.80,0.90,
     /1.00,1.50,2.00,3.00,4.00,5.00,6.00,7.00,8.00,9.00,
     /10.0,15.0,20.0,30.0,40.0,50.0,60.0,70.0,80.0,90.0,
     /100.0,200.,400.,1000.,10000.,100000./
C  ELASTIC TOTAL ( NO GOOD DATA AVAILABLE)
      DATA YXTOT/56*0.0/
C  VIBRATION V1 (RESONANCE ONLY)
      DATA XVIB2/0.065,1.00,1.90,2.30,3.10,3.70,4.50,5.50,6.50,8.00,
     /9.00,10.0,11.0,12.0,13.0,15.0,20.0,50.0,100.,1000.,
     /10000.,100000./
      DATA YVIB2/0.0,.0000001,.050,.113,.353,.328,.252,.227,.328,.378,
     /.378,.315,.113,.050,.025,.013,.0025,.000013,.0000013,.00000013,
     /.000000013,.0000000013/
C  VIBRATION V2  (RESONANCE ONLY)
      DATA XVIB3/0.100,1.00,1.90,2.30,3.10,3.70,4.50,5.50,6.50,8.00,
     /9.00,10.0,11.0,12.0,13.0,15.0,20.0,50.0,100.,1000.,
     /10000.,100000./
      DATA YVIB3/0.0,.0000001,.315,.617,1.94,1.87,1.39,1.26,1.84,2.07,
     /2.03,1.73,0.63,.277,.113,.050,.025,.000005,.0000005,.00000005,
     /.000000005,.0000000005/
C  VIBRATION V3 (RESONANCE ONLY)
      DATA XVIB4/0.155,1.00,1.90,2.30,3.10,3.70,4.50,5.50,6.50,8.00,
     /9.00,10.0,11.0,12.0,13.0,15.0,20.0,50.0,100.,1000.,
     /10000.,100000./
      DATA YVIB4/0.0,.0000001,.680,1.36,4.21,4.03,3.02,2.72,4.01,4.54,
     /4.48,3.78,1.39,.605,.252,.126,.063,.00013,.000013,.0000013,
     /.00000013,.000000013/
C  VIBRATION HARMONIC 2(V3)
      DATA XVIB5/0.35,1.00,1.90,2.30,3.10,3.70,4.50,5.50,6.50,8.00,
     /9.00,10.0,11.0,12.0,13.0,15.0,20.0,50.0,100.,1000.,
     /10000.,100000./
      DATA YVIB5/0.0,.0000001,.243,.486,1.51,1.43,1.08,.972,1.43,1.62,
     /1.59,1.35,.486,.216,.081,.054,.027,.00027,.000027,.0000027,
     /.00000027,.000000027/
C VIBRATION HARMONIC (3(V3) + ALL OTHER HARMONICS)
      DATA XVIB6/0.500,1.00,1.90,2.30,3.10,3.70,4.50,5.50,6.50,8.00,
     /9.00,10.0,11.0,12.0,13.0,15.0,20.0,50.0,100.,1000.,
     /10000.,100000./
      DATA YVIB6/0.0,.0000001,.826,1.65,5.12,4.90,3.65,3.30,4.85,5.50,
     /5.45,4.60,1.65,.735,.300,.160,.070,.00023,.000023,.0000023,
     /.00000023,.000000023/
C  DISOCIATION X-SECTION
      DATA XDISS/11.0,12.0,13.0,14.0,15.0,18.0,20.0,25.0,30.0,40.0,
     /50.0,60.0,80.0,100.,120.,150.,200.,300.,400.,500.,
     /600.,800.,1000.,2000.,4000.,10000.,100000./
      DATA YDISS/0.00,.005,.070,0.22,0.75,1.70,2.25,2.90,3.15,3.35,
     /3.45,3.50,3.60,3.60,3.60,3.55,3.50,3.35,3.25,3.08,
     /2.80,2.45,2.05,1.12,0.65,0.30,0.030/
C ION NISHIMURA ET AL
      DATA XION/13.38,16.0,17.0,18.0,19.0,20.0,22.0,24.0,26.0,28.0,
     /30.0,32.0,34.0,36.0,38.0,40.0,42.0,44.0,46.0,48.0,
     /50.0,60.0,70.0,80.0,90.0,100.,125.,150.,175.,200.,
     /250.,300.,350.,400.,450.,500.,600.,700.,800.,900.,
     /1000.,1250.,1500.,1750.,2000.,2500.,3000.,10000.,20000.,100000./
      DATA YION/0.00,.129,.316,.562,.815,1.13,1.81,2.31,3.08,3.58,
     /4.10,4.57,5.12,5.58,5.88,6.54,7.01,7.43,7.85,8.31,
     /8.99,10.4,11.3,11.9,12.5,12.8,13.3,13.4,13.2,12.8,
     /12.1,11.2,10.5,9.80,9.31,8.61,7.80,6.99,6.41,5.82,
     /5.48,4.64,4.05,3.62,3.31,2.78,2.44,0.88,0.48,0.13/
C ATTACHMENT
      DATA XATT/0.70,0.80,1.00,1.50,1.70,2.00,2.30,2.50,2.70,3.00,
     /3.50,4.00,4.50,5.00,5.50,6.00,6.50,7.00,8.00,10.0,
     /20.0,100.0,100000./
C PRESSURE DEPENDENT ATTACHMENT X-SEC
      DATA YATT/.000,.003,.006,.028,.049,.092,.097,.073,.035,.026,
     /.021,.017,.015,.012,.008,.006,.005,.005,.005,.004,
     /.002,.00005,.0000005/
C  DISOCIATIVE ATTACHMENT
      DATA YATT1/0.00,0.00,0.00,.002,.010,.026,.066,.099,.127,.103,
     /.055,.025,.009,.004,.004,.004,.003,.003,.002,.001,
     /.001,.00005,.0000005/
C ---------------------------------------------------------------------
C    APPROXIMATE PRESSURE DEPENDENCE OF ATTACHMENT IS INCLUDED
C    ALLOWS SUPERELASTIC SCATTERING TO ALL VIBRATIONAL LEVELS
C    EXCLUDING VIBRATION HARMONICS.
C    BORN ANGULAR DISTRIBUTION FOR  V2(0.100) AND V3(0.155) LEVELS.
C --------------------------------------------------------------------
C
      NAME=' C3F8  -2002-- '
C
      NIN=9
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
C ANISOTROPIC SCATTERING FOR LEVELS 5 AND 6
      KIN(5)=1
      KIN(6)=1
C
      NDATA=56
      NETOT=56
      NVIB2=22
      NVIB3=22
      NVIB4=22
      NVIB5=22
      NVIB6=22
      NDISS=27
      NATT=23
      NION=50
      E(1)=0.0
      E(2)=2.0*EMASS/(188.0193*AMU)
      E(3)=13.38
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=13.38
      EIN(1)=-0.065
      EIN(2)=-0.100
      EIN(3)=-0.155
      EIN(4)=0.065
      EIN(5)=0.100
      EIN(6)=0.155
      EIN(7)=0.35
      EIN(8)=0.500
      EIN(9)=11.0
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       C3F8           '
      SCRPT(3)=' IONISATION    ELOSS= 13.38   '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' VIB V1        ELOSS= -0.065  '
      SCRPT(8)=' VIB V2        ELOSS= -0.100  '
      SCRPT(9)=' VIB V3        ELOSS= -0.155  '
      SCRPT(10)=' VIB V1        ELOSS=  0.065  '
      SCRPT(11)=' VIB V2        ELOSS=  0.100  '
      SCRPT(12)=' VIB V3        ELOSS=  0.155  '
      SCRPT(13)=' VIB 2V3       ELOSS=  0.35   '
      SCRPT(14)=' VIB           ELOSS=  0.50   '
      SCRPT(15)=' EXC DISOCN    ELOSS= 11.0    '
      APOP1=DEXP(EIN(1)/AKT)
      APOP2=DEXP(EIN(2)/AKT)
      APOP3=DEXP(EIN(3)/AKT)
      EN=-ESTEP/2.0
      DO 9000 I=1,NSTEP
      EN=EN+ESTEP
      DO 10 J=2,NDATA
      IF(EN.LE.XENM(J)) GO TO 20
   10 CONTINUE
      J=NDATA
   20 A=(YXMOM(J)-YXMOM(J-1))/(XENM(J)-XENM(J-1))
      B=(XENM(J-1)*YXMOM(J)-XENM(J)*YXMOM(J-1))/(XENM(J-1)-XENM(J))
      XMOMT=(A*EN+B)*1.0D-16
      DO 50 J=2,NETOT
      IF(EN.LE.XENT(J)) GO TO 60
   50 CONTINUE
      J=NETOT
   60 A=(YXTOT(J)-YXTOT(J-1))/(XENT(J)-XENT(J-1))
      B=(XENT(J-1)*YXTOT(J)-XENT(J)*YXTOT(J-1))/(XENT(J-1)-XENT(J))
      XTOT=(A*EN+B)*1.0D-16
      Q(2,I)=XTOT
      PEQEL(2,I)=0.5+(XTOT-XMOMT)/XTOT
      IF(KEL(2).EQ.0) Q(2,I)=XMOMT
      IF(KEL(2).EQ.0) PEQEL(2,I)=0.5
C
      Q(3,I)=0.0
      IF(EN.LT.E(3)) GO TO 200
      DO 110 J=2,NION
      IF(EN.LE.XION(J)) GO TO 120
  110 CONTINUE
      J=NION
  120 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
C
  200 Q(4,I)=0.0
      IF(EN.LT.XATT(1)) GO TO 250
      IF(EN.GT.XATT(NATT)) GO TO 250
      DO 210 J=2,NATT
      IF(EN.LE.XATT(J)) GO TO 220
  210 CONTINUE
      J=NATT
  220 A=(YATT(J)-YATT(J-1))/(XATT(J)-XATT(J-1))
      B=(XATT(J-1)*YATT(J)-XATT(J)*YATT(J-1))/(XATT(J-1)-XATT(J))
      A1=(YATT1(J)-YATT1(J-1))/(XATT(J)-XATT(J-1))
      B1=(XATT(J-1)*YATT1(J)-XATT(J)*YATT1(J-1))/(XATT(J-1)-XATT(J))
      Q(4,I)=((A*EN+B)+(A1*EN+B1)*TORR/2280.0)*1.D-16
  250 Q(5,I)=0.0
      Q(6,I)=0.0
C
C SUPERELASTICS
      QIN(1,I)=0.0
      QIN(2,I)=0.0
      QIN(3,I)=0.0
      IF(EN.EQ.0.0) GO TO 305
C SUPERELASTIC OF VIBRATION V1
      EFAC=DSQRT(1.0-(EIN(1)/EN))
      QIN(1,I)=0.070*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      DO 260 J=2,NVIB2
      IF((EN+EIN(4)).LE.XVIB2(J)) GO TO 270
  260 CONTINUE
      J=NVIB2
  270 A=(YVIB2(J)-YVIB2(J-1))/(XVIB2(J)-XVIB2(J-1))
      B=(XVIB2(J-1)*YVIB2(J)-XVIB2(J)*YVIB2(J-1))/(XVIB2(J-1)-XVIB2(J))
      QIN(1,I)=QIN(1,I)+(EN+EIN(4))*(A*(EN+EIN(4))+B)/EN
      QIN(1,I)=QIN(1,I)*APOP1/(1.0+APOP1)*1.D-16
C  SUPERELASTIC OF VIBRATION V2
      EFAC=DSQRT(1.0-(EIN(2)/EN))
      QIN(2,I)=0.850*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      DO 280 J=2,NVIB3
      IF((EN+EIN(5)).LE.XVIB3(J)) GO TO 290
  280 CONTINUE
      J=NVIB3
  290 A=(YVIB3(J)-YVIB3(J-1))/(XVIB3(J)-XVIB3(J-1))
      B=(XVIB3(J-1)*YVIB3(J)-XVIB3(J)*YVIB3(J-1))/(XVIB3(J-1)-XVIB3(J))
      QIN(2,I)=QIN(2,I)+(EN+EIN(5))*(A*(EN+EIN(5))+B)/EN
      QIN(2,I)=QIN(2,I)*APOP2/(1.0+APOP2)*1.D-16
C SUPERELASTIC OF VIBRATION V3
      EFAC=DSQRT(1.0-(EIN(3)/EN))
      QIN(3,I)=1.600*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      DO 300 J=2,NVIB4
      IF((EN+EIN(6)).LE.XVIB4(J))GO TO 301
  300 CONTINUE
      J=NVIB4
  301 A=(YVIB4(J)-YVIB4(J-1))/(XVIB4(J)-XVIB4(J-1))
      B=(XVIB4(J-1)*YVIB4(J)-XVIB4(J)*YVIB4(J-1))/(XVIB4(J-1)-XVIB4(J))
      QIN(3,I)=QIN(3,I)+(EN+EIN(6))*(A*(EN+EIN(6))+B)/EN
      QIN(3,I)=QIN(3,I)*APOP3/(1.0+APOP3)*1.D-16
C
  305 CONTINUE
      QIN(4,I)=0.0
      IF(EN.LE.EIN(4)) GO TO 400
      DO 310 J=2,NVIB2
      IF(EN.LE.XVIB2(J)) GO TO 320
  310 CONTINUE
      J=NVIB2
  320 A=(YVIB2(J)-YVIB2(J-1))/(XVIB2(J)-XVIB2(J-1))
      B=(XVIB2(J-1)*YVIB2(J)-XVIB2(J)*YVIB2(J-1))/(XVIB2(J-1)-XVIB2(J))
      EFAC=DSQRT(1.0-(EIN(4)/EN))
      QIN(4,I)=0.070*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      QIN(4,I)=((A*EN+B)+QIN(4,I))*1.0/(1.0+APOP1)*1.D-16
  400 CONTINUE
C
      QIN(5,I)=0.0
      IF(EN.LE.EIN(5)) GO TO 500
      DO 410 J=2,NVIB3
      IF(EN.LE.XVIB3(J)) GO TO 420
  410 CONTINUE
      J=NVIB3
  420 A=(YVIB3(J)-YVIB3(J-1))/(XVIB3(J)-XVIB3(J-1))
      B=(XVIB3(J-1)*YVIB3(J)-XVIB3(J)*YVIB3(J-1))/(XVIB3(J-1)-XVIB3(J))
      EFAC=DSQRT(1.0-(EIN(5)/EN))
      QIN(5,I)=0.850*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      ELF=EN-EIN(5)
      FWD=DLOG((EN+ELF)/(EN+ELF-2.0*DSQRT(EN*ELF)))
      BCK=DLOG((EN+ELF+2.0*DSQRT(EN*ELF))/(EN+ELF))
C ASSUME RATIO  MOM.T /TOT X-SECT FOR RESONANCE PART = RAT3
      RAT3=0.80
      XMT=((1.5-FWD/(FWD+BCK))*QIN(5,I)+RAT3*(A*EN+B))*1.0D-16
      XMT=XMT/(1.0+APOP2)
      QIN(5,I)=((A*EN+B)+QIN(5,I))*1.0/(1.0+APOP2)*1.D-16
      PEQIN(5,I)=0.5+(QIN(5,I)-XMT)/QIN(5,I)
  500 CONTINUE
C
      QIN(6,I)=0.0
      IF(EN.LE.EIN(6)) GO TO 600
      DO 510 J=2,NVIB4
      IF(EN.LE.XVIB4(J)) GO TO 520
  510 CONTINUE
      J=NVIB4
  520 A=(YVIB4(J)-YVIB4(J-1))/(XVIB4(J)-XVIB4(J-1))
      B=(XVIB4(J-1)*YVIB4(J)-XVIB4(J)*YVIB4(J-1))/(XVIB4(J-1)-XVIB4(J))
      EFAC=DSQRT(1.0-(EIN(6)/EN))
      QIN(6,I)=1.600*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      ELF=EN-EIN(6)
      FWD=DLOG((EN+ELF)/(EN+ELF-2.0*DSQRT(EN*ELF)))
      BCK=DLOG((EN+ELF+2.0*DSQRT(EN*ELF))/(EN+ELF))
C   ASSUME RATIO MOM T./ TOT X-SECT FOR RESONANCE PART = RAT4
      RAT4=0.80
      XMT=((1.5-FWD/(FWD+BCK))*QIN(6,I)+RAT4*(A*EN+B))*1.0D-16
      XMT=XMT/(1.0+APOP3)
      QIN(6,I)=((A*EN+B)+QIN(6,I))*1.0/(1.0+APOP3)*1.D-16
      PEQIN(6,I)=0.5+(QIN(6,I)-XMT)/QIN(6,I)
  600 CONTINUE
C
      QIN(7,I)=0.0
      IF(EN.LE.EIN(7)) GO TO 700
      DO 610 J=2,NVIB5
      IF(EN.LE.XVIB5(J)) GO TO 620
  610 CONTINUE
      J=NVIB5
  620 A=(YVIB5(J)-YVIB5(J-1))/(XVIB5(J)-XVIB5(J-1))
      B=(XVIB5(J-1)*YVIB5(J)-XVIB5(J)*YVIB5(J-1))/(XVIB5(J-1)-XVIB5(J))
      QIN(7,I)=(A*EN+B)*1.D-16
  700 CONTINUE
C
      QIN(8,I)=0.0
      IF(EN.LE.EIN(8)) GO TO 800
      DO 710 J=2,NVIB6
      IF(EN.LE.XVIB6(J)) GO TO 720
  710 CONTINUE
      J=NVIB6
  720 A=(YVIB6(J)-YVIB6(J-1))/(XVIB6(J)-XVIB6(J-1))
      B=(XVIB6(J-1)*YVIB6(J)-XVIB6(J)*YVIB6(J-1))/(XVIB6(J-1)-XVIB6(J))
      QIN(8,I)=(A*EN+B)*1.D-16
  800 CONTINUE
C
      QIN(9,I)=0.0
      IF(EN.LE.EIN(9)) GO TO 900
      DO 810 J=2,NDISS
      IF(EN.LE.XDISS(J)) GO TO 820
  810 CONTINUE
      J=NDISS
  820 A=(YDISS(J)-YDISS(J-1))/(XDISS(J)-XDISS(J-1))
      B=(XDISS(J-1)*YDISS(J)-XDISS(J)*YDISS(J-1))/(XDISS(J-1)-XDISS(J))
      QIN(9,I)=(A*EN+B)*1.D-16
  900 CONTINUE
C
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+QIN(1,I)+QIN(2,I)+QIN(3,I)+QIN(4,I)+
     /QIN(5,I)+QIN(6,I)+QIN(7,I)+QIN(8,I)+QIN(9,I)
 9000 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(9)) NIN=8
      IF(EFINAL.LE.EIN(8)) NIN=7
      IF(EFINAL.LE.EIN(7)) NIN=6
      IF(EFINAL.LE.EIN(6)) NIN=5
      IF(EFINAL.LE.EIN(5)) NIN=4
      IF(EFINAL.LE.EIN(4)) NIN=3
      IF(EFINAL.LE.EIN(3)) NIN=2
      IF(EFINAL.LE.EIN(2)) NIN=1
      IF(EFINAL.LE.EIN(1)) NIN=0
      RETURN
      END
      SUBROUTINE GAS53(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      DIMENSION XEN(30),YXSEC(30),XION(104),YION(104),
     /XVIB1(18),YVIB1(18),XVIB2(18),YVIB2(18),XVIB3(16),YVIB3(16),
     /XVIB4(16),YVIB4(16),XVIB5(16),YVIB5(16),
     /XEXC1(15),YEXC1(15),XEXC2(14),YEXC2(14),XEXC3(15),YEXC3(15),
     /XATT(25),YAT1(25),YAT2(25)
      CHARACTER*15 NAME
      CHARACTER*30 SCRPT(226)
      DATA XEN/1.D-6,.001,0.01,0.10,0.20,0.40,0.70,1.00,2.00,3.00,
     /4.00,5.00,6.00,7.00,8.00,10.0,15.0,20.0,30.0,50.0,
     /100.,200.,300.,600.,1000.,2000.,3000.,6000.,10000.,100000./
      DATA YXSEC/3000.,1500.,150.,19.0,14.0,12.0,12.0,12.0,12.0,12.0,
     /12.0,12.0,12.0,12.0,12.0,12.0,11.5,11.0,10.0,7.40,
     /4.70,1.99,1.16,0.41,.185,.058,.028,.0081,.0031,.0003/
C  VIBRATION V2  BEND MODE
C  RESONANCE ONLY , DIPOLE ANALYTICAL
      DATA XVIB1/.0869,0.50,1.00,1.50,2.00,3.00,4.00,5.00,6.00,7.00,
     /8.00,9.00,10.0,12.0,15.0,100.,1000.,100000./
      DATA YVIB1/0.00,.0005,.001,.005,.010,0.12,.265,0.24,0.13,0.07,
     /0.03,0.02,0.01,.001,.0001,.00001,.000001,.0000001/
C  VIBRATION SUM OF V1 AND V3 STRETCH MODES
C  RESONANCE ONLY , DIPOLE ANALYTICAL
      DATA XVIB2/.1292,0.50,1.00,1.50,2.00,3.00,4.00,5.00,6.00,7.00,
     /8.00,9.00,10.0,12.0,14.0,100.,1000.,100000./
      DATA YVIB2/0.00,0.01,0.015,0.02,0.05,0.43,0.83,0.74,0.56,0.44,
     /0.25,0.14,0.05,0.01,.001,.0001,.00001,.000001/
C VIBRATION HARMONIC (V12 AND V23 )
      DATA XVIB3/0.2161,1.00,2.00,3.00,4.00,5.00,6.00,7.00,8.00,9.00,
     /10.0,12.0,20.0,100.,1000.,100000./
      DATA YVIB3/0.00,.001,0.01,.077,.165,.140,.068,.034,.022,.020,
     /.020,.010,.005,.001,.0001,.000001/
C VIBRATION HARMONIC (V13 2V1 AND 2V3)
      DATA XVIB4/0.2660,1.00,2.00,3.00,4.00,5.00,6.00,7.00,8.00,9.00,
     /10.0,12.0,20.0,100.,1000.,100000./
      DATA YVIB4/0.00,.003,0.04,.140,.278,.271,.238,.210,.140,.075,
     /.029,.010,.005,.001,.0001,.000001/
C VIBRATION HARMONIC ( SUM OF HIGHER HARMONICS )
      DATA XVIB5/0.38,1.00,2.00,3.00,4.00,5.00,6.00,7.00,8.00,9.00,
     /10.0,12.0,20.0,100.,1000.,100000./
      DATA YVIB5/0.00,.001,0.02,.070,.139,.135,.119,.105,.070,.038,
     /.014,.005,.002,.001,.0001,.000001/
      DATA XION/12.75,13.0,13.5,14.0,14.5,15.0,15.5,16.0,16.5,17.0,
     /17.5,18.0,18.5,19.0,19.5,20.0,20.5,21.0,21.5,22.0,
     /22.5,23.0,23.5,24.0,26.0,28.0,30.0,32.0,34.0,36.0,
     /38.0,40.0,45.0,50.0,55.0,60.0,65.0,70.0,75.0,80.0,
     /85.0,90.0,95.0,100.,105.,110.,115.,120.,125.,130.,
     /135.,140.,145.,150.,160.,170.,180.,190.,200.,210.,
     /220.,230.,240.,250.,300.,350.,400.,450.,500.,550.,
     /600.,650.,700.,750.,800.,850.,900.,950.,1000.,1100.,
     /1250.,1500.,1750.,2000.,2250.,2500.,2750.,3000.,3250.,3500.,
     /3750.,4000.,4500.,5000.,6000.,7000.,8000.,9000.,10000.,15000.,
     /20000.,30000.,50000.,100000./
      DATA YION/0.00,.011,.035,.059,.083,.118,.162,.216,.270,.324,
     /.378,.431,.484,.535,.586,.636,.685,.732,.779,.824,
     /.869,.921,.975,1.03,1.25,1.46,1.66,1.84,2.01,2.17,
     /2.31,2.44,2.72,2.95,3.14,3.30,3.42,3.52,3.60,3.66,
     /3.71,3.74,3.77,3.78,3.79,3.80,3.80,3.79,3.78,3.77,
     /3.76,3.74,3.72,3.70,3.66,3.61,3.56,3.51,3.46,3.41,
     /3.35,3.30,3.25,3.20,2.97,2.76,2.57,2.41,2.27,2.14,
     /2.03,1.93,1.84,1.76,1.68,1.62,1.55,1.50,1.44,1.35,
     /1.23,1.07,.950,.856,.780,.717,.664,.619,.580,.546,
     /.516,.489,.443,.406,.348,.305,.272,.246,.225,.158,
     /.123,.086,.054,.029/
C  DISOCIATIVE ATTACHMENT :  O3 + E- = O2 + O-
      DATA XATT/0.00,0.20,0.40,0.60,0.80,1.00,1.20,1.40,1.60,1.80,
     /2.00,2.40,2.60,3.00,3.50,4.00,5.00,6.00,7.00,7.50,
     /8.00,9.00,10.0,20.0,100000./
      DATA YAT1/0.00,.032,.070,0.14,0.22,0.29,0.36,0.37,0.36,0.26,
     /0.21,0.12,0.10,0.09,0.08,0.06,0.02,0.02,0.05,0.07,
     /0.05,0.01,.005,.001,.00000001/
C DISOCIATIVE ATTACHMENT :  O3 + E- = O + O2-
      DATA YAT2/0.00,0.00,0.00,0.01,0.08,0.13,0.17,0.15,0.11,.055,
     /.025,.006,.005,.002,.002,.0015,.001,.002,.003,.003,
     /.0025,.001,.0005,.0001,.00000001/
C  CHAPPUIS BAND
      DATA XEXC1/1.50,2.00,3.00,4.00,5.00,6.00,8.00,10.0,12.0,14.0,
     /20.0,40.0,100.,1000.,100000./
      DATA YEXC1/0.00,0.01,0.04,0.12,0.12,0.10,0.08,0.06,0.05,0.04,
     /0.02,0.01,.004,.0004,.000004/
C   HARTLEY BAND
      DATA XEXC2/4.85,6.00,7.00,8.00,9.00,10.0,12.0,14.0,16.0,20.0,
     /40.0,100.,1000.,100000./
      DATA YEXC2/0.00,0.26,0.63,0.75,0.68,0.65,0.58,0.47,0.37,0.27,
     /0.13,0.05,.005,.000005/
C    SUM OF OTHER STATES HIGHER THAN 9.0 EV
      DATA XEXC3/9.00,10.0,12.0,14.0,16.0,18.0,20.0,40.0,100.,150.,
     /200.,400.,1000.,10000.,100000./
      DATA YEXC3/0.00,0.52,1.50,1.50,1.40,1.40,1.20,1.00,0.80,0.70,
     /0.60,0.30,0.12,.012,.0012/
C ---------------------------------------------------------------------
C  OZONE
C      USED BEB (THEORETICAL VALUES) FOR IONIZATION X-SECTION
C      VIB.RESONANCES:  ALLAN ET AL      J. PHYS. B   29(1996)4727
C      ATTACHMENT:      RANGWALA ET AL   J. PHYS. B   32(1999)3795
C      EXCITATION:      ALLEN ET AL      J.CHEM.PHYS.105(1996)5665
C      ELASTIC   :      SHYN AND SWEENEY  PHYS REV  47A (1993)2919
C                       GULLEY ET AL     J. PHYS. B  31 (1998)5197
C                       PABLOS ET AL     J. PHYS. B  35 (2002)865
C      GOOD FIT TO EXPERIMENTAL ATTACHMENT RATE MEASUREMENTS :
C              STELMAN,MORUZZI AND PHELPS  J.CHEM.PHYS 56(1972)4183
C      N.B. ATTACHMENT RATE MEASUREMENTS OF PHELPS NEED TO BE CORRECTED
C           FOR DETACHMENT COLLISIONS . CORRECTION FACTOR TAKEN FROM
C           KLOPOVSKII ET AL   PLASMA PHYSICS REPORTS 23(1997) 165-171
C ---------------------------------------------------------------------
C
      NAME=' OZONE  2002   '
C
      NIN=11
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      NDATA=30
      NVIB1=18
      NVIB2=18
      NVIB3=16
      NVIB4=16
      NVIB5=16
      NION=104
      NATT=25
      NEXC1=15
      NEXC2=14
      NEXC3=15
      E(1)=0.0
      E(2)=2.0*EMASS/(47.9982*AMU)
      E(3)=12.75
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
C SET OPAL AND BEATY ENERGY SPLITTING TO EION
      EOBY=E(3)
      EIN(1)=-0.005
      EIN(2)=0.005
      EIN(3)=-0.0869
      EIN(4)=0.0869
      EIN(5)=0.1292
      EIN(6)=0.2161
      EIN(7)=0.2660
      EIN(8)=0.380
      EIN(9)=1.50
      EIN(10)=4.85
      EIN(11)=9.00
      APOPR=DEXP(EIN(1)/AKT)
      APOPV=DEXP(EIN(3)/AKT)
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC        OZONE         '
      SCRPT(3)=' IONISATION    ELOSS= 12.75   '
      SCRPT(4)=' DISOCIATIVE ATTACHMENT       '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' ROT           ELOSS= -0.005  '
      SCRPT(8)=' ROT           ELOSS=  0.005  '
      SCRPT(9)=' VIB2  BEND    ELOSS= -0.0869 '
      SCRPT(10)=' VIB2 BEND     ELOSS=  0.0869 '
      SCRPT(11)=' VIB3+VIB1     ELOSS=  0.1292 '
      SCRPT(12)=' V12+V23       ELOSS=  0.2161 '
      SCRPT(13)=' V13+2V1+2V3   ELOSS=  0.2660 '
      SCRPT(14)=' SUM HIGH VIB  ELOSS=  0.380  '
      SCRPT(15)=' EXC CHAPPUIS  ELOSS=  1.50   '
      SCRPT(16)=' EXC HARTLEY   ELOSS=  4.85   '
      SCRPT(17)=' EXC           ELOSS=  9.00   '
      EN=-ESTEP/2.0
      DO 9000 I=1,NSTEP
      EN=EN+ESTEP
      IF(EN.EQ.0.0) Q(2,I)=3000.D-16
      IF(EN.EQ.0.0) GO TO 30
      DO 10 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 20
   10 CONTINUE
      J=NDATA
C USE LOG INTERPOLATION
   20 Y1=DLOG(YXSEC(J-1))
      Y2=DLOG(YXSEC(J))
      X1=DLOG(XEN(J-1))
      X2=DLOG(XEN(J))
      A=(Y2-Y1)/(X2-X1)
      B=(X1*Y2-X2*Y1)/(X1-X2)
      Q(2,I)=DEXP((A*DLOG(EN)+B))*1.0D-16
   30 Q(3,I)=0.0
      IF(EN.LT.E(3)) GO TO 200
      DO 110 J=2,NION
      IF(EN.LE.XION(J)) GO TO 120
  110 CONTINUE
      J=NION
  120 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
C   SUM OF DISOCIATIVE ATTACHMENTS TO O- AND O2-
  200 Q(4,I)=0.0
      IF(EN.LT.XATT(1)) GO TO 300
      IF(EN.GT.XATT(NATT)) GO TO 300
      DO 210 J=2,NATT
      IF(EN.LE.XATT(J)) GO TO 220
  210 CONTINUE
      J=NATT
  220 A1=(YAT1(J)-YAT1(J-1))/(XATT(J)-XATT(J-1))
      B1=(XATT(J-1)*YAT1(J)-XATT(J)*YAT1(J-1))/(XATT(J-1)-XATT(J))
      A2=(YAT2(J)-YAT2(J-1))/(XATT(J)-XATT(J-1))
      B2=(XATT(J-1)*YAT2(J)-XATT(J)*YAT2(J-1))/(XATT(J-1)-XATT(J))
      Q(4,I)=((A1+A2)*EN+B1+B2)*1.D-16
  300 Q(5,I)=0.0
      Q(6,I)=0.0
C
C SUPERELASTIC EFFECTIVE ROTATION
C
      QIN(1,I)=0.0
      IF(EN.EQ.0.0) GO TO 305
      EFAC=DSQRT(1.0-(EIN(1)/EN))
      QIN(1,I)=0.450*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      QIN(1,I)=QIN(1,I)*APOPR/(1.0+APOPR)*1.D-16
C
C EFFECTIVE ROTATION
  305 CONTINUE
      QIN(2,I)=0.0
      IF(EN.LE.EIN(2)) GO TO 350
      EFAC=DSQRT(1.0-(EIN(2)/EN))
      QIN(2,I)=0.450*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      QIN(2,I)=QIN(2,I)*1.0/(1.0+APOPR)*1.D-16
  350 CONTINUE
C
C SUPERELASTIC  VIBRATION V2 (BEND MODE)
C
      QIN(3,I)=0.0
      IF(EN.EQ.0.0) GO TO 365
      EFAC=DSQRT(1.0-(EIN(3)/EN))
      QIN(3,I)=0.0133*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      QIN(3,I)=QIN(3,I)*APOPV/(1.0+APOPV)*1.D-16
C
C VIBRATION V2 (BEND MODE)
  365 CONTINUE
      QIN(4,I)=0.0
      IF(EN.LE.EIN(4)) GO TO 400
      DO 370 J=2,NVIB1
      IF(EN.LE.XVIB1(J)) GO TO 380
  370 CONTINUE
      J=NVIB1
  380 A=(YVIB1(J)-YVIB1(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB1(J)-XVIB1(J)*YVIB1(J-1))/(XVIB1(J-1)-XVIB1(J))
      EFAC=DSQRT(1.0-(EIN(4)/EN))
      QIN(4,I)=0.0133*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      QIN(4,I)=(A*EN+B)+QIN(4,I)
      QIN(4,I)=QIN(4,I)*1.0/(1.0+APOPV)*1.D-16
  400 CONTINUE
C
C  V1 + V3   ( STRETCH MODES )
      QIN(5,I)=0.0
      IF(EN.LE.EIN(5)) GO TO 500
      DO 410 J=2,NVIB2
      IF(EN.LE.XVIB2(J)) GO TO 420
  410 CONTINUE
      J=NVIB2
  420 A=(YVIB2(J)-YVIB2(J-1))/(XVIB2(J)-XVIB2(J-1))
      B=(XVIB2(J-1)*YVIB2(J)-XVIB2(J)*YVIB2(J-1))/(XVIB2(J-1)-XVIB2(J))
      EFAC=DSQRT(1.0-(EIN(5)/EN))
      QIN(5,I)=0.090*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      QIN(5,I)=((A*EN+B)+QIN(5,I))*1.D-16
  500 CONTINUE
C
C V12 +V23
      QIN(6,I)=0.0
      IF(EN.LE.EIN(6)) GO TO 600
      DO 510 J=2,NVIB3
      IF(EN.LE.XVIB3(J)) GO TO 520
  510 CONTINUE
      J=NVIB3
  520 A=(YVIB3(J)-YVIB3(J-1))/(XVIB3(J)-XVIB3(J-1))
      B=(XVIB3(J-1)*YVIB3(J)-XVIB3(J)*YVIB3(J-1))/(XVIB3(J-1)-XVIB3(J))
      QIN(6,I)=(A*EN+B)*1.D-16
  600 CONTINUE
C
C  V13+2V1+2V3
      QIN(7,I)=0.0
      IF(EN.LE.EIN(7)) GO TO 700
      DO 610 J=2,NVIB4
      IF(EN.LE.XVIB4(J)) GO TO 620
  610 CONTINUE
      J=NVIB4
  620 A=(YVIB4(J)-YVIB4(J-1))/(XVIB4(J)-XVIB4(J-1))
      B=(XVIB4(J-1)*YVIB4(J)-XVIB4(J)*YVIB4(J-1))/(XVIB4(J-1)-XVIB4(J))
      QIN(7,I)=(A*EN+B)*1.D-16
  700 CONTINUE
C
C  HIGHER HARMONICS
      QIN(8,I)=0.0
      IF(EN.LE.EIN(8)) GO TO 800
      DO 710 J=2,NVIB5
      IF(EN.LE.XVIB5(J)) GO TO 720
  710 CONTINUE
      J=NVIB5
  720 A=(YVIB5(J)-YVIB5(J-1))/(XVIB5(J)-XVIB5(J-1))
      B=(XVIB5(J-1)*YVIB5(J)-XVIB5(J)*YVIB5(J-1))/(XVIB5(J-1)-XVIB5(J))
      QIN(8,I)=(A*EN+B)*1.D-16
  800 CONTINUE
C
C   EXCITATION  CHAPPUIS BAND
      QIN(9,I)=0.0
      IF(EN.LE.EIN(9)) GO TO 900
      DO 810 J=2,NEXC1
      IF(EN.LE.XEXC1(J)) GO TO 820
  810 CONTINUE
      J=NEXC1
  820 A=(YEXC1(J)-YEXC1(J-1))/(XEXC1(J)-XEXC1(J-1))
      B=(XEXC1(J-1)*YEXC1(J)-XEXC1(J)*YEXC1(J-1))/(XEXC1(J-1)-XEXC1(J))
      QIN(9,I)=(A*EN+B)*1.D-16
  900 CONTINUE
C
C   EXCITATION  HARTLEY BAND
      QIN(10,I)=0.0
      IF(EN.LE.EIN(10)) GO TO 1000
      DO 910 J=2,NEXC2
      IF(EN.LE.XEXC2(J)) GO TO 920
  910 CONTINUE
      J=NEXC2
  920 A=(YEXC2(J)-YEXC2(J-1))/(XEXC2(J)-XEXC2(J-1))
      B=(XEXC2(J-1)*YEXC2(J)-XEXC2(J)*YEXC2(J-1))/(XEXC2(J-1)-XEXC2(J))
      QIN(10,I)=(A*EN+B)*1.D-16
 1000 CONTINUE
C
C   EXCITATION
      QIN(11,I)=0.0
      IF(EN.LE.EIN(11)) GO TO 1100
      DO 1010 J=2,NEXC3
      IF(EN.LE.XEXC3(J)) GO TO 1020
 1010 CONTINUE
      J=NEXC3
 1020 A=(YEXC3(J)-YEXC3(J-1))/(XEXC3(J)-XEXC3(J-1))
      B=(XEXC3(J-1)*YEXC3(J)-XEXC3(J)*YEXC3(J-1))/(XEXC3(J-1)-XEXC3(J))
      QIN(11,I)=(A*EN+B)*1.D-16
 1100 CONTINUE
C
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+QIN(1,I)+QIN(2,I)+QIN(3,I)+QIN(4,I)+
     /QIN(5,I)+QIN(6,I)+QIN(7,I)+QIN(8,I)+QIN(9,I)+QIN(10,I)+QIN(11,I)
 9000 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(11)) NIN=10
      IF(EFINAL.LE.EIN(10)) NIN=9
      IF(EFINAL.LE.EIN(9)) NIN=8
      IF(EFINAL.LE.EIN(8)) NIN=7
      IF(EFINAL.LE.EIN(7)) NIN=6
      IF(EFINAL.LE.EIN(6)) NIN=5
      IF(EFINAL.LE.EIN(5)) NIN=4
      IF(EFINAL.LE.EIN(4)) NIN=3
      IF(EFINAL.LE.EIN(3)) NIN=2
      IF(EFINAL.LE.EIN(2)) NIN=1
      IF(EFINAL.LE.EIN(1)) NIN=0
      RETURN
      END
      SUBROUTINE GAS54(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/RATIO/AN1,AN2,AN3,AN4,AN5,AN6,AN,FRAC(6)
      COMMON/GASN/NGASN(6)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      DIMENSION XEN(79),YXSEC(79),XION(52),YION(52)
      DIMENSION XDIM(10),YDIM(10)
      DIMENSION XEXC3(28),YEXC3(28),XEXC4(32),YEXC4(32),XEXC5(20)
      DIMENSION YEXC5(20),XEXC6(24),YEXC6(24),YEXC7(12),XEXC7(12)
      DIMENSION YEXC8(12),XEXC8(12),XEL(57),YEL(57)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
C   ELASTIC MOMENTUM TRANSFER ENGLAND+ELFORD 1991 (MOD 2003 EL+MC)
      DATA XEN/0.00,.005,0.01,.015,0.02,0.03,0.04,0.05,0.06,0.07,
     /0.08,0.09,0.10,0.12,0.13,0.14,0.15,0.16,0.17,0.18,
     /0.19,0.20,0.21,0.22,0.23,0.24,0.26,0.28,0.30,0.32,
     /0.34,0.36,0.38,0.39,0.40,0.41,0.42,0.43,0.44,0.46,
     /0.48,0.50,0.55,0.60,0.65,0.70,0.75,0.80,0.90,1.00,
     /1.20,1.40,1.60,1.80,2.00,2.50,3.00,4.00,5.00,6.00,
     /7.00,8.00,9.00,10.0,12.0,15.0,25.0,35.0,50.0,100.,
     /150.,300.,400.,500.,1000.,2000.,4000.,10000.,100000./
      DATA YXSEC/13.7,13.8,13.9,14.2,15.0,16.5,18.0,20.5,23.0,26.5,
     /30.0,34.0,39.4,54.9,62.9,71.0,78.9,86.5,94.2,102.,
     /109.,115.,121.,127.,133.,139.,149.,159.,168.,177.,
     /186.,195.,204.,208.,211.,214.,217.,219.,220.,219.,
     /215.,209.,190.,174.,161.,151.,143.,136.,123.,113.,
     /95.5,82.0,70.0,60.5,51.5,37.0,29.0,20.0,14.7,10.8,
     /8.17,5.63,4.29,3.37,3.00,2.95,4.00,4.40,3.60,1.35,
     /0.95,0.79,.826,.752,0.57,0.28,0.14,.056,.0056/
C ELASTIC TOTAL  ELFORD AND MCEARCHAN THEORY
      DATA XEL/0.00,.001,.002,.004,.007,0.01,0.02,0.03,0.04,0.05,
     /0.06,0.07,0.08,0.09,0.10,0.15,0.20,0.25,0.30,0.35,
     /0.40,0.45,0.50,0.55,0.60,0.70,0.80,0.90,1.00,1.20,
     /1.40,1.60,1.80,2.00,3.00,4.00,5.00,6.00,7.00,8.00,
     /9.00,10.0,12.0,15.0,25.0,35.0,50.0,100.,150.,300.,
     /400.,500.,1000.,2000.,4000.,10000.,100000./
      DATA YEL/12.33,17.4,17.9,19.2,21.2,20.4,23.5,26.0,28.2,30.4,
     /32.5,34.7,37.0,39.4,42.0,58.1,81.7,113.,147.,176.,
     /194.,203.,205.,205.,203.,195.,185.,173.,162.,142.,
     /126.,113.,102.,93.1,63.5,46.5,35.3,27.8,22.2,19.4,
     /16.5,14.3,12.5,11.0,9.60,9.00,9.00,8.80,7.50,4.90,
     /3.90,3.40,2.30,1.40,0.90,0.50,0.12/
C IONISATION
      DATA XION/10.4375,15.0,17.5,20.0,25.0,30.0,35.0,40.0,45.0,
     /50.0,55.0,60.0,65.0,70.0,75.0,80.0,90.0,100.,125.,
     /150.,175.,200.,250.,300.,350.,400.,450.,500.,550.,
     /600.,650.,700.,800.,900.,1000.,1500.,2000.,2500.,3000.,
     /3500.,4000.,4500.,5000.,6000.,7000.,8000.,9000.,10000.,11000.,
     /20000.,50000.,100000./
      DATA YION/0.00,1.13,2.47,2.68,3.79,4.50,5.09,5.44,5.75,
     /5.95,6.09,6.22,6.27,6.37,6.38,6.42,6.37,6.27,5.92,
     /5.72,5.44,5.17,4.77,4.34,4.01,3.87,3.46,3.24,3.13,
     /3.07,2.80,2.70,2.37,2.20,2.12,1.62,1.31,1.11,.976,
     /.859,.763,.691,.612,.513,.431,.373,.332,.300,.274,
     /.150,.060,.030/
C  DIMER X-SECTION (ENGLAND AND ELFORD AJP 44(1991)647-675)
      DATA XDIM/.040,.045,0.09,0.17,0.40,4.00,40.0,400.,4000.,100000./
      DATA YDIM/0.00,8.30,8.30,1.25,0.83,.083,.008,.0008,.00008,.000003/
C EXCITATION
      DATA XEXC3/4.667,4.70,4.80,4.90,5.00,5.10,5.20,5.30,5.40,5.50,
     /5.60,5.70,5.80,5.90,6.00,6.25,6.50,7.00,7.25,7.50,
     /10.0,12.0,15.0,20.0,30.0,100.,1000.,100000./
      DATA YEXC3/0.00,0.10,0.60,0.25,0.30,0.40,0.55,0.68,0.85,0.95,
     /0.95,0.90,0.85,0.75,0.70,0.65,0.60,0.50,0.48,0.45,
     /0.15,0.09,.044,.019,.005,.00015,.000005,.0000000001/
      DATA XEXC4/4.887,4.90,5.00,5.10,5.20,5.30,5.40,5.50,5.60,5.70,
     /5.80,5.90,6.00,6.25,6.50,7.00,7.25,7.50,10.0,12.0,
     /15.0,20.0,30.0,60.0,100.,150.,200.,400.,1000.,2000.,
     /10000.,100000./
      DATA YEXC4/0.00,0.20,1.20,2.50,1.50,1.40,1.60,2.00,2.40,2.50,
     /2.45,2.30,2.15,1.95,1.75,1.55,1.50,1.45,0.80,0.60,
     /0.39,0.34,0.27,0.19,0.13,.085,0.06,0.03,.012,.006,
     /.0012,.00012/
      DATA XEXC5/5.461,5.50,5.60,5.70,5.80,5.90,6.00,6.25,6.50,7.00,
     /7.25,7.50,10.0,15.0,20.0,30.0,40.0,100.,1000.,100000./
      DATA YEXC5/0.00,0.80,2.00,3.20,3.50,3.65,3.60,3.45,3.25,2.60,
     /2.45,2.30,0.90,0.23,0.10,.028,.012,.0009,.000001,.00000001/
      DATA XEXC6/6.704,7.00,7.50,8.00,9.00,10.0,11.0,12.5,15.0,20.0,
     /25.0,35.0,40.0,50.0,60.0,100.,150.,200.,400.,1000.,
     /2000.,5000.,10000.,100000./
      DATA YEXC6/0.00,0.08,0.20,0.50,1.50,2.05,2.50,3.05,3.55,4.25,
     /4.55,4.50,4.40,4.15,3.75,3.00,2.45,2.10,1.25,0.65,
     /0.34,0.14,0.07,.007/
      DATA XEXC7/7.926,9.00,10.0,20.0,40.0,60.0,100.,200.,1000.,2000.,
     /10000.,100000./
      DATA YEXC7/0.00,0.25,0.15,0.14,0.13,0.11,0.07,0.04,.008,.004,
     /.0008,.00008/
      DATA XEXC8/8.60,10.0,11.0,20.0,40.0,60.0,100.,200.,1000.,2000.,
     /10000.,100000./
      DATA YEXC8/0.00,0.75,0.45,0.42,0.39,0.32,0.21,0.12,.024,.012,
     /.0024,.00024/
C -------------------------------------------------------------------
      NAME='MERCURY DIMER03'
C-------------------------------------------------------------------
C --------------------------------------------------------------------
C  ISOTROPIC SCATTERING VERSION OF MERCURY WITH DIMERS USES AMALGAM OF
C  ELFORD AND MCEARCHAN  2003             AND
C  ENGLAND AND ELFORD    1993
C  CONTAINS POSSIBLE EXTENSION TO ANISOTROPIC SCATTERING USING THE
C  THEORETICAL ELASTIC X-SECTION OF ELFORD AND MCEARCHAN.
C
C  DIMER FRACTION IN GAS FOR NITROGEN AND HELIUM MIXTURES AND PURE
C  MERCURY  SHOWN AS PARAMETER EANDE (BELOW) FOR GENERAL PURPOSE USE
C  HAVE SET EANDE TO NITROGEN MIXTURE VALUE.
C  FOR LARGE FRACTIONS OF MERCURY AT LOW FIELDS USE BOLTZMAN SOLUTION
C  SINCE  BACKGROUND GAS MOVEMENT (KT TERM) IS IMPORTANT .
C  USE MONTE CARLO (KT=0) BACKGROUND GAS STATIONARY FOR MOST OTHER CASES
C --------------------------------------------------------------------
C
C  FIND FRACTION OF GAS FOR DIMER NORMALISATION
C
      GFRAC=0.0
      DO 11 IDGS=1,6
       IF(NGASN(IDGS).EQ.54) THEN
        GFRAC=FRAC(IDGS)
       ENDIF
   11 CONTINUE
      GFRAC=GFRAC/100.0
C-------------------------------------------------------------
C  DIMER NORMALISATION
C  PURE MERCURY  EANDE=0.00221
C  N2-HG MIX     EANDE=0.00162
C  HE-HG MIX     EANDE=0.00067
      EANDE=0.00221
      DNORM=GFRAC*(573.0/(273.15+TEMPC))*TORR/760.0
      DNORM=DNORM*EANDE
C---------------------------------------------------------------
      NIN=8
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      NDATA=79
      NEL=57
      NION=52
      NDIM=10
      NEXC3=28
      NEXC4=32
      NEXC5=20
      NEXC6=24
      NEXC7=12
      NEXC8=12
      E(1)=0.0
      E(2)=2.0*EMASS/(200.59*AMU)
      E(3)=10.4375
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=10.4375
      EIN(1)=-0.040
      EIN(2)=0.040
      EIN(3)=4.667
      EIN(4)=4.887
      EIN(5)=5.461
      EIN(6)=6.704
      EIN(7)=7.926
      EIN(8)=8.60
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC (ISOT)  MERCURY      '
      SCRPT(3)=' IONISATION    ELOSS= 10.4375 '
      SCRPT(4)='                              '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' DIMER SUPER   ELOSS= -0.040  '
      SCRPT(8)=' DIMER         ELOSS=  0.040  '
      SCRPT(9)=' EXC 3P0       ELOSS=  4.667  '
      SCRPT(10)=' EXC 3P1       ELOSS=  4.887  '
      SCRPT(11)=' EXC 3P2       ELOSS=  5.461  '
      SCRPT(12)=' EXC 1P1       ELOSS=  6.704  '
      SCRPT(13)=' EXC 1S0       ELOSS=  7.926  '
      SCRPT(14)=' EXC HIGH      ELOSS=  8.60   '
      APOPDM=DEXP(EIN(1)/AKT)
      EN=-ESTEP/2.0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
C USE LOG INTERPOLATION FOR ELASTIC AND MT X-SECTIONS
      IF(EN.LE.XEL(2)) THEN
       QELA=YEL(1)*1.D-16
       GO TO 125
      ENDIF
      DO 110 J=2,NEL
      IF(EN.LE.XEL(J)) GO TO 120
  110 CONTINUE
      J=NEL
  120 YXJ=DLOG(YEL(J))
      YXJ1=DLOG(YEL(J-1))
      XNJ=DLOG(XEL(J))
      XNJ1=DLOG(XEL(J-1))
      A=(YXJ-YXJ1)/(XNJ-XNJ1)
      B=(XNJ1*YXJ-XNJ*YXJ1)/(XNJ1-XNJ)
      QELA=DEXP(A*DLOG(EN)+B)*1.D-16
  125 IF(EN.LE.XEN(2)) THEN
       QMOM=YXSEC(1)*1.D-16
       GO TO 200
      ENDIF
      DO 150 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 160
  150 CONTINUE
      J=NDATA
  160 YXJ=DLOG(YXSEC(J))
      YXJ1=DLOG(YXSEC(J-1))
      XNJ=DLOG(XEN(J))
      XNJ1=DLOG(XEN(J-1))
      A=(YXJ-YXJ1)/(XNJ-XNJ1)
      B=(XNJ1*YXJ-XNJ*YXJ1)/(XNJ1-XNJ)
      QMOM=DEXP(A*DLOG(EN)+B)*1.D-16
  200 CONTINUE
C------------------------------------------------------------------
C ANISOTROPIC VERSION DECOMMENT 2 LINES BELOW AND COMMENT NEXT TWO
C ALSO CHANGE SCRIPT DESCRIPTOR  : SCRPT(2) AND SET KEL(2)=1
C     PEQEL(2,I)=0.5+(QELA-QMOM)/QELA
C     Q(2,I)=QELA
C--------------------------------------------------------------
      PEQEL(2,I)=0.0
      Q(2,I)=QMOM
C--------------------------------------------------------------
C IONISATION
      Q(3,I)=0.0
      IF(EN.LE.E(3)) GO TO 230
      DO 210 J=2,NION
      IF(EN.LE.XION(J)) GO TO 220
  210 CONTINUE
      J=NION
  220 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.0D-16
  230 CONTINUE
      Q(4,I)=0.0
      Q(5,I)=0.0
      Q(6,I)=0.0
C DIMER SUPERELASTIC
      QIN(1,I)=0.0
      IF(EN.LE.0.0) GO TO 300
      DO 250 J=2,NDIM
      IF((EN+EIN(2)).LE.XDIM(J)) GO TO 270
  250 CONTINUE
      J=NDIM
  270 A=(YDIM(J)-YDIM(J-1))/(XDIM(J)-XDIM(J-1))
      B=(XDIM(J-1)*YDIM(J)-XDIM(J)*YDIM(J-1))/(XDIM(J-1)-XDIM(J))
      QIN(1,I)=(EN+EIN(2))*(A*(EN+EIN(2))+B)*1.D-16/EN
      QIN(1,I)=QIN(1,I)*APOPDM/(1.0+APOPDM)
      QIN(1,I)=QIN(1,I)*DNORM
  300 CONTINUE
C DIMER
      QIN(2,I)=0.0
      IF(EN.LE.EIN(2)) GO TO 340
      DO 310 J=2,NDIM
      IF(EN.LE.XDIM(J)) GO TO 320
  310 CONTINUE
      J=NDIM
  320 A=(YDIM(J)-YDIM(J-1))/(XDIM(J)-XDIM(J-1))
      B=(XDIM(J-1)*YDIM(J)-XDIM(J)*YDIM(J-1))/(XDIM(J-1)-XDIM(J))
      QIN(2,I)=(A*EN+B)*1.D-16
      QIN(2,I)=QIN(2,I)/(1.0+APOPDM)
      QIN(2,I)=QIN(2,I)*DNORM
  340 CONTINUE
C  EXC 3P0
      QIN(3,I)=0.0
      IF(EN.LE.EIN(3)) GO TO 370
      DO 350 J=2,NEXC3
      IF(EN.LE.XEXC3(J)) GO TO 360
  350 CONTINUE
      J=NEXC3
  360 A=(YEXC3(J)-YEXC3(J-1))/(XEXC3(J)-XEXC3(J-1))
      B=(XEXC3(J-1)*YEXC3(J)-XEXC3(J)*YEXC3(J-1))/(XEXC3(J-1)-XEXC3(J))
      QIN(3,I)=(A*EN+B)*1.0D-16
  370 CONTINUE
C EXC 3P1
      QIN(4,I)=0.0
      IF(EN.LE.EIN(4)) GO TO 470
      DO 450 J=2,NEXC4
      IF(EN.LE.XEXC4(J)) GO TO 460
  450 CONTINUE
      J=NEXC4
  460 A=(YEXC4(J)-YEXC4(J-1))/(XEXC4(J)-XEXC4(J-1))
      B=(XEXC4(J-1)*YEXC4(J)-XEXC4(J)*YEXC4(J-1))/(XEXC4(J-1)-XEXC4(J))
      QIN(4,I)=(A*EN+B)*1.0D-16
  470 CONTINUE
C  EXC 3P2
      QIN(5,I)=0.0
      IF(EN.LE.EIN(5)) GO TO 570
      DO 550 J=2,NEXC5
      IF(EN.LE.XEXC5(J)) GO TO 560
  550 CONTINUE
      J=NEXC5
  560 A=(YEXC5(J)-YEXC5(J-1))/(XEXC5(J)-XEXC5(J-1))
      B=(XEXC5(J-1)*YEXC5(J)-XEXC5(J)*YEXC5(J-1))/(XEXC5(J-1)-XEXC5(J))
      QIN(5,I)=(A*EN+B)*1.0D-16
  570 CONTINUE
C EXC 1P1
      QIN(6,I)=0.0
      IF(EN.LE.EIN(6)) GO TO 670
      DO 650 J=2,NEXC6
      IF(EN.LE.XEXC6(J)) GO TO 660
  650 CONTINUE
      J=NEXC6
  660 A=(YEXC6(J)-YEXC6(J-1))/(XEXC6(J)-XEXC6(J-1))
      B=(XEXC6(J-1)*YEXC6(J)-XEXC6(J)*YEXC6(J-1))/(XEXC6(J-1)-XEXC6(J))
      QIN(6,I)=(A*EN+B)*1.0D-16
  670 CONTINUE
C EXC 1S0
      QIN(7,I)=0.0
      IF(EN.LE.EIN(7)) GO TO 770
      DO 750 J=2,NEXC7
      IF(EN.LE.XEXC7(J)) GO TO 760
  750 CONTINUE
      J=NEXC7
  760 A=(YEXC7(J)-YEXC7(J-1))/(XEXC7(J)-XEXC7(J-1))
      B=(XEXC7(J-1)*YEXC7(J)-XEXC7(J)*YEXC7(J-1))/(XEXC7(J-1)-XEXC7(J))
      QIN(7,I)=(A*EN+B)*1.0D-16
  770 CONTINUE
C EXC SUM HIGHER LEVELS
      QIN(8,I)=0.0
      IF(EN.LE.EIN(8)) GO TO 870
      DO 850 J=2,NEXC8
      IF(EN.LE.XEXC8(J)) GO TO 860
  850 CONTINUE
      J=NEXC8
  860 A=(YEXC8(J)-YEXC8(J-1))/(XEXC8(J)-XEXC8(J-1))
      B=(XEXC8(J-1)*YEXC8(J)-XEXC8(J)*YEXC8(J-1))/(XEXC8(J-1)-XEXC8(J))
      QIN(8,I)=(A*EN+B)*1.0D-16
  870 CONTINUE
      Q(1,I)=Q(2,I)+Q(3,I)+QIN(1,I)+QIN(2,I)+QIN(3,I)+QIN(4,I)+QIN(5,I)+
     /QIN(6,I)+QIN(7,I)+QIN(8,I)
  900 CONTINUE
      IF(EFINAL.LT.EIN(8)) NIN=7
      IF(EFINAL.LT.EIN(7)) NIN=6
      IF(EFINAL.LT.EIN(6)) NIN=5
      IF(EFINAL.LT.EIN(5)) NIN=4
      IF(EFINAL.LT.EIN(4)) NIN=3
      IF(EFINAL.LT.EIN(3)) NIN=2
      IF(EFINAL.LT.EIN(2)) NIN=1
      RETURN
      END
      SUBROUTINE GAS55(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      DIMENSION XEL(25),YEL(25),XVIB1(16),YVIB1(16),XVIB2(16),YVIB2(16),
     /XVIB3(15),YVIB3(15),XVIB4(15),YVIB4(15),XEXC(18),YEXC(18),
     /XION(66),YION(66),XATT(26),YATT(26)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
C ELASTIC + EFFECTIVE ROTATION
      DATA XEL/0.00,.001,0.01,0.10,0.40,0.60,0.80,1.00,1.20,1.50,
     /1.75,2.00,2.30,3.00,5.00,7.00,10.0,15.0,20.0,30.0,
     /50.0,100.,1000.,10000.,100000./
      DATA YEL/1900.,1900.,1600.,160.,40.0,23.5,13.0,8.10,7.50,9.00,
     /15.0,18.9,21.0,17.0,21.8,21.8,12.8,8.30,5.20,3.30,
     /1.75,0.75,0.07,.007,.0007/
C VIBRATION
      DATA XVIB1/.1466,0.80,1.00,1.50,2.00,2.30,2.70,3.00,5.00,7.00,
     /10.0,20.0,100.,1000.,10000.,100000./
      DATA YVIB1/0.00,.0001,0.02,0.22,0.55,0.60,0.60,0.56,0.33,0.20,
     /0.10,.05,.001,.0001,.00001,.000001/
      DATA XVIB2/.3242,0.80,1.00,1.50,2.00,2.30,2.70,3.00,5.00,7.00,
     /10.0,20.0,100.,1000.,10000.,100000./
      DATA YVIB2/0.00,.0001,0.10,1.20,2.30,2.15,1.50,1.20,0.30,0.10,
     /0.05,.025,.001,.0001,.00001,.000001/
      DATA XVIB3/.4708,0.90,1.00,1.50,2.00,2.30,2.70,3.00,5.00,7.00,
     /10.0,100.,1000.,10000.,100000./
      DATA YVIB3/0.00,.001,.006,0.24,0.42,0.50,0.42,0.25,0.05,0.01,
     /.001,.0001,.00001,.000001,.0000001/
      DATA XVIB4/.6484,0.90,1.00,1.50,2.00,2.30,2.70,3.00,5.00,7.00,
     /10.0,100.,1000.,10000.,100000./
      DATA YVIB4/0.00,.001,0.01,1.15,1.40,1.45,1.40,0.80,0.16,0.03,
     /.001,.0001,.00001,.000001,.0000001/
      DATA XION/10.48,11.0,11.5,12.0,12.5,13.0,13.5,14.0,14.5,15.0,
     /16.0,17.0,18.0,19.0,20.0,22.0,24.0,26.0,28.0,30.0,
     /32.0,34.0,36.0,38.0,40.0,45.0,50.0,55.0,60.0,65.0,
     /70.0,80.0,90.0,100.,110.,120.,130.,150.,170.,200.,
     /250.,300.,350.,400.,450.,500.,550.,600.,650.,700.,
     /750.,800.,900.,1000.,1200.,1500.,2000.,3000.,4000.,7000.,
     /10000.,14000.,20000.,40000.,60000.,100000./
      DATA YION/0.00,.088,.175,.262,.349,.435,.518,.621,.724,.825,
     /1.02,1.22,1.42,1.62,1.79,2.11,2.38,2.62,2.82,3.01,
     /3.17,3.30,3.42,3.52,3.61,3.77,3.88,3.94,3.98,3.99,
     /3.99,3.95,3.88,3.80,3.71,3.61,3.52,3.33,3.16,2.93,
     /2.61,2.36,2.15,1.98,1.83,1.71,1.60,1.51,1.42,1.35,
     /1.28,1.22,1.12,1.04,.903,.758,.603,.433,.341,.212,
     /.155,.116,.085,.046,.032,.020/
      DATA XATT/1.50,1.75,2.00,2.25,2.50,2.75,3.00,3.25,4.75,5.00,
     /5.25,5.50,5.65,6.00,6.25,6.50,7.00,7.50,8.00,8.50,
     /9.00,9.50,10.0,10.5,11.0,11.5/
      DATA YATT/0.00,.0023,.0088,.019,.018,.012,.003,.0001,.0001,.0007,
     /.005,.010,.010,.0048,.0012,.0001,.0001,.0018,.0024,.0018,
     /.0018,.003,.0033,.001,.0001,.0000001/
      DATA XEXC/7.85,8.00,9.00,10.0,12.0,15.0,20.0,25.0,30.0,40.0,
     /60.0,100.,150.,200.,300.,1000.,10000.,100000./
      DATA YEXC/0.00,0.40,2.00,3.00,3.80,4.20,4.60,4.60,4.20,3.80,
     /2.90,2.30,1.70,1.40,1.15,0.55,.055,.0055/
C------------------------------------------------------------------
      NAME='H2S       2003 '
C --------------------------------------------------------------------
C   NO DRIFT VELOCITY AVAILABLE IN PURE H2S USED DATA OF MIXTURE IN C2H4
C   FROM HURST ET AL. AND DIFFUSION FROM MILLICAN AND WALKER.
C   ELASTIC AND VIBRATION XSECTIONS FROM ELECTRON SCATTERING BY :
C   GULLEY ET AL AND ROHR . ATTACHMENT FROM AZRIA ET AL.
C   IONISATION : BEB X-SECTIONS OF KIM
C    NB. DT OF MILLICAN AND WALKER AFFECTED BY ATTACHMENT ABOVE 40 TD.
C ---------------------------------------------------------------------
      NIN=9
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      NEL=25
      NVIB1=16
      NVIB2=16
      NVIB3=15
      NVIB4=15
      NION=66
      NATT=26
      NEXC=18
      AMP1=0.1875
      AMP2=0.1725
      AMPVIB1=0.075
      AMPVIB2=0.375
      E(1)=0.0
      E(2)=2.0*EMASS/(34.08088*AMU)
      E(3)=10.48
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=10.48
      EIN(1)=-0.025
      EIN(2)=0.025
      EIN(3)=-0.075
      EIN(4)=0.075
      EIN(5)=0.1466
      EIN(6)=0.3242
      EIN(7)=0.4708
      EIN(8)=0.6484
      EIN(9)=7.85
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       H2S            '
      SCRPT(3)=' IONISATION    ELOSS= 10.48   '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' ROT R1        ELOSS= -0.025  '
      SCRPT(8)=' ROT R1        ELOSS=  0.025  '
      SCRPT(9)=' ROT R2        EL0SS= -0.075  '
      SCRPT(10)=' ROT R2        ELOSS=  0.075  '
      SCRPT(11)=' VIB V2        ELOSS=  0.1466 '
      SCRPT(12)=' VIB V13       ELOSS=  0.3242 '
      SCRPT(13)=' (V13+V2)+HIGH ELOSS=  0.4708 '
      SCRPT(14)=' 2V13+HIGH     ELOSS=  0.6484 '
      SCRPT(15)=' EXC           ELOSS=  7.85   '
      APOP1=DEXP(EIN(1)/AKT)
      APOP2=DEXP(EIN(3)/AKT)
      EN=-ESTEP/2.0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      Q(2,I)=0.0
      IF(EN.LE.XEL(2)) THEN
       Q(2,I)=YEL(2)*1.D-16
       GO TO 30
      ENDIF
      DO 10 J=2,NEL
      IF(EN.LE.XEL(J)) GO TO 20
   10 CONTINUE
      J=NEL
   20 Y1=DLOG(YEL(J))
      Y2=DLOG(YEL(J-1))
      X1=DLOG(XEL(J))
      X2=DLOG(XEL(J-1))
      A=(Y1-Y2)/(X1-X2)
      B=(X2*Y1-X1*Y2)/(X2-X1)
      Q(2,I)=DEXP(A*DLOG(EN)+B)*1.0D-16
C
   30 Q(3,I)=0.0
      IF(EN.LT.E(3)) GO TO 200
      DO 110 J=2,NION
      IF(EN.LE.XION(J)) GO TO 120
  110 CONTINUE
      J=NION
  120 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
  200 CONTINUE
C
      Q(4,I)=0.0
      IF(EN.LT.XATT(1).OR.EN.GT.XATT(NATT)) GO TO 300
      DO 210 J=2,NATT
      IF(EN.LE.XATT(J)) GO TO 220
  210 CONTINUE
      J=NATT
  220 A=(YATT(J)-YATT(J-1))/(XATT(J)-XATT(J-1))
      B=(XATT(J-1)*YATT(J)-XATT(J)*YATT(J-1))/(XATT(J-1)-XATT(J))
      Q(4,I)=(A*EN+B)*1.D-16
  300 CONTINUE
      Q(5,I)=0.0
      Q(6,I)=0.0
C
C  SUPERELASTIC  ROT1
C
      QIN(1,I)=0.0
      IF(EN.LE.0.0) GO TO 1300
      EFAC=DSQRT(1.0-(EIN(1)/EN))
      QIN(1,I)=AMP1*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      QIN(1,I)=QIN(1,I)*APOP1/(1.0+APOP1)*1.D-16
C  ROT1
 1300 QIN(2,I)=0.0
      IF(EN.LE.EIN(2)) GO TO 1400
      EFAC=DSQRT(1.0-(EIN(2)/EN))
      QIN(2,I)=AMP1*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      QIN(2,I)=QIN(2,I)/(1.0+APOP1)*1.D-16
C
C  SUPERELASTIC ROT2
C
 1400 QIN(3,I)=0.0
      IF(EN.LE.0.0) GO TO 1500
      EFAC=DSQRT(1.0-(EIN(3)/EN))
      QIN(3,I)=AMP2*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      QIN(3,I)=QIN(3,I)*APOP2/(1.0+APOP2)*1.D-16
C  ROT2
 1500 QIN(4,I)=0.0
      IF(EN.LE.EIN(4)) GO TO 1600
      EFAC=DSQRT(1.0-(EIN(4)/EN))
      QIN(4,I)=AMP2*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      QIN(4,I)=QIN(4,I)/(1.0+APOP2)*1.D-16
C  VIB V2
 1600 QIN(5,I)=0.0
      IF(EN.LE.EIN(5)) GO TO 400
      EFAC=DSQRT(1.0-(EIN(5)/EN))
      QIN(5,I)=AMPVIB1*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      DO 310 J=2,NVIB1
      IF(EN.LE.XVIB1(J)) GO TO 320
  310 CONTINUE
      J=NVIB1
  320 A=(YVIB1(J)-YVIB1(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB1(J)-XVIB1(J)*YVIB1(J-1))/(XVIB1(J-1)-XVIB1(J))
      QIN(5,I)=(QIN(5,I)+(A*EN+B))*1.D-16
  400 CONTINUE
C  VIB V13 COMPOSITE
      QIN(6,I)=0.0
      IF(EN.LE.EIN(6)) GO TO 500
      EFAC=DSQRT(1.0-(EIN(6)/EN))
      QIN(6,I)=AMPVIB2*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      DO 410 J=2,NVIB2
      IF(EN.LE.XVIB2(J)) GO TO 420
  410 CONTINUE
      J=NVIB2
  420 A=(YVIB2(J)-YVIB2(J-1))/(XVIB2(J)-XVIB2(J-1))
      B=(XVIB2(J-1)*YVIB2(J)-XVIB2(J)*YVIB2(J-1))/(XVIB2(J-1)-XVIB2(J))
      QIN(6,I)=(QIN(6,I)+(A*EN+B))*1.D-16
  500 CONTINUE
C  VIB V2+V13 AND HIGHER SERIES
      QIN(7,I)=0.0
      IF(EN.LE.EIN(7)) GO TO 600
      DO 510 J=2,NVIB3
      IF(EN.LE.XVIB3(J)) GO TO 520
  510 CONTINUE
      J=NVIB3
  520 A=(YVIB3(J)-YVIB3(J-1))/(XVIB3(J)-XVIB3(J-1))
      B=(XVIB3(J-1)*YVIB3(J)-XVIB3(J)*YVIB3(J-1))/(XVIB3(J-1)-XVIB3(J))
      QIN(7,I)=(A*EN+B)*1.D-16
  600 CONTINUE
C  VIB 2V13 AND HIGHER SERIES
      QIN(8,I)=0.0
      IF(EN.LE.EIN(8)) GO TO 700
      DO 610 J=2,NVIB4
      IF(EN.LE.XVIB4(J)) GO TO 620
  610 CONTINUE
      J=NVIB4
  620 A=(YVIB4(J)-YVIB4(J-1))/(XVIB4(J)-XVIB4(J-1))
      B=(XVIB4(J-1)*YVIB4(J)-XVIB4(J)*YVIB4(J-1))/(XVIB4(J-1)-XVIB4(J))
      QIN(8,I)=(A*EN+B)*1.D-16
  700 CONTINUE
C  SINGLE EFFECTIVE EXCITATION LEVEL
      QIN(9,I)=0.0
      IF(EN.LE.EIN(9)) GO TO 800
      DO 710 J=2,NEXC
      IF(EN.LE.XEXC(J)) GO TO 720
  710 CONTINUE
      J=NEXC
  720 A=(YEXC(J)-YEXC(J-1))/(XEXC(J)-XEXC(J-1))
      B=(XEXC(J-1)*YEXC(J)-XEXC(J)*YEXC(J-1))/(XEXC(J-1)-XEXC(J))
      QIN(9,I)=(A*EN+B)*1.D-16
  800 CONTINUE
C---------------------------------------------------------------------
C   GET ELASTIC FROM ELASTIC + ROTATION  X-SECTION
      Q(2,I)=Q(2,I)-QIN(1,I)-QIN(2,I)-QIN(3,I)-QIN(4,I)
C
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+QIN(7,I)+QIN(8,I)+
     /QIN(9,I)+QIN(1,I)+QIN(2,I)+QIN(3,I)+QIN(4,I)+QIN(5,I)+QIN(6,I)
  900 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(9)) NIN=8
      IF(EFINAL.LE.EIN(8)) NIN=7
      IF(EFINAL.LE.EIN(7)) NIN=6
      IF(EFINAL.LE.EIN(6)) NIN=5
      IF(EFINAL.LE.EIN(5)) NIN=4
C
      RETURN
      END
      SUBROUTINE GAS56(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      DIMENSION XEN(57),YXSEC(57),XION(46),YION(46),XATT(16),YATT(16),
     /XVIB1(34),YVIB1(34),XVIB2(28),YVIB2(28),XVIB3(28),YVIB3(28),
     /XVIB4(25),YVIB4(25),XVIB5(19),YVIB5(19),XEXC1(25),YEXC1(25),
     /XEXC2(23),YEXC2(23),XEXC3(19),YEXC3(19)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      DATA XEN/0.00,.001,.002,.004,.007,0.01,.015,0.02,.025,0.03,
     /0.04,0.05,0.06,0.07,0.08,0.09,0.10,0.12,0.14,0.17,
     /0.20,0.25,0.30,0.35,0.40,0.50,0.60,0.80,1.00,1.50,
     /2.00,3.00,4.00,5.00,6.00,7.00,8.00,9.00,10.0,15.0,
     /20.0,30.0,40.0,70.0,100.,140.,200.,250.,300.,500.,
     /1000.,1500.,3000.,6000.,10000.,20000.,100000./
      DATA YXSEC/60.0,59.0,56.0,54.0,51.0,45.0,35.0,27.5,22.5,19.0,
     /14.0,10.7,9.40,7.80,6.90,6.00,5.50,5.30,5.55,6.55,
     /8.05,11.5,13.5,14.5,15.5,16.5,17.5,18.5,19.5,21.0,
     /22.5,25.0,29.0,31.0,34.0,36.0,36.0,34.0,31.0,21.5,
     /17.0,11.5,8.80,5.20,3.75,2.21,1.36,0.98,0.81,0.46,
     /0.20,0.13,0.06,.026,.016,.0065,.0013/
      DATA XION/10.67,11.2,12.7,13.7,14.7,17.2,20.0,25.0,30.0,35.0,
     /40.0,45.0,50.0,60.0,70.0,80.0,90.0,100.,125.,150.,
     /175.,200.,250.,300.,350.,400.,450.,500.,600.,700.,
     /800.,900.,1000.,1250.,1500.,1750.,2000.,2500.,3000.,5000.,
     /7000.,10000.,15000.,30000.,60000.,100000./
      DATA YION/0.00,0.27,0.61,0.99,1.48,3.00,4.30,6.77,8.41,9.58,
     /10.4,11.1,12.0,12.7,13.1,13.3,13.3,13.3,12.9,12.2,
     /11.5,10.9,10.1,8.89,8.12,7.51,6.84,6.41,5.63,5.19,
     /4.77,4.25,3.97,3.43,2.95,2.68,2.44,2.11,1.81,1.20,
     /0.90,0.66,0.47,.254,.136,.086/
      DATA XATT/6.85,7.00,7.20,7.50,8.00,8.50,9.00,9.50,10.0,10.5,
     /11.0,11.5,12.0,12.5,13.0,13.2/
      DATA YATT/0.00,1.15,1.92,2.90,4.90,7.72,11.6,18.1,25.7,21.6,
     /17.0,10.9,6.14,2.30,0.87,0.00/
      DATA XVIB1/.052,.055,.060,.065,.070,.075,0.08,0.10,0.12,0.14,
     /0.20,0.25,0.30,0.40,0.50,0.70,1.00,1.50,2.00,3.00,
     /4.00,5.00,6.00,7.50,8.50,10.0,15.0,20.0,30.0,40.0,
     /100.,1000.,10000.,100000./
      DATA YVIB1/0.00,.014,.021,.024,.026,.027,.028,.028,.027,.025,
     /.021,.018,.016,.014,.012,.009,.008,.012,.015,.024,
     /.036,.047,.060,.079,.079,.065,.045,.025,.014,.008,
     /.002,.0002,.00002,.00002/
      DATA XVIB2/.108,.125,0.15,0.20,0.23,0.25,0.30,0.40,0.50,0.70,
     /1.00,1.50,2.00,3.00,4.00,5.00,6.00,7.50,8.50,10.0,
     /15.0,20.0,30.0,40.0,100.,1000.,10000.,100000./
      DATA YVIB2/0.00,0.27,0.52,0.71,0.73,0.73,0.66,0.56,0.49,0.41,
     /0.32,0.32,0.39,0.63,0.93,1.22,1.57,2.06,2.06,1.69,
     /1.17,0.66,0.35,0.22,0.05,.005,.0005,.00005/
      DATA XVIB3/.173,0.18,0.19,0.20,0.23,0.25,0.30,0.40,0.50,0.70,
     /1.00,1.50,2.00,3.00,4.00,5.00,6.00,7.50,8.50,10.0,
     /15.0,20.0,30.0,40.0,100.,1000.,10000.,100000./
      DATA YVIB3/0.00,0.13,0.27,0.38,0.49,0.53,0.56,0.53,0.49,0.42,
     /0.34,0.31,0.33,0.48,0.72,0.94,1.21,1.59,1.59,1.30,
     /0.90,0.51,0.27,0.17,0.04,.004,.0004,.00004/
      DATA XVIB4/.363,0.40,0.45,0.50,0.60,0.70,0.80,1.00,1.50,2.00,
     /3.00,4.00,5.00,6.00,7.50,8.50,10.0,15.0,20.0,30.0,
     /40.0,100.,1000.,10000.,100000./
      DATA YVIB4/0.00,0.47,0.63,0.70,0.74,0.74,0.70,0.66,0.63,0.69,
     /1.00,1.43,1.86,2.40,2.65,2.29,1.69,0.97,0.43,0.24,
     /0.14,0.03,.003,.0003,.00003/
      DATA XVIB5/.519,1.00,1.50,2.00,3.00,4.00,5.00,6.00,7.50,8.50,
     /10.0,15.0,20.0,30.0,40.0,100.,1000.,10000.,100000./
      DATA YVIB5/0.00,.001,0.01,.033,.085,0.16,0.20,0.27,0.30,0.25,
     /.193,.112,.047,.027,.017,.003,.0003,.00003,.000003/
      DATA XEXC1/7.40,8.70,9.70,11.0,12.0,14.0,16.0,20.0,25.0,30.0,
     /40.0,60.0,80.0,100.,150.,200.,300.,400.,600.,1000.,
     /2000.,4000.,10000.,20000.,100000./
      DATA YEXC1/0.00,1.30,1.89,2.02,2.08,2.15,2.15,2.15,2.15,2.15,
     /2.21,2.21,2.15,2.02,1.69,1.56,1.30,1.22,1.04,0.68,
     /0.33,0.17,0.06,.034,.007/
      DATA XEXC2/9.70,10.7,11.7,14.0,16.0,20.0,25.0,30.0,
     /40.0,60.0,80.0,100.,150.,200.,300.,400.,600.,1000.,
     /2000.,4000.,10000.,20000.,100000./
      DATA YEXC2/0.00,0.19,0.40,0.75,1.16,1.56,1.82,1.98,
     /2.15,2.21,2.15,2.02,1.69,1.56,1.30,1.22,1.04,0.68,
     /0.32,0.17,0.06,.034,.006/
      DATA XEXC3/17.0,20.0,25.0,30.0,40.0,60.0,80.0,100.,150.,200.,
     /300.,400.,600.,1000.,2000.,4000.,10000.,20000.,100000./
      DATA YEXC3/0.00,0.43,0.94,1.30,1.82,2.15,2.15,2.02,1.69,1.56,
     /1.30,1.22,1.04,0.68,0.33,0.17,0.07,.034,.006/
C--------------------------------------------------------
      NAME=' N-BUTANE 2003 '
C ---------------------------------------------------------------------
C  NO EXPERIMENTAL DATA AVAILABLE ON DIFFUSION . DRIFT VELOCITY DATA
C  FROM FLORIANO,GEE AND FREEMAN USED.
C  ANALYSIS : FIXED INELASTIC X-SECTIONS TO ISOBUTANE VALUES AND VARIED
C  ELASTIC X-SECTION TO OBTAIN FIT TO DRIFT VELOCITY.
C  NO USEFUL ELECTRON SCATTERING DATA AVAILABLE.
C ----------------------------------------------------------------------
      NIN=10
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      NDATA=57
      NION=46
      NATT=16
      NVIB1=34
      NVIB2=28
      NVIB3=28
      NVIB4=25
      NVIB5=19
      NEXC1=25
      NEXC2=23
      NEXC3=19
      E(1)=0.0
      E(2)=2.0*EMASS/(58.1234*AMU)
      E(3)=10.67
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=10.67
      EIN(1)=-0.052
      EIN(2)=0.052
      EIN(3)=-0.108
      EIN(4)=0.108
      EIN(5)=0.173
      EIN(6)=0.363
      EIN(7)=0.519
      EIN(8)=7.4
      EIN(9)=9.70
      EIN(10)=17.0
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       N-BUTANE       '
      SCRPT(3)=' IONISATION    ELOSS= 10.67   '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' VIB           ELOSS= -0.052  '
      SCRPT(8)=' VIB           ELOSS=  0.052  '
      SCRPT(9)=' VIB           ELOSS= -0.108  '
      SCRPT(10)=' VIB           ELOSS=  0.108  '
      SCRPT(11)=' VIB           ELOSS=  0.173  '
      SCRPT(12)=' VIB           ELOSS=  0.363  '
      SCRPT(13)=' VIB           ELOSS=  0.519  '
      SCRPT(14)=' EXC           ELOSS=  7.4    '
      SCRPT(15)=' EXC           ELOSS=  9.70   '
      SCRPT(16)=' EXC           ELOSS= 17.0    '
      APOP=DEXP(EIN(1)/AKT)
      HPOP=DEXP(EIN(3)/AKT)
      EN=-ESTEP/2.0
      DO 1000 I=1,NSTEP
      EN=EN+ESTEP
      DO 10 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 20
   10 CONTINUE
      J=NDATA
   20 A=(YXSEC(J)-YXSEC(J-1))/(XEN(J)-XEN(J-1))
      B=(XEN(J-1)*YXSEC(J)-XEN(J)*YXSEC(J-1))/(XEN(J-1)-XEN(J))
      Q(2,I)=(A*EN+B)*1.0D-16
      Q(3,I)=0.0
      IF(EN.LT.E(3)) GO TO 200
      DO 110 J=2,NION
      IF(EN.LE.XION(J)) GO TO 120
  110 CONTINUE
      J=NION
  120 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
  200 Q(4,I)=0.0
      IF(EN.LT.XATT(1)) GO TO 300
      IF(EN.GT.XATT(NATT)) GO TO 300
      DO 210 J=2,NATT
      IF(EN.LE.XATT(J)) GO TO 220
  210 CONTINUE
      J=NATT
  220 A=(YATT(J)-YATT(J-1))/(XATT(J)-XATT(J-1))
      B=(XATT(J-1)*YATT(J)-XATT(J)*YATT(J-1))/(XATT(J-1)-XATT(J))
      Q(4,I)=(A*EN+B)*1.D-21
  300 Q(5,I)=0.0
      Q(6,I)=0.0
C
C SUPERELASTIC VIB
      QIN(1,I)=0.0
      IF(EN.EQ.0.0) GO TO 305
      DO 301 J=2,NVIB1
      IF((EN+EIN(2)).LE.XVIB1(J)) GO TO 302
  301 CONTINUE
      J=NVIB1
  302 A=(YVIB1(J)-YVIB1(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB1(J)-XVIB1(J)*YVIB1(J-1))/(XVIB1(J-1)-XVIB1(J))
      QIN(1,I)=(EN+EIN(2))*(A*(EN+EIN(2))+B)*1.D-16/EN
      QIN(1,I)=APOP*QIN(1,I)/(1.0+APOP)
C
  305 QIN(2,I)=0.0
      IF(EN.LE.EIN(2)) GO TO 4000
      DO 4100 J=2,NVIB1
      IF(EN.LE.XVIB1(J)) GO TO 4200
 4100 CONTINUE
      J=NVIB1
 4200 A=(YVIB1(J)-YVIB1(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB1(J)-XVIB1(J)*YVIB1(J-1))/(XVIB1(J-1)-XVIB1(J))
      QIN(2,I)=(A*EN+B)*1.D-16/(1.0+APOP)
 4000 CONTINUE
      QIN(3,I)=0.0
      IF(EN.EQ.0.0) GO TO 1100
      DO 307 J=2,NVIB2
      IF((EN+EIN(4)).LE.XVIB2(J)) GO TO 308
  307 CONTINUE
      J=NVIB2
  308 A=(YVIB2(J)-YVIB2(J-1))/(XVIB2(J)-XVIB2(J-1))
      B=(XVIB2(J-1)*YVIB2(J)-XVIB2(J)*YVIB2(J-1))/(XVIB2(J-1)-XVIB2(J))
      QIN(3,I)=(EN+EIN(4))*(A*(EN+EIN(4))+B)*1.D-16/EN
      QIN(3,I)=HPOP*QIN(3,I)/(1.0+HPOP)
 1100 QIN(4,I)=0.0
      IF(EN.LE.EIN(4)) GO TO 400
      DO 310 J=2,NVIB2
      IF(EN.LE.XVIB2(J)) GO TO 320
  310 CONTINUE
      J=NVIB2
  320 A=(YVIB2(J)-YVIB2(J-1))/(XVIB2(J)-XVIB2(J-1))
      B=(XVIB2(J-1)*YVIB2(J)-XVIB2(J)*YVIB2(J-1))/(XVIB2(J-1)-XVIB2(J))
      QIN(4,I)=(A*EN+B)*1.D-16/(1.0+HPOP)
  400 CONTINUE
      QIN(5,I)=0.0
      IF(EN.LE.EIN(5)) GO TO 500
      DO 410 J=2,NVIB3
      IF(EN.LE.XVIB3(J)) GO TO 420
  410 CONTINUE
      J=NVIB3
  420 A=(YVIB3(J)-YVIB3(J-1))/(XVIB3(J)-XVIB3(J-1))
      B=(XVIB3(J-1)*YVIB3(J)-XVIB3(J)*YVIB3(J-1))/(XVIB3(J-1)-XVIB3(J))
      QIN(5,I)=(A*EN+B)*1.D-16
  500 CONTINUE
      QIN(6,I)=0.0
      IF(EN.LE.EIN(6)) GO TO 600
      DO 510 J=2,NVIB4
      IF(EN.LE.XVIB4(J)) GO TO 520
  510 CONTINUE
      J=NVIB4
  520 A=(YVIB4(J)-YVIB4(J-1))/(XVIB4(J)-XVIB4(J-1))
      B=(XVIB4(J-1)*YVIB4(J)-XVIB4(J)*YVIB4(J-1))/(XVIB4(J-1)-XVIB4(J))
      QIN(6,I)=(A*EN+B)*1.D-16
  600 CONTINUE
      QIN(7,I)=0.0
      IF(EN.LE.EIN(7)) GO TO 700
      DO 610 J=2,NVIB5
      IF(EN.LE.XVIB5(J)) GO TO 620
  610 CONTINUE
      J=NVIB5
  620 A=(YVIB5(J)-YVIB5(J-1))/(XVIB5(J)-XVIB5(J-1))
      B=(XVIB5(J-1)*YVIB5(J)-XVIB5(J)*YVIB5(J-1))/(XVIB5(J-1)-XVIB5(J))
      QIN(7,I)=(A*EN+B)*1.D-16
  700 CONTINUE
      QIN(8,I)=0.0
      IF(EN.LE.EIN(8)) GO TO 800
      DO 710 J=2,NEXC1
      IF(EN.LE.XEXC1(J)) GO TO 720
  710 CONTINUE
      J=NEXC1
  720 A=(YEXC1(J)-YEXC1(J-1))/(XEXC1(J)-XEXC1(J-1))
      B=(XEXC1(J-1)*YEXC1(J)-XEXC1(J)*YEXC1(J-1))/(XEXC1(J-1)-XEXC1(J))
      QIN(8,I)=(A*EN+B)*1.D-16
  800 CONTINUE
      QIN(9,I)=0.0
      IF(EN.LE.EIN(9)) GO TO 900
      DO 810 J=2,NEXC2
      IF(EN.LE.XEXC2(J)) GO TO 820
  810 CONTINUE
      J=NEXC2
  820 A=(YEXC2(J)-YEXC2(J-1))/(XEXC2(J)-XEXC2(J-1))
      B=(XEXC2(J-1)*YEXC2(J)-XEXC2(J)*YEXC2(J-1))/(XEXC2(J-1)-XEXC2(J))
      QIN(9,I)=(A*EN+B)*1.D-16
  900 CONTINUE
      QIN(10,I)=0.0
      IF(EN.LE.EIN(10)) GO TO 990
      DO 910 J=2,NEXC3
      IF(EN.LE.XEXC3(J)) GO TO 920
  910 CONTINUE
      J=NEXC3
  920 A=(YEXC3(J)-YEXC3(J-1))/(XEXC3(J)-XEXC3(J-1))
      B=(XEXC3(J-1)*YEXC3(J)-XEXC3(J)*YEXC3(J-1))/(XEXC3(J-1)-XEXC3(J))
      QIN(10,I)=(A*EN+B)*1.D-16
  990 CONTINUE
C
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+QIN(1,I)+QIN(2,I)+QIN(3,I)+QIN(4,I)+
     /QIN(5,I)+QIN(6,I)+QIN(7,I)+QIN(8,I)+QIN(9,I)+QIN(10,I)
 1000 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(10)) NIN=9
      IF(EFINAL.LE.EIN(9)) NIN=8
      IF(EFINAL.LE.EIN(8)) NIN=7
      IF(EFINAL.LE.EIN(7)) NIN=6
      IF(EFINAL.LE.EIN(6)) NIN=5
      IF(EFINAL.LE.EIN(5)) NIN=4
      IF(EFINAL.LE.EIN(4)) NIN=3
      RETURN
      END
      SUBROUTINE GAS57(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      DIMENSION XEN(61),YXSEC(61),XION(46),YION(46),XATT(16),YATT(16),
     /XVIB1(34),YVIB1(34),XVIB2(28),YVIB2(28),XVIB3(28),YVIB3(28),
     /XVIB4(25),YVIB4(25),XVIB5(19),YVIB5(19),XEXC1(25),YEXC1(25),
     /XEXC2(23),YEXC2(23),XEXC3(19),YEXC3(19)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      DATA XEN/0.00,.001,.002,.003,.004,.005,.007,0.01,.015,0.02,
     /0.03,0.04,0.05,0.06,0.07,0.08,0.09,0.10,0.11,0.12,
     /0.14,0.16,0.18,0.20,0.23,0.26,0.30,0.35,0.40,0.50,
     /0.60,0.80,1.00,1.40,2.00,3.00,4.00,5.00,6.00,7.00,
     /8.00,9.00,10.0,15.0,20.0,30.0,40.0,70.0,100.,140.,
     /200.,250.,300.,500.,1000.,1500.,3000.,6000.,10000.,20000.,
     /100000./
      DATA YXSEC/77.0,75.0,70.0,66.0,62.0,57.0,51.0,45.0,37.0,31.0,
     /24.0,18.5,15.5,13.0,11.0,9.45,8.25,7.35,6.75,6.75,
     /8.20,10.6,13.7,17.2,20.5,23.0,25.0,26.5,27.0,28.0,
     /29.0,30.0,31.0,32.5,34.0,36.0,38.0,40.0,43.0,44.0,
     /44.0,42.0,39.0,28.0,22.0,15.0,11.5,6.80,4.90,2.90,
     /1.78,1.28,1.06,0.60,0.26,0.17,0.08,.034,.021,.0085,
     /.0017/
      DATA XION/10.35,11.0,12.5,13.5,14.5,17.0,20.0,25.0,30.0,35.0,
     /40.0,45.0,50.0,60.0,70.0,80.0,90.0,100.,125.,150.,
     /175.,200.,250.,300.,350.,400.,450.,500.,600.,700.,
     /800.,900.,1000.,1250.,1500.,1750.,2000.,2500.,3000.,5000.,
     /7000.,10000.,15000.,30000.,60000.,100000./
      DATA YION/0.00,0.33,0.75,1.22,1.82,3.69,5.29,8.33,10.3,11.8,
     /12.8,13.7,14.8,15.6,16.1,16.4,16.4,16.4,15.9,15.0,
     /14.1,13.4,12.4,10.9,9.99,9.24,8.41,7.88,6.92,6.38,
     /5.87,5.23,4.88,4.22,3.63,3.30,3.00,2.60,2.23,1.48,
     /1.11,0.81,0.58,0.31,.167,.106/
      DATA XATT/6.85,7.00,7.20,7.50,8.00,8.50,9.00,9.50,10.0,10.5,
     /11.0,11.5,12.0,12.5,13.0,13.2/
      DATA YATT/0.00,1.41,2.36,3.57,6.03,9.50,14.3,22.3,31.6,26.6,
     /20.9,13.4,7.55,2.83,1.07,0.00/
      DATA XVIB1/.052,.055,.060,.065,.070,.075,0.08,0.10,0.12,0.14,
     /0.20,0.25,0.30,0.40,0.50,0.70,1.00,1.50,2.00,3.00,
     /4.00,5.00,6.00,7.50,8.50,10.0,15.0,20.0,30.0,40.0,
     /100.,1000.,10000.,100000./
      DATA YVIB1/0.00,.017,.026,.030,.032,.033,.034,.034,.033,.031,
     /.026,.022,.020,.017,.015,.011,.010,.015,.018,.030,
     /.044,.058,.074,.097,.097,.080,.055,.031,.017,.010,
     /.003,.0003,.00003,.00003/
      DATA XVIB2/.108,.125,0.15,0.20,0.23,0.25,0.30,0.40,0.50,0.70,
     /1.00,1.50,2.00,3.00,4.00,5.00,6.00,7.50,8.50,10.0,
     /15.0,20.0,30.0,40.0,100.,1000.,10000.,100000./
      DATA YVIB2/0.00,0.33,0.64,0.87,0.90,0.90,0.81,0.69,0.60,0.50,
     /0.39,0.39,0.48,0.77,1.14,1.50,1.93,2.53,2.53,2.08,
     /1.44,0.81,0.43,0.27,0.06,.006,.0006,.00006/
      DATA XVIB3/.173,0.18,0.19,0.20,0.23,0.25,0.30,0.40,0.50,0.70,
     /1.00,1.50,2.00,3.00,4.00,5.00,6.00,7.50,8.50,10.0,
     /15.0,20.0,30.0,40.0,100.,1000.,10000.,100000./
      DATA YVIB3/0.00,0.16,0.33,0.47,0.60,0.65,0.69,0.65,0.60,0.52,
     /0.42,0.38,0.41,0.59,0.89,1.16,1.49,1.96,1.96,1.60,
     /1.11,0.63,0.33,0.21,0.05,.005,.0005,.00005/
      DATA XVIB4/.363,0.40,0.45,0.50,0.60,0.70,0.80,1.00,1.50,2.00,
     /3.00,4.00,5.00,6.00,7.50,8.50,10.0,15.0,20.0,30.0,
     /40.0,100.,1000.,10000.,100000./
      DATA YVIB4/0.00,0.58,0.77,0.86,0.91,0.91,0.86,0.81,0.77,0.85,
     /1.23,1.76,2.29,2.95,3.26,2.82,2.08,1.19,0.53,0.30,
     /0.17,0.04,.004,.0004,.00004/
      DATA XVIB5/.519,1.00,1.50,2.00,3.00,4.00,5.00,6.00,7.50,8.50,
     /10.0,15.0,20.0,30.0,40.0,100.,1000.,10000.,100000./
      DATA YVIB5/0.00,.001,0.01,.041,.105,0.20,0.25,0.33,0.37,0.31,
     /.237,.138,.058,.033,.021,.004,.0004,.00004,.000004/
      DATA XEXC1/7.20,8.50,9.50,11.0,12.0,14.0,16.0,20.0,25.0,30.0,
     /40.0,60.0,80.0,100.,150.,200.,300.,400.,600.,1000.,
     /2000.,4000.,10000.,20000.,100000./
      DATA YEXC1/0.00,1.60,2.32,2.48,2.56,2.64,2.64,2.64,2.64,2.64,
     /2.72,2.72,2.64,2.48,2.08,1.92,1.60,1.50,1.28,0.84,
     /0.41,0.21,0.07,.042,.009/
      DATA XEXC2/9.50,10.5,11.5,14.0,16.0,20.0,25.0,30.0,
     /40.0,60.0,80.0,100.,150.,200.,300.,400.,600.,1000.,
     /2000.,4000.,10000.,20000.,100000./
      DATA YEXC2/0.00,0.23,0.49,0.92,1.43,1.92,2.24,2.44,
     /2.65,2.72,2.65,2.48,2.08,1.92,1.60,1.50,1.28,0.84,
     /0.39,0.21,0.07,.042,.007/
      DATA XEXC3/17.0,20.0,25.0,30.0,40.0,60.0,80.0,100.,150.,200.,
     /300.,400.,600.,1000.,2000.,4000.,10000.,20000.,100000./
      DATA YEXC3/0.00,0.53,1.16,1.60,2.24,2.64,2.64,2.48,2.08,1.92,
     /1.60,1.50,1.28,0.84,0.41,0.21,0.09,.042,.007/
C ----------------------------------------------------------------------
C  NO DIFFUSION EXPERIMENTAL DATA AVAILABLE,USED INELASTICS FROM SCALING
C  ISOBUTANE INELASTIC X-SECT. ELASTIC DETERMINED FROM DRIFT VELOCITY.
C HENCE DIFFUSION ACCURATE TO ONLY 10% , DRIFT VELOCITY TO 3% BELOW
C 10KV/CM.
C MODIFICATION OF NEO-PENTANE (1995) TO INCLUDE SUPERELASTIC SCATTERING
C FIT TO DRIFT VELOCITY OF FLORIANO GEE AND FREEMAN
C ----------------------------------------------------------------------
C
      NAME='N-PENTANE   03 '
C
      NIN=11
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      NDATA=61
      NION=46
      NATT=16
      NVIB1=34
      NVIB2=28
      NVIB3=28
      NVIB4=25
      NVIB5=19
      NEXC1=25
      NEXC2=23
      NEXC3=19
      E(1)=0.0
      E(2)=2.0*EMASS/(72.1503*AMU)
      E(3)=10.35
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=10.35
      EIN(1)=-.052
      EIN(2)=0.052
      EIN(3)=-.108
      EIN(4)=0.108
      EIN(5)=-.173
      EIN(6)=0.173
      EIN(7)=0.363
      EIN(8)=0.519
      EIN(9)=7.2
      EIN(10)=9.50
      EIN(11)=17.0
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       N-PENTANE      '
      SCRPT(3)=' IONISATION    ELOSS= 10.35   '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' VIB           ELOSS= -0.052  '
      SCRPT(8)=' VIB           ELOSS=  0.052  '
      SCRPT(9)=' VIB           ELOSS= -0.108  '
      SCRPT(10)=' VIB           ELOSS=  0.108  '
      SCRPT(11)=' VIB           ELOSS= -0.173  '
      SCRPT(12)=' VIB           ELOSS=  0.173  '
      SCRPT(13)=' VIB           ELOSS=  0.363  '
      SCRPT(14)=' VIB           ELOSS=  0.519  '
      SCRPT(15)=' EXC           ELOSS=  7.20   '
      SCRPT(16)=' EXC           ELOSS=  9.50   '
      SCRPT(17)=' EXC           ELOSS= 17.0    '
      APOP1=DEXP(EIN(1)/AKT)
      APOP2=DEXP(EIN(3)/AKT)
      APOP3=DEXP(EIN(5)/AKT)
      EN=-ESTEP/2.0
      DO 1000 I=1,NSTEP
      EN=EN+ESTEP
      IF(EN.LE.XEN(2)) THEN
       Q(2,I)=YXSEC(2)*1.D-16
       GO TO 21
      ENDIF
      DO 10 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 20
   10 CONTINUE
      J=NDATA
   20 YXJ=DLOG(YXSEC(J))
      YXJ1=DLOG(YXSEC(J-1))
      XNJ=DLOG(XEN(J))
      XNJ1=DLOG(XEN(J-1))
      A=(YXJ-YXJ1)/(XNJ-XNJ1)
      B=(XNJ1*YXJ-XNJ*YXJ1)/(XNJ1-XNJ)
      Q(2,I)=DEXP(A*DLOG(EN)+B)*1.D-16
   21 CONTINUE
      Q(3,I)=0.0
      IF(EN.LT.E(3)) GO TO 30
      DO 22 J=2,NION
      IF(EN.LE.XION(J)) GO TO 23
   22 CONTINUE
      J=NION
   23 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
   30 Q(4,I)=0.0
      IF(EN.LT.XATT(1)) GO TO 40
      IF(EN.GT.XATT(NATT)) GO TO 40
      DO 31 J=2,NATT
      IF(EN.LE.XATT(J)) GO TO 32
   31 CONTINUE
      J=NATT
   32 A=(YATT(J)-YATT(J-1))/(XATT(J)-XATT(J-1))
      B=(XATT(J-1)*YATT(J)-XATT(J)*YATT(J-1))/(XATT(J-1)-XATT(J))
      Q(4,I)=(A*EN+B)*1.D-21
   40 Q(5,I)=0.0
      Q(6,I)=0.0
C
C SUPERELASTIC VIB1
      QIN(1,I)=0.0
      IF(EN.LE.0.0) GO TO 150
      DO 110 J=2,NVIB1
      IF((EN+EIN(2)).LE.XVIB1(J)) GO TO 120
  110 CONTINUE
      J=NVIB1
  120 A=(YVIB1(J)-YVIB1(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB1(J)-XVIB1(J)*YVIB1(J-1))/(XVIB1(J-1)-XVIB1(J))
      QIN(1,I)=(EN+EIN(2))*(A*(EN+EIN(2))+B)/EN
      QIN(1,I)=QIN(1,I)*APOP1/(1.0+APOP1)*1.D-16
C  VIB1
  150 QIN(2,I)=0.0
      IF(EN.LE.EIN(2)) GO TO 200
      DO 160  J=2,NVIB1
      IF(EN.LE.XVIB1(J)) GO TO 170
  160 CONTINUE
      J=NVIB1
  170 A=(YVIB1(J)-YVIB1(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB1(J)-XVIB1(J)*YVIB1(J-1))/(XVIB1(J-1)-XVIB1(J))
      QIN(2,I)=(A*EN+B)/(1.0+APOP1)*1.D-16
  200 CONTINUE
C
C SUPERELASTIC VIB2
      QIN(3,I)=0.0
      IF(EN.LE.0.0) GO TO 250
      DO 210 J=2,NVIB2
      IF((EN+EIN(4)).LE.XVIB2(J)) GO TO 220
  210 CONTINUE
      J=NVIB2
  220 A=(YVIB2(J)-YVIB2(J-1))/(XVIB2(J)-XVIB2(J-1))
      B=(XVIB2(J-1)*YVIB2(J)-XVIB2(J)*YVIB2(J-1))/(XVIB2(J-1)-XVIB2(J))
      QIN(3,I)=(EN+EIN(4))*(A*(EN+EIN(4))+B)/EN
      QIN(3,I)=QIN(3,I)*APOP2/(1.0+APOP2)*1.D-16
C  VIB2
  250 QIN(4,I)=0.0
      IF(EN.LE.EIN(4)) GO TO 300
      DO 260 J=2,NVIB2
      IF(EN.LE.XVIB2(J)) GO TO 270
  260 CONTINUE
      J=NVIB2
  270 A=(YVIB2(J)-YVIB2(J-1))/(XVIB2(J)-XVIB2(J-1))
      B=(XVIB2(J-1)*YVIB2(J)-XVIB2(J)*YVIB2(J-1))/(XVIB2(J-1)-XVIB2(J))
      QIN(4,I)=(A*EN+B)/(1.0+APOP2)*1.D-16
  300 CONTINUE
C
C SUPERELASTIC VIB3
      QIN(5,I)=0.0
      IF(EN.LE.0.0) GO TO 350
      DO 310 J=2,NVIB3
      IF((EN+EIN(6)).LE.XVIB3(J)) GO TO 320
  310 CONTINUE
      J=NVIB3
  320 A=(YVIB3(J)-YVIB3(J-1))/(XVIB3(J)-XVIB3(J-1))
      B=(XVIB3(J-1)*YVIB3(J)-XVIB3(J)*YVIB3(J-1))/(XVIB3(J-1)-XVIB3(J))
      QIN(5,I)=(EN+EIN(6))*(A*(EN+EIN(6))+B)/EN
      QIN(5,I)=QIN(5,I)*APOP3/(1.0+APOP3)*1.D-16
C  VIB3
  350 QIN(6,I)=0.0
      IF(EN.LE.EIN(6)) GO TO 400
      DO 360 J=2,NVIB3
      IF(EN.LE.XVIB3(J)) GO TO 370
  360 CONTINUE
      J=NVIB3
  370 A=(YVIB3(J)-YVIB3(J-1))/(XVIB3(J)-XVIB3(J-1))
      B=(XVIB3(J-1)*YVIB3(J)-XVIB3(J)*YVIB3(J-1))/(XVIB3(J-1)-XVIB3(J))
      QIN(6,I)=(A*EN+B)/(1.0+APOP3)*1.D-16
  400 CONTINUE
C VIB4
      QIN(7,I)=0.0
      IF(EN.LE.EIN(7)) GO TO 500
      DO 410 J=2,NVIB4
      IF(EN.LE.XVIB4(J)) GO TO 420
  410 CONTINUE
      J=NVIB4
  420 A=(YVIB4(J)-YVIB4(J-1))/(XVIB4(J)-XVIB4(J-1))
      B=(XVIB4(J-1)*YVIB4(J)-XVIB4(J)*YVIB4(J-1))/(XVIB4(J-1)-XVIB4(J))
      QIN(7,I)=(A*EN+B)*1.D-16
  500 CONTINUE
C VIB5
      QIN(8,I)=0.0
      IF(EN.LE.EIN(8)) GO TO 600
      DO 510 J=2,NVIB5
      IF(EN.LE.XVIB5(J)) GO TO 520
  510 CONTINUE
      J=NVIB5
  520 A=(YVIB5(J)-YVIB5(J-1))/(XVIB5(J)-XVIB5(J-1))
      B=(XVIB5(J-1)*YVIB5(J)-XVIB5(J)*YVIB5(J-1))/(XVIB5(J-1)-XVIB5(J))
      QIN(8,I)=(A*EN+B)*1.D-16
  600 CONTINUE
C EXC1
      QIN(9,I)=0.0
      IF(EN.LE.EIN(9)) GO TO 700
      DO 610 J=2,NEXC1
      IF(EN.LE.XEXC1(J)) GO TO 620
  610 CONTINUE
      J=NEXC1
  620 A=(YEXC1(J)-YEXC1(J-1))/(XEXC1(J)-XEXC1(J-1))
      B=(XEXC1(J-1)*YEXC1(J)-XEXC1(J)*YEXC1(J-1))/(XEXC1(J-1)-XEXC1(J))
      QIN(9,I)=(A*EN+B)*1.D-16
  700 CONTINUE
C EXC2
      QIN(10,I)=0.0
      IF(EN.LE.EIN(10)) GO TO 800
      DO 710 J=2,NEXC2
      IF(EN.LE.XEXC2(J)) GO TO 720
  710 CONTINUE
      J=NEXC2
  720 A=(YEXC2(J)-YEXC2(J-1))/(XEXC2(J)-XEXC2(J-1))
      B=(XEXC2(J-1)*YEXC2(J)-XEXC2(J)*YEXC2(J-1))/(XEXC2(J-1)-XEXC2(J))
      QIN(10,I)=(A*EN+B)*1.D-16
  800 CONTINUE
C EXC3
      QIN(11,I)=0.0
      IF(EN.LE.EIN(11)) GO TO 900
      DO 810 J=2,NEXC3
      IF(EN.LE.XEXC3(J)) GO TO 820
  810 CONTINUE
      J=NEXC3
  820 A=(YEXC3(J)-YEXC3(J-1))/(XEXC3(J)-XEXC3(J-1))
      B=(XEXC3(J-1)*YEXC3(J)-XEXC3(J)*YEXC3(J-1))/(XEXC3(J-1)-XEXC3(J))
      QIN(11,I)=(A*EN+B)*1.D-16
  900 CONTINUE
C
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+QIN(1,I)+QIN(2,I)+QIN(3,I)+QIN(4,I)+
     /QIN(5,I)+QIN(6,I)+QIN(7,I)+QIN(8,I)+QIN(9,I)+QIN(10,I)+QIN(11,I)
 1000 CONTINUE
C  SAVE COMPUTE TIME
      IF(EFINAL.LE.EIN(11)) NIN=10
      IF(EFINAL.LE.EIN(10)) NIN=9
      IF(EFINAL.LE.EIN(9)) NIN=8
      IF(EFINAL.LE.EIN(8)) NIN=7
      IF(EFINAL.LE.EIN(7)) NIN=6
      IF(EFINAL.LE.EIN(6)) NIN=5
      RETURN
      END
      SUBROUTINE GAS58(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220),
     /PJ(120)
      DIMENSION XMOM(65),YMOM(65),XELA(59),YELA(59),XVIB1(50),YVIB1(50),
     /XVIB2(24),YVIB2(24),XVIB3(20),YVIB3(20),XVIB4(18),YVIB4(18),
     /XVIB5(18),YVIB5(18),XVIB6(15),YVIB6(15),XVIB7(17),YVIB7(17),
     /XVIB8(15),YVIB8(15),
     /XTRP1(25),YTRP1(25),XTRP3(23),YTRP3(23),XTRP5(26),YTRP5(26),
     /XTRP7(29),YTRP7(29),XTRP8(19),YTRP8(19),
     /XSNG2(29),YSNG2(29),XSNG5(26),YSNG5(26),XION(43),YION(43)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      DATA XELA/0.00,.010,.015,0.02,0.03,0.04,0.05,0.07,0.10,0.12,
     /0.15,0.17,0.20,0.25,0.30,0.35,0.40,0.50,0.70,1.00,
     /1.20,1.30,1.50,1.70,1.90,2.10,2.20,2.50,2.80,3.00,
     /3.30,3.60,4.00,4.50,5.00,6.00,7.00,8.00,10.0,12.0,
     /15.0,17.0,20.0,25.0,30.0,50.0,75.0,100.,150.,200.,
     /300.,500.,700.,1000.,2000.,4000.,10000.,20000.,100000./
      DATA YELA/1.10,1.92,2.23,2.49,2.95,3.35,3.78,4.48,5.26,5.72,
     /6.33,6.62,7.11,7.70,8.22,8.62,8.96,9.24,9.52,9.74,
     /10.26,10.91,11.99,13.78,16.98,17.62,18.94,19.11,22.7,18.74,
     /16.88,15.59,14.08,12.90,12.74,12.53,12.43,13.01,13.23,13.23,
     /12.80,12.56,12.10,11.41,10.67,8.30,6.66,5.38,4.18,3.50,
     /2.70,1.831,1.455,1.03,0.58,0.28,0.10,.052,.008/
      DATA XMOM/0.00,.001,.002,.003,.005,.007,.0085,.010,.015,0.02,
     /0.03,0.04,0.05,0.07,0.10,0.12,0.15,0.17,0.20,0.25,
     /0.30,0.35,0.40,0.50,0.70,1.00,1.20,1.30,1.50,1.70,
     /1.90,2.10,2.20,2.50,2.80,3.00,3.30,3.60,4.00,4.50,
     /5.00,6.00,7.00,8.00,10.0,12.0,15.0,17.0,20.0,25.0,
     /30.0,50.0,75.0,100.,150.,200.,300.,500.,700.,1000.,
     /2000.,4000.,10000.,20000.,100000./
      DATA YMOM/1.10,1.36,1.49,1.62,1.81,2.00,2.10,2.19,2.55,2.85,
     /3.38,3.82,4.30,5.08,5.92,6.42,7.08,7.38,7.88,8.48,
     /8.98,9.36,9.67,9.87,9.97,9.96,10.34,10.92,11.87,13.47,
     /16.41,16.85,18.02,17.92,21.0,17.20,15.3,13.96,12.42,11.19,
     /10.86,10.36,10.0,10.2,9.90,9.50,8.70,8.26,7.60,6.70,
     /5.90,3.80,2.56,1.80,1.13,0.80,0.48,0.23,.143,.077,
     /.038,.019,.008,.004,.001/
      DATA XVIB1/0.29,0.30,0.33,0.40,0.75,0.90,1.00,1.10,1.16,1.20,
     /1.22,1.40,1.50,1.60,1.65,1.70,1.80,1.90,2.00,2.10,
     /2.20,2.30,2.40,2.50,2.60,2.70,2.75,2.80,2.90,3.00,
     /3.10,3.20,3.30,3.40,3.50,3.60,4.00,5.00,15.0,18.0,
     /20.0,22.0,23.0,25.0,29.0,32.0,50.0,80.0,1000.,100000./
      DATA YVIB1/.00,.001,.0017,.0025,.0037,.0055,.0065,.009,.011,.0125,
     /.0135,.070,.100,.150,.270,.315,.540,1.485,4.80,2.565,
     /1.20,4.50,2.76,1.59,3.15,1.545,0.60,1.35,.525,0.870,
     /1.17,0.855,0.66,0.60,.585,0.57,.055,.035,.035,0.04,
     /.065,.085,.085,0.06,0.03,.015,.012,0.00,0.00,0.00/
      DATA XVIB2/0.59,1.70,1.80,1.90,2.00,2.10,2.20,2.30,2.40,2.50,
     /2.60,2.70,2.75,2.80,2.90,3.00,3.10,3.20,3.30,3.40,
     /3.50,3.60,1000.,100000./
      DATA YVIB2/0.00,0.00,.015,0.63,1.935,3.30,1.47,0.54,2.115,3.00,
     /0.54,1.05,1.725,1.275,0.33,0.90,0.645,0.375,0.345,0.30,
     /0.213,0.00,0.00,0.00/
      DATA XVIB3/0.88,1.90,2.00,2.10,2.20,2.30,2.40,2.50,2.60,2.70,
     /2.75,2.80,2.90,3.00,3.10,3.20,3.30,3.40,1000.,100000./
      DATA YVIB3/0.00,0.00,0.96,2.055,2.70,1.695,0.075,0.96,1.47,0.45,
     /0.96,0.54,0.855,0.405,0.282,0.291,0.0615,0.00,0.00,0.00/
      DATA XVIB4/1.17,2.00,2.10,2.20,2.30,2.40,2.50,2.60,2.70,2.75,
     /2.80,2.90,3.00,3.10,3.20,3.30,1000.,100000./
      DATA YVIB4/0.0,0.0,.2025,1.515,2.385,1.440,.555,.0825,1.2,1.095,
     /0.675,0.03,0.33,0.315,0.06,0.00,0.00,0.00/
      DATA XVIB5/1.47,2.10,2.20,2.30,2.40,2.50,2.60,2.70,2.75,2.80,
     /2.90,3.00,3.10,3.20,3.30,3.40,1000.,100000./
      DATA YVIB5/0.00,0.00,.825,1.23,1.53,1.44,0.345,.0225,.345,0.54,
     /0.66,.2175,.105,.315,.1035,0.00,0.00,0.00/
      DATA XVIB6/1.76,2.20,2.30,2.40,2.50,2.60,2.70,2.75,2.80,2.90,
     /3.00,3.10,3.20,1000.,100000./
      DATA YVIB6/0.00,0.00,.0063,1.125,1.74,1.38,0.78,0.45,.315,.246,
     /0.48,.1635,0.00,0.00,0.00/
      DATA XVIB7/2.06,2.30,2.40,2.50,2.60,2.70,2.75,2.80,2.90,3.00,
     /3.10,3.20,3.30,3.40,3.50,1000.,100000./
      DATA YVIB7/0.00,0.00,.0126,0.39,0.66,0.96,.795,0.60,0.18,.0063,
     /.192,.204,.078,.0189,0.00,0.00,0.00/
      DATA XVIB8/2.35,2.50,2.60,2.70,2.75,2.80,2.90,3.00,3.10,3.20,
     /3.30,3.40,3.50,1000.,100000./
      DATA YVIB8/0.00,0.00,.0189,0.36,0.36,0.33,.345,.264,.0375,.0063,
     /.1545,.0252,0.00,0.00,0.00/
      DATA XTRP1/6.17,7.00,7.80,8.50,9.00,10.0,11.0,12.0,13.0,14.0,
     /16.0,17.0,18.0,20.0,22.0,24.0,26.0,30.0,34.0,40.0,
     /50.0,70.0,150.,1000.,100000./
      DATA YTRP1/0.00,.0033,.0085,.0213,.0307,.0468,.059,.069,.075,.082,
     /.089,.089,.084,.072,.061,.052,.045,.034,.029,.023,
     /.019,.004,0.00,0.00,0.00/
      DATA XTRP3/7.35,8.00,9.00,10.0,11.0,12.0,13.0,14.0,15.0,16.0,
     /17.0,18.0,20.0,22.0,26.0,30.0,34.0,40.0,50.0,70.0,
     /150.0,1000.,100000./
      DATA YTRP3/.0,.0543,.1434,.2312,.2975,.343,.373,.387,.397,.399,
     /.383,.354,.289,.227,.165,.131,.106,.0777,.0469,.0168,
     /0.00,0.00,0.00/
      DATA XTRP5/7.80,8.10,8.50,8.70,9.00,10.0,11.0,12.0,13.0,14.0,
     /16.0,17.0,18.0,20.0,22.0,24.0,26.0,30.0,34.0,40.0,
     /50.0,70.0,150.0,500.0,1000.,100000./
      DATA YTRP5/0.0,.0015,.0097,.018,.029,.073,.115,.148,.180,.208,
     /.205,.178,.152,.122,.105,.091,.081,.066,.057,.047,
     /.041,.021,.007,0.00,0.00,0.00/
      DATA XSNG2/8.55,9.00,12.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,
     /24.0,26.0,30.0,40.0,50.0,70.0,100.,150.,200.,250.,
     /300.,500.,700.,1000.,2000.,4000.,10000.,20000.,100000./
      DATA YSNG2/.0,.0141,.163,.2276,.2412,.2481,.2483,.238,.2268,.2150,
     /.1860,.1734,.1527,.1160,.0900,.0642,.0425,.0268,.0201,.0161,
     /.0134,.0082,.0060,.0042,.0020,.0010,.0004,.0002,.00004/
      DATA XTRP7/11.03,11.5,12.0,12.5,13.0,13.5,13.8,14.0,14.2,14.5,
     /15.0,16.0,17.0,18.0,19.0,20.0,22.0,24.0,26.0,28.0,
     /30.0,36.0,40.0,50.0,70.0,100.0,150.0,1000.,100000./
      DATA YTRP7/.0,.0405,.093,.1965,.435,.735,.93,.975,.96,.945,
     /.825,.645,.525,.450,.405,.375,.315,.2655,.225,.2085,
     /.1665,.117,.0945,.0585,.0225,.0023,0.00,0.00,0.00/
      DATA XTRP8/11.87,11.92,12.7,17.0,19.0,20.0,22.0,24.0,26.0,28.0,
     /30.0,32.0,40.0,50.0,70.0,100.,150.0,1000.,100000./
      DATA YTRP8/.0,.0496,.0041,.0346,.0436,.0448,.0405,.0338,.0289,
     /.0241,.0193,.0172,.0122,.010,.007,.005,0.00,0.00,0.00/
      DATA XSNG5/13.0,14.0,15.0,16.0,17.0,18.0,20.0,22.0,25.0,30.0,
     /40.0,60.0,80.0,100.,150.,200.,250.,300.,500.,700.,
     /1000.,2000.,4000.,10000.,20000.,100000./
      DATA YSNG5/0.0,.081,0.19,0.25,0.42,0.52,0.75,0.96,1.19,1.48,
     /1.65,1.76,1.68,1.58,1.33,1.16,1.05,0.96,0.74,0.64,
     /0.53,0.28,0.14,0.06,0.03,.006/
      DATA XION/15.6,16.0,16.5,17.0,17.5,18.0,18.5,19.0,19.5,20.0,
     /21.0,22.0,23.0,24.0,25.0,26.0,30.0,34.0,38.0,45.0,
     /50.0,60.0,75.0,100.,125.,150.,200.,250.,300.,400.,
     /500.,700.,1000.,1500.,2000.,3000.,4000.,6000.,8000.,10000.,
     /20000.,40000.,100000./
      DATA YION/0.00,.021,.047,.071,.099,.129,.164,.199,.230,.270,
     /.344,.418,.492,.565,.640,.714,1.03,1.27,1.49,1.78,
     /1.94,2.18,2.39,2.52,2.52,2.45,2.27,2.08,1.92,1.66,
     /1.45,1.16,0.91,.654,.521,.375,.295,.209,.164,.135,
     /.073,.040,.017/
C
      NAME='N2 2004 PHELPS '
C    --------------------------------------------------------------
C    NITROGEN FROM PITCHFORD AND PHELPS . JILA REPORT NO.26 (1985)
C    MULTI TERM CROSS SECTIONS WITH MODIFICATION CF:PHELPS PRIVATE
C    COMMUNICATION . REDUCED 11.03 ENERGY LOSS X-SECTION BY 0.6666
C    IN CODE.
C       ACCURACY ABOUT 1% AT ALL FIELDS.
C    COMBINED SOME CLOSE LEVELS IN ORDER TO SAVE COMPUTING TIME
C    2004: INCLUDED FULL TREATMENT OF ROTATIONAL STATES
C    ANISOTROPIC ELASTIC SCATTERING
C    --------------------------------------------------------------
      NIN=71
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
C USE ANISTROPIC ELASTIC SCATTERING AND COPY (OFFSET) TO IONISATION
      KEL(2)=1
      KEL(3)=1
C ANISOTROPIC INELASTIC FROM COPY (OFFSET) OF ELASTIC ANGULAR DIST
      KIN(65)=1
      KIN(66)=1
      KIN(67)=1
      KIN(68)=1
      KIN(69)=1
      KIN(70)=1
      KIN(71)=1
      NELA=59
      NMOM=65
      NVIB1=50
      NVIB2=24
      NVIB3=20
      NVIB4=18
      NVIB5=18
      NVIB6=15
      NVIB7=17
      NVIB8=15
      NTRP1=25
      NTRP3=23
      NTRP5=26
      NTRP7=29
      NTRP8=19
      NSNG2=29
      NSNG5=26
      NION=43
      E(1)=0.0
      E(2)=2.0*EMASS/(27.7940*AMU)
      E(3)=15.60
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=13.0
      IOFF=IFIX(SNGL(0.5+E(3)/ESTEP))
C CALC FRACTIONAL POPULATION DENSITY FOR ROTATIONAL STATES
      B0=2.4668D-4
      A0=0.5291772083
      QBQA=1.06
      QBK=1.67552*(QBQA*A0)**2*1.D-16
      DO 3 K=1,29,2
    3 PJ(K)=3*(2*K+1)*DEXP(-K*(K+1)*B0/AKT)
      DO 4 K=2,28,2
    4 PJ(K)=6*(2*K+1)*DEXP(-K*(K+1)*B0/AKT)
      SUM=6.0
      DO 5 K=1,29
    5 SUM=SUM+PJ(K)
      FROT0=6.0/SUM
      DO 6 K=1,29
    6 PJ(K)=PJ(K)/SUM
C CALC ROTATIONAL TRANSITION ENERGIES
      DO 7 K=1,28
      J=K-1
      EIN(K+28)=B0*(4*J+6)
    7 EIN(K)=-EIN(K+28)
      EIN(57)=0.290
      EIN(58)=0.590
      EIN(59)=0.880
      EIN(60)=1.17
      EIN(61)=1.47
      EIN(62)=1.76
      EIN(63)=2.06
      EIN(64)=2.35
      EIN(65)=6.17
      EIN(66)=7.35
      EIN(67)=7.80
      EIN(68)=8.55
      EIN(69)=11.03
      EIN(70)=11.87
      EIN(71)=13.0
      IOFF65=IFIX(SNGL(0.5+EIN(65)/ESTEP))
      IOFF66=IFIX(SNGL(0.5+EIN(66)/ESTEP))
      IOFF67=IFIX(SNGL(0.5+EIN(67)/ESTEP))
      IOFF68=IFIX(SNGL(0.5+EIN(68)/ESTEP))
      IOFF69=IFIX(SNGL(0.5+EIN(69)/ESTEP))
      IOFF70=IFIX(SNGL(0.5+EIN(70)/ESTEP))
      IOFF71=IFIX(SNGL(0.5+EIN(71)/ESTEP))
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC  ANISOTROPIC NITROGEN'
      SCRPT(3)=' IONISATION    ELOSS= 15.60   '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' ROT 2-0       ELOSS= -0.00148'
      SCRPT(8)=' ROT 3-1       ELOSS= -0.00247'
      SCRPT(9)=' ROT 4-2       ELOSS= -0.00345'
      SCRPT(10)=' ROT 5-3       ELOSS= -0.00444'
      SCRPT(11)=' ROT 6-4       ELOSS= -0.00543'
      SCRPT(12)=' ROT 7-5       ELOSS= -0.00641'
      SCRPT(13)=' ROT 8-6       ELOSS= -0.00740'
      SCRPT(14)=' ROT 9-7       ELOSS= -0.00839'
      SCRPT(15)=' ROT 10-8      ELOSS= -0.00937'
      SCRPT(16)=' ROT 11-9      ELOSS= -0.0104 '
      SCRPT(17)=' ROT 12-10     ELOSS= -0.0113 '
      SCRPT(18)=' ROT 13-11     ELOSS= -0.0123 '
      SCRPT(19)=' ROT 14-12     ELOSS= -0.0133 '
      SCRPT(20)=' ROT 15-13     ELOSS= -0.0143 '
      SCRPT(21)=' ROT 16-14     ELOSS= -0.0153 '
      SCRPT(22)=' ROT 17-15     ELOSS= -0.0163 '
      SCRPT(23)=' ROT 18-16     ELOSS= -0.0173 '
      SCRPT(24)=' ROT 19-17     ELOSS= -0.0183 '
      SCRPT(25)=' ROT 20-18     ELOSS= -0.0192 '
      SCRPT(26)=' ROT 21-19     ELOSS= -0.0202 '
      SCRPT(27)=' ROT 22-20     ELOSS= -0.0212 '
      SCRPT(28)=' ROT 23-21     ELOSS= -0.0222 '
      SCRPT(29)=' ROT 24-22     ELOSS= -0.0232 '
      SCRPT(30)=' ROT 25-23     ELOSS= -0.0242 '
      SCRPT(31)=' ROT 26-24     ELOSS= -0.0252 '
      SCRPT(32)=' ROT 27-25     ELOSS= -0.0261 '
      SCRPT(33)=' ROT 28-26     ELOSS= -0.0271 '
      SCRPT(34)=' ROT 29-27     ELOSS= -0.0281 '
      SCRPT(35)=' ROT 0-2       ELOSS=  0.00148'
      SCRPT(36)=' ROT 1-3       ELOSS=  0.00247'
      SCRPT(37)=' ROT 2-4       ELOSS=  0.00345'
      SCRPT(38)=' ROT 3-5       ELOSS=  0.00444'
      SCRPT(39)=' ROT 4-6       ELOSS=  0.00543'
      SCRPT(40)=' ROT 5-7       ELOSS=  0.00641'
      SCRPT(41)=' ROT 6-8       ELOSS=  0.00740'
      SCRPT(42)=' ROT 7-9       ELOSS=  0.00839'
      SCRPT(43)=' ROT 8-10      ELOSS=  0.00937'
      SCRPT(44)=' ROT 9-11      ELOSS=  0.0104 '
      SCRPT(45)=' ROT 10-12     ELOSS=  0.0113 '
      SCRPT(46)=' ROT 11-13     ELOSS=  0.0123 '
      SCRPT(47)=' ROT 12-14     ELOSS=  0.0133 '
      SCRPT(48)=' ROT 13-15     ELOSS=  0.0143 '
      SCRPT(49)=' ROT 14-16     ELOSS=  0.0153 '
      SCRPT(50)=' ROT 15-17     ELOSS=  0.0163 '
      SCRPT(51)=' ROT 16-18     ELOSS=  0.0173 '
      SCRPT(52)=' ROT 17-19     ELOSS=  0.0183 '
      SCRPT(53)=' ROT 18-20     ELOSS=  0.0192 '
      SCRPT(54)=' ROT 19-21     ELOSS=  0.0202 '
      SCRPT(55)=' ROT 20-22     ELOSS=  0.0212 '
      SCRPT(56)=' ROT 21-23     ELOSS=  0.0222 '
      SCRPT(57)=' ROT 22-24     ELOSS=  0.0232 '
      SCRPT(58)=' ROT 23-25     ELOSS=  0.0242 '
      SCRPT(59)=' ROT 24-26     ELOSS=  0.0252 '
      SCRPT(60)=' ROT 25-27     ELOSS=  0.0261 '
      SCRPT(61)=' ROT 26-28     ELOSS=  0.0271 '
      SCRPT(62)=' ROT 27-29     ELOSS=  0.0281 '
      SCRPT(63)=' VIB V1        ELOSS=  0.290  '
      SCRPT(64)=' VIB 2V1       ELOSS=  0.590  '
      SCRPT(65)=' VIB 3V1       ELOSS=  0.880  '
      SCRPT(66)=' VIB 4V1       ELOSS=  1.17   '
      SCRPT(67)=' VIB 5V1       ELOSS=  1.47   '
      SCRPT(68)=' VIB 6V1       ELOSS=  1.76   '
      SCRPT(69)=' VIB 7V1       ELOSS=  2.06   '
      SCRPT(70)=' VIB 8V1       ELOSS=  2.35   '
      SCRPT(71)=' EXC TRPLT1    ELOSS=  6.17   '
      SCRPT(72)=' EXC TRPLT3    ELOSS=  7.35   '
      SCRPT(73)=' EXC TRPLT5    ELOSS=  7.80   '
      SCRPT(74)=' EXC SNGLT2    ELOSS=  8.55   '
      SCRPT(75)=' EXC TRPLT7    ELOSS= 11.03   '
      SCRPT(76)=' EXC TRPLT8    ELOSS= 11.87   '
      SCRPT(77)=' EXC SNGLT5    ELOSS= 13.0    '
C
      EN=-ESTEP/2.0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
C
C ELASTIC (+ROTATIONAL)
      DO 10 J=2,NELA
      IF(EN.LE.XELA(J)) GO TO 15
   10 CONTINUE
      J=NELA
   15 A=(YELA(J)-YELA(J-1))/(XELA(J)-XELA(J-1))
      B=(XELA(J-1)*YELA(J)-XELA(J)*YELA(J-1))/(XELA(J-1)-XELA(J))
      QELA=(A*EN+B)*1.0D-16
C
C  MOMENTUM TRANSFER
      DO 20 J=2,NMOM
      IF(EN.LE.XMOM(J)) GO TO 25
   20 CONTINUE
      J=NMOM
   25 A=(YMOM(J)-YMOM(J-1))/(XMOM(J)-XMOM(J-1))
      B=(XMOM(J-1)*YMOM(J)-XMOM(J)*YMOM(J-1))/(XMOM(J-1)-XMOM(J))
      QMOM=(A*EN+B)*1.0D-16
C
      PEQEL(2,I)=0.5+(QELA-QMOM)/QELA
      Q(2,I)=QELA
C
      Q(3,I)=0.0
      PEQEL(3,I)=0.5
      IF(EN.LT.E(3)) GO TO 50
      DO 30 J=2,NION
      IF(EN.LE.XION(J)) GO TO 40
   30 CONTINUE
      J=NION
   40 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=(A*EN+B)*1.D-16
C USE ANISOTROPIC SCATTERING FOR PRIMARY IONISATION ELECTRON FOR
C ENERGIES ABOVE 2 * IONISATION ENERGY
C ANISOTROPIC ANGULAR DISTRIBUTION SAME AS ELASTIC AT ENERGY OFFSET BY
C IONISATION ENERGY
      IF(EN.LE.(2.0*E(3))) GO TO 50
      PEQEL(3,I)=PEQEL(2,(I-IOFF))
C
   50 Q(4,I)=0.0
      Q(5,I)=0.0
      Q(6,I)=0.0
C---------------------------------------------------------------------
C  QUADRUPOLE BORN ROTATIONAL STATES  ( GERJUOY AND STEIN)
C---------------------------------------------------------------------
C  SUPERELASTIC ROTATION
      DO 51 K=1,28
      AJ=DFLOAT(K+1)
   51 QIN(K,I)=PJ(K+1)*QBK*DSQRT(1.0-EIN(K)/EN)*AJ*(AJ-1.0)/((2.0*AJ+1.0
     /)*(2.0*AJ-1.0))
C
      DO 52 K=29,56
   52 QIN(K,I)=0.0
C INELASTIC ROTATION
C   ROT 0-2
      IF(EN.LE.EIN(29)) GO TO 60
       QIN(29,I)=FROT0*QBK*DSQRT(1.0-EIN(29)/EN)*2.0/3.0
C   ROT 1-3 AND HIGHER
      DO 53 K=30,56
      AJ=DFLOAT(K-29)
      IF(EN.LE.EIN(K)) GO TO 60
   53 QIN(K,I)=PJ(K-29)*QBK*DSQRT(1.0-EIN(K)/EN)*(AJ+2.0)*(AJ+1.0)/((2.0
     /*AJ+3.0)*(2.0*AJ+1.0))
C BORN (1/E) FALL OFF IN ROTATIONAL X-SECS ABOVE 6.0 EV
   60 IF(EN.LT.6.0) GO TO 80
      DO 70 K=1,56
   70 QIN(K,I)=QIN(K,I)*6.0/EN
C
C---------------------------------------------------------------------
   80 CONTINUE
C---------------------------------------------------------------------
      QIN(57,I)=0.0
      IF(EN.LE.EIN(57)) GO TO 110
      DO 90 J=2,NVIB1
      IF(EN.LE.XVIB1(J)) GO TO 100
   90 CONTINUE
      J=NVIB1
  100 A=(YVIB1(J)-YVIB1(J-1))/(XVIB1(J)-XVIB1(J-1))
      B=(XVIB1(J-1)*YVIB1(J)-XVIB1(J)*YVIB1(J-1))/(XVIB1(J-1)-XVIB1(J))
      QIN(57,I)=(A*EN+B)*1.D-16
  110 CONTINUE
C
      QIN(58,I)=0.0
      IF(EN.LE.EIN(58)) GO TO 140
      DO 120 J=2,NVIB2
      IF(EN.LE.XVIB2(J)) GO TO 130
  120 CONTINUE
      J=NVIB2
  130 A=(YVIB2(J)-YVIB2(J-1))/(XVIB2(J)-XVIB2(J-1))
      B=(XVIB2(J-1)*YVIB2(J)-XVIB2(J)*YVIB2(J-1))/(XVIB2(J-1)-XVIB2(J))
      QIN(58,I)=(A*EN+B)*1.D-16
  140 CONTINUE
C
      QIN(59,I)=0.0
      IF(EN.LE.EIN(59)) GO TO 170
      DO 150 J=2,NVIB3
      IF(EN.LE.XVIB3(J)) GO TO 160
  150 CONTINUE
      J=NVIB3
  160 A=(YVIB3(J)-YVIB3(J-1))/(XVIB3(J)-XVIB3(J-1))
      B=(XVIB3(J-1)*YVIB3(J)-XVIB3(J)*YVIB3(J-1))/(XVIB3(J-1)-XVIB3(J))
      QIN(59,I)=(A*EN+B)*1.D-16
  170 CONTINUE
C
      QIN(60,I)=0.0
      IF(EN.LE.EIN(60)) GO TO 200
      DO 180 J=2,NVIB4
      IF(EN.LE.XVIB4(J)) GO TO 190
  180 CONTINUE
      J=NVIB4
  190 A=(YVIB4(J)-YVIB4(J-1))/(XVIB4(J)-XVIB4(J-1))
      B=(XVIB4(J-1)*YVIB4(J)-XVIB4(J)*YVIB4(J-1))/(XVIB4(J-1)-XVIB4(J))
      QIN(60,I)=(A*EN+B)*1.D-16
  200 CONTINUE
C
      QIN(61,I)=0.0
      IF(EN.LE.EIN(61)) GO TO 230
      DO 210 J=2,NVIB5
      IF(EN.LE.XVIB5(J)) GO TO 220
  210 CONTINUE
      J=NVIB5
  220 A=(YVIB5(J)-YVIB5(J-1))/(XVIB5(J)-XVIB5(J-1))
      B=(XVIB5(J-1)*YVIB5(J)-XVIB5(J)*YVIB5(J-1))/(XVIB5(J-1)-XVIB5(J))
      QIN(61,I)=(A*EN+B)*1.D-16
  230 CONTINUE
C
      QIN(62,I)=0.0
      IF(EN.LE.EIN(62)) GO TO 260
      DO 240 J=2,NVIB6
      IF(EN.LE.XVIB6(J)) GO TO 250
  240 CONTINUE
      J=NVIB6
  250 A=(YVIB6(J)-YVIB6(J-1))/(XVIB6(J)-XVIB6(J-1))
      B=(XVIB6(J-1)*YVIB6(J)-XVIB6(J)*YVIB6(J-1))/(XVIB6(J-1)-XVIB6(J))
      QIN(62,I)=(A*EN+B)*1.D-16
  260 CONTINUE
C
      QIN(63,I)=0.0
      IF(EN.LE.EIN(63)) GO TO 330
      DO 310 J=2,NVIB7
      IF(EN.LE.XVIB7(J)) GO TO 320
  310 CONTINUE
      J=NVIB7
  320 A=(YVIB7(J)-YVIB7(J-1))/(XVIB7(J)-XVIB7(J-1))
      B=(XVIB7(J-1)*YVIB7(J)-XVIB7(J)*YVIB7(J-1))/(XVIB7(J-1)-XVIB7(J))
      QIN(63,I)=(A*EN+B)*1.D-16
  330 CONTINUE
C
      QIN(64,I)=0.0
      IF(EN.LE.EIN(64)) GO TO 360
      DO 340 J=2,NVIB8
      IF(EN.LE.XVIB8(J)) GO TO 350
  340 CONTINUE
      J=NVIB8
  350 A=(YVIB8(J)-YVIB8(J-1))/(XVIB8(J)-XVIB8(J-1))
      B=(XVIB8(J-1)*YVIB8(J)-XVIB8(J)*YVIB8(J-1))/(XVIB8(J-1)-XVIB8(J))
      QIN(64,I)=(A*EN+B)*1.D-16
  360 CONTINUE
C
      QIN(65,I)=0.0
      PEQIN(65,I)=0.5
      IF(EN.LE.EIN(65)) GO TO 450
      DO 430 J=2,NTRP1
      IF(EN.LE.XTRP1(J)) GO TO 440
  430 CONTINUE
      J=NTRP1
  440 A=(YTRP1(J)-YTRP1(J-1))/(XTRP1(J)-XTRP1(J-1))
      B=(XTRP1(J-1)*YTRP1(J)-XTRP1(J)*YTRP1(J-1))/(XTRP1(J-1)-XTRP1(J))
      QIN(65,I)=(A*EN+B)*1.D-16
      IF(EN.LE.(2.0*EIN(65))) GO TO 450
      PEQIN(65,I)=PEQEL(2,(I-IOFF65))
  450 CONTINUE
C
      QIN(66,I)=0.0
      PEQIN(66,I)=0.5
      IF(EN.LE.EIN(66)) GO TO 510
      DO 490 J=2,NTRP3
      IF(EN.LE.XTRP3(J)) GO TO 500
  490 CONTINUE
      J=NTRP3
  500 A=(YTRP3(J)-YTRP3(J-1))/(XTRP3(J)-XTRP3(J-1))
      B=(XTRP3(J-1)*YTRP3(J)-XTRP3(J)*YTRP3(J-1))/(XTRP3(J-1)-XTRP3(J))
      QIN(66,I)=(A*EN+B)*1.D-16
      IF(EN.LE.(2.0*EIN(66))) GO TO 510
      PEQIN(66,I)=PEQEL(2,(I-IOFF66))
  510 CONTINUE
C
      QIN(67,I)=0.0
      PEQIN(67,I)=0.5
      IF(EN.LE.EIN(67)) GO TO 570
      DO 550 J=2,NTRP5
      IF(EN.LE.XTRP5(J)) GO TO 560
  550 CONTINUE
      J=NTRP5
  560 A=(YTRP5(J)-YTRP5(J-1))/(XTRP5(J)-XTRP5(J-1))
      B=(XTRP5(J-1)*YTRP5(J)-XTRP5(J)*YTRP5(J-1))/(XTRP5(J-1)-XTRP5(J))
      QIN(67,I)=(A*EN+B)*1.D-16
      IF(EN.LE.(2.0*EIN(67))) GO TO 570
      PEQIN(67,I)=PEQEL(2,(I-IOFF67))
  570 CONTINUE
C
      QIN(68,I)=0.0
      PEQIN(68,I)=0.5
      IF(EN.LE.EIN(68)) GO TO 660
      DO 640 J=2,NSNG2
      IF(EN.LE.XSNG2(J)) GO TO 650
  640 CONTINUE
      J=NSNG2
  650 A=(YSNG2(J)-YSNG2(J-1))/(XSNG2(J)-XSNG2(J-1))
      B=(XSNG2(J-1)*YSNG2(J)-XSNG2(J)*YSNG2(J-1))/(XSNG2(J-1)-XSNG2(J))
      QIN(68,I)=(A*EN+B)*1.D-16
      IF(EN.LE.(2.0*EIN(68))) GO TO 660
      PEQIN(68,I)=PEQEL(2,(I-IOFF68))
  660 CONTINUE
C
      QIN(69,I)=0.0
      PEQIN(69,I)=0.5
      IF(EN.LE.EIN(69)) GO TO 720
      DO 700 J=2,NTRP7
      IF(EN.LE.XTRP7(J)) GO TO 710
  700 CONTINUE
      J=NTRP7
  710 A=(YTRP7(J)-YTRP7(J-1))/(XTRP7(J)-XTRP7(J-1))
      B=(XTRP7(J-1)*YTRP7(J)-XTRP7(J)*YTRP7(J-1))/(XTRP7(J-1)-XTRP7(J))
      QIN(69,I)=0.6666*(A*EN+B)*1.D-16
      IF(EN.LE.(2.0*EIN(69))) GO TO 720
      PEQIN(69,I)=PEQEL(2,(I-IOFF69))
  720 CONTINUE
C
      QIN(70,I)=0.0
      PEQIN(70,I)=0.5
      IF(EN.LE.EIN(70)) GO TO 750
      DO 730 J=2,NTRP8
      IF(EN.LE.XTRP8(J)) GO TO 740
  730 CONTINUE
      J=NTRP8
  740 A=(YTRP8(J)-YTRP8(J-1))/(XTRP8(J)-XTRP8(J-1))
      B=(XTRP8(J-1)*YTRP8(J)-XTRP8(J)*YTRP8(J-1))/(XTRP8(J-1)-XTRP8(J))
      QIN(70,I)=(A*EN+B)*1.D-16
      IF(EN.LE.(2.0*EIN(70))) GO TO 750
      PEQIN(70,I)=PEQEL(2,(I-IOFF70))
  750 CONTINUE
C
      QIN(71,I)=0.0
      PEQIN(71,I)=0.5
      IF(EN.LE.EIN(71)) GO TO 810
      DO 790 J=2,NSNG5
      IF(EN.LE.XSNG5(J)) GO TO 800
  790 CONTINUE
      J=NSNG5
  800 A=(YSNG5(J)-YSNG5(J-1))/(XSNG5(J)-XSNG5(J-1))
      B=(XSNG5(J-1)*YSNG5(J)-XSNG5(J)*YSNG5(J-1))/(XSNG5(J-1)-XSNG5(J))
      QIN(71,I)=(A*EN+B)*1.D-16
      IF(EN.LE.(2.0*EIN(71))) GO TO 810
      PEQIN(71,I)=PEQEL(2,(I-IOFF71))
  810 CONTINUE
C
C
      SUM=0.0
      DO 898 K=1,56
      SUM=SUM+QIN(K,I)
  898 CONTINUE
C GET CORRECT ELASTIC XSECTION BY SUBTRACTION OF ROTATION
      Q(2,I)=Q(2,I)-SUM
      SUM1=0.0
      DO 899 K=57,71
      SUM1=SUM1+QIN(K,I)
  899 CONTINUE
      Q(1,I)=Q(2,I)+Q(3,I)+SUM+SUM1
  900 CONTINUE
C SAVE COMPUTE TIME
      DO 1000 K=1,71
      J=72-K
      IF(EFINAL.LE.EIN(J)) NIN=J-1
 1000 CONTINUE
C
      RETURN
      END
      SUBROUTINE GAS59(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220),
     /PJ(220)
      DIMENSION XEN(65),YMOM(65),XV2(21),YV2(21),X2V2(23),Y2V2(23),
     /XV1(30),YV1(30),X3V2(15),Y3V2(15),XV3(15),YV3(15),
     /XVPD3(20),YVPD3(20),XV130(17),YV130(17),XVPD4(18),YVPD4(18),
     /XVPD5(15),YVPD5(15),XVPD6(15),YVPD6(15),XVPD7(15),YVPD7(15),
     /XVPD8(15),YVPD8(15),XVPD9(15),YVPD9(15),XVPDH(13),YVPDH(13),
     /XEXC1(40),YEXC1(40),XEXC2(40),YEXC2(40),XEXC3(38),YEXC3(38),
     /XEXC4(38),YEXC4(38),XEXC5(38),YEXC5(38),XEXC6(38),YEXC6(38),
     /XATT(29),YATT(29),XION(68),YION(68),YEL(65),YVBMOM(65),YVBEL(65)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
C ELASTIC +ROTATIONAL
      DATA XEN/1.D-6,.001,.002,.004,.007,.010,.014,.020,.030,.040,
     /0.05,0.06,0.08,0.10,.125,.150,.175,0.20,0.25,0.30,
     /0.35,0.40,0.50,0.60,0.70,0.85,1.00,1.25,1.50,1.70,
     /1.90,2.10,2.30,2.50,2.80,3.00,3.30,3.60,3.80,4.00,
     /4.50,5.00,5.50,6.00,7.00,8.00,10.0,12.0,15.0,17.0,
     /20.0,25.0,30.0,50.0,75.0,100.,200.,400.,600.,1000.,
     /2000.,4000.,10000.,20000.,100000./
C GROUND STATE AND BEND MODE ELASTIC + ROTATION.  MOMENTUM TRANSFER
C  AT 293.15 KELVIN
      DATA YMOM/148.,148.,146.,141.,134.,128.,119.,109.,95.0,85.0,
     /76.5,69.5,59.0,52.5,47.5,41.0,36.0,30.0,22.0,16.2,
     /12.8,10.6,8.20,6.45,5.35,4.30,3.90,3.65,3.60,3.65,
     /3.75,3.85,4.00,4.20,4.60,4.90,5.30,5.80,6.00,6.00,
     /5.50,5.10,5.00,5.20,6.10,7.30,8.80,10.0,11.0,11.0,
     /10.8,10.2,9.50,6.50,4.25,3.15,1.16,0.42,0.23,0.12,
     /.046,.021,.0081,.0040,.001/
C GROUND STATE AND BEND MODE ELASTIC + ROTATION.  AT 293.15 KELVIN
      DATA YEL/148.,148.,146.,141.,135.,129.,120.,110.,96.0,86.0,
     /77.5,70.5,60.0,53.5,48.5,42.0,37.0,31.5,24.8,20.4,
     /17.4,15.5,13.0,10.7,9.20,7.50,6.30,5.30,4.65,4.46,
     /4.45,4.45,4.60,4.75,5.10,5.55,6.80,7.90,8.50,7.80,
     /6.25,6.15,6.60,7.05,8.10,9.50,11.5,13.1,13.3,13.7,
     /13.8,14.0,13.7,10.4,8.25,7.00,4.55,2.85,2.10,1.40,
     /0.80,0.44,0.20,.105,.018/
C ELASTIC FOR BEND MODE VIBRATIONS.   MOMENTUM TRANSFER
      DATA YVBMOM/148.,148.,146.,141.,134.,128.,119.,109.,95.0,85.0,
     /76.5,69.5,59.0,53.5,50.0,46.5,45.5,45.0,43.0,37.0,
     /28.5,22.5,16.0,11.5,8.95,6.80,5.80,5.05,4.80,4.65,
     /4.65,4.70,4.80,5.00,5.35,5.65,6.00,6.20,6.20,6.10,
     /5.50,5.10,5.00,5.20,6.10,7.30,8.80,10.0,11.0,11.0,
     /10.8,10.2,9.50,6.50,4.25,3.15,1.16,0.42,0.23,0.12,
     /.046,.021,.0081,.0040,.001/
C ELASTIC FOR BEND MODE VIBRATIONS.
      DATA YVBEL/148.,148.,146.,141.,135.,129.,120.,110.,96.0,86.0,
     /77.5,70.5,60.0,53.5,48.5,42.0,37.0,31.5,24.8,20.4,
     /17.4,15.5,13.0,10.7,9.20,7.50,6.30,5.30,4.65,4.46,
     /4.45,4.45,4.60,4.75,5.10,5.55,6.80,7.90,8.50,7.80,
     /6.25,6.15,6.60,7.05,8.10,9.50,11.5,13.1,13.3,13.7,
     /13.8,14.0,13.7,10.4,8.25,7.00,4.55,2.85,2.10,1.40,
     /0.80,0.44,0.20,.105,.018/
C
C V(010)  BEND MODE  ( ANALYTICAL DIPOLE FUNCTION AT THRESHOLD)
      DATA XV2/.08275,2.00,2.50,3.00,3.50,3.80,4.00,4.50,5.00,6.00,
     /8.00,10.0,15.0,20.0,30.0,50.0,70.0,100.,1000.,10000.,
     /100000./
      DATA YV2/0.00,0.00,0.24,0.48,1.29,1.70,1.70,1.17,0.74,0.42,
     /0.01,0.08,0.05,0.08,0.12,0.07,.001,.0001,.00001,.000001,
     /.0000001/
C V(020)  BEND MODE HARMONIC  RESONANCE
      DATA X2V2/.15937,0.18,0.50,1.00,2.00,3.00,3.50,3.80,4.00,4.50,
     /5.00,6.00,8.00,10.0,15.0,20.0,30.0,50.0,70.0,100.,
     /1000.,10000.,100000./
      DATA Y2V2/0.00,0.02,0.01,.003,.025,0.09,0.31,0.44,0.56,0.49,
     /0.35,0.17,0.08,0.10,0.02,.008,.015,.008,.001,.0001,
     /.00001,.000001,.0000001/
C V(100) SYMMETRIC STRETCH
      DATA XV1/.17211,0.18,0.20,0.23,0.25,0.30,0.40,0.50,0.60,1.00,
     /2.00,2.50,3.00,3.50,3.80,4.00,4.50,5.00,6.00,8.00,
     /10.0,15.0,20.0,30.0,50.0,70.0,100.,1000.,10000.,100000./
      DATA YV1/0.00,.475,.790,0.91,0.91,0.82,0.58,0.43,0.34,0.32,
     /0.38,0.66,0.89,1.27,1.32,1.04,0.53,0.18,.084,.075,
     /.077,.030,.009,.030,.008,.001,.0001,.00001,.000001,.0000001/
C V(030) + V(110)
      DATA X3V2/.251,2.00,2.50,3.00,3.50,3.80,4.00,4.50,5.00,6.00,
     /10.0,100.,1000.,10000.,100000./
      DATA Y3V2/0.00,0.00,0.01,0.17,0.36,0.58,0.58,0.36,0.17,0.01,
     /.001,.0001,.00001,.000001,.0000001/
C V(001) ASYMMETRIC STRETCH  (ANALYTICAL DIPOLE FUNCTION AT THRESHOLD)
      DATA XV3/.29126,2.00,3.00,3.50,3.80,4.00,4.50,5.00,6.00,8.00,
     /10.0,100.,1000.,10000.,100000./
      DATA YV3/0.00,0.00,.002,.005,.010,.005,.002,.001,.001,.001,
     /.001,.0001,.00001,.000001,.0000001/
C V(040) + V(120) + V(200)  POLYAD 3
      DATA XVPD3/.335,0.35,0.50,0.80,2.00,2.50,3.00,3.50,3.80,4.00,
     /4.50,5.00,6.00,10.0,20.0,40.0,100.,1000.,10000.,100000./
      DATA YVPD3/0.00,0.09,.035,0.02,0.02,0.02,0.21,0.43,0.70,0.70,
     /0.43,0.21,0.05,.020,0.01,.005,.0001,.00001,.000001,.0000001/
C  V(130) + V(210)
      DATA XV130/0.422,2.00,2.50,3.00,3.50,3.80,4.00,4.50,5.00,6.00,
     /10.0,20.0,40.0,100.,1000.,10000.,100000./
      DATA YV130/0.00,0.00,.005,0.10,0.22,0.35,0.35,0.22,0.10,.025,
     /.005,.002,.001,.0001,.00001,.000001,.0000001/
C  POLYAD 4
      DATA XVPD4/0.505,0.55,0.65,1.00,2.00,2.50,3.00,3.50,3.80,4.00,
     /4.50,5.00,6.00,10.0,100.,1000.,10000.,100000./
      DATA YVPD4/0.00,.0017,.0005,.0001,.0001,.005,0.12,0.24,0.40,0.40,
     /0.24,0.13,0.01,.001,.0001,.00001,.000001,.0000001/
C  POLYAD 5
      DATA XVPD5/0.685,2.00,2.50,3.00,3.50,3.80,4.00,4.50,5.00,6.00,
     /10.0,100.,1000.,10000.,100000./
      DATA YVPD5/0.00,0.00,.003,0.07,0.14,0.24,0.24,0.14,0.08,.006,
     /.001,.0001,.00001,.000001,.0000001/
C  POLYAD 6
      DATA XVPD6/0.825,2.00,2.50,3.00,3.50,3.80,4.00,4.50,5.00,6.00,
     /10.0,100.,1000.,10000.,100000./
      DATA YVPD6/0.00,0.00,.001,0.05,0.10,0.16,0.16,0.10,0.05,.004,
     /.001,.0001,.00001,.000001,.0000001/
C  POLYAD 7
      DATA XVPD7/0.995,2.00,2.50,3.00,3.50,3.80,4.00,4.50,5.00,6.00,
     /10.0,100.,1000.,10000.,100000./
      DATA YVPD7/0.00,0.00,.001,0.03,0.06,0.10,0.10,0.06,0.03,.003,
     /.001,.0001,.00001,.000001,.0000001/
C  POLYAD 8
      DATA XVPD8/1.160,2.00,2.50,3.00,3.50,3.80,4.00,4.50,5.00,6.00,
     /10.0,100.,1000.,10000.,100000./
      DATA YVPD8/0.00,0.00,.001,0.03,0.06,0.10,0.10,0.06,0.03,.003,
     /.001,.0001,.00001,.000001,.0000001/
C  POLYAD 9
      DATA XVPD9/1.320,2.00,2.50,3.00,3.50,3.80,4.00,4.50,5.00,6.00,
     /10.0,100.,1000.,10000.,100000./
      DATA YVPD9/0.00,0.00,.001,0.03,0.06,0.10,0.10,0.06,0.03,.003,
     /.001,.0001,.00001,.000001,.0000001/
C  SUM HIGHER POLYADS
      DATA XVPDH/2.50,3.00,3.50,3.80,4.00,4.50,5.00,6.00,10.0,100.,
     /1000.,10000.,100000./
      DATA YVPDH/0.00,0.01,0.36,0.58,0.58,0.36,0.16,.045,.001,.0001,
     /.00001,.000001,.0000001/
C DATA FROM RAP AND BRIGLIA WITH CORRECTED ONSET
      DATA XATT/3.85,4.00,4.20,4.40,4.60,4.80,5.00,5.20,5.40,6.30,
     /6.60,6.90,7.20,7.40,7.60,7.80,8.00,8.20,8.40,8.60,
     /8.80,9.00,9.20,9.50,9.80,10.0,100.,1000.,100000./
      DATA YATT/.0,.0005,.0014,.0014,.001,.0006,.0003,.0001,.0001,.0001,
     /.0001,.0002,.0008,.0018,.0027,.0036,.0042,.0041,.0034,.0020,
     /.0012,.0004,.0003,.0002,.0001,.0001,.00001,.000001,.0000001/
C
      DATA XEXC1/7.90,9.00,10.0,11.0,12.0,13.0,14.0,16.0,18.0,20.0,
     /25.0,30.0,35.0,40.0,50.0,60.0,80.0,100.,120.,150.,
     /200.,250.,300.,400.,500.,600.,750.,1000.,1500.,2000.,
     /2500.,3000.,4000.,6000.,8000.,10000.,20000.,40000.,60000.,100000./
      DATA YEXC1/0.00,.007,.030,.069,.078,.069,.063,.060,.058,.057,
     /.053,.051,.049,.047,.046,.043,.038,.034,.031,.027,
     /.022,.019,.016,.013,.0110,.0095,.0079,.0062,.0044,.0034,
     /.0028,.0024,.0018,.0013,.00098,.00080,.00042,.00023,.00016,.00009/
C
      DATA XEXC2/8.90,9.50,10.0,11.0,12.0,13.0,14.0,16.0,18.0,20.0,
     /25.0,30.0,35.0,40.0,50.0,60.0,80.0,100.,120.,150.,
     /200.,250.,300.,400.,500.,600.,750.,1000.,1500.,2000.,
     /2500.,3000.,4000.,6000.,8000.,10000.,20000.,40000.,60000.,100000./
      DATA YEXC2/0.00,.004,.009,.040,.065,.062,.060,.058,.057,.056,
     /.055,.054,.052,.050,.048,.046,.041,.037,.034,.029,
     /.024,.021,.018,.015,.0123,.0106,.0089,.0070,.0050,.0039,
     /.0032,.0027,.0021,.0015,.00116,.00095,.00046,.00027,.00019,.00012/
C
      DATA XEXC3/10.5,12.0,13.0,14.0,15.0,17.0,20.0,25.0,30.0,35.0,
     /40.0,50.0,60.0,70.0,80.0,100.,120.,150.,200.,250.,
     /300.,400.,500.,600.,750.,1000.,1500.,2000.,2500.,3000.,
     /4000.,6000.,8000.,10000.,20000.,40000.,60000.,100000./
      DATA YEXC3/0.00,0.56,0.43,0.34,0.31,0.30,0.30,0.31,0.32,0.33,
     /0.34,0.35,0.36,0.36,0.35,0.34,0.32,0.29,0.26,0.23,
     /.206,.171,.147,.129,.109,.088,.063,.049,.041,.035,
     /.027,.019,.0142,.0114,.0058,.0029,.0020,.0011/
C
      DATA XEXC4/12.2,13.0,14.0,15.0,16.0,17.0,20.0,25.0,30.0,35.0,
     /40.0,50.0,60.0,70.0,80.0,100.,120.,150.,200.,250.,
     /300.,400.,500.,600.,750.,1000.,1500.,2000.,2500.,3000.,
     /4000.,6000.,8000.,10000.,20000.,40000.,60000.,100000./
      DATA YEXC4/0.00,0.23,0.31,0.34,0.38,0.40,0.46,0.54,0.60,0.63,
     /0.65,0.67,0.68,0.67,0.66,0.63,0.60,0.54,0.47,0.41,
     /0.37,0.30,0.26,0.23,.186,.147,.104,.081,.066,.057,
     /.043,.030,.023,.0180,.0093,.0047,.0031,.00182/
C
      DATA XEXC5/13.2,14.0,15.0,16.0,17.0,18.0,20.0,25.0,30.0,35.0,
     /40.0,50.0,60.0,70.0,80.0,100.,120.,150.,200.,250.,
     /300.,400.,500.,600.,750.,1000.,1500.,2000.,2500.,3000.,
     /4000.,6000.,8000.,10000.,20000.,40000.,60000.,100000./
      DATA YEXC5/0.00,0.37,0.48,0.61,0.69,0.76,0.89,1.11,1.24,1.33,
     /1.39,1.45,1.48,1.49,1.48,1.45,1.37,1.27,1.11,1.00,
     /0.91,0.76,0.66,0.58,0.49,0.40,0.30,0.24,0.21,0.17,
     /0.13,.099,.077,.064,.036,.021,.014,.0094/
C
      DATA XEXC6/15.0,16.0,17.0,18.0,19.0,20.0,21.0,25.0,30.0,35.0,
     /40.0,50.0,60.0,70.0,80.0,100.,120.,150.,200.,250.,
     /300.,400.,500.,600.,750.,1000.,1500.,2000.,2500.,3000.,
     /4000.,6000.,8000.,10000.,20000.,40000.,60000.,100000./
      DATA YEXC6/0.0,.0005,.003,.006,.009,.013,.016,.025,.031,.034,
     /.037,.038,.039,.039,.038,.037,.035,.032,.028,.025,
     /.022,.019,.016,.014,.012,.010,.007,.006,.0049,.0043,
     /.0034,.0025,.0020,.0018,.00098,.0006,.0004,.00027/
C
C DATA FROM RAPP, LINDSAY AND RIEKE ALSO BB THEORY
      DATA XION/13.773,14.5,15.0,15.5,16.0,16.5,17.0,17.5,18.0,18.5,
     /19.0,19.5,21.0,21.5,22.0,22.5,23.0,23.5,24.0,26.0,
     /28.0,30.0,32.0,34.0,36.0,38.0,40.0,45.0,50.0,55.0,
     /60.0,65.0,70.0,75.0,80.0,85.0,90.0,100.,110.,130.,
     /140.,160.,180.,200.,250.,300.,400.,500.,600.,700.,
     /800.,900.,1000.,1400.,2000.,3000.,4000.,5000.,6000.,7000.,
     /8000.,10000.,14000.,20000.,30000.,40000.,60000.,100000./
      DATA YION/0.00,.055,.097,.135,.174,.215,.255,.293,.333,.373,
     /.427,.452,.577,.623,.676,.727,.777,.828,.880,1.12,
     /1.34,1.51,1.65,1.78,1.89,1.99,2.11,2.37,2.59,2.76,
     /2.93,3.07,3.18,3.27,3.35,3.41,3.46,3.52,3.55,3.55,
     /3.52,3.44,3.36,3.26,3.02,2.81,2.42,2.10,1.86,1.69,
     /1.54,1.42,1.32,1.03,.795,.575,.454,.376,.322,.282,
     /.252,.208,.158,.115,.082,.063,.046,.032/
C ---------------------------------------------------------------------
C ---------------------------------------------------------------------
C
      NAME='CO2  2004 ANISO'
C  --------------------------------------------------------------------
C
C ---------------------------------------------------------------------
      NIN=85
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
C USE ANOISOTROPIC ELASTIC SCATTERING AND COPY (OFFSET) TO IONISATION
      KEL(2)=1
      KEL(3)=1
C
      NEL=65
      NV2=21
      N2V2=23
      NV1=30
      N3V2=15
      NV3=15
      NPD3=20
      NV130=17
      NPD4=18
      NPD5=15
      NPD6=15
      NPD7=15
      NPD8=15
      NPD9=15
      NPDH=13
      NATT=29
      NEXC1=40
      NEXC2=40
      NEXC3=38
      NEXC4=38
      NEXC5=38
      NEXC6=38
      NION=68
      E(1)=0.0
      E(2)=2.0*EMASS/(44.0095*AMU)
      E(3)=13.773
      E(4)=3.85
      E(5)=0.0
      E(6)=0.0
C OPAL AND BEATY IONISATION ENERGY SPLITTING
      EOBY=13.773
C OFFSET ENERGY FOR PRIMARY IONISATION ELECTRON ANGULAR DISTRIBUTION
      IOFF=IFIX(SNGL(0.5+E(3)/ESTEP))
C
C DIPOLE TRANSITION STRENGTH FOR VIBRATIONS V010 AND V001
      AMPV2=0.1703
      AMPV3=0.3922
C-----------------------------------------------------------------------
C  B0 IS ROTATIONAL CONSTANT
C  QBQA IS QUADRUPOLE MOMENT
      B0=4.838D-5
      A0=0.5291772083D-8
      QBQA=3.24
      QBK=1.67552*(QBQA*A0)**2
C-----------------------------------------------------------------------
C CALC FRACTIONAL POPULATION DENSITY OF ROTATIONAL STATES
      PJ(1)=1.0
      DO 3 L=2,31
      J=(2*L)-2
    3 PJ(L)=(2*J+1)*DEXP(-J*(J+1)*B0/AKT)
      SUM=0.0
      DO 4 L=1,31
    4 SUM=SUM+PJ(L)
      DO 5 L=1,31
    5 PJ(L)=PJ(L)/SUM
C----------------------------------------------------------------------
C CALC ROTATIONAL TRANSITION ENERGIES
      DO 7 K=1,59,2
      EIN(K)=B0*(4*K+2)
    7 EIN(K+1)=-EIN(K)
      EIN(61)  = -0.08275
      EIN(62)  =  0.08275
      EIN(63)  = -0.15937
      EIN(64)  =  0.15937
      EIN(65)  = -0.17211
      EIN(66)  =  0.17211
      EIN(67)  = -0.251
      EIN(68)  =  0.251
      EIN(69)  = -0.29126
      EIN(70)  =  0.29126
      EIN(71)  =  0.335
      EIN(72)  =  0.422
      EIN(73)  =  0.505
      EIN(74)  =  0.685
      EIN(75)  =  0.825
      EIN(76)  =  0.995
      EIN(77)  =  1.160
      EIN(78)  =  1.320
      EIN(79)  =  2.500
      EIN(80)  =  7.90
      EIN(81)  =  8.90
      EIN(82)  = 10.5
      EIN(83)  = 12.2
      EIN(84)  = 13.2
      EIN(85)  = 15.0
C---------------------------------------------------
C DEGENERACY OF VIBRATIONAL STATES
      DEGV1=1.0
      DEGV2=2.0
      DEGV3=1.0
      DEG2V2=3.0
C 3V2 === SUM (3V2 + V12) =   4+2
      DEG3V2=6.0
C----------------------------------------------------
C CALC POPULATION OF VIBRATIONAL STATES
      SUM=0.0
      APOPV2=DEGV2*DEXP(EIN(61)/AKT)
      APOP2V2=DEG2V2*DEXP(EIN(63)/AKT)
      APOPV1=DEGV1*DEXP(EIN(65)/AKT)
      APOP3V2=DEG3V2*DEXP(EIN(67)/AKT)
      APOPV3=DEGV3*DEXP(EIN(69)/AKT)
      SUM=1.0+APOPV2+APOP2V2+APOPV1+APOP3V2+APOPV3
      APOPGS=1.0/SUM
      APOPV2=APOPV2/SUM
      APOP2V2=APOP2V2/SUM
      APOPV1=APOPV1/SUM
      APOP3V2=APOP3V2/SUM
      APOPV3=APOPV3/SUM
      APBEND=APOPV2+APOP2V2+APOP3V2
C     WRITE(6,865) APOPGS,APOPV2,APOP2V2,APOPV1,APOP3V2,APOPV3,APBEND
C 865 FORMAT(' APOPGS=',F8.6,' APOPV2=',F8.6,' APOP2V2=',F8.6,' APOPV1='
C    /,F8.6,' APOP3V2=',F8.6,' APOPV3=',F8.6,/,' APBEND=',F12.10)
C
C RENORMALISE VIBRATIONAL GROUND STATE POPULATION IN ORDER TO ACCOUNT
C FOR EXCITATION FROM VIBRATIONALLY EXCITED STATES
      APOPGS=1.0
C BEND MODE AND EFFECTIVE GROUND STATE POPULATION AT 293.15 KELVIN
      AEXT20=7.51373753D-2
      AGST20=1.0-AEXT20
C     WRITE(6,866) APOPGS,AEXT20
C 866 FORMAT(' RENORMALISED GS POPULATION=', F6.4,' AEXT20=',F12.10)
C------------------------------------------------------
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC  ANISOTROPIC    CO2  '
      SCRPT(3)=' IONISATION    ELOSS= 13.773  '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      SCRPT(7)=' ROT  0-2      ELOSS=  0.00029'
      SCRPT(8)=' ROT  2-0      ELOSS= -0.00029'
      SCRPT(9)=' ROT  2-4      ELOSS=  0.00068'
      SCRPT(10)=' ROT  4-2      ELOSS= -0.00068'
      SCRPT(11)=' ROT  4-6      ELOSS=  0.00106'
      SCRPT(12)=' ROT  6-4      ELOSS= -0.00106'
      SCRPT(13)=' ROT  6-8      ELOSS=  0.00145'
      SCRPT(14)=' ROT  8-6      ELOSS= -0.00145'
      SCRPT(15)=' ROT  8-10     ELOSS=  0.00184'
      SCRPT(16)=' ROT 10-8      ELOSS= -0.00184'
      SCRPT(17)=' ROT 10-12     ELOSS=  0.00223'
      SCRPT(18)=' ROT 12-10     ELOSS= -0.00223'
      SCRPT(19)=' ROT 12-14     ELOSS=  0.00261'
      SCRPT(20)=' ROT 14-12     ELOSS= -0.00261'
      SCRPT(21)=' ROT 14-16     ELOSS=  0.00300'
      SCRPT(22)=' ROT 16-14     ELOSS= -0.00300'
      SCRPT(23)=' ROT 16-18     ELOSS=  0.00339'
      SCRPT(24)=' ROT 18-16     ELOSS= -0.00339'
      SCRPT(25)=' ROT 18-20     ELOSS=  0.00377'
      SCRPT(26)=' ROT 20-18     ELOSS= -0.00377'
      SCRPT(27)=' ROT 20-22     ELOSS=  0.00416'
      SCRPT(28)=' ROT 22-20     ELOSS= -0.00416'
      SCRPT(29)=' ROT 22-24     ELOSS=  0.00455'
      SCRPT(30)=' ROT 24-22     ELOSS= -0.00455'
      SCRPT(31)=' ROT 24-26     ELOSS=  0.00493'
      SCRPT(32)=' ROT 26-24     ELOSS= -0.00493'
      SCRPT(33)=' ROT 26-28     ELOSS=  0.00532'
      SCRPT(34)=' ROT 28-26     ELOSS= -0.00532'
      SCRPT(35)=' ROT 28-30     ELOSS=  0.00571'
      SCRPT(36)=' ROT 30-28     ELOSS= -0.00571'
      SCRPT(37)=' ROT 30-32     ELOSS=  0.00610'
      SCRPT(38)=' ROT 32-30     ELOSS= -0.00610'
      SCRPT(39)=' ROT 32-34     ELOSS=  0.00648'
      SCRPT(40)=' ROT 34-32     ELOSS= -0.00648'
      SCRPT(41)=' ROT 34-36     ELOSS=  0.00687'
      SCRPT(42)=' ROT 36-34     ELOSS= -0.00687'
      SCRPT(43)=' ROT 36-38     ELOSS=  0.00726'
      SCRPT(44)=' ROT 38-36     ELOSS= -0.00726'
      SCRPT(45)=' ROT 38-40     ELOSS=  0.00764'
      SCRPT(46)=' ROT 40-38     ELOSS= -0.00764'
      SCRPT(47)=' ROT 40-42     ELOSS=  0.00803'
      SCRPT(48)=' ROT 42-40     ELOSS= -0.00803'
      SCRPT(49)=' ROT 42-44     ELOSS=  0.00842'
      SCRPT(50)=' ROT 44-42     ELOSS= -0.00842'
      SCRPT(51)=' ROT 44-46     ELOSS=  0.00881'
      SCRPT(52)=' ROT 46-44     ELOSS= -0.00881'
      SCRPT(53)=' ROT 46-48     ELOSS=  0.00919'
      SCRPT(54)=' ROT 48-46     ELOSS= -0.00919'
      SCRPT(55)=' ROT 48-50     ELOSS=  0.00958'
      SCRPT(56)=' ROT 50-48     ELOSS= -0.00958'
      SCRPT(57)=' ROT 50-52     ELOSS=  0.00997'
      SCRPT(58)=' ROT 52-50     ELOSS= -0.00997'
      SCRPT(59)=' ROT 52-54     ELOSS=  0.01035'
      SCRPT(60)=' ROT 54-52     ELOSS= -0.01035'
      SCRPT(61)=' ROT 54-56     ELOSS=  0.01074'
      SCRPT(62)=' ROT 56-54     ELOSS= -0.01074'
      SCRPT(63)=' ROT 56-58     ELOSS=  0.01113'
      SCRPT(64)=' ROT 58-56     ELOSS= -0.01113'
      SCRPT(65)=' ROT 58-60     ELOSS=  0.01151'
      SCRPT(66)=' ROT 60-58     ELOSS= -0.01151'
      SCRPT(67)=' V (010)       ELOSS= -0.08275'
      SCRPT(68)=' V (010)       ELOSS=  0.08275'
      SCRPT(69)=' V (020)       ELOSS= -0.15937'
      SCRPT(70)=' V (020)       ELOSS=  0.15937'
      SCRPT(71)=' V (100)       ELOSS= -0.17211'
      SCRPT(72)=' V (100)       ELOSS=  0.17211'
      SCRPT(73)=' V (030)+(110) ELOSS= -0.251  '
      SCRPT(74)=' V (030)+(110) ELOSS=  0.251  '
      SCRPT(75)=' V (001)       ELOSS= -0.29126'
      SCRPT(76)=' V (001)       ELOSS=  0.29126'
      SCRPT(77)=' V POLYAD 3    ELOSS=  0.335  '
      SCRPT(78)=' V (130)+(210) ELOSS=  0.422  '
      SCRPT(79)=' V POLYAD 4    ELOSS=  0.505  '
      SCRPT(80)=' V POLYAD 5    ELOSS=  0.685  '
      SCRPT(81)=' V POLYAD 6    ELOSS=  0.825  '
      SCRPT(82)=' V POLYAD 7    ELOSS=  0.995  '
      SCRPT(83)=' V POLYAD 8    ELOSS=  1.160  '
      SCRPT(84)=' V POLYAD 9    ELOSS=  1.320  '
      SCRPT(85)=' V POLYAD SUM  ELOSS=  2.500  '
      SCRPT(86)=' EXC           ELOSS=  7.900  '
      SCRPT(87)=' EXC           ELOSS=  8.900  '
      SCRPT(88)=' EXC           ELOSS= 10.500  '
      SCRPT(89)=' EXC           ELOSS= 12.200  '
      SCRPT(90)=' EXC           ELOSS= 13.200  '
      SCRPT(91)=' EXC           ELOSS= 15.000  '
      EN=-ESTEP/2.0
      DO 9000 I=1,NSTEP
      EN=EN+ESTEP
C ELASTIC USE LOG INTERPOLATION
      IF(EN.LE.XEN(1)) THEN
       QMOM=YMOM(1)*1.D-16
       QELA=YEL(1)*1.D-16
       QBMOM=QMOM
       QBELA=QELA
       GO TO 20
      ENDIF
      DO 10 J=2,NEL
      IF(EN.LE.XEN(J)) GO TO 15
   10 CONTINUE
      J=NEL
   15 YXJ=DLOG(YMOM(J))
      YXJ1=DLOG(YMOM(J-1))
      XNJ=DLOG(XEN(J))
      XNJ1=DLOG(XEN(J-1))
      A=(YXJ-YXJ1)/(XNJ-XNJ1)
      B=(XNJ1*YXJ-XNJ*YXJ1)/(XNJ1-XNJ)
      QMOM=DEXP(A*DLOG(EN)+B)*1.D-16
      YXJ=DLOG(YEL(J))
      YXJ1=DLOG(YEL(J-1))
      A=(YXJ-YXJ1)/(XNJ-XNJ1)
      B=(XNJ1*YXJ-XNJ*YXJ1)/(XNJ1-XNJ)
      QELA=DEXP(A*DLOG(EN)+B)*1.D-16
      YXJ=DLOG(YVBMOM(J))
      YXJ1=DLOG(YVBMOM(J-1))
      A=(YXJ-YXJ1)/(XNJ-XNJ1)
      B=(XNJ1*YXJ-XNJ*YXJ1)/(XNJ1-XNJ)
      QBMOM=DEXP(A*DLOG(EN)+B)*1.D-16
      YXJ=DLOG(YVBEL(J))
      YXJ1=DLOG(YVBEL(J-1))
      A=(YXJ-YXJ1)/(XNJ-XNJ1)
      B=(XNJ1*YXJ-XNJ*YXJ1)/(XNJ1-XNJ)
      QBELA=DEXP(A*DLOG(EN)+B)*1.D-16
   20 CONTINUE
C CALC CHANGE IN ELASTIC CROSS SECTION DUE TO CHANGE IN ELASTIC
C SCATTERING FROM BEND MODES ( CHANGE RELATIVE TO X-SECTION AT 293.15K)
C BEND MODE POPULATION AT 293.15K == AEXT20,GROUND STATE POP. == AGST20
C
      QMOM=(1.0-APBEND)*(QMOM-AEXT20*QBMOM)/AGST20+APBEND*QBMOM
      QELA=(1.0-APBEND)*(QELA-AEXT20*QBELA)/AGST20+APBEND*QBELA
C ISOTROPIC
C     Q(2,I)=QMOM
C
C ANISOTROPIC
      Q(2,I)=QELA
      PEQEL(2,I)=0.5+(QELA-QMOM)/QELA
C
C IONISATION
      Q(3,I)=0.0
      PEQEL(3,I)=0.5
      IF(EN.LE.E(3)) GO TO 40
      DO 25 J=2,NION
      IF(EN.LE.XION(J)) GO TO 30
   25 CONTINUE
      J=NION
   30 A=(YION(J)-YION(J-1))/(XION(J)-XION(J-1))
      B=(XION(J-1)*YION(J)-XION(J)*YION(J-1))/(XION(J-1)-XION(J))
      Q(3,I)=1.0D-16*(A*EN+B)
C USE ANISOTROPIC SCATTERING FOR PRIMARY IONISATION ELECTRON FOR
C ENERGIES ABOVE 2 * IONISATION ENERGY
C ANISOTROPIC ANGULAR DISTRIBUTION SAME AS ELASTIC AT ENERGY OFFSET BY
C IONISATION ENERGY
      IF(EN.LE.(2.0*E(3))) GO TO 40
      PEQEL(3,I)=PEQEL(2,(I-IOFF))
C
C ATTACHMENT
   40 Q(4,I)=0.0
      IF(EN.LE.E(4)) GO TO 50
      DO 45  J=2,NATT
      IF(EN.LE.XATT(J)) GO TO 46
   45 CONTINUE
      J=NATT
   46 A=(YATT(J)-YATT(J-1))/(XATT(J)-XATT(J-1))
      B=(XATT(J-1)*YATT(J)-XATT(J)*YATT(J-1))/(XATT(J-1)-XATT(J))
      Q(4,I)=1.0D-16*(A*EN+B)
C
   50 Q(5,I)=0.0
      Q(6,I)=0.0
C ----------------------------------------------------------------------
C  QUADRUPOLE BORN ROTATIONAL STATES (GERJUOY AND STEIN)
C ----------------------------------------------------------------------
C SUPERELASTIC ROTATION
      DO 51 K=2,60,2
      AJ=DFLOAT(K)
      L=(K/2)+1
   51 QIN(K,I)=PJ(L)*QBK*DSQRT(1.0-EIN(K)/EN)*AJ*(AJ-1.0)/((2.0*AJ+1.0)*
     /(2.0*AJ-1.0))
C ROTATION
      DO 52 K=1,59,2
      QIN(K,I)=0.0
      IF(EN.LE.EIN(K)) GO TO 52
      AJ=DFLOAT(K-1)
      L=(K+1)/2
      QIN(K,I)=PJ(L)*QBK*DSQRT(1.0-EIN(K)/EN)*(AJ+2.0)*(AJ+1.0)/((2.0*AJ
     /+3.0)*(2.0*AJ+1.0))
   52 CONTINUE
C BORN (1/E) FALL OFF IN ROTATONAL X-SEC ABOVE 6.0 EV
      IF(EN.LT.6.0) GO TO 80
      DO 70 K=1,60
   70 QIN(K,I)=QIN(K,I)*6.0/EN
   80 CONTINUE
C
C  SUPERELASTIC V2  BEND MODE
      QIN(61,I)=0.0
      IF(EN.LE.0.0) GO TO 150
      EFAC=DSQRT(1.0-(EIN(61)/EN))
      QIN(61,I)=AMPV2*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      DO 110 J=2,NV2
      IF((EN+EIN(62)).LE.XV2(J)) GOTO 120
  110 CONTINUE
      J=NV2
  120 A=(YV2(J)-YV2(J-1))/(XV2(J)-XV2(J-1))
      B=(XV2(J-1)*YV2(J)-XV2(J)*YV2(J-1))/(XV2(J-1)-XV2(J))
      QIN(61,I)=QIN(61,I)+(EN+EIN(62))*(A*(EN+EIN(62))+B)/EN
      QIN(61,I)=QIN(61,I)*APOPV2/DEGV2*1.D-16
C V2  BEND MODE
  150 QIN(62,I)=0.0
      IF(EN.LE.EIN(62)) GO TO 200
      EFAC=DSQRT(1.0-(EIN(62)/EN))
      QIN(62,I)=AMPV2*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      DO 160 J=2,NV2
      IF(EN.LE.XV2(J)) GO TO 170
  160 CONTINUE
      J=NV2
  170 A=(YV2(J)-YV2(J-1))/(XV2(J)-XV2(J-1))
      B=(XV2(J-1)*YV2(J)-XV2(J)*YV2(J-1))/(XV2(J-1)-XV2(J))
      QIN(62,I)=QIN(62,I)+(A*EN+B)
      QIN(62,I)=QIN(62,I)*APOPGS*1.D-16
C
C  SUPERELASTIC 2V2 BEND MODE HARMONIC
  200 CONTINUE
      QIN(63,I)=0.0
      IF(EN.LE.0.0) GO TO 250
      DO 210 J=2,N2V2
      IF((EN+EIN(64)).LE.X2V2(J)) GOTO 220
  210 CONTINUE
      J=N2V2
  220 A=(Y2V2(J)-Y2V2(J-1))/(X2V2(J)-X2V2(J-1))
      B=(X2V2(J-1)*Y2V2(J)-X2V2(J)*Y2V2(J-1))/(X2V2(J-1)-X2V2(J))
      QIN(63,I)=(EN+EIN(64))*(A*(EN+EIN(64))+B)/EN
      QIN(63,I)=QIN(63,I)*APOP2V2/DEG2V2*1.D-16
C  2V2 BEND MODE HARMONIC
  250 CONTINUE
      QIN(64,I)=0.0
      IF(EN.LE.EIN(64)) GO TO 300
      DO 260 J=2,N2V2
      IF(EN.LE.X2V2(J)) GOTO 270
  260 CONTINUE
      J=N2V2
  270 A=(Y2V2(J)-Y2V2(J-1))/(X2V2(J)-X2V2(J-1))
      B=(X2V2(J-1)*Y2V2(J)-X2V2(J)*Y2V2(J-1))/(X2V2(J-1)-X2V2(J))
      QIN(64,I)=(A*EN+B)*APOPGS*1.D-16
C
C SUPERELASTIC V1 SYMMETRIC STRETCH
  300 CONTINUE
      QIN(65,I)=0.0
      IF(EN.LE.0.0) GO TO 350
      DO 310 J=2,NV1
      IF((EN+EIN(66)).LE.XV1(J)) GOTO 320
  310 CONTINUE
      J=NV1
  320 A=(YV1(J)-YV1(J-1))/(XV1(J)-XV1(J-1))
      B=(XV1(J-1)*YV1(J)-XV1(J)*YV1(J-1))/(XV1(J-1)-XV1(J))
      QIN(65,I)=(EN+EIN(66))*(A*(EN+EIN(66))+B)/EN
      QIN(65,I)=QIN(65,I)*APOPV1/DEGV1*1.D-16
C V1 SYMMETRIC STRETCH
  350 CONTINUE
      QIN(66,I)=0.0
      IF(EN.LE.EIN(66)) GO TO 400
      DO 360 J=2,NV1
      IF(EN.LE.XV1(J)) GOTO 370
  360 CONTINUE
      J=NV1
  370 A=(YV1(J)-YV1(J-1))/(XV1(J)-XV1(J-1))
      B=(XV1(J-1)*YV1(J)-XV1(J)*YV1(J-1))/(XV1(J-1)-XV1(J))
      QIN(66,I)=(A*EN+B)*APOPGS*1.D-16
C
C SUPERELASTIC 3V2 + V12
  400 CONTINUE
      QIN(67,I)=0.0
      IF(EN.LE.0.0) GO TO 450
      DO 410 J=2,N3V2
      IF((EN+EIN(68)).LE.X3V2(J)) GOTO 420
  410 CONTINUE
      J=N3V2
  420 A=(Y3V2(J)-Y3V2(J-1))/(X3V2(J)-X3V2(J-1))
      B=(X3V2(J-1)*Y3V2(J)-X3V2(J)*Y3V2(J-1))/(X3V2(J-1)-X3V2(J))
      QIN(67,I)=(EN+EIN(68))*(A*(EN+EIN(68))+B)/EN
      QIN(67,I)=QIN(67,I)*APOP3V2/DEG3V2*1.D-16
C 3V2 + V12
  450 CONTINUE
      QIN(68,I)=0.0
      IF(EN.LE.EIN(68)) GO TO 500
      DO 460 J=2,N3V2
      IF(EN.LE.X3V2(J)) GOTO 470
  460 CONTINUE
      J=N3V2
  470 A=(Y3V2(J)-Y3V2(J-1))/(X3V2(J)-X3V2(J-1))
      B=(X3V2(J-1)*Y3V2(J)-X3V2(J)*Y3V2(J-1))/(X3V2(J-1)-X3V2(J))
      QIN(68,I)=(A*EN+B)*APOPGS*1.D-16
C
C  SUPERELASTIC V3 ASYMMETRIC STRETCH
  500 QIN(69,I)=0.0
      IF(EN.LE.0.0) GO TO 550
      EFAC=DSQRT(1.0-(EIN(69)/EN))
      QIN(69,I)=AMPV3*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      DO 510 J=2,NV3
      IF((EN+EIN(70)).LE.XV3(J)) GOTO 520
  510 CONTINUE
      J=NV3
  520 A=(YV3(J)-YV3(J-1))/(XV3(J)-XV3(J-1))
      B=(XV3(J-1)*YV3(J)-XV3(J)*YV3(J-1))/(XV3(J-1)-XV3(J))
      QIN(69,I)=QIN(69,I)+(EN+EIN(70))*(A*(EN+EIN(70))+B)/EN
      QIN(69,I)=QIN(69,I)*APOPV3/DEGV3*1.D-16
C V3  ASYMMETRIC STRETCH
  550 QIN(70,I)=0.0
      IF(EN.LE.EIN(70)) GO TO 600
      EFAC=DSQRT(1.0-(EIN(70)/EN))
      QIN(70,I)=AMPV3*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      DO 560 J=2,NV3
      IF(EN.LE.XV3(J)) GO TO 570
  560 CONTINUE
      J=NV3
  570 A=(YV3(J)-YV3(J-1))/(XV3(J)-XV3(J-1))
      B=(XV3(J-1)*YV3(J)-XV3(J)*YV3(J-1))/(XV3(J-1)-XV3(J))
      QIN(70,I)=QIN(70,I)+(A*EN+B)
      QIN(70,I)=QIN(70,I)*APOPGS*1.D-16
C
C  4V2 + 2V1 + V12V2  POLYAD 3
  600 CONTINUE
      QIN(71,I)=0.0
      IF(EN.LE.EIN(71)) GO TO 650
      DO 610 J=2,NPD3
      IF(EN.LE.XVPD3(J)) GOTO 620
  610 CONTINUE
      J=NPD3
  620 A=(YVPD3(J)-YVPD3(J-1))/(XVPD3(J)-XVPD3(J-1))
      B=(XVPD3(J-1)*YVPD3(J)-XVPD3(J)*YVPD3(J-1))/(XVPD3(J-1)-XVPD3(J))
      QIN(71,I)=(A*EN+B)*1.D-16
C
C       3V2V1  + 2V1V2
  650 CONTINUE
      QIN(72,I)=0.0
      IF(EN.LE.EIN(72)) GO TO 700
      DO 660 J=2,NV130
      IF(EN.LE.XV130(J)) GOTO 670
  660 CONTINUE
      J=NV130
  670 A=(YV130(J)-YV130(J-1))/(XV130(J)-XV130(J-1))
      B=(XV130(J-1)*YV130(J)-XV130(J)*YV130(J-1))/(XV130(J-1)-XV130(J))
      QIN(72,I)=(A*EN+B)*1.D-16
C
C   POLYAD 4
  700 CONTINUE
      QIN(73,I)=0.0
      IF(EN.LE.EIN(73)) GO TO 750
      DO 710 J=2,NPD4
      IF(EN.LE.XVPD4(J)) GOTO 720
  710 CONTINUE
      J=NPD4
  720 A=(YVPD4(J)-YVPD4(J-1))/(XVPD4(J)-XVPD4(J-1))
      B=(XVPD4(J-1)*YVPD4(J)-XVPD4(J)*YVPD4(J-1))/(XVPD4(J-1)-XVPD4(J))
      QIN(73,I)=(A*EN+B)*1.D-16
C
C  PLOYAD 5
  750 CONTINUE
      QIN(74,I)=0.0
      IF(EN.LE.EIN(74)) GO TO 800
      DO 760 J=2,NPD5
      IF(EN.LE.XVPD5(J)) GOTO 770
  760 CONTINUE
      J=NPD5
  770 A=(YVPD5(J)-YVPD5(J-1))/(XVPD5(J)-XVPD5(J-1))
      B=(XVPD5(J-1)*YVPD5(J)-XVPD5(J)*YVPD5(J-1))/(XVPD5(J-1)-XVPD5(J))
      QIN(74,I)=(A*EN+B)*1.D-16
C
C   POLYAD 6
  800 CONTINUE
      QIN(75,I)=0.0
      IF(EN.LE.EIN(75)) GO TO 850
      DO 810 J=2,NPD6
      IF(EN.LE.XVPD6(J)) GOTO 820
  810 CONTINUE
      J=NPD6
  820 A=(YVPD6(J)-YVPD6(J-1))/(XVPD6(J)-XVPD6(J-1))
      B=(XVPD6(J-1)*YVPD6(J)-XVPD6(J)*YVPD6(J-1))/(XVPD6(J-1)-XVPD6(J))
      QIN(75,I)=(A*EN+B)*1.D-16
C
C   POLYAD 7
  850 CONTINUE
      QIN(76,I)=0.0
      IF(EN.LE.EIN(76)) GO TO 900
      DO 860 J=2,NPD7
      IF(EN.LE.XVPD7(J)) GOTO 870
  860 CONTINUE
      J=NPD7
  870 A=(YVPD7(J)-YVPD7(J-1))/(XVPD7(J)-XVPD7(J-1))
      B=(XVPD7(J-1)*YVPD7(J)-XVPD7(J)*YVPD7(J-1))/(XVPD7(J-1)-XVPD7(J))
      QIN(76,I)=(A*EN+B)*1.D-16
C
C   POLYAD 8
  900 CONTINUE
      QIN(77,I)=0.0
      IF(EN.LE.EIN(77)) GO TO 950
      DO 910 J=2,NPD8
      IF(EN.LE.XVPD8(J)) GOTO 920
  910 CONTINUE
      J=NPD8
  920 A=(YVPD8(J)-YVPD8(J-1))/(XVPD8(J)-XVPD8(J-1))
      B=(XVPD8(J-1)*YVPD8(J)-XVPD8(J)*YVPD8(J-1))/(XVPD8(J-1)-XVPD8(J))
      QIN(77,I)=(A*EN+B)*1.D-16
C
C   POLYAD 9
  950 CONTINUE
      QIN(78,I)=0.0
      IF(EN.LE.EIN(78)) GO TO 1000
      DO 960 J=2,NPD9
      IF(EN.LE.XVPD9(J)) GOTO 970
  960 CONTINUE
      J=NPD9
  970 A=(YVPD9(J)-YVPD9(J-1))/(XVPD9(J)-XVPD9(J-1))
      B=(XVPD9(J-1)*YVPD9(J)-XVPD9(J)*YVPD9(J-1))/(XVPD9(J-1)-XVPD9(J))
      QIN(78,I)=(A*EN+B)*1.D-16
C
C   SUM OF HIGHER POLYADS
 1000 CONTINUE
      QIN(79,I)=0.0
      IF(EN.LE.EIN(79)) GO TO 1050
      DO 1010 J=2,NPDH
      IF(EN.LE.XVPDH(J)) GOTO 1020
 1010 CONTINUE
      J=NPDH
 1020 A=(YVPDH(J)-YVPDH(J-1))/(XVPDH(J)-XVPDH(J-1))
      B=(XVPDH(J-1)*YVPDH(J)-XVPDH(J)*YVPDH(J-1))/(XVPDH(J-1)-XVPDH(J))
      QIN(79,I)=(A*EN+B)*1.D-16
C
 1050 CONTINUE
      QIN(80,I)=0.0
      IF(EN.LE.EIN(80)) GO TO 1100
      DO 1060 J=2,NEXC1
      IF(EN.LE.XEXC1(J)) GOTO 1070
 1060 CONTINUE
      J=NEXC1
 1070 A=(YEXC1(J)-YEXC1(J-1))/(XEXC1(J)-XEXC1(J-1))
      B=(XEXC1(J-1)*YEXC1(J)-XEXC1(J)*YEXC1(J-1))/(XEXC1(J-1)-XEXC1(J))
      QIN(80,I)=(A*EN+B)*1.D-16

 1100 CONTINUE
      QIN(81,I)=0.0
      IF(EN.LE.EIN(81)) GO TO 1150
      DO 1110 J=2,NEXC2
      IF(EN.LE.XEXC2(J)) GOTO 1120
 1110 CONTINUE
      J=NEXC2
 1120 A=(YEXC2(J)-YEXC2(J-1))/(XEXC2(J)-XEXC2(J-1))
      B=(XEXC2(J-1)*YEXC2(J)-XEXC2(J)*YEXC2(J-1))/(XEXC2(J-1)-XEXC2(J))
      QIN(81,I)=(A*EN+B)*1.D-16
C
 1150 CONTINUE
      QIN(82,I)=0.0
      IF(EN.LE.EIN(82)) GO TO 1200
      DO 1160  J=2,NEXC3
      IF(EN.LE.XEXC3(J)) GOTO 1170
 1160 CONTINUE
      J=NEXC3
 1170 A=(YEXC3(J)-YEXC3(J-1))/(XEXC3(J)-XEXC3(J-1))
      B=(XEXC3(J-1)*YEXC3(J)-XEXC3(J)*YEXC3(J-1))/(XEXC3(J-1)-XEXC3(J))
      QIN(82,I)=(A*EN+B)*1.D-16
C
 1200 CONTINUE
      QIN(83,I)=0.0
      IF(EN.LE.EIN(83)) GO TO 1250
      DO 1210 J=2,NEXC4
      IF(EN.LE.XEXC4(J)) GOTO 1220
 1210 CONTINUE
      J=NEXC4
 1220 A=(YEXC4(J)-YEXC4(J-1))/(XEXC4(J)-XEXC4(J-1))
      B=(XEXC4(J-1)*YEXC4(J)-XEXC4(J)*YEXC4(J-1))/(XEXC4(J-1)-XEXC4(J))
      QIN(83,I)=(A*EN+B)*1.D-16
C
 1250 CONTINUE
      QIN(84,I)=0.0
      IF(EN.LE.EIN(84)) GO TO 1300
      DO 1260  J=2,NEXC5
      IF(EN.LE.XEXC5(J)) GOTO 1270
 1260 CONTINUE
      J=NEXC5
 1270 A=(YEXC5(J)-YEXC5(J-1))/(XEXC5(J)-XEXC5(J-1))
      B=(XEXC5(J-1)*YEXC5(J)-XEXC5(J)*YEXC5(J-1))/(XEXC5(J-1)-XEXC5(J))
      QIN(84,I)=(A*EN+B)*1.D-16
C
 1300 CONTINUE
      QIN(85,I)=0.0
      IF(EN.LE.EIN(85)) GO TO 1400
      DO 1310  J=2,NEXC6
      IF(EN.LE.XEXC6(J)) GOTO 1320
 1310 CONTINUE
      J=NEXC6
 1320 A=(YEXC6(J)-YEXC6(J-1))/(XEXC6(J)-XEXC6(J-1))
      B=(XEXC6(J-1)*YEXC6(J)-XEXC6(J)*YEXC6(J-1))/(XEXC6(J-1)-XEXC6(J))
      QIN(85,I)=(A*EN+B)*1.D-16
 1400 CONTINUE
C SUM ROTATION
      SUMR=0.0
      DO 1450 K=1,60
      SUMR=SUMR+QIN(K,I)
 1450 CONTINUE
C SUM VIBRATION
      SUMV=0.0
      DO 1455 K=61,79
      SUMV=SUMV+QIN(K,I)
 1455 CONTINUE
C SUM EXCITATION
      SUME=0.0
      DO 1460 K=80,85
      SUME=SUME+QIN(K,I)
 1460 CONTINUE
C GET CORRECT ELASTIC X-SECTION
      Q(2,I)=Q(2,I)-SUMR
C Q(1,I) TOTAL USED FOR INFORMATION ONLY
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)+SUMR+SUMV+SUME
 9000 CONTINUE
C
C     SAVE ON COMPUTING TIME
C
      DO 2000 K=1,15
      J=86-K
      IF(EFINAL.LE.EIN(J)) NIN=J-1
 2000 CONTINUE
C
      RETURN
      END
      SUBROUTINE GAS60(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      NAME=' DUMMY         '
C ---------------------------------------------------------------------
C   DUMMY ROUTINE
C ---------------------------------------------------------------------
      NIN=0
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      E(1)=0.0
      E(2)=0.0
      E(3)=0.0
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=0.0
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       DUMMY          '
      SCRPT(3)=' IONISATION    ELOSS=         '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      EN=-ESTEP/2.0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      Q(2,I)=0.0
      Q(3,I)=0.0
      Q(4,I)=0.0
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)
  900 CONTINUE
C  SAVE COMPUTE TIME
      RETURN
      END
      SUBROUTINE GAS61(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      NAME=' DUMMY         '
C ---------------------------------------------------------------------
C   DUMMY ROUTINE
C ---------------------------------------------------------------------
      NIN=0
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      E(1)=0.0
      E(2)=0.0
      E(3)=0.0
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=0.0
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       DUMMY          '
      SCRPT(3)=' IONISATION    ELOSS=         '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      EN=-ESTEP/2.0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      Q(2,I)=0.0
      Q(3,I)=0.0
      Q(4,I)=0.0
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)
  900 CONTINUE
C  SAVE COMPUTE TIME
      RETURN
      END
      SUBROUTINE GAS62(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      NAME=' DUMMY         '
C ---------------------------------------------------------------------
C   DUMMY ROUTINE
C ---------------------------------------------------------------------
      NIN=0
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      E(1)=0.0
      E(2)=0.0
      E(3)=0.0
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=0.0
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       DUMMY          '
      SCRPT(3)=' IONISATION    ELOSS=         '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      EN=-ESTEP/2.0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      Q(2,I)=0.0
      Q(3,I)=0.0
      Q(4,I)=0.0
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)
  900 CONTINUE
C  SAVE COMPUTE TIME
      RETURN
      END
      SUBROUTINE GAS63(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      NAME=' DUMMY         '
C ---------------------------------------------------------------------
C   DUMMY ROUTINE
C ---------------------------------------------------------------------
      NIN=0
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      E(1)=0.0
      E(2)=0.0
      E(3)=0.0
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=0.0
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       DUMMY          '
      SCRPT(3)=' IONISATION    ELOSS=         '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      EN=-ESTEP/2.0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      Q(2,I)=0.0
      Q(3,I)=0.0
      Q(4,I)=0.0
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)
  900 CONTINUE
C  SAVE COMPUTE TIME
      RETURN
      END
      SUBROUTINE GAS64(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      NAME=' DUMMY         '
C ---------------------------------------------------------------------
C   DUMMY ROUTINE
C ---------------------------------------------------------------------
      NIN=0
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      E(1)=0.0
      E(2)=0.0
      E(3)=0.0
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=0.0
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       DUMMY          '
      SCRPT(3)=' IONISATION    ELOSS=         '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      EN=-ESTEP/2.0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      Q(2,I)=0.0
      Q(3,I)=0.0
      Q(4,I)=0.0
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)
  900 CONTINUE
C  SAVE COMPUTE TIME
      RETURN
      END
      SUBROUTINE GAS65(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      NAME=' DUMMY         '
C ---------------------------------------------------------------------
C   DUMMY ROUTINE
C ---------------------------------------------------------------------
      NIN=0
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      E(1)=0.0
      E(2)=0.0
      E(3)=0.0
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=0.0
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       DUMMY          '
      SCRPT(3)=' IONISATION    ELOSS=         '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      EN=-ESTEP/2.0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      Q(2,I)=0.0
      Q(3,I)=0.0
      Q(4,I)=0.0
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)
  900 CONTINUE
C  SAVE COMPUTE TIME
      RETURN
      END
      SUBROUTINE GAS66(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      NAME=' DUMMY         '
C ---------------------------------------------------------------------
C   DUMMY ROUTINE
C ---------------------------------------------------------------------
      NIN=0
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      E(1)=0.0
      E(2)=0.0
      E(3)=0.0
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=0.0
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       DUMMY          '
      SCRPT(3)=' IONISATION    ELOSS=         '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      EN=-ESTEP/2.0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      Q(2,I)=0.0
      Q(3,I)=0.0
      Q(4,I)=0.0
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)
  900 CONTINUE
C  SAVE COMPUTE TIME
      RETURN
      END
      SUBROUTINE GAS67(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      NAME=' DUMMY         '
C ---------------------------------------------------------------------
C   DUMMY ROUTINE
C ---------------------------------------------------------------------
      NIN=0
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      E(1)=0.0
      E(2)=0.0
      E(3)=0.0
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=0.0
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       DUMMY          '
      SCRPT(3)=' IONISATION    ELOSS=         '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      EN=-ESTEP/2.0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      Q(2,I)=0.0
      Q(3,I)=0.0
      Q(4,I)=0.0
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)
  900 CONTINUE
C  SAVE COMPUTE TIME
      RETURN
      END
      SUBROUTINE GAS68(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      NAME=' DUMMY         '
C ---------------------------------------------------------------------
C   DUMMY ROUTINE
C ---------------------------------------------------------------------
      NIN=0
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      E(1)=0.0
      E(2)=0.0
      E(3)=0.0
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=0.0
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       DUMMY          '
      SCRPT(3)=' IONISATION    ELOSS=         '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      EN=-ESTEP/2.0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      Q(2,I)=0.0
      Q(3,I)=0.0
      Q(4,I)=0.0
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)
  900 CONTINUE
C  SAVE COMPUTE TIME
      RETURN
      END
      SUBROUTINE GAS69(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      NAME=' DUMMY         '
C ---------------------------------------------------------------------
C   DUMMY ROUTINE
C ---------------------------------------------------------------------
      NIN=0
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      E(1)=0.0
      E(2)=0.0
      E(3)=0.0
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=0.0
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       DUMMY          '
      SCRPT(3)=' IONISATION    ELOSS=         '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      EN=-ESTEP/2.0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      Q(2,I)=0.0
      Q(3,I)=0.0
      Q(4,I)=0.0
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)
  900 CONTINUE
C  SAVE COMPUTE TIME
      RETURN
      END
      SUBROUTINE GAS70(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      NAME=' DUMMY         '
C ---------------------------------------------------------------------
C   DUMMY ROUTINE
C ---------------------------------------------------------------------
      NIN=0
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      E(1)=0.0
      E(2)=0.0
      E(3)=0.0
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=0.0
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       DUMMY          '
      SCRPT(3)=' IONISATION    ELOSS=         '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      EN=-ESTEP/2.0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      Q(2,I)=0.0
      Q(3,I)=0.0
      Q(4,I)=0.0
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)
  900 CONTINUE
C  SAVE COMPUTE TIME
      RETURN
      END
      SUBROUTINE GAS71(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      NAME=' DUMMY         '
C ---------------------------------------------------------------------
C   DUMMY ROUTINE
C ---------------------------------------------------------------------
      NIN=0
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      E(1)=0.0
      E(2)=0.0
      E(3)=0.0
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=0.0
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       DUMMY          '
      SCRPT(3)=' IONISATION    ELOSS=         '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      EN=-ESTEP/2.0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      Q(2,I)=0.0
      Q(3,I)=0.0
      Q(4,I)=0.0
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)
  900 CONTINUE
C  SAVE COMPUTE TIME
      RETURN
      END
      SUBROUTINE GAS72(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      NAME=' DUMMY         '
C ---------------------------------------------------------------------
C   DUMMY ROUTINE
C ---------------------------------------------------------------------
      NIN=0
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      E(1)=0.0
      E(2)=0.0
      E(3)=0.0
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=0.0
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       DUMMY          '
      SCRPT(3)=' IONISATION    ELOSS=         '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      EN=-ESTEP/2.0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      Q(2,I)=0.0
      Q(3,I)=0.0
      Q(4,I)=0.0
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)
  900 CONTINUE
C  SAVE COMPUTE TIME
      RETURN
      END
      SUBROUTINE GAS73(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      NAME=' DUMMY         '
C ---------------------------------------------------------------------
C   DUMMY ROUTINE
C ---------------------------------------------------------------------
      NIN=0
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      E(1)=0.0
      E(2)=0.0
      E(3)=0.0
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=0.0
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       DUMMY          '
      SCRPT(3)=' IONISATION    ELOSS=         '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      EN=-ESTEP/2.0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      Q(2,I)=0.0
      Q(3,I)=0.0
      Q(4,I)=0.0
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)
  900 CONTINUE
C  SAVE COMPUTE TIME
      RETURN
      END
      SUBROUTINE GAS74(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      NAME=' DUMMY         '
C ---------------------------------------------------------------------
C   DUMMY ROUTINE
C ---------------------------------------------------------------------
      NIN=0
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      E(1)=0.0
      E(2)=0.0
      E(3)=0.0
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=0.0
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       DUMMY          '
      SCRPT(3)=' IONISATION    ELOSS=         '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      EN=-ESTEP/2.0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      Q(2,I)=0.0
      Q(3,I)=0.0
      Q(4,I)=0.0
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)
  900 CONTINUE
C  SAVE COMPUTE TIME
      RETURN
      END
      SUBROUTINE GAS75(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      NAME=' DUMMY         '
C ---------------------------------------------------------------------
C   DUMMY ROUTINE
C ---------------------------------------------------------------------
      NIN=0
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      E(1)=0.0
      E(2)=0.0
      E(3)=0.0
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=0.0
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       DUMMY          '
      SCRPT(3)=' IONISATION    ELOSS=         '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      EN=-ESTEP/2.0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      Q(2,I)=0.0
      Q(3,I)=0.0
      Q(4,I)=0.0
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)
  900 CONTINUE
C  SAVE COMPUTE TIME
      RETURN
      END
      SUBROUTINE GAS76(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      NAME=' DUMMY         '
C ---------------------------------------------------------------------
C   DUMMY ROUTINE
C ---------------------------------------------------------------------
      NIN=0
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      E(1)=0.0
      E(2)=0.0
      E(3)=0.0
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=0.0
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       DUMMY          '
      SCRPT(3)=' IONISATION    ELOSS=         '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      EN=-ESTEP/2.0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      Q(2,I)=0.0
      Q(3,I)=0.0
      Q(4,I)=0.0
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)
  900 CONTINUE
C  SAVE COMPUTE TIME
      RETURN
      END
      SUBROUTINE GAS77(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      NAME=' DUMMY         '
C ---------------------------------------------------------------------
C   DUMMY ROUTINE
C ---------------------------------------------------------------------
      NIN=0
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      E(1)=0.0
      E(2)=0.0
      E(3)=0.0
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=0.0
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       DUMMY          '
      SCRPT(3)=' IONISATION    ELOSS=         '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      EN=-ESTEP/2.0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      Q(2,I)=0.0
      Q(3,I)=0.0
      Q(4,I)=0.0
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)
  900 CONTINUE
C  SAVE COMPUTE TIME
      RETURN
      END
      SUBROUTINE GAS78(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      NAME=' DUMMY         '
C ---------------------------------------------------------------------
C   DUMMY ROUTINE
C ---------------------------------------------------------------------
      NIN=0
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      E(1)=0.0
      E(2)=0.0
      E(3)=0.0
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=0.0
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       DUMMY          '
      SCRPT(3)=' IONISATION    ELOSS=         '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      EN=-ESTEP/2.0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      Q(2,I)=0.0
      Q(3,I)=0.0
      Q(4,I)=0.0
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)
  900 CONTINUE
C  SAVE COMPUTE TIME
      RETURN
      END
      SUBROUTINE GAS79(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      NAME=' DUMMY         '
C ---------------------------------------------------------------------
C   DUMMY ROUTINE
C ---------------------------------------------------------------------
      NIN=0
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      E(1)=0.0
      E(2)=0.0
      E(3)=0.0
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=0.0
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       DUMMY          '
      SCRPT(3)=' IONISATION    ELOSS=         '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      EN=-ESTEP/2.0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      Q(2,I)=0.0
      Q(3,I)=0.0
      Q(4,I)=0.0
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)
  900 CONTINUE
C  SAVE COMPUTE TIME
      RETURN
      END
      SUBROUTINE GAS80(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      DIMENSION PEQEL(6,4000),PEQIN(220,4000),KIN(220),KEL(6)
      DIMENSION Q(6,4000),QIN(220,4000),E(6),EIN(220),PENFRA(3,220)
      CHARACTER*30 SCRPT(226)
      CHARACTER*15 NAME
      NAME=' DUMMY         '
C ---------------------------------------------------------------------
C   DUMMY ROUTINE
C ---------------------------------------------------------------------
      NIN=0
      DO 1 J=1,6
    1 KEL(J)=0
      DO 2 J=1,NIN
    2 KIN(J)=0
      E(1)=0.0
      E(2)=0.0
      E(3)=0.0
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
      EOBY=0.0
      SCRPT(1)='                              '
      SCRPT(2)=' ELASTIC       DUMMY          '
      SCRPT(3)=' IONISATION    ELOSS=         '
      SCRPT(4)=' ATTACHMENT                   '
      SCRPT(5)='                              '
      SCRPT(6)='                              '
      EN=-ESTEP/2.0
      DO 900 I=1,NSTEP
      EN=EN+ESTEP
      Q(2,I)=0.0
      Q(3,I)=0.0
      Q(4,I)=0.0
      Q(1,I)=Q(2,I)+Q(3,I)+Q(4,I)
  900 CONTINUE
C  SAVE COMPUTE TIME
      RETURN
      END
